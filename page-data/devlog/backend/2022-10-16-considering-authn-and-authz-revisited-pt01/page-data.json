{"componentChunkName":"component---src-templates-post-template-post-template-tsx","path":"/devlog/backend/2022-10-16-considering-authn-and-authz-revisited-pt01","result":{"data":{"markdownRemark":{"id":"b5579848-3664-5744-836f-f16aaf6d3754","html":"<h1 id=\"연재-안내\" style=\"position:relative;\"><a href=\"#%EC%97%B0%EC%9E%AC-%EC%95%88%EB%82%B4\" aria-label=\"연재 안내 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>연재 안내</h1>\n<ul>\n<li>인가를 다시 살펴보다 (1)</li>\n<li><a href=\"/devlog/backend/2022-10-17-considering-authn-and-authz-revisited-pt02\">인가를 다시 살펴보다 (2)</a></li>\n</ul>\n<h1 id=\"들어가며\" style=\"position:relative;\"><a href=\"#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0\" aria-label=\"들어가며 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>들어가며</h1>\n<p>필요한 API 서비스를 나누고 서비스의 규모가 커지면, 인증과 인가에 대해 구조적으로 돌아보게 됩니다. 그러면서 자연스럽게 SSO(IdP, SP)나 OAuth 2.0, OpenID Connect 같은 큰 개념을 돌아보게 되고, 어떻게 이를 위임하거나 전파할지를 구상하게 됩니다.</p>\n<h1 id=\"single-sign-onsso-이란\" style=\"position:relative;\"><a href=\"#single-sign-onsso-%EC%9D%B4%EB%9E%80\" aria-label=\"single sign onsso 이란 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Single-sign On(SSO) 이란?</h1>\n<p>단일 로그인입니다. 자기 서비스에 한번만 로그인 하면, 연관있는 다른 “서비스”를 로그인 없이 이용할 수 있게 하는 것이지요. 사용자에게는 여러 서비스를 한번에 쓸 수 있게끔 세팅해주는 것이고, 뒷단에서는 각 서비스에 대해 별도 인증시스템을 따로 꾸리지 않으며 사용자 접근관리를 하도록 합니다.</p>\n<h2 id=\"sso-구현-모델에-대해\" style=\"position:relative;\"><a href=\"#sso-%EA%B5%AC%ED%98%84-%EB%AA%A8%EB%8D%B8%EC%97%90-%EB%8C%80%ED%95%B4\" aria-label=\"sso 구현 모델에 대해 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SSO 구현 모델에 대해</h2>\n<p>SSO를 구현하는 구현모델 및 기법을 살펴봅시다. 여기서는 제가 이해한 모델에 대해서 기술하겠습니다.</p>\n<h3 id=\"delegation-model\" style=\"position:relative;\"><a href=\"#delegation-model\" aria-label=\"delegation model permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Delegation model</h3>\n<p>SSO 에이전트가 중앙에서 인증을 대행합니다.\n대상 애플리케이션의 인증방식을 변경하기 어려울 때 서비스에 일일이 붙여주는 방식으로 사용합니다.\n사용자의 인증 정보를 SSO 에이전트가 관리합니다(SPOF가 될 수 있겠지요).</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 945px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/549e80f403be0429f455ef576795da7a/0ede0/00_SSO_delegation_diagram.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIDBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHuRsIWT//EABgQAQEAAwAAAAAAAAAAAAAAAAERAhIg/9oACAEBAAEFAlhtcTj/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAWEAEBAQAAAAAAAAAAAAAAAAAA4SD/2gAIAQEABj8CVcf/xAAcEAEAAQQDAAAAAAAAAAAAAAABEQAQIUExUWH/2gAIAQEAAT8hVFAj2sJkM6ouc7sg6t//2gAMAwEAAgADAAAAEKj/AP/EABURAQEAAAAAAAAAAAAAAAAAABBB/9oACAEDAQE/EIf/xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAgEBPxBX/8QAHRABAAICAgMAAAAAAAAAAAAAAQARQVEhMYGRsf/aAAgBAQABPxAP1k8fkXgU6T3Usy+SIJSCaYAUANBKn//Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/549e80f403be0429f455ef576795da7a/8ac56/00_SSO_delegation_diagram.webp 240w,\n/static/549e80f403be0429f455ef576795da7a/d3be9/00_SSO_delegation_diagram.webp 480w,\n/static/549e80f403be0429f455ef576795da7a/a70f5/00_SSO_delegation_diagram.webp 945w\"\n              sizes=\"(max-width: 945px) 100vw, 945px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/549e80f403be0429f455ef576795da7a/09b79/00_SSO_delegation_diagram.jpg 240w,\n/static/549e80f403be0429f455ef576795da7a/7cc5e/00_SSO_delegation_diagram.jpg 480w,\n/static/549e80f403be0429f455ef576795da7a/0ede0/00_SSO_delegation_diagram.jpg 945w\"\n            sizes=\"(max-width: 945px) 100vw, 945px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/549e80f403be0429f455ef576795da7a/0ede0/00_SSO_delegation_diagram.jpg\"\n            alt=\"Delegation model의 도식&lt;br /&gt;(출처: https://itwiki.kr/w/SSO)\"\n            title=\"Delegation model의 도식&lt;br /&gt;(출처: https://itwiki.kr/w/SSO)\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\"><p>Delegation model의 도식<br />(출처: <a href=\"https://itwiki.kr/w/SSO\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://itwiki.kr/w/SSO</a>)</p></figcaption>\n  </figure></p>\n<h3 id=\"propagation-model\" style=\"position:relative;\"><a href=\"#propagation-model\" aria-label=\"propagation model permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Propagation model</h3>\n<p>통합인증 서비스에서 인증을 수행하고 인증 토큰을 받아옵니다.\n서비스 접근 시, 인증토큰을 서비스에 전달하고, 이를 가지고 사용자를 확인할 수 있는 구조입니다.</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 945px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9a847bcbd3eac8d49d838fb23932f7f9/0ede0/00_SSO_propagation_diagram.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIDBAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHtz0SRxgf/xAAYEAADAQEAAAAAAAAAAAAAAAAAAQIRMf/aAAgBAQABBQLWKSViJ6f/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAWEAEBAQAAAAAAAAAAAAAAAAABEAD/2gAIAQEABj8CzWf/xAAYEAEBAQEBAAAAAAAAAAAAAAABEQAgof/aAAgBAQABPyFRgIGFlH3DI4//2gAMAwEAAgADAAAAEOTP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQIBAT8QJ//EABoQAQEAAwEBAAAAAAAAAAAAAAERABAhMbH/2gAIAQEAAT8QZoCLOuImxedH1yb0Let0QkHuv//Z'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/9a847bcbd3eac8d49d838fb23932f7f9/8ac56/00_SSO_propagation_diagram.webp 240w,\n/static/9a847bcbd3eac8d49d838fb23932f7f9/d3be9/00_SSO_propagation_diagram.webp 480w,\n/static/9a847bcbd3eac8d49d838fb23932f7f9/a70f5/00_SSO_propagation_diagram.webp 945w\"\n              sizes=\"(max-width: 945px) 100vw, 945px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/9a847bcbd3eac8d49d838fb23932f7f9/09b79/00_SSO_propagation_diagram.jpg 240w,\n/static/9a847bcbd3eac8d49d838fb23932f7f9/7cc5e/00_SSO_propagation_diagram.jpg 480w,\n/static/9a847bcbd3eac8d49d838fb23932f7f9/0ede0/00_SSO_propagation_diagram.jpg 945w\"\n            sizes=\"(max-width: 945px) 100vw, 945px\"\n            type=\"image/jpeg\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/9a847bcbd3eac8d49d838fb23932f7f9/0ede0/00_SSO_propagation_diagram.jpg\"\n            alt=\"Propagation model의 도식&lt;br /&gt;(출처: https://itwiki.kr/w/SSO)\"\n            title=\"Propagation model의 도식&lt;br /&gt;(출처: https://itwiki.kr/w/SSO)\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\"><p>Propagation model의 도식<br />(출처: <a href=\"https://itwiki.kr/w/SSO\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://itwiki.kr/w/SSO</a>)</p></figcaption>\n  </figure></p>\n<h1 id=\"oauth-20이란\" style=\"position:relative;\"><a href=\"#oauth-20%EC%9D%B4%EB%9E%80\" aria-label=\"oauth 20이란 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>OAuth 2.0이란?</h1>\n<p>유저에게 자신, 타인의 리소스에 접근할 수 있는 <strong>권한을 토큰으로 부여</strong> 하는 프로토콜(<a href=\"https://tools.ietf.org/html/rfc6749\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">RFC 6749</a>)입니다.</p>\n<h2 id=\"oauth-20의-특징\" style=\"position:relative;\"><a href=\"#oauth-20%EC%9D%98-%ED%8A%B9%EC%A7%95\" aria-label=\"oauth 20의 특징 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>OAuth 2.0의 특징</h2>\n<p>OAuth 2.0은 인증 성공시 제한된 권한을 가진 <strong>Access Token</strong>과, 이를 갱신하는 <strong>Refresh Token</strong>을 동시에 발급받습니다. 이를 통해 유저별로 다양한 서비스에 대해 필요한 권한을 부여할 수 있습니다.</p>\n<p>이처럼 권한을 부여하고 토큰을 관리하는 구조를 이해하는 것이 <strong>OAuth 2.0의 핵심</strong> 입니다.</p>\n<h2 id=\"oauth-20의-주요-용어\" style=\"position:relative;\"><a href=\"#oauth-20%EC%9D%98-%EC%A3%BC%EC%9A%94-%EC%9A%A9%EC%96%B4\" aria-label=\"oauth 20의 주요 용어 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>OAuth 2.0의 주요 용어</h2>\n<p>OAuth 2.0을 이해하기에 앞서, 용어를 정리해봅시다.</p>\n<h3 id=\"역할에-대해\" style=\"position:relative;\"><a href=\"#%EC%97%AD%ED%95%A0%EC%97%90-%EB%8C%80%ED%95%B4\" aria-label=\"역할에 대해 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>역할에 대해</h3>\n<p>OAuth 2.0을 구성하고 있는 주요 4가지 객체(Roles)는 다음과 같습니다. 이 글을 기술하며, 아래의 상황을 가정합시다.</p>\n<blockquote>\n<p>“나”는, “파이어폭스”로 “가나다” 서비스에서 “곰곰”이라는 서비스에 접근하는 권한을 주려합니다.</p>\n</blockquote>\n<ul>\n<li>\n<p>Resource owner</p>\n<ul>\n<li>Resource Server(후술할 서버)의 데이터의 주인, 즉 “나” 입니다(참고: 개인 뿐 아니라 회사 단위일 수도 있습니다).</li>\n<li>각자의 계정을 가지고 있지요.</li>\n<li>정보에 접근할 수 있는 범위(scope)를 스스로 지정합니다.\n<ul>\n<li>외부 Resource Server에 어떤 행동을 할지에 대한 권한을 부여합니다.</li>\n<li>read, write 뿐 아니라 다른 권한 또한 주고 빼고를 결정할 수 있습니다.</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>Resource server</p>\n<ul>\n<li>일반 사용자(Resouce owner)의 정보를 가지고있는 API 서버입니다. 즉 “곰곰”이라는 서비스의 서버지요.</li>\n<li>Access token을 사용하여 요청을 수신할 때, 권한을 검증한 후 적절한 결과를 응답합니다.\n<ul>\n<li>권한이 있으면 값을 주고, 아니면 401이나 403을 리턴하겠죠.</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>Client</p>\n<ul>\n<li><code class=\"language-text\">Resource owner</code>가 리소스에 접근하는 애플리케이션을 의미합니다. “가나다” 서비스에 접근하는 “파이어폭스” 이자, “가나다” 서비스 내부의 비밀정보를 저장하는 프로그램을 의미합니다.</li>\n<li>참고로, 이는 클라이언트는 노출될 수도, 내부에 존재할 수도 있습니다.\n<ul>\n<li>Confidential Client(이하 내부 클라이언트)는 사용자가 직접 관리할 수 없는 공간에 있습니다.</li>\n<li>Public Client(이하 외부 클라이언트)는 브라우저, 모바일 앱, IoT 디바이스입니다.</li>\n</ul>\n</li>\n<li>참고. Client 등록은 앱에 접근하기 위한 자격을 얻는 것을 의미합니다.</li>\n</ul>\n</li>\n<li>\n<p>Authorization server</p>\n<ul>\n<li>OAuth 2.0 프레임워크가 구현된 <strong>권한 부여</strong> 처리용 서버입니다. “가나다” 서비스의 OAuth 2.0 처리서버를 의미합니다.</li>\n<li><code class=\"language-text\">Resource owner</code>를 인증한 후, Client에 대해 적절한 권한을 부여해줍니다.</li>\n<li><code class=\"language-text\">Access token</code>, <code class=\"language-text\">Refresh token</code>를 발급합니다.\n<ul>\n<li><code class=\"language-text\">Access token</code>에는 각종 권한과 유효기간 등 주요정보가 들어가있습니다.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"토큰에-대해\" style=\"position:relative;\"><a href=\"#%ED%86%A0%ED%81%B0%EC%97%90-%EB%8C%80%ED%95%B4\" aria-label=\"토큰에 대해 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>토큰에 대해</h3>\n<p>OAuth 2.0에서 “토큰”이란 아래와 같은 두 가지가 있습니다. 토큰을 어떤 스펙으로 정해야 하는지는 정해져있진 않습니다만, 주로 <code class=\"language-text\">JWT</code>를 사용합니다.</p>\n<h4 id=\"access-token\" style=\"position:relative;\"><a href=\"#access-token\" aria-label=\"access token permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">Access token</code></h4>\n<p>Access token의 주요 특징은 아래와 같습니다:</p>\n<ul>\n<li>보호된 리소스에 접근하기 위해 필요한 토큰입니다.</li>\n<li>살아있는 기간이 짧습니다. 보통 시간단위나 분단위입니다.</li>\n<li>외부 클라이언트가 사용합니다.</li>\n<li><code class=\"language-text\">Access Token</code> 만료시 <code class=\"language-text\">Refresh Token</code>으로 갱신합니다.</li>\n</ul>\n<h4 id=\"refresh-token\" style=\"position:relative;\"><a href=\"#refresh-token\" aria-label=\"refresh token permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">Refresh token</code></h4>\n<p>Refresh token의 주요 특징은 아래와 같습니다:</p>\n<ul>\n<li>유효기간이 지나 만료된 <code class=\"language-text\">Access token</code> 을 갱신하기 위한 토큰입니다.</li>\n<li>보통 일간, 월간, 연간 단위로 살아있을 수 있습니다.</li>\n<li>외부 클라이언트가 <strong>인증</strong>을 하여 획득합니다.</li>\n<li>갱신될 수 없으며, 유효기간이 만료되면 재로그인을 수행해야 합니다.</li>\n<li>“삭제(revoke)“가 가능하며, 그러면 더이상 <strong>권한 부여</strong>를 하지 않게 됩니다.</li>\n</ul>\n<p>Refresh token에 담긴 주요 리소스들을 살펴보도록 합시다.</p>\n<h3 id=\"토큰과-연관된-엔드포인트\" style=\"position:relative;\"><a href=\"#%ED%86%A0%ED%81%B0%EA%B3%BC-%EC%97%B0%EA%B4%80%EB%90%9C-%EC%97%94%EB%93%9C%ED%8F%AC%EC%9D%B8%ED%8A%B8\" aria-label=\"토큰과 연관된 엔드포인트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>토큰과 연관된 엔드포인트</h3>\n<p>이 토큰은 <strong>인증 서버</strong>로부터 받아옵니다. 관련 엔드포인트는 <code class=\"language-text\">authorize</code>, <code class=\"language-text\">token</code> 이라는 두 개의 엔드포인트를 일컫습니다.</p>\n<ul>\n<li><code class=\"language-text\">token</code> 엔드포인트\n<ul>\n<li>상기 <code class=\"language-text\">authorize</code> 엔드포인트에 성공적으로 응답을 받고, <code class=\"language-text\">Access token</code> 과 <code class=\"language-text\">Refresh token</code> 을 받습니다.</li>\n</ul>\n</li>\n<li><code class=\"language-text\">authorize</code> 엔드포인트\n<ul>\n<li>사용자로부터 동의 및 권한 부여, 유저에 대한 <strong>권한 정보</strong>를 받기 위해 이동하는 곳입니다.</li>\n<li>“나”는 “가나다” 서비스로부터 “권한부여를 허용하시겠어요?” 와 같은 메시지를 받습니다.</li>\n</ul>\n</li>\n<li><code class=\"language-text\">introspect</code> 엔드포인트\n<ul>\n<li>Authorization Server가 Resource server에 접근하기 위해, <code class=\"language-text\">token</code> 엔드포인트로부터 받은 토큰을 물어보는 과정입니다.</li>\n<li>“가나다” 서비스가 “곰곰” 서비스에 물어본다고 할 수 있지요.</li>\n<li>“나”가 “파이어폭스”로 직접 해당 서비스를 호출할 수도 있습니다.</li>\n</ul>\n</li>\n<li><code class=\"language-text\">revoke</code> 엔드포인트\n<ul>\n<li>사용하지 않을 <code class=\"language-text\">Refresh token</code>을 “만료시키는” 엔드포인트 입니다. 유저가 특정 앱에 대해 권한을 주지 않음을 명시할 때 호출합니다.</li>\n</ul>\n</li>\n</ul>\n<p>획득한 Access token으로 API에 접근할 때 사용하며, 만료되면 내부 클라이언트가 Refresh token을 가지고 Access token을 갱신합니다.</p>\n<h1 id=\"oauth-20의-작동방식\" style=\"position:relative;\"><a href=\"#oauth-20%EC%9D%98-%EC%9E%91%EB%8F%99%EB%B0%A9%EC%8B%9D\" aria-label=\"oauth 20의 작동방식 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>OAuth 2.0의 작동방식</h1>\n<blockquote>\n<p>아래 내용을 시행하기에 앞서, 클라이언트는 자신의 서비스에 먼저 “로그인” 한 것을 가정한 것으로 이해하시면 됩니다. 저는 RFC 문서 상의 2.3. Client Authentication 을 보고 이를 판단했습니다:</p>\n<p>If the client type is confidential, the client and authorization server establish a client authentication method suitable for the security requirements of the authorization server. The authorization server MAY accept any form of client authentication meeting its security requirements. (후략)</p>\n<p>그 후에 추가적인 “인가” 를 받고(OAuth 2.0) Resource Server에 통신하거나, 추가적인 “인증”, “인가” 를 모두 받고(OpenID Connect) Resource Server와 통신하는 것으로 이해하시면 됩니다.</p>\n<p>상세한 내용은 후술하겠습니다.</p>\n</blockquote>\n<p>OAuth 2.0의 전체 프레임워크의 가장 기본적인 Flow는 다음과 같습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">          +--------+                               +---------------+\n          |        |--(A)- Authorization Request ->|   Resource    |\n          |        |                               |     Owner     |\n          |        |&lt;-(B)-- Authorization Grant ---|               |\n          |        |                               +---------------+\n          |        |\n          |        |                               +---------------+\n          |        |--(C)-- Authorization Grant -->| Authorization |\n          | Client |                               |     Server    |\n          |        |&lt;-(D)----- Access Token -------|               |\n          |        |                               +---------------+\n          |        |\n          |        |                               +---------------+\n          |        |--(E)----- Access Token ------>|    Resource   |\n          |        |                               |     Server    |\n          |        |&lt;-(F)--- Protected Resource ---|               |\n          +--------+                               +---------------+\n\n                          Figure 1: Abstract Protocol Flow</code></pre></div>\n<p>또한, 이 문서에서는 Front channel이란 용어와, Back channel이란 용어를 각각 사용하겠습니다. Front channel은 고객(클라이언트 사이드)과 연관있는 파트를, Back channel은 Authorization Server, Resource server 와 같이 프로그래머 및 서비스와 밀접한 관계가 있는 파트를 의미합니다.</p>\n<h2 id=\"front-channel에서의-작업\" style=\"position:relative;\"><a href=\"#front-channel%EC%97%90%EC%84%9C%EC%9D%98-%EC%9E%91%EC%97%85\" aria-label=\"front channel에서의 작업 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Front channel에서의 작업</h2>\n<p>“나”가 “파이어폭스”를 통해, “가나다” 서비스에서 “곰곰” 서비스로 요청하는 과정을 도식화한 것입니다. 여기서는 간략히 설명하겠습니다.</p>\n<ul>\n<li>\n<p>(A): 클라이언트는 <strong>인가</strong>를 resource owner에 요청합니다. 인증요청은 resource owner에 직접적으로 요청되거나, authorization server를 중간에 거쳐서 수행합니다.</p>\n</li>\n<li>\n<p>(B): Resource owner는 Client에게 인증허가를 수행합니다. 인증허가 방법은 총 4가지가 있습니다. 인증허가 방식은 하단에서 자세히 후술하겠습니다. 여기서는 특징만을 기술합니다.</p>\n<ul>\n<li>\n<p>Authorization Code Grant</p>\n<ul>\n<li>클라이언트가 resource owner에게 권한부여를 요청하는 대신, resource owner가 authorization server에서 인증을 받고 권한을 허가합니다.</li>\n<li>owner가 권한을 허가하면 authorization code가 발급되고 이를 클라이언트에 전달합니다.</li>\n<li>클라이언트는 authorization code를 authorization server에 코드를 보내며 권한허가 사실을 알리고 access token을 받습니다.</li>\n<li>후술할 Back channel과 Front channel이 확실히 분리되어 있어, 훨씬 안전합니다.</li>\n<li>해당 프로토콜의 다이어그램은 다음과 같습니다:\n<figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 737px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9d1fd5e124b5e02589bb8b4832aa9cea/d125e/01-oauth-auth-code.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.58333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAABp0lEQVQoz4WS266bMBBF8//f1LdElfIQRVFIEEICDObikBQMvo2N7Za44kSqdDpv45nl2dueHSGkbZtpmpRSUkrGWNu1r9cvIddUCFmWZZqmwzCod1BK7/d73/ev12s3juP1GgGAf4dS6ng8YlR476213vssyw6HgzEmNADAfr/vuk4ptZNSUjo750JNa5Pcox9R0Urv/XrY9/3pdDqfz6FBCBHH8eVyeT6fOwBYlkUIwRijdJoZ53T8WU0Fc4HWWqdpmiTJmjpnrR3HESFECNlprQEA4zq63W7RLctypdQmcvPymWqtnXOc8xVWStZ1nedFmqZ5XszzzIVYlsUYE+xIKTdfwba1doWNMUIIAGCM1XXTtR3GGCFUVVWWZ8MwzDNjjH9OBoCvycH2dre1NvBFUVS4Ig/CufgO/lRlrUUlul6jOI4JIcYYxlh4rdD2JftfeFmWx+NR17hpO1xhzvm2Bf+fbIyZpplzjgqU50XQ3zQNxphz8a5O38GUUgDgnE8TzfI8SRKESkqplCKssPf+L7x9ySZba72lzjmlVFjVYDtswR/4N8ne5l07c/+0AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/9d1fd5e124b5e02589bb8b4832aa9cea/8ac56/01-oauth-auth-code.webp 240w,\n/static/9d1fd5e124b5e02589bb8b4832aa9cea/d3be9/01-oauth-auth-code.webp 480w,\n/static/9d1fd5e124b5e02589bb8b4832aa9cea/a99e1/01-oauth-auth-code.webp 737w\"\n              sizes=\"(max-width: 737px) 100vw, 737px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/9d1fd5e124b5e02589bb8b4832aa9cea/8ff5a/01-oauth-auth-code.png 240w,\n/static/9d1fd5e124b5e02589bb8b4832aa9cea/e85cb/01-oauth-auth-code.png 480w,\n/static/9d1fd5e124b5e02589bb8b4832aa9cea/d125e/01-oauth-auth-code.png 737w\"\n            sizes=\"(max-width: 737px) 100vw, 737px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/9d1fd5e124b5e02589bb8b4832aa9cea/d125e/01-oauth-auth-code.png\"\n            alt=\"Authorization Code Grant의 도식\"\n            title=\"Authorization Code Grant의 도식\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\"><p>Authorization Code Grant의 도식</p></figcaption>\n  </figure></li>\n</ul>\n</li>\n<li>\n<p>Implicit</p>\n<ul>\n<li>Authorization code 방식에서 마지막의 코드 관련 통신을 뺀것입니다.</li>\n<li>Refresh token을 지원하지 않습니다.</li>\n<li>이는 자격증명을 안전하게 저장하기 힘든 클라이언트에 최적화된 방식입니다. Resource Owner와 Client가 모두 한 디바이스인 것을 가정합니다.</li>\n<li>이러한 연유로 보안성이 낮아집니다. 주의해야 할 부분의 링크는 <a href=\"https://tools.ietf.org/html/rfc6749#section-10.16\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">여기를 참고</a>해주세요.\n<ul>\n<li>Front channel에 Access token이 노출되는 케이스이기 때문입니다.</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>Resource Owner Password Credentials</p>\n<ul>\n<li>계정 인증정보(ID/PW) 같은 정보가 access token을 얻기 위한 authorizaion grant로 쓰입니다. access token을 얻으면 리소스 요청을 위해 ID/PW를 클라이언트가 보관할 필요는 없습니다.</li>\n<li>해당 프로토콜의 다이어그램은 다음과 같습니다:\n<figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 746px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c68f9acd46f568aa7ae3e4578a820b50/62de4/02-oauth-password.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.41666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABd0lEQVQoz12QWY7jMAxEc//79AUCDwIE+ZieTi/ZJrGy2LLcsK1doigNYmWMRupLFOuBLM4opbfbTQjuvXfOGWMul3PdNNZ5Zy0AEEJeX/8wxgAgG9brNSHEez/r+/5t/a61TqMAYLVa7beblBLGmFJq23Y+n0+GlNJyudztdimlmVJKSoWIuREC/t1+vfw+vPcxpTvMOS+KX0VR/DeE/X6/WCwYY3cYMVprhRBKaYzRG7VhspQxuxGxruvj8ZjLGKPWuqqqYRhmWmsAX5anj4/PzWZblkQIOS0yZflZhhDimOgOe+8RMcaIiABgrW2/v2tKa0qrqjpfLlyIPDPDzrkQwgPOr0kxxq7rKKXNKKnU02QAyKvdMz/1EHG8orxer2dybpqmbduu61jLjDE58wMeMz/DxhjvvVKq7/uyJIfD4XQ6dV1njHHOjTceYWPM09qI6JybSu+9lNI5N2UGgMfBGGOcc/FDfNRUSik550qp6WcYhmz4B0lwdcaj5YoDAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/c68f9acd46f568aa7ae3e4578a820b50/8ac56/02-oauth-password.webp 240w,\n/static/c68f9acd46f568aa7ae3e4578a820b50/d3be9/02-oauth-password.webp 480w,\n/static/c68f9acd46f568aa7ae3e4578a820b50/f7ebd/02-oauth-password.webp 746w\"\n              sizes=\"(max-width: 746px) 100vw, 746px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/c68f9acd46f568aa7ae3e4578a820b50/8ff5a/02-oauth-password.png 240w,\n/static/c68f9acd46f568aa7ae3e4578a820b50/e85cb/02-oauth-password.png 480w,\n/static/c68f9acd46f568aa7ae3e4578a820b50/62de4/02-oauth-password.png 746w\"\n            sizes=\"(max-width: 746px) 100vw, 746px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/c68f9acd46f568aa7ae3e4578a820b50/62de4/02-oauth-password.png\"\n            alt=\"Resource Owner Password Credentials의 도식\"\n            title=\"Resource Owner Password Credentials의 도식\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\"><p>Resource Owner Password Credentials의 도식</p></figcaption>\n  </figure></li>\n</ul>\n</li>\n<li>\n<p>Client Credentials</p>\n<ul>\n<li>자원 소유자가 유저가 아니고 클라이언트면 사용하는 방식.</li>\n<li>client가 관리하는 리소스에 접근하는 경우로 권한이 한정되어있을 때 씁니다. 클라이언트 각각이 resource owner가 될 수 있습니다.</li>\n<li>해당 프로토콜의 다이어그램은 다음과 같습니다:\n<figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 573px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/85b7b29c60834a648b9a206543917a12/3c024/03-oauth-client-creds.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.41666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAABpklEQVQoz42RyY7bMBBE9f+fkS/w2Qgi5GxYRmDDC+MxRVoLSVmLtZAiKakDmTOewUwC5B10KHR1V4leWZbDA2NM/4ZSKn+QZZmU0ola67qub7dbVVXGGMaYp5TCGAdBwBgHAJgmeEAp9X3/dDpND8V9y7JcLpf7/R4AiqLwrLWEEN//kSSxG3rOrddrjPFHsa7rIAgQQq9mF+Cw/fX9EF86ABjHcQSAWTwcfN8/Ho9OdQaE0Gq1iuO4LEtPa13VdUou33bFTzGvHx9H2rZljC0Wi+12+zQrpdI03Ww2u91uviylBACt9TiOgqVhGJKQCCGmaTLGwBe01tba19hPs1Tq5eWCMT6fzwj9rqqqbVv3ENPbX3STbum7ue97ITihJEln4jiWUv3vZaWUlLKTknNOKI2iiM3wvCiKPBdCdF33NA/D8Dn2MAzW2vv9nmWZEOIaRYTQJEk450KIpmmstX3fN03zbnYru66TUlprXUOt9fUaXTAOyVzENXeBpZSuTp7nXt/3AGCMcY/xkb92dgcAoKoqj1KaZZnL9ol/iZzzPM8RQn8Af/TfHgZXV7QAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/85b7b29c60834a648b9a206543917a12/8ac56/03-oauth-client-creds.webp 240w,\n/static/85b7b29c60834a648b9a206543917a12/d3be9/03-oauth-client-creds.webp 480w,\n/static/85b7b29c60834a648b9a206543917a12/351b3/03-oauth-client-creds.webp 573w\"\n              sizes=\"(max-width: 573px) 100vw, 573px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/85b7b29c60834a648b9a206543917a12/8ff5a/03-oauth-client-creds.png 240w,\n/static/85b7b29c60834a648b9a206543917a12/e85cb/03-oauth-client-creds.png 480w,\n/static/85b7b29c60834a648b9a206543917a12/3c024/03-oauth-client-creds.png 573w\"\n            sizes=\"(max-width: 573px) 100vw, 573px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/85b7b29c60834a648b9a206543917a12/3c024/03-oauth-client-creds.png\"\n            alt=\"Client Credentials의 도식\"\n            title=\"Client Credentials의 도식\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\"><p>Client Credentials의 도식</p></figcaption>\n  </figure></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>참고) 인증 허가 후의 과정은 아래의 Back channel과도 밀접한 연관을 가집니다. Back channel에서의 플로우 및 상세 구현방법이 정해지기 때문입니다. 여기서는 개념만 짚고 넘어가도록 하겠습니다.</p>\n<h2 id=\"back-channel에서의-작업\" style=\"position:relative;\"><a href=\"#back-channel%EC%97%90%EC%84%9C%EC%9D%98-%EC%9E%91%EC%97%85\" aria-label=\"back channel에서의 작업 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Back Channel에서의 작업</h2>\n<p>유저에게 동의(consent)를 구하고, 클라이언트는 토큰을 통해 작업하는 큰 흐름에 대해 설명합니다. 상세한 구현방법은 상기 (B) 과정에 설명한 내용입니다. 아래 내용은 OAuth 2.0의 대략적인 플로우를 의미합니다.</p>\n<ul>\n<li>(C): 권한부여를 받은 클라이언트는 access token을 authorization server 에 요청합니다.</li>\n<li>(D): authorization server는 권한부여가 올바른지 유효성을 검증하고, 유효하다면 access token을 발급한 후 클라이언트에 결과를 보냅니다.</li>\n<li>(E): 발급받은 access token으로 client는 resource server에 리소스를 요청합니다.</li>\n<li>(F): resource server는 access token의 유효성을 점검 후 필요한 리소스를 줍니다.</li>\n</ul>\n<h1 id=\"oauth-20의-grant-flow에-대해\" style=\"position:relative;\"><a href=\"#oauth-20%EC%9D%98-grant-flow%EC%97%90-%EB%8C%80%ED%95%B4\" aria-label=\"oauth 20의 grant flow에 대해 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>OAuth 2.0의 Grant flow에 대해</h1>\n<p>토큰 부여까지는 살펴보았고, 그렇다면 이제 그 토큰을 통해 어떤식으로 <strong>권한 처리</strong> 에 대한 플로우를 사용하는지 알아봅시다. 이 글에서는 Authorization Code Grant만을 살펴보도록 하겠습니다. 보다 더 상세한 스펙과 내용에 대해서는 RFC 문서를 참고해주시기 바랍니다.</p>\n<h2 id=\"grant-flow에-대해\" style=\"position:relative;\"><a href=\"#grant-flow%EC%97%90-%EB%8C%80%ED%95%B4\" aria-label=\"grant flow에 대해 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Grant flow에 대해</h2>\n<p>인가 이 후 어떤 식으로 동작하는지에 대해 살펴봅시다. Back channel에서 일어나는 일에 대해 보다 소상히 살펴본다고 생각하시면 됩니다.</p>\n<h3 id=\"authorization-code-grant\" style=\"position:relative;\"><a href=\"#authorization-code-grant\" aria-label=\"authorization code grant permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Authorization Code Grant</h3>\n<p>Authorization code grant type은 Access token과 Refresh token을 모두 얻는 데 사용되며 기밀 클라이언트에 최적화되어 있습니다. 이것은 리디렉션 기반 흐름이므로 클라이언트는 Resource Owner의 사용자 에이전트(일반적으로 웹 브라우저)와 상호 작용할 수 있어야 하며 Authorization Server에서 들어오는 요청(리디렉션을 통해)을 수신할 수 있어야 합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">          +----------+\n          | Resource |\n          |   Owner  |\n          |          |\n          +----------+\n                ^\n                |\n              (B)\n          +----|-----+          Client Identifier      +---------------+\n          |         -+----(A)-- &amp; Redirection URI ---->|               |\n          |  User-   |                                 | Authorization |\n          |  Agent  -+----(B)-- User authenticates --->|     Server    |\n          |          |                                 |               |\n          |         -+----(C)-- Authorization Code ---&lt;|               |\n          +-|----|---+                                 +---------------+\n            |    |                                         ^      v\n            (A)  (C)                                       |      |\n            |    |                                         |      |\n            ^    v                                         |      |\n          +---------+                                      |      |\n          |         |>---(D)-- Authorization Code ---------'      |\n          |  Client |          &amp; Redirection URI                  |\n          |         |                                             |\n          |         |&lt;---(E)----- Access Token -------------------'\n          +---------+       (w/ Optional Refresh Token)\n\n        Note: The lines illustrating steps (A), (B), and (C) are broken into\n        two parts as they pass through the user-agent.\n\n                          Figure 3: Authorization Code Flow</code></pre></div>\n<h4 id=\"권한요청시\" style=\"position:relative;\"><a href=\"#%EA%B6%8C%ED%95%9C%EC%9A%94%EC%B2%AD%EC%8B%9C\" aria-label=\"권한요청시 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>권한요청시</h4>\n<p>Authorization Code Grant 플로우 중, 권한요청 시에는 아래 request 쿼리값이 들어갈 수 있습니다. <code class=\"language-text\">application/x-www-form-urlencoded</code> 포맷으로 전송합니다.</p>\n<table>\n<thead>\n<tr>\n<th>필드명</th>\n<th>필수여부</th>\n<th>상세설명</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code class=\"language-text\">response_type</code></td>\n<td>REQUIRED</td>\n<td>반드시 <code class=\"language-text\">code</code> 라는 문자열이야 합니다.</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">client_id</code></td>\n<td>REQUIRED</td>\n<td>Client identifier 값입니다.</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">redirect_uri</code></td>\n<td>OPTIONAL</td>\n<td>토큰이 발급받을 위치를 지정합니다. 이 값을 엉뚱한 값으로 바꾸어 리소스에 접근할 수 없도록 하는 약속입니다.</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">scope</code></td>\n<td>OPTIONAL</td>\n<td>클라이언트가 수행할 수 있는 “범위”를 지정해주는 값입니다.</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">state</code></td>\n<td>RECOMMENDED</td>\n<td>요청-콜백 간 상태를 유지하기 위해 클라이언트 측에서 사용하는 opaque한 값입니다. CSRF를 방지하기 위해 사용됩니다.</td>\n</tr>\n</tbody>\n</table>\n<p>요청 예시는 아래와 같습니다:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\nGET /authorize?response_type=code&amp;client_id=s6BhdRkqt3&amp;state=xyz\n    &amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb HTTP/1.1\nHost: server.example.com</code></pre></div>\n<h4 id=\"권한응답시-정상처리\" style=\"position:relative;\"><a href=\"#%EA%B6%8C%ED%95%9C%EC%9D%91%EB%8B%B5%EC%8B%9C-%EC%A0%95%EC%83%81%EC%B2%98%EB%A6%AC\" aria-label=\"권한응답시 정상처리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>권한응답시 (정상처리)</h4>\n<table>\n<thead>\n<tr>\n<th>필드명</th>\n<th>필수여부</th>\n<th>상세설명</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code class=\"language-text\">code</code></td>\n<td>REQUIRED</td>\n<td>Authrization 서버로부터 생성된 <strong>권한 부여</strong> 코드값입니다. 이 값은 악의적인 사용(유출되거나 하는 등)을 방지하기 위해 만료시간이 짧아야 합니다(<code class=\"language-text\">10분</code> 이 권장됩니다). <br />해당 값은 반드시 한번 이상 <strong>사용할 수 없도록</strong> 해야합니다. 한번 이상 사용한다면 요청을 <strong>반드시</strong> 거부해야합니다.</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">state</code></td>\n<td>REQUIRED</td>\n<td>앞선 요청에 <code class=\"language-text\">state</code> 필드값이 있었다면, 요청과 동일한 값을 응답해줍니다.</td>\n</tr>\n</tbody>\n</table>\n<p>응답 예시는 아래와 같습니다:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">HTTP/1.1 302 Found\nLocation: https://client.example.com/cb?code=SplxlOBeZQQYbYS6WxSbIA\n          &amp;state=xyz</code></pre></div>\n<p>클라이언트 측에서도 식별되지 않은 응답 파라미터는 <strong>반드시</strong> 무시해야합니다.</p>\n<h4 id=\"권한응답시-비정상-처리\" style=\"position:relative;\"><a href=\"#%EA%B6%8C%ED%95%9C%EC%9D%91%EB%8B%B5%EC%8B%9C-%EB%B9%84%EC%A0%95%EC%83%81-%EC%B2%98%EB%A6%AC\" aria-label=\"권한응답시 비정상 처리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>권한응답시 (비정상 처리)</h4>\n<p>Authorization server는 아래 상황에 대해 에러를 리턴해야 하고, 잘못된 리디렉션 URI로 <strong>반드시 가게해선 안 됩니다</strong>.</p>\n<table>\n<thead>\n<tr>\n<th>필드명</th>\n<th>필수여부</th>\n<th>상세설명</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code class=\"language-text\">error</code></td>\n<td>REQUIRED</td>\n<td>에러를 표기하기 위한 <code class=\"language-text\">ASCII</code> 값입니다(알파벳 대소문자, 숫자 이외의 값은 포함하면 안됩니다). 값들은 아래와 같습니다: <br /><code class=\"language-text\">invalid_request</code>: 필수 파라미터를 포함하지 않았거나 잘못 사용한 경우 <br /><code class=\"language-text\">unauthorized_client</code>: 클라이언트가 해당 리소스를 사용하기에 적절한 권한이 없는 경우 <br /><code class=\"language-text\">access_denied</code>: Resource owner 혹은 Authorization server가 요청을 거부한 경우 <br /><code class=\"language-text\">unsupported_response_type</code>: Authorization server가 이 방법을 사용한 액세스 토큰 획득을 지원하지 않는 경우 <br /><code class=\"language-text\">invalid_scope</code>: 요청의 <code class=\"language-text\">scope</code> 값이 유효하지 않거나, 알려지지 않은 값이거나, 손상된 경우 <br /><code class=\"language-text\">server_error</code>: Authorization server 측의 예기치 않은 에러가 발생된 경우. <code class=\"language-text\">500 Internal Server Error</code> Response를 줄 수 없는 경우 사용합니다. <br /><code class=\"language-text\">temporarily_unavailable</code>: Authorization server 측의 과부화 혹은 점검의 이유로 인해 해당 요청을 처리할 수 없는 경우 사용합니다. <code class=\"language-text\">503 Service Unavailable</code> Response를 줄 수 없는 경우 사용합니다.</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">error_description</code></td>\n<td>OPTIONAL</td>\n<td>human-readable <code class=\"language-text\">ASCII</code> 텍스트. 클라이언트 개발자에게 보다 유용한 에러 메시지를 전달하기 위한 필드입니다. <br />알파벳 대소문자, 숫자 이외의 값을 포함하면 안됩니다.</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">error_uri</code></td>\n<td>OPTIONAL</td>\n<td>클라이언트 개발자에게 보다 유용한 에러 메시지를 전달하기 위한 human-readable 웹페이지 URI 값입니다.</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">state</code></td>\n<td>REQUIRED</td>\n<td>앞선 요청에 <code class=\"language-text\">state</code> 필드값이 있었다면, 요청과 동일한 값을 응답해줍니다.</td>\n</tr>\n</tbody>\n</table>\n<ol>\n<li>URI 리디렉션이 잘못되었거나, 유효하지 않거나, 없는 값인 경우</li>\n<li>Client identifier가 없거나 유요하지 않은경우</li>\n</ol>\n<p>Authorization server가 요청을 거부한 경우에 대한 응답 예시는 아래와 같습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">HTTP/1.1 302 Found\nLocation: https://client.example.com/cb#error=access_denied&amp;state=xyz</code></pre></div>\n<h4 id=\"token-발행-요청\" style=\"position:relative;\"><a href=\"#token-%EB%B0%9C%ED%96%89-%EC%9A%94%EC%B2%AD\" aria-label=\"token 발행 요청 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Token 발행 요청</h4>\n<p>HTTP request entity-body에 <code class=\"language-text\">UTF-8</code> 인코딩을 사용하고, <code class=\"language-text\">application/x-www-form-urlencoded</code> 포맷으로 보냅니다.</p>\n<table>\n<thead>\n<tr>\n<th>필드명</th>\n<th>필수여부</th>\n<th>상세설명</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code class=\"language-text\">grant_type</code></td>\n<td>REQUIRED</td>\n<td>이 값은 <strong>반드시</strong> 문자열 <code class=\"language-text\">authorization_code</code> 값이어야합니다.</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">code</code></td>\n<td>REQUIRED</td>\n<td>Authorization server로부터 받은 authorization code 값입니다.</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">redirect_url</code></td>\n<td>REQUIRED</td>\n<td>Authorization request 과정에서 해당 값이 포함되어 있었다면, <strong>반드시</strong> 그 값과 동일해야합니다.</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">client_id</code></td>\n<td>REQUIRED</td>\n<td>클라이언트 자격증명에 사용됩니다. 클라이언트가 권한 서버에 등록하면 발급받을 수 있으며 권한 서버 연동 시 클라이언트의 검증에 사용됩니다.</td>\n</tr>\n</tbody>\n</table>\n<p>요청 예시는 아래와 같습니다:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">POST /token HTTP/1.1\nHost: server.example.com\nAuthorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW\nContent-Type: application/x-www-form-urlencoded\n\ngrant_type=authorization_code&amp;code=SplxlOBeZQQYbYS6WxSbIA\n&amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb</code></pre></div>\n<h4 id=\"token-발행-요청에-대한-응답-정상처리\" style=\"position:relative;\"><a href=\"#token-%EB%B0%9C%ED%96%89-%EC%9A%94%EC%B2%AD%EC%97%90-%EB%8C%80%ED%95%9C-%EC%9D%91%EB%8B%B5-%EC%A0%95%EC%83%81%EC%B2%98%EB%A6%AC\" aria-label=\"token 발행 요청에 대한 응답 정상처리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Token 발행 요청에 대한 응답 (정상처리)</h4>\n<p>해당 값 리턴 시, 헤더에 <code class=\"language-text\">Cache-Control: no-store</code> 값과 <code class=\"language-text\">Pragma: no-cache</code> 값이 <strong>반드시</strong> 존재해야 합니다. <code class=\"language-text\">Content-Type</code> 은 <code class=\"language-text\">application/json</code> 입니다.</p>\n<table>\n<thead>\n<tr>\n<th>필드명</th>\n<th>필수여부</th>\n<th>상세설명</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code class=\"language-text\">access_token</code></td>\n<td>REQUIRED</td>\n<td>Authorization server로부터 발급받은 Access token 값입니다.</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">token_type</code></td>\n<td>REQUIRED</td>\n<td>발급한 토큰의 타입을 기재합니다. 대소문자를 구별합니다.</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">expires_in</code></td>\n<td>RECOMMENDED</td>\n<td>Access token의 유효기간입니다. <br /><code class=\"language-text\">3600</code> 이라면, 1시간 후 만료됩니다. 만약 이 값이 없다면 Authorization server에서 만료 시간을 기본값으로 정해주어야 합니다.</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">refresh_token</code></td>\n<td>OPTIONAL</td>\n<td>Refresh token값입니다. 이 값은 동일한 authorization grant 과정에 사용되는 새로운 Access token을 발급받는데 사용됩니다.</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">scope</code></td>\n<td>OPTIONAL</td>\n<td>어떤 권한을 요청할 것인지에 대한 범위입니다. 유저별로 구별되어있다면 OPTIONAL이지만, 그렇지 않다면 REQUIRED 입니다.</td>\n</tr>\n</tbody>\n</table>\n<p>응답 예시는 아래와 같습니다:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">HTTP/1.1 200 OK\nContent-Type: application/json;charset=UTF-8\nCache-Control: no-store\nPragma: no-cache\n\n{\n  \"access_token\":\"2YotnFZFEjr1zCsicMWpAA\",\n  \"token_type\":\"example\",\n  \"expires_in\":3600,\n  \"refresh_token\":\"tGzv3JOkF0XG5Qx2TlKWIA\",\n  \"example_parameter\":\"example_value\"\n}</code></pre></div>\n<p>상단에서 살펴본 Access token과 Refresh token이 보입니다. 이를 통해 리소스 요청 및 Access token 갱신을 수행합니다. 또한 클라이언트 측에서도 식별되지 않은 응답 파라미터는 <strong>반드시</strong> 무시해야합니다.</p>\n<h4 id=\"token-발행-요청에-대한-응답-정상처리-1\" style=\"position:relative;\"><a href=\"#token-%EB%B0%9C%ED%96%89-%EC%9A%94%EC%B2%AD%EC%97%90-%EB%8C%80%ED%95%9C-%EC%9D%91%EB%8B%B5-%EC%A0%95%EC%83%81%EC%B2%98%EB%A6%AC-1\" aria-label=\"token 발행 요청에 대한 응답 정상처리 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Token 발행 요청에 대한 응답 (정상처리)</h4>\n<table>\n<thead>\n<tr>\n<th>필드명</th>\n<th>필수여부</th>\n<th>상세설명</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code class=\"language-text\">error</code></td>\n<td>REQUIRED</td>\n<td>에러를 표기하기 위한 <code class=\"language-text\">ASCII</code> 값입니다(알파벳 대소문자, 숫자 이외의 값은 포함하면 안됩니다). 값들은 아래와 같습니다: <br /><code class=\"language-text\">invalid_request</code>: 파라미터가 잘못되거나, 클라이언트 인증에 문제가 있거나, 값이 변조된 경우 <br /><code class=\"language-text\">invalid_client</code>: 클라이언트 인증에 실패하는 경우 <br /><code class=\"language-text\">invalid_grant</code>: authorization grant 과정 혹은 refresh token이 잘못된 경우 <br /><code class=\"language-text\">unauthorized_client</code> : 클라이언트가 적절한 권한을 가지지 않은 경우<br /><code class=\"language-text\">unsupported_grant_type</code> : authorization server에서 지원하지 않는 authorization grant type인 경우 <br /><code class=\"language-text\">invalid_scope</code>: resource owner가 제공하지 않은 권한 밖의 <code class=\"language-text\">scope</code> 를 요청한 경우</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">error_description</code></td>\n<td>OPTIONAL</td>\n<td>human-readable <code class=\"language-text\">ASCII</code> 텍스트. 클라이언트 개발자에게 보다 유용한 에러 메시지를 전달하기 위한 필드입니다. <br />알파벳 대소문자, 숫자 이외의 값을 포함하면 안됩니다.</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">error_uri</code></td>\n<td>OPTIONAL</td>\n<td>클라이언트 개발자에게 보다 유용한 에러 메시지를 전달하기 위한 human-readable 웹페이지 URI 값입니다.</td>\n</tr>\n</tbody>\n</table>\n<p>응답 예시는 아래와 같습니다:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">HTTP/1.1 400 Bad Request\nContent-Type: application/json;charset=UTF-8\nCache-Control: no-store\nPragma: no-cache\n\n{\n  \"error\":\"invalid_request\"\n}</code></pre></div>\n<p>또한 클라이언트 측에서도 식별되지 않은 응답 파라미터는 <strong>반드시</strong> 무시해야합니다.</p>\n<h4 id=\"access-token-갱신\" style=\"position:relative;\"><a href=\"#access-token-%EA%B0%B1%EC%8B%A0\" aria-label=\"access token 갱신 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Access token 갱신</h4>\n<p>권한서버는</p>\n<table>\n<thead>\n<tr>\n<th>필드명</th>\n<th>필수여부</th>\n<th>상세설명</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code class=\"language-text\">grant_type</code></td>\n<td>REQUIRED</td>\n<td>이 값은 <strong>반드시</strong> <code class=\"language-text\">refresh_token</code> 이라는 문자열이어야 합니다.</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">refresh_token</code></td>\n<td>REQUIRED</td>\n<td>클라이언트에게 발급된 refresh token 값입니다.</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">scope</code></td>\n<td>OPTIONAL</td>\n<td>어떤 권한을 요청할 것인지에 대한 범위입니다. 유저별로 구별되어있다면 OPTIONAL이지만, 그렇지 않다면 REQUIRED 입니다.</td>\n</tr>\n</tbody>\n</table>\n<p>요청 예시는 아래와 같습니다</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">POST /token HTTP/1.1\nHost: server.example.com\nAuthorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW\nContent-Type: application/x-www-form-urlencoded\n\ngrant_type=refresh_token&amp;refresh_token=tGzv3JOkF0XG5Qx2TlKWIA</code></pre></div>\n<h2 id=\"그-외\" style=\"position:relative;\"><a href=\"#%EA%B7%B8-%EC%99%B8\" aria-label=\"그 외 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>그 외?</h2>\n<ul>\n<li>상세한 내용 및 스펙에 대한 기재사항은 OAuth 2.0의 RFC 문서를 참고해 주십시오.</li>\n<li><a href=\"https://www.rfc-editor.org/rfc/rfc7662\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Introspection 스펙</a>과 <a href=\"https://www.rfc-editor.org/rfc/rfc7009\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Revocation 스펙</a>은 RFC 링크를 참고해 주십시오.</li>\n</ul>\n<h1 id=\"마무리\" style=\"position:relative;\"><a href=\"#%EB%A7%88%EB%AC%B4%EB%A6%AC\" aria-label=\"마무리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>마무리</h1>\n<p>이번 글을 통해, 아래 내용들을 살펴볼 수 있었습니다:</p>\n<ol>\n<li>OAuth 2.0의 기본 원리와 도식을 살펴보았습니다.\n<ol>\n<li>OAuth 2.0에 사용되는 주요 용어와</li>\n</ol>\n</li>\n<li>어떤식으로 <strong>권한 부여</strong>에 활용되는지 살펴보았습니다.\n<ol>\n<li>권한 부여를 위해, 어떤 설계가 이루어지는지 살펴보았습니다.</li>\n<li>토큰 요청과 응답과 관련한 스펙을 살펴보고, 어떤 식으로 작동하는지 살펴보았습니다.</li>\n</ol>\n</li>\n</ol>\n<p>잘못된 사항은 언제든 댓글로 되짚어주십시오.</p>\n<p>읽어주셔서 감사합니다.</p>\n<hr>\n<ul>\n<li>References\n<ul>\n<li>[1] <a href=\"https://datatracker.ietf.org/doc/rfc6749/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">OAuth 2.0의 RFC 문서입니다</a></li>\n<li>[2] <a href=\"https://developer.okta.com/blog/2017/06/21/what-the-heck-is-oauth\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">OAuth 2.0의 flow를 확인하며 정말 도움되었던 글입니다</a></li>\n<li>[3] <a href=\"https://www.youtube.com/watch?v=nSa0ZCfF2Sc\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">OAuth 2.0의 Introspection에 대한 해설을 이해하는데 도움되었습니다</a></li>\n<li>[4] <a href=\"https://auth0.com/blog/what-is-and-how-does-single-sign-on-work/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Single Sign-on 이해에 상당히 도움되었습니다</a></li>\n<li>[5] <a href=\"https://wiki.wikisecurity.net/wiki:sso\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">SSO 구현 모델에 대해 살펴보는데 도움되었습니다</a></li>\n<li>[6] <a href=\"https://blog.naver.com/mds_datasecurity/222182943542\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">OAuth 2.0의 구동 관련 내용을 번역해둔 사항에 대해 참고하였습니다</a></li>\n</ul>\n</li>\n</ul>","fields":{"slug":"/devlog/backend/2022-10-16---considering-authn-and-authz-revisited-pt01//devlog/backend/2022-10-16-considering-authn-and-authz-revisited-pt01","tagSlugs":["/tag/backend/"]},"frontmatter":{"date":"2022-10-16T21:50:00.000Z","description":"API 서비스가 많이 나누어졌을 때, 인가에 대해 살펴보며 **인가** 에 사용되는 OAuth 2.0 스펙을 알아봅시다.","tags":["backend"],"title":"인가를 다시 살펴보다 (1) OAuth 2.0 개요와 프로토콜 소개","socialImage":{"publicURL":{"publicURL":"/static/96a8473e2549fd33a3d6cc8b0d8f96be/pomeranian.jpg"}}}}},"pageContext":{"slug":"/devlog/backend/2022-10-16---considering-authn-and-authz-revisited-pt01//devlog/backend/2022-10-16-considering-authn-and-authz-revisited-pt01"}},"staticQueryHashes":["251939775","357378587","401334301"]}