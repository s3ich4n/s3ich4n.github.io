<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[팔공산 창고]]></title><description><![CDATA[팔공산 창고]]></description><link>http://github.com/dylang/node-rss</link><generator>GatsbyJS</generator><lastBuildDate>Sun, 16 Feb 2025 13:06:13 GMT</lastBuildDate><item><title><![CDATA[PEP 공부해보기 - PEP 333, PEP 3333에 대하여 (2)]]></title><description><![CDATA[PEP 시리즈 - PEP 333, PEP 3333 을 탐구합니다. 이번 글에서는 ASGI 구현체에 대해 살펴봅니다.]]></description><link>https://blog.s3ich4n.me/devlog/python/2025-02-16-probing-pep-333-3-wsgi-and-asgi-pt02</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/python/2025-02-16-probing-pep-333-3-wsgi-and-asgi-pt02</guid><pubDate>Sun, 16 Feb 2025 18:57:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;들어가며&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0&quot; aria-label=&quot;들어가며 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;들어가며&lt;/h1&gt;
&lt;p&gt;지난 글에서 살펴보았던 WSGI의 간단한 구현체 작성에 이어 이번에는 ASGI 스펙을 읽고, 어떤 점과 차이가 있는지 살펴봅니다. 그리고 어떤 부분에서 다른지 추가로 구현해봅니다.&lt;/p&gt;
&lt;h1 id=&quot;제한사항&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A0%9C%ED%95%9C%EC%82%AC%ED%95%AD&quot; aria-label=&quot;제한사항 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;제한사항&lt;/h1&gt;
&lt;p&gt;이 글에서는 이벤트 루프를 다루지 않습니다. 그저 이벤트 루프를 쓴다 정도에만 한정하고, ASGI의 구현에 집중합니다.&lt;/p&gt;
&lt;p&gt;이벤트 루프에 대해서는 아래 글과 영상을 참고해주세요:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.python.org/ko/3.13/library/asyncio-eventloop.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Python 공식 문서 - 이벤트 루프&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://ks1171-park.tistory.com/81&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;블로그 - [ python ] event loop (1)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=8I9Rc2Zaos4&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;YouTube -  Talks - Arthur Pastel: Demystifying AsyncIO: Building Your Own Event Loop in Python &lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;asgi란&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#asgi%EB%9E%80&quot; aria-label=&quot;asgi란 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;ASGI란?&lt;/h1&gt;
&lt;p&gt;ASGI는 네트워크 프로토콜 서버(특히 웹 서버)와 Python 애플리케이션 간의 표준 인터페이스 확장입니다. WSGI는 HTTP 프로토콜만을 다루었지만 HTTP, HTTP/2, WebSocket을 포함한 여러 일반적인 프로토콜 스타일을 비동기 스타일로 처리할 수 있도록 하기 위한 확장(&lt;em&gt;superset&lt;/em&gt;)입니다.&lt;/p&gt;
&lt;p&gt;ASGI는 기존의 동기처리와 새로운 비동기 처리를 모두 지원합니다. WSGI에서 동기 처리를 위헤 Callable 객체를 주고받았던 것 처럼, ASGI는 비동기 호출 모델로 구성되어 있습니다. 파이썬으로 작성된 비동기 처리 웹 앱과 웹 서버 간의 통신규약이라는 뜻이지요.&lt;/p&gt;
&lt;p&gt;그리고 ASGI는 다양한 구현체들이 있습니다. 유명한 구현체로는 &lt;a href=&quot;https://www.uvicorn.org/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;uvicorn&lt;/a&gt;, &lt;a href=&quot;https://github.com/pgjones/hypercorn/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;hypercorn&lt;/a&gt;, &lt;a href=&quot;https://github.com/django/daphne&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;daphne&lt;/a&gt; 가 있습니다. ASGI 공식 스펙에 필요한 주요 도구를 지속 개발중인 리포지토리도 알아주시면 좋습니다(&lt;a href=&quot;https://github.com/django/asgiref&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;asgiref&lt;/a&gt;)&lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;p&gt;놀랍게도 앞선 글에서 언급한 WSGI는 PEP 표준이지만, ASGI는 PEP 표준은 아닙니다. 비동기 처리 대응용 확장 정도로 살펴보면 되겠네요.&lt;/p&gt;
&lt;h1 id=&quot;asgi-소개&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#asgi-%EC%86%8C%EA%B0%9C&quot; aria-label=&quot;asgi 소개 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;ASGI 소개&lt;/h1&gt;
&lt;h2 id=&quot;wsgi-처리의-한계점&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#wsgi-%EC%B2%98%EB%A6%AC%EC%9D%98-%ED%95%9C%EA%B3%84%EC%A0%90&quot; aria-label=&quot;wsgi 처리의 한계점 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;WSGI 처리의 한계점?&lt;/h2&gt;
&lt;p&gt;우선 WSGI는 살펴보았다시피 단일 콜러블 인터페이스로 구성됩니다. 이런 인터페이스는 단독 요청-응답에 맞게 설계되어있다보니 롱 폴링이 필요한 WebSocket 같은 웹 프로토콜에는 적합하지 않지요. 이런 프로토콜은 연결이 오래 지속되고 여러 이벤트가 발생합니다.&lt;/p&gt;
&lt;p&gt;따라서 단순히 비동기 처리를 하도록 바꾸기에는 어려우므로 WSGI를 바탕으로 한 새 설계가 시작된 것입니다.&lt;/p&gt;
&lt;h2 id=&quot;asgi의-설계-기초&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#asgi%EC%9D%98-%EC%84%A4%EA%B3%84-%EA%B8%B0%EC%B4%88&quot; aria-label=&quot;asgi의 설계 기초 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;ASGI의 설계 기초&lt;/h2&gt;
&lt;p&gt;ASGI도 WSGI와 비슷하지만, &lt;em&gt;단일 비동기 콜러블&lt;/em&gt; 인터페이스로 설계되었습니다. 이 메소드는 &lt;code class=&quot;language-text&quot;&gt;scope&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;send&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;receive&lt;/code&gt;를 각각 가집니다. 아래에서 설명하겠습니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;scope&lt;/code&gt;: 딕셔너리 - 현재 커넥션 관련 상세정보를 저장함&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;send&lt;/code&gt;: 비동기 콜러블 - 애플리케이션이 이벤트 메시지를 클라이언트에 전송해줌&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;receive&lt;/code&gt;: 비동기 콜러블 - 애플리케이션이 클라이언트로부터 메시지를 받게 해줌&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이런 구조는 들어오고 나가는 이벤트를 각 애플리케이션 마다 처리할 수 있슬 뿐 아니라 백그라운드 코루틴을 허용하여 애플리케이션이 다른 작업을 수행할 수 있도록 합니다. 예를 들어 Redie queue를 통한 외부 트리거 리스닝 등이 있어요.&lt;/p&gt;
&lt;p&gt;예시를 보면 어떻게 되어있나 봅시다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;application&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;scope&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; receive&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; send&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    event &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; receive&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; send&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;websocket.send&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;send&lt;/code&gt; 하고 &lt;code class=&quot;language-text&quot;&gt;receive&lt;/code&gt; 하는 모든 이벤트는 사전에 정의된(&lt;em&gt;predefined&lt;/em&gt;) &lt;code class=&quot;language-text&quot;&gt;dict&lt;/code&gt; 타입입니다. 이렇게 되면 필요할 때 애플리케이션을 서버 간 교체를 할 수 있습니다. 다른 ASGI서버를 쓰더라도 잘 실행할 수 있다는 뜻이지요.&lt;/p&gt;
&lt;p&gt;모든 이벤트는 &lt;code class=&quot;language-text&quot;&gt;type&lt;/code&gt; 이라는 값을 가집니다. 이 값을 통해 이벤트의 구조를 추론할 수 있지요. HTTP 프로토콜인지, WebSocket 프로토콜인지, 후술할 lifespan 프로토콜인지 설명해줍니다.&lt;/p&gt;
&lt;p&gt;이벤트는 이런 규칙을 가집니다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;http.request&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;        &lt;span class=&quot;token comment&quot;&gt;# HTTP 요청임을 나타내는 타입&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;body&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;b&quot;Hello World&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;        &lt;span class=&quot;token comment&quot;&gt;# 요청 본문 (바이트 형식)&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;more_body&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;            &lt;span class=&quot;token comment&quot;&gt;# 추가 본문이 없음을 표시&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;만일 웹소켓 이벤트라면:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;websocket.send&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;      &lt;span class=&quot;token comment&quot;&gt;# WebSocket 메시지 전송을 나타내는 타입&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;text&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Hello world!&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;        &lt;span class=&quot;token comment&quot;&gt;# 전송할 텍스트 메시지&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;lifespan 프로토콜은 ASGI 애플리케이션의 수명주기를 관리합니다. 서버 시작/종료시점에 필요한 행위를 처리하는 이벤트임을 말해주는 것이죠.&lt;/p&gt;
&lt;h2 id=&quot;wsgi-호환&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#wsgi-%ED%98%B8%ED%99%98&quot; aria-label=&quot;wsgi 호환 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;WSGI 호환&lt;/h2&gt;
&lt;p&gt;ASGI는 설계부터 WSGI의 superset으로 고려되었습니다. 따라서 WSGI 앱이 ASGI 앱 내에서도 작동되도록 하는 전환 wrapper가 따로 존재합니다(&lt;code class=&quot;language-text&quot;&gt;asgiref&lt;/code&gt; 라이브러리에서 제공됩니다). 정확히는 스레드풀이 동기 WSGI 앱을 async event loop와 별개로 쓰이는 형식입니다(&lt;code class=&quot;language-text&quot;&gt;WsgiToAsgi&lt;/code&gt; 를 참고하세요).&lt;/p&gt;
&lt;h1 id=&quot;asgi-스펙-상세보기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#asgi-%EC%8A%A4%ED%8E%99-%EC%83%81%EC%84%B8%EB%B3%B4%EA%B8%B0&quot; aria-label=&quot;asgi 스펙 상세보기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;ASGI 스펙 상세보기&lt;/h1&gt;
&lt;p&gt;이제부터 본격적인 ASGI의 구성을 살펴봅시다.&lt;/p&gt;
&lt;h2 id=&quot;구성요소와-하는-일&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B5%AC%EC%84%B1%EC%9A%94%EC%86%8C%EC%99%80-%ED%95%98%EB%8A%94-%EC%9D%BC&quot; aria-label=&quot;구성요소와 하는 일 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;구성요소와 하는 일&lt;/h2&gt;
&lt;p&gt;ASGI는 크게 두 가지 구성요소를 가집니다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;프로토콜 서버
&lt;ul&gt;
&lt;li&gt;소켓 연결을 관리하고, 이를 연결과 연결 별 이벤트 메시지로 변환&lt;/li&gt;
&lt;li&gt;비동기 이벤트 루프 관리&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;애플리케이션
&lt;ul&gt;
&lt;li&gt;프로토콜 서버 내부에 존재하며, 각 연결당 한 번씩 호출됨&lt;/li&gt;
&lt;li&gt;이벤트 메시지가 발생할 때마다 처리하고, 필요할 때 자체 이벤트 메시지를 전송&lt;/li&gt;
&lt;li&gt;메인 스레드에서 실행되며, 필요시 동기 코드를 위한 별도 스레드/프로세스 사용 가능&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;구조는 WSGI와 유사하지만, 애플리케이션은 비동기 Callable 객체임에 유의합니다. 데이터 처리는 단일 입력 스트림 대신 비동기 이벤트 메시지를 통해 이루어집니다. 그러므로 ASGI 애플리케이션은 &lt;code class=&quot;language-text&quot;&gt;async&lt;/code&gt;/&lt;code class=&quot;language-text&quot;&gt;await&lt;/code&gt; 호환 코루틴(i.e., &lt;code class=&quot;language-text&quot;&gt;asyncio&lt;/code&gt; 호환)으로 실행되어야 합니다.&lt;/p&gt;
&lt;p&gt;ASGI 연결은 다음 두 가지 주요 부분으로 구성됩니다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;연결 &lt;code class=&quot;language-text&quot;&gt;scope&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;사용자와의 프로토콜 연결을 나타내는 정보&lt;/li&gt;
&lt;li&gt;연결이 종료될 때까지 유지됨&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;이벤트 처리
&lt;ul&gt;
&lt;li&gt;receive: 연결에서 발생하는 이벤트를 애플리케이션이 수신&lt;/li&gt;
&lt;li&gt;send: 애플리케이션이 서버로 응답을 전송(클라이언트에게 전달될 데이터 포함)&lt;/li&gt;
&lt;li&gt;두 가지 모두 awaitable callable로 구현&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;각 애플리케이션 호출은 하나의 연결에 매핑되며, 해당 연결의 수명과 정리 작업이 완료될 때까지 유지됩니다.&lt;/p&gt;
&lt;h1 id=&quot;asgi-예시코드-짜보기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#asgi-%EC%98%88%EC%8B%9C%EC%BD%94%EB%93%9C-%EC%A7%9C%EB%B3%B4%EA%B8%B0&quot; aria-label=&quot;asgi 예시코드 짜보기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;ASGI 예시코드 짜보기&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;🍅 tips
먼저 GET 요청을 받고 확인하는 로직을 구현합니다.
POST 요청은 그 다음에 진행해봅시다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;이제부터는 ASGI의 두 구성요소를 만들어봐야겠죠. 애플리케이션의 예시는 보았다시피 단순히 요청을 받고, 처리할 수 있기만 하면 됩니다. 그렇다면 우리는 소켓 연결을 관리하고, 메시지로 변환해주는 ASGI의 프로토콜 서버를 만들어봅시다. 그런데 예시가 너무 막막하네요. 이럴 땐 완성된 구현체를 한번 보는것부터 시작합시다.&lt;/p&gt;
&lt;h2 id=&quot;asgi의-프로토콜-서버-만들기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#asgi%EC%9D%98-%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C-%EC%84%9C%EB%B2%84-%EB%A7%8C%EB%93%A4%EA%B8%B0&quot; aria-label=&quot;asgi의 프로토콜 서버 만들기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;ASGI의 프로토콜 서버 만들기&lt;/h2&gt;
&lt;h3 id=&quot;uvicorn-구현체와-테스트-구동을-통한-확인&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#uvicorn-%EA%B5%AC%ED%98%84%EC%B2%B4%EC%99%80-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EA%B5%AC%EB%8F%99%EC%9D%84-%ED%86%B5%ED%95%9C-%ED%99%95%EC%9D%B8&quot; aria-label=&quot;uvicorn 구현체와 테스트 구동을 통한 확인 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;uvicorn&lt;/code&gt; 구현체와 테스트 구동을 통한 확인&lt;/h3&gt;
&lt;p&gt;우선 기념비적인 전체 테스트를 돌려봅시다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/b618d2a637db3add4918df48df012052/3b578/001.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 84.16666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABYlAAAWJQFJUiTwAAAD40lEQVQ4y02US6/aRhiG/VvaBgMGg/Hd4/v9hg02cJKT9OQsEmUXVlm3bBq6alctmy76K9vI1ryVTVRl8WhmNJpH73xzYdIs32oPp9+l7e6zWbZXP2+vycjhmpWna1Ycr1lxuqbl8ZoWx6sf769pfhzno3h3DaPdtSyrz2nZ/OYElcdoJPzbzRq4yR5OtIM3EO7gRw1cv4Yf7WF7W1h2CdMuQZwSllfdcbcwnRK2V8INKrhh/SujGeEfSX5E1fz4jx8UXRjXne3m3XJJugWnd9zyzmKhdxynd4ul0c3majedKd10pnaLpdYtlvK/khwijg4/MUFY3tLtaxTNhy4unmhcPsMJ9uDmKhyzgOtUsJwSmp1AElxohgtZIeDXKiasjDmn0gkr9oLgIArKCxOE2S3Odih3r7ska2g0bN3bguN0eGYBTY+wkVyIsofN2oYku1itCWacAnaqYDbX6AtW7gXBgOPEF8Z08pufNKMwSlsaJi0cf4vZTAVRIkTRDuFQH68CUVMYWgRFDTCbq2CnQ0KNfv9C6olioEqiC2NY6S3JD2hPT50X7uhwIEPCYYGuhHD9BrqeQtMirAQLC17HhJUwncqYzpRR+N0PUu8QG4equDDEzm5B3KA9PndZcaJR2sJ2S3ALHYrqQ1QCCKI3ynieYLkio5Bl5THhbK6OCXWZoEiSuzBMBuFTl34VmnaBjegijhuYVgbFCSBrFjaiCUk2IcoW+LWBOadjsSR0MlV6XXWQJdk3CR+eu7x6oEnejvVaCy68sIAXJRAMExvZxHpDsJHuLcfrmHEqFjyh7EzvPdNDsx2FyS1NH9HuPnRN9Y4W+VsQu8BKcBH5R+yqR+TxS3j2ETY5wBkw73j2CRapKb+xemL4CPz4wthecUuKR5S7d12SP9G8fo8oPSCIW8TJCWH0gCh5hSR9QByfEMUnhPHxKyf4UUvdoO6doIZhpZfh6d2CrEHVPnXDZFK8RGDECEQbvmRDk3zoUgBjbULkh5rpWPDGt9AlT3rLLWA5+YXR1ODmBlvUh9ddmp9omOwp0SNqaQE19ZBqekglyaHrtUlXa4tyC51OWImyU/l/JqzUWU4By80vTJIf/wzTFsX+1Zf94W0fJm2f5se+3j/2ZfWyb9o3fb177Ivy1Gt62PMr0k9YqWencs+ydyas9MV2clhu8TNj+9u/hh8mrx9QN28QD9fGykDMBAaJYdn3viR7kBUfguhgyRvjfRzhCfgVQRDWsJzsF0bYaI6sWJ9k1f6oG95ZlMh5xonnlaCdBdE484J25tfqeSMa43hAUsyzpFgjgmydZdX66Afxp5Wgyv8BpgcrPZHjbAcAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/b618d2a637db3add4918df48df012052/8ac56/001.webp 240w,
/static/b618d2a637db3add4918df48df012052/d3be9/001.webp 480w,
/static/b618d2a637db3add4918df48df012052/e46b2/001.webp 960w,
/static/b618d2a637db3add4918df48df012052/f992d/001.webp 1440w,
/static/b618d2a637db3add4918df48df012052/882b9/001.webp 1920w,
/static/b618d2a637db3add4918df48df012052/7f1f0/001.webp 3632w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/b618d2a637db3add4918df48df012052/8ff5a/001.png 240w,
/static/b618d2a637db3add4918df48df012052/e85cb/001.png 480w,
/static/b618d2a637db3add4918df48df012052/d9199/001.png 960w,
/static/b618d2a637db3add4918df48df012052/07a9c/001.png 1440w,
/static/b618d2a637db3add4918df48df012052/29114/001.png 1920w,
/static/b618d2a637db3add4918df48df012052/3b578/001.png 3632w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/b618d2a637db3add4918df48df012052/d9199/001.png&quot;
            alt=&quot;M칩 맥 이슈를 제외하고선 모든 테스트가 성공적으로 도는군요&quot;
            title=&quot;M칩 맥 이슈를 제외하고선 모든 테스트가 성공적으로 도는군요&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;M칩 맥 이슈를 제외하고선 모든 테스트가 성공적으로 도는군요&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;그렇다면, &lt;code class=&quot;language-text&quot;&gt;protocols&lt;/code&gt; 디렉터리 내의 HTTP 프로토콜 테스트를 돌려봅시다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/3d111ef7c17314e6139fc4b10b4bd788/97bfd/002.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 168.75%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAiCAYAAABfqvm9AAAACXBIWXMAABYlAAAWJQFJUiTwAAAD5ElEQVRIx5VW2ZLiRhDkkxxzscAOEpKQROvq1gXiGi7b4whHeMcTfnE4vA/+8HRUSc0AK1j7IaMlIWVnVWVV0zEtBdef4bHr4e7BRvfTGA+PNu4fLDw+2XjqOoy7ews/3BnofRboD0P0ngWe+n6NnsfPh6ZEx7AlXDHF/dMYvZ4Py5IYDAT6/QmehxEGgwBDI8Kn7hh3dyN0BwI9IhyG6A8jxsCImk0CdAwrhO2FcOwUfrCG51UQfgVjpCBcBRnOEIklfPkrAvWKIJAY2QFjaNZ4NkQNM0THmcwQlgcIuYPIf0RS/oww3WNgTzEOKvjxCl60hZX8Ake+IlJ7uOGG4QhatwjkAaH6CSJeoUMP4s07Vq9fsXv9B8vD3yjXf0Jk75ik7/DT3zFJ3yDUF0zUF3jqje8JvnpDPP0D891fWOy/Yrr6DR1jFGEcKkyyAlItMfZTmHYM04owsiOYR8QNTp7RO04Mx5U1PIXOcBTB8VJMyhIqWyMrN4jkAoYVYzgiAomR0w76zXYVPFHAEzmDCUd2AlfliPI5pFpB5Wt+KYgrWGMFeqdGfIRpJwwiJtKxn8GbNISGGcOTOYK8OqqktZhuIaIZBFU6mfMGdB/GFWw3PRIaVlIrPRKOYrgyR1TUCvPpFmm+RqwWmM0PSNIVE03CKYOuTwlppUi+IQyLCjKtCSnsvFFKH/N71nnIH7lsCMUJIYUcUsjpGmnxwoWZLQ6siIiuFeaqQq9RSIQccvHCaulF/dEt3CQsZlsmTdSSQ07zFw5bK9Kb6GuyTzthXtVFKTesMJYLJiPEaokkXUJmta3oniKg67GXwRrL8xzqopAqIguTOe9Kpj+t6CmIhHAj5DmHTD4smkrTmhUv7DMi1uStOWxTSCGnJ5ahVW9Aa1nt4YmSzfz9Kjc5pJA1IV0TGeWM0kB5DKJZK6HbSpiuWAkVgkKW2ZpV0cva3NqXl53i3lJIZKSQw55uufkvu+NcoTwndE98SGRaIZFPqz0cLztT1NYp7rXhoPuYqks5o9x9j9C+2ct5TUS5pGI8mx+5ayO9nkPdy41VKFwij2Q9C6lLaPBeC7m1l2Vaz8GssYtWSqjnoPr/Idd2WTG0H2kTspQflP9N4WWnkDoiLGa7eiA0RwMV6HI+ftgma8lh0246fzT+VWNueqaHQZuxvw25KQofUuzFOnRay2rHObxu7Gu93BDqk49ApFTpvNnosjBXja1bjwvShJoVG7aK9qH24vFcPhlfR0KTFKqCO0WPfLZLsUFebnlytw3Yo0JH/4PI0fls0N+xEHao4CcFgqhiE9NpR9ObyOij00lzCRZl14f9vzTAB8/7HSsBAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/3d111ef7c17314e6139fc4b10b4bd788/8ac56/002.webp 240w,
/static/3d111ef7c17314e6139fc4b10b4bd788/d3be9/002.webp 480w,
/static/3d111ef7c17314e6139fc4b10b4bd788/e46b2/002.webp 960w,
/static/3d111ef7c17314e6139fc4b10b4bd788/cff29/002.webp 1078w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/3d111ef7c17314e6139fc4b10b4bd788/8ff5a/002.png 240w,
/static/3d111ef7c17314e6139fc4b10b4bd788/e85cb/002.png 480w,
/static/3d111ef7c17314e6139fc4b10b4bd788/d9199/002.png 960w,
/static/3d111ef7c17314e6139fc4b10b4bd788/97bfd/002.png 1078w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/3d111ef7c17314e6139fc4b10b4bd788/d9199/002.png&quot;
            alt=&quot;여전히 많군요. 그렇다면 범위를 좁혀야겠죠&quot;
            title=&quot;여전히 많군요. 그렇다면 범위를 좁혀야겠죠&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;여전히 많군요. 그렇다면 범위를 좁혀야겠죠&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;HTTP의 다양한 케이스에 대해 정리한 것을 볼 수 있습니다. 그러면 우리는 가장 쉬운 “일단 되기” 부터 만들기 위해 테스트 케이스를 분석해보죠.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_get_request&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;http_protocol_cls&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; HTTPProtocol&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    app &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Response&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Hello, world&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; media_type&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;text/plain&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    protocol &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; get_connected_protocol&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;app&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; http_protocol_cls&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    protocol&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;data_received&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;SIMPLE_GET_REQUEST&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; protocol&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;loop&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;run_one&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;b&quot;HTTP/1.1 200 OK&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; protocol&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;transport&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;buffer&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;b&quot;Hello, world&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; protocol&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;transport&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;buffer&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;app은 ASGI의 애플리케이션 서버의 예시를 말합니다. 실제로도 코드에 그렇게 정의되어 있어요&lt;sup id=&quot;fnref-2&quot;&gt;&lt;a href=&quot;#fn-2&quot; class=&quot;footnote-ref&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;. 우리가 관심있는 &lt;code class=&quot;language-text&quot;&gt;get_connected_protocol&lt;/code&gt; 은 바로 윗줄에 있습니다&lt;sup id=&quot;fnref-3&quot;&gt;&lt;a href=&quot;#fn-3&quot; class=&quot;footnote-ref&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;p&gt;이 코드를 보면 loop, transport, config, lifespan, 기타 등등이 있지만 우리의 주요 관심사인 &lt;code class=&quot;language-text&quot;&gt;protocol&lt;/code&gt; 부터 봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get_connected_protocol&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    app&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ASGIApplication&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    http_protocol_cls&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; HTTPProtocol&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 이건 무슨타입일까요.&lt;/span&gt;
    lifespan&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; LifespanOff &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; LifespanOn &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;kwargs&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Any&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;HTTPProtocol&lt;/code&gt; 타입에 대해 봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; TYPE_CHECKING&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# (생략)&lt;/span&gt;
    HTTPProtocol&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; TypeAlias &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;type[HttpToolsProtocol | H11Protocol]&quot;&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# 이 코드에 집중합시다!&lt;/span&gt;
    WSProtocol&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; TypeAlias &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;type[WebSocketProtocol | _WSProtocol]&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;H11Protocol과 HttpToolsProtocol 둘 중 하나가 될 수 있는 모양이군요. &lt;code class=&quot;language-text&quot;&gt;conftest.py&lt;/code&gt; 를 봤더니 둘 다 쓰고있도록 하고있구요&lt;sup id=&quot;fnref-4&quot;&gt;&lt;a href=&quot;#fn-4&quot; class=&quot;footnote-ref&quot;&gt;4&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fixture&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    params&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
        pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;param&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&quot;uvicorn.protocols.http.httptools_impl:HttpToolsProtocol&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            marks&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mark&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;skipif&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;not&lt;/span&gt; importlib&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;util&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;find_spec&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;httptools&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                reason&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;httptools not installed.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token builtin&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;httptools&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;param&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;uvicorn.protocols.http.h11_impl:H11Protocol&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;h11&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;http_protocol_cls&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;request&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;FixtureRequest&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; import_from_string&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;request&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;param&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 이건 아래 4번 각주를 참고해주세요.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이런 식으로 픽스처 처리를 하면 parametrized 처리도 할 수 있나봅니다. 하나 배웠네요!&lt;/p&gt;
&lt;p&gt;…아무튼 본론으로 다시 돌아가서,&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;HttpToolsProtocol&lt;/code&gt;과 &lt;code class=&quot;language-text&quot;&gt;H11Protocol&lt;/code&gt; 구현체를 봅시다. 각각 아래와 같이 되어있습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# uvicorn/protocols/http/h11_impl.py&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;H11Protocol&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Protocol&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        config&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Config&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        server_state&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ServerState&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        app_state&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Any&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        _loop&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractEventLoop &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# uvicorn/protocols/http/httptools_impl.py&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;HttpToolsProtocol&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Protocol&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        config&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Config&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        server_state&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ServerState&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        app_state&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Any&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        _loop&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractEventLoop &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;공통적으로 &lt;code class=&quot;language-text&quot;&gt;asyncio.Protocol&lt;/code&gt; 을 상속하고 있네요. 그렇다면 &lt;code class=&quot;language-text&quot;&gt;asyncio.Protocol&lt;/code&gt; 은 무엇인지 볼까요?&lt;/p&gt;
&lt;h3 id=&quot;asyncioprotocol-살펴보기-1---큰-개념&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#asyncioprotocol-%EC%82%B4%ED%8E%B4%EB%B3%B4%EA%B8%B0-1---%ED%81%B0-%EA%B0%9C%EB%85%90&quot; aria-label=&quot;asyncioprotocol 살펴보기 1   큰 개념 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;asyncio.Protocol&lt;/code&gt; 살펴보기 (1) - 큰 개념&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;asyncio.Protocol&lt;/code&gt; 구현체를 이해하기 위해선 이 글&lt;sup id=&quot;fnref-5&quot;&gt;&lt;a href=&quot;#fn-5&quot; class=&quot;footnote-ref&quot;&gt;5&lt;/a&gt;&lt;/sup&gt; 에 대한 이해가 선행되어야 합니다. 하지만 하고자하는 목적에서 많이 벗어나지 않게, 우리가 필요한 최소한의 것만을 요약해보았습니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;큰 그림에서…
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Transport&lt;/code&gt;와 &lt;code class=&quot;language-text&quot;&gt;Protocol&lt;/code&gt;은 loop.create_connection()과 같은 저수준 이벤트 루프 API에서 사용&lt;/li&gt;
&lt;li&gt;콜백 기반 프로그래밍 스타일을 사용&lt;/li&gt;
&lt;li&gt;네트워크나 IPC 프로토콜(예: HTTP)의 고성능 구현을 위한 규약&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Transport&lt;/code&gt;와 &lt;code class=&quot;language-text&quot;&gt;Protocol&lt;/code&gt;의 책임 분리
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Transport&lt;/code&gt;: “어떻게” 전송할지 (바이트 전송 메커니즘)&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Protocol&lt;/code&gt;: “무엇을” 전송할지 (바이트 내용과 타이밍)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;추상화 수준
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Transport&lt;/code&gt;: 소켓 수준의 추상화&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Protocol&lt;/code&gt;: 애플리케이션 수준의 추상화&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;1:1 관계
&lt;ul&gt;
&lt;li&gt;하나의 &lt;code class=&quot;language-text&quot;&gt;Transport&lt;/code&gt;는 하나의 &lt;code class=&quot;language-text&quot;&gt;Protocol&lt;/code&gt;과 연결&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;서로 호출하는 관계:
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Protocol&lt;/code&gt; → &lt;code class=&quot;language-text&quot;&gt;Transport&lt;/code&gt;: 데이터 전송 요청&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Transport&lt;/code&gt; → &lt;code class=&quot;language-text&quot;&gt;Protocol&lt;/code&gt;: 수신된 데이터 전달&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;이벤트 루프와의 관계
&lt;ul&gt;
&lt;li&gt;protocol_factory를 통해 프로토콜 객체 생성&lt;/li&gt;
&lt;li&gt;(transport, protocol) 쌍으로 작동&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이를 그림으로 그려보면 이렇습니다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;[클라이언트] HTTP 요청
       ↓
[OS 소켓/TCP]
       ↓
[이벤트 루프] (create_server로 생성된)
       ↓
[Transport] (TCP/소켓 추상화)
    │  ↑ (1:1 관계)
    ↓  │
[Protocol] (HTTP 파싱/처리)
       ↓
[ASGI 애플리케이션]&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;asyncioprotocol-살펴보기-2---http-파서-구현하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#asyncioprotocol-%EC%82%B4%ED%8E%B4%EB%B3%B4%EA%B8%B0-2---http-%ED%8C%8C%EC%84%9C-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0&quot; aria-label=&quot;asyncioprotocol 살펴보기 2   http 파서 구현하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;asyncio.Protocol&lt;/code&gt; 살펴보기 (2) - HTTP 파서 구현하기&lt;/h3&gt;
&lt;p&gt;HTTP 파서를 구현하기 위해 &lt;code class=&quot;language-text&quot;&gt;asyncio.Protocol&lt;/code&gt; 에서 구현(&lt;em&gt;implement&lt;/em&gt;)해야하는&lt;sup id=&quot;fnref-6&quot;&gt;&lt;a href=&quot;#fn-6&quot; class=&quot;footnote-ref&quot;&gt;6&lt;/a&gt;&lt;/sup&gt; 메소드를 살펴봅시다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code class=&quot;language-text&quot;&gt;connection_made(transport)&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;연결이 성립되었을 때 호출됨&lt;/li&gt;
&lt;li&gt;transport 인자로 Transport 객체를 받음&lt;/li&gt;
&lt;li&gt;일반적으로 이 transport 객체를 저장해두고 나중에 데이터 전송에 사용&lt;/li&gt;
&lt;li&gt;(&lt;strong&gt;중요&lt;/strong&gt;) 이 코드의 존재로 인해 &lt;code class=&quot;language-text&quot;&gt;Transport&lt;/code&gt; 객체는 자동으로 주입되고, 소켓 추상화는 처리하지 않아도 됩니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;connection_made&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; transport&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;transport &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; transport&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code class=&quot;language-text&quot;&gt;data_received(data)&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;데이터가 수신될 때마다 호출됨&lt;/li&gt;
&lt;li&gt;data는 bytes 타입&lt;/li&gt;
&lt;li&gt;부분적으로 데이터가 올 수 있으므로 버퍼링이 필요할 수 있음&lt;/li&gt;
&lt;li&gt;(&lt;strong&gt;중요&lt;/strong&gt;) 여기서 이벤트를 수신하고 HTTP 메시지를 파싱합니다!&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;data_received&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_buffer &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; data
    &lt;span class=&quot;token comment&quot;&gt;# 데이터 처리 로직&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;&lt;code class=&quot;language-text&quot;&gt;connection_lost(exc)&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;연결이 종료되었을 때 호출됨&lt;/li&gt;
&lt;li&gt;exc가 None이면 정상 종료, Exception이면 에러로 인한 종료&lt;/li&gt;
&lt;li&gt;(&lt;strong&gt;중요&lt;/strong&gt;) 여기서 연결 종료 시의 예외처리를 수행합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;connection_lost&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; exc&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; exc&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;에러로 인한 연결 종료: &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;exc&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;정상적인 연결 종료&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;my-first-protocol-implementation&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#my-first-protocol-implementation&quot; aria-label=&quot;my first protocol implementation permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;my first protocol implementation!&lt;/h2&gt;
&lt;p&gt;좋습니다. 방법을 알았으니 일단 짜보고 테스트를 구동해봅시다!&lt;/p&gt;
&lt;p&gt;먼저 기본적인 규약을 흉내내봅시다.&lt;/p&gt;
&lt;h3 id=&quot;객체-초기화-따라하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B0%9D%EC%B2%B4-%EC%B4%88%EA%B8%B0%ED%99%94-%EB%94%B0%EB%9D%BC%ED%95%98%EA%B8%B0&quot; aria-label=&quot;객체 초기화 따라하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;객체 초기화 따라하기&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; asyncio
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; typing &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Callable


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyAsgiProtocol&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Protocol&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; app&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Callable&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;app &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; app
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;transport &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_buffer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;b&apos;&apos;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;객체 생성 시의 내용은 이대로 베낍시다. 후에 설명하겠습니다.&lt;/p&gt;
&lt;h3 id=&quot;http-파서-구현하기-1---기본적인-것만&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#http-%ED%8C%8C%EC%84%9C-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0-1---%EA%B8%B0%EB%B3%B8%EC%A0%81%EC%9D%B8-%EA%B2%83%EB%A7%8C&quot; aria-label=&quot;http 파서 구현하기 1   기본적인 것만 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;HTTP 파서 구현하기 (1) - 기본적인 것만&lt;/h3&gt;
&lt;p&gt;이어서 필수로 구현해야하는 메소드를 만들어봅시다. 간단한 것 부터 설명하겠습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;connection_made&lt;/code&gt;는 transport를 단순히 받기만 하면 됩니다. 이미 약속된 패턴입니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;connection_lost&lt;/code&gt;는 연결 단절 시 예외처리 구문을 추가하는 로직입니다. 간단히 만들어둡시다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;data_received&lt;/code&gt; 는 TCP 데이터가 넘어오고난 후의 로직입니다. &lt;code class=&quot;language-text&quot;&gt;data&lt;/code&gt; 를 버퍼에 그대로 담고, HTTP 로직인지 확인한 후 이벤트 루프에 태스크를 하나 생성합니다&lt;sup id=&quot;fnref-7&quot;&gt;&lt;a href=&quot;#fn-7&quot; class=&quot;footnote-ref&quot;&gt;7&lt;/a&gt;&lt;/sup&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;connection_made&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; transport&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;transport &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; transport

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;data_received&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;bytes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_buffer &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; data

    &lt;span class=&quot;token comment&quot;&gt;# 올바른 HTTP 요청 헤더인지 확인&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;b&quot;\r\n\r\n&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_buffer&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;create_task&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle_request&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 후술합니다&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;connection_lost&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; exc&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; exc&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;Connection lost: &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;exc&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;Connection closed&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;http-파서-구현하기-2---handle_request-구현&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#http-%ED%8C%8C%EC%84%9C-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0-2---handle_request-%EA%B5%AC%ED%98%84&quot; aria-label=&quot;http 파서 구현하기 2   handle_request 구현 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;HTTP 파서 구현하기 (2) - &lt;code class=&quot;language-text&quot;&gt;handle_request()&lt;/code&gt; 구현&lt;/h3&gt;
&lt;p&gt;다음과정입니다. HTTP 요청 파싱을 위한 별도 태스크를 구현한 로직입니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;handle_request&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    request_data &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_buffer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;decode&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# HTTP 요청 자체를 헤더, 바디로 파싱&lt;/span&gt;
    headers&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; _&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; body &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; request_data&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;partition&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\r\n\r\n&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# HTTP 요청 첫 줄 파싱 (예: &quot;GET / HTTP/1.1&quot;)&lt;/span&gt;
    request_line&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;_ &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; headers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;split&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\r\n&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# HTTP method와 경로를 파싱&lt;/span&gt;
    method&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; path&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; _ &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; request_line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;split&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    scope &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;http&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;method&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; method&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;path&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; path&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;headers&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 헤더를 추가할 수 있음&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;receive&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot; 애플리케이션이 클라이언트로부터 메시지를 받게 해줌

        :return:
        &quot;&quot;&quot;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;http.request&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;body&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; body&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;encode&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;more_body&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;message&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot; 애플리케이션이 이벤트 메시지를 클라이언트에 전송해줌

        :param message:
        :return:
        &quot;&quot;&quot;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; message&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;http.response.start&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            response_headers &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;b&quot;HTTP/1.1 200 OK\r\nContent-Type: text/plain\r\n\r\n&quot;&lt;/span&gt;
            self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;transport&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;write&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;response_headers&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;elif&lt;/span&gt; message&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;http.response.body&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;transport&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;write&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;message&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;body&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;transport&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;close&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 응답 완료 후 연결 종료&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;app&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;scope&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; receive&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; send&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;테스트합시다-1---get-요청-테스트&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%A9%EC%8B%9C%EB%8B%A4-1---get-%EC%9A%94%EC%B2%AD-%ED%85%8C%EC%8A%A4%ED%8A%B8&quot; aria-label=&quot;테스트합시다 1   get 요청 테스트 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;테스트합시다 (1) - GET 요청 테스트&lt;/h3&gt;
&lt;p&gt;그렇다면 제대로 도는지 테스트해볼까요. 필요한 최소한의 내용을 구성합시다.&lt;/p&gt;
&lt;p&gt;테스트를 위한 픽스처를 구성하고…&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fixture&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;server&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;서버 fixture: 테스트용 서버를 시작하고 정리&quot;&quot;&quot;&lt;/span&gt;
    loop &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_event_loop&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    server &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; loop&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;create_server&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;lambda&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; MyAsgiProtocol&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;app&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;127.0.0.1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token number&quot;&gt;8000&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sleep&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;    &lt;span class=&quot;token comment&quot;&gt;# 서버 인스턴스 생성을 위해 일시대기&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt; server
    &lt;span class=&quot;token keyword&quot;&gt;finally&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        server&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;close&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; server&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;wait_closed&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fixture&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;클라이언트 fixture: aiohttp 클라이언트 세션 생성 및 정리&quot;&quot;&quot;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; aiohttp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ClientSession&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt; session&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;테스트를 구동해봅시다!&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mark&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;asyncio&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_get_request_returns_hello_world&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;server&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; client&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;기본 HTTP GET 요청 테스트&quot;&quot;&quot;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;http://127.0.0.1:8000&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;status &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;200&lt;/span&gt;
        text &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;text&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; text &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Hello, World!&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;$ pytest &lt;span class=&quot;token parameter variable&quot;&gt;-v&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;test&lt;/span&gt; session starts &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;
platform darwin -- Python &lt;span class=&quot;token number&quot;&gt;3.12&lt;/span&gt;.6, pytest-8.3.4, pluggy-1.5.0 -- /Users/seongeun.yu/Library/Caches/pypoetry/virtualenvs/asgi-explained-S4wxQJIT-py3.12/bin/python
cachedir: .pytest_cache
rootdir: /Users/seongeun.yu/workspace/asgi_explained
configfile: pyproject.toml
plugins: cov-6.0.0, asyncio-0.25.3
asyncio: &lt;span class=&quot;token assign-left variable&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;Mode.AUTO, &lt;span class=&quot;token assign-left variable&quot;&gt;asyncio_default_fixture_loop_scope&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;function
collected &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; item                                                                                                                                     

tests/test_server.py::test_get_request_returns_hello_world PASSED                                                                              &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; passed &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.16s &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;패스합니다! 그럼 내부적으로 어떻게 돌았던 건지 디버깅한 결과를 보여드릴게요:&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/1da30cef55541e04b46e8a5af3926f54/0f586/003.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 123.75%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAYAAAAxFw7TAAAACXBIWXMAABYlAAAWJQFJUiTwAAADRUlEQVQ4y42V2W/cNhDG/f+/tehjg6I2ciFFj5ceQFGgDwX60gaOvbYT7xGvrNWx2tWKOimS+hWkLNmLep0QGJCUOB+/Gc5xpNqOquwQQlJVHW3bAR1dZ2coS43IpJOiUBhD/9901HWvJ0Tr1lbnKM/B9zUXFxGrlaYo2BvesuD09Jbzs4DZLKNte0CtIQoNk/OQi4uYKDLusiPLyDKTDW6uK4XWVrSTqjJIifvfNGB0z9zcMXTfa+4Z2tvs0EqTZSmrlc9qtXIShiFBsCLPc7QyI+vBHf3a7O2P7MbuZdMSxzFBYEECJ1EU4fu3RGFAVZZ0nR6VBz3L1IpdjwztxjIwRmNMP2ttb1ZEt98zefsVi/fP8GbfolWyx3IAHL4dDYvBN/vDkG9/I1y+JL59zdp/g1abzwfszehGcyygv3jBh7Mvmbz9An/+NUYng/d6vRGwe5zhCHjHsKlmVPmEIjvHtFO0Kp07bAT05+3Lm1HvACB7wa20DfCWbVowny+YTqd4ns9ul6EevL575UMM7/1ks0eS7VKEyFwIlWXBcv4zl++e8+7fEz5e/4g3/4l0/ecTJnf3jm+lpK7rPSaq/IPEf8Vyeszi/TcuAurs18cBR+AxeKGqG0ReEIYxSZKQJGvSdIOUFUa3Y5AfYNj7Rckl2foXFtc/cOZMe00S/oUQOUIIN2eZoGnkePGTgE15hTd9xs31sRN/cUxT/L1nuvVvY5P8UGA/ZvKgWJYlURSzXq/vzE4oigIp5dOAYxbonCz5nenlG07/OWbx4SXp5pI8r8lz4V7cvvwnGQ6AWqVE3iu82Qne7DnBzQltM9sz2bL7JMP9XDVsNglxHFEUuXPDwxS1ep+Zy0OuKoTYMZ9PXb0cMuhgceieqDadKYm87wiXr/DmL7idn9DWN2PMHag2d/naKnfImmidvdvtKEuBakOqYkmRf0S3AcZU99E+mG8eVGytO5SCXDSUhUQ2yuWqBbQhYZtSXffSV+j7wmE7Zit7fSuOoe1ytttdXcUEofl/1/Nyzs58JpOA+WyHetD14si4bnl5GRPHd12vaTqyrCNNW7Kdoam7PccLodlsJNutZJcq+jLY+y0XVk+x3bZubU3/D5hQkH0i1+cBAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/1da30cef55541e04b46e8a5af3926f54/8ac56/003.webp 240w,
/static/1da30cef55541e04b46e8a5af3926f54/d3be9/003.webp 480w,
/static/1da30cef55541e04b46e8a5af3926f54/e46b2/003.webp 960w,
/static/1da30cef55541e04b46e8a5af3926f54/f992d/003.webp 1440w,
/static/1da30cef55541e04b46e8a5af3926f54/72539/003.webp 1498w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/1da30cef55541e04b46e8a5af3926f54/8ff5a/003.png 240w,
/static/1da30cef55541e04b46e8a5af3926f54/e85cb/003.png 480w,
/static/1da30cef55541e04b46e8a5af3926f54/d9199/003.png 960w,
/static/1da30cef55541e04b46e8a5af3926f54/07a9c/003.png 1440w,
/static/1da30cef55541e04b46e8a5af3926f54/0f586/003.png 1498w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/1da30cef55541e04b46e8a5af3926f54/d9199/003.png&quot;
            alt=&quot;GET만 있는 경우 이렇게 호출됩니다&quot;
            title=&quot;GET만 있는 경우 이렇게 호출됩니다&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;GET만 있는 경우 이렇게 호출됩니다&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;즉, 아래와 같이 동작함을 볼 수 있습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;TCP, HTTP까진 알아서 오고&lt;/li&gt;
&lt;li&gt;HTTP 요청인지 확인 후 HTTP 파싱을 요청 (비동기 태스크 시작)&lt;/li&gt;
&lt;li&gt;GET 요청은 body가 없으므로 &lt;code class=&quot;language-text&quot;&gt;receive()&lt;/code&gt; 처리를 안함&lt;/li&gt;
&lt;li&gt;응답헤더, 바디 각각 완성될 때마다 도착&lt;/li&gt;
&lt;li&gt;완성되면 응답 완료 후 연결 종료&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;테스트합시다-2---post-요청-테스트&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%A9%EC%8B%9C%EB%8B%A4-2---post-%EC%9A%94%EC%B2%AD-%ED%85%8C%EC%8A%A4%ED%8A%B8&quot; aria-label=&quot;테스트합시다 2   post 요청 테스트 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;테스트합시다 (2) - POST 요청 테스트&lt;/h3&gt;
&lt;p&gt;이어서, POST 에 대한 케이스도 추가해볼까요. POST 처리를 위해 애플리케이션도 약간 수정해봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;scope&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; receive&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; send&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot; ASGI 프로토콜 서버에서 데이터를 받고, 이를 가공

    :param scope:
    :param receive:
    :param send:
    :return:
    &quot;&quot;&quot;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; scope&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;method&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;POST&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        request &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; receive&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        body &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; request&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;body&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;b&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 요청 데이터 가져오기&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        body &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;b&quot;Hello, World!&quot;&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# GET 요청에서는 바디가 필요 없음&lt;/span&gt;
    
    &lt;span class=&quot;token comment&quot;&gt;# 생략&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mark&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;asyncio&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_post_request_returns_hello_world&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;server&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; client&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;기본 HTTP POST 요청 테스트&quot;&quot;&quot;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;post&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;http://127.0.0.1:8000&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Hello, ASGI!&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;status &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;200&lt;/span&gt;
        text &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;text&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; text &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Hello, ASGI!&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;둘 다 돌리면…&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;$ pytest &lt;span class=&quot;token parameter variable&quot;&gt;-v&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;test&lt;/span&gt; session starts &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;
platform darwin -- Python &lt;span class=&quot;token number&quot;&gt;3.12&lt;/span&gt;.6, pytest-8.3.4, pluggy-1.5.0 -- /Users/seongeun.yu/Library/Caches/pypoetry/virtualenvs/asgi-explained-S4wxQJIT-py3.12/bin/python
cachedir: .pytest_cache
rootdir: /Users/seongeun.yu/workspace/asgi_explained
configfile: pyproject.toml
plugins: cov-6.0.0, asyncio-0.25.3
asyncio: &lt;span class=&quot;token assign-left variable&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;Mode.AUTO, &lt;span class=&quot;token assign-left variable&quot;&gt;asyncio_default_fixture_loop_scope&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;function
collected &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; items                                                                                                                                    

tests/test_server.py::test_get_request_returns_hello_world PASSED                                                                              &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt;%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
tests/test_server.py::test_post_request_returns_hello_world PASSED                                                                             &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; passed &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.27s &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;다행입니다, 잘 되네요.&lt;/p&gt;
&lt;h2 id=&quot;my-first-protocol-flow-charts&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#my-first-protocol-flow-charts&quot; aria-label=&quot;my first protocol flow charts permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;my first protocol flow charts&lt;/h2&gt;
&lt;p&gt;그렇다면 GET, POST 요청 각각에 대한 플로우차트를 읽어봅시다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/488fe61d2aa2d00d12bc91028c27b499/2a333/004.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 184.58333333333331%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAlCAYAAABCr8kFAAAACXBIWXMAABYlAAAWJQFJUiTwAAAEVElEQVRIx5VWW4+jNhjd//9UbXe7rboP3bYrte99aUdVpX2r1Gq3Mx2N5paQEEgCAQwYsLHNqT4bCJlJprOWLBuwj7/bOeZFWQJRJLFaFUhTAyk6AK4LYeAvc3heiuUyB8sUXKNvwGYj4HmJHevKvX/BGBCGEguvRJIAqsXYaL5ccNzfZ5jNcuxiia5zG+saCFbSflsua5BhFtCYDsbALswyhjjeIUkS7HY7pEmKLMuh2g7T1nW0p7N7OuP68PzCuUenpYjjDGVZoiiGXoCxDGXBkbMcYRja99QcQAetzDin0QISctPo0QJjaJE+sEppQIgWSqnRSrtWd/u5A3QfRSMhpQDLGNbrNTabCCzbImcz7KIbyCaE0dkI9r+ArdTQWlvrOgoKWSU8XJ+/xOXHV7g+/xLb1S/PBDQUi24SdAeo2wBx8BPWi58Rej+Csw8uEZ8D6BY7wFbM4V2/wfL2LWZXr8HT33DYOmhtesDuKcDhRAGtEhiVoTMZRJMgz3OkaYa6bvr16GvTlc9RwOno3AJYzuH7ARaLBebzGXx/gSjaoCyK3joFo83TFg6ukFtULlo7GslmgdXsLa4v3uDqn9e4+fcb+Hdfoy4vTgPugR2ThmTRK93GaIoPiMIzbFa/IgrOwLPfoaS/B6RsnWptq5GmKYIgsD0M1wjXEdI0B+fNhBCYFnZrLaiqCnEcI4oi1HVt3xEg1eiUy85yA16WdnyU5ZyVaJoadVVbPlMnwKZpLIuEkNbKLMtsphlj4Ly0Bpg+JgeAmHhM1mitiOXuWRnkeWFBHGhqR3ouinyfxCkgywpbWyRhYRAiCEI7JwsrXkOKFm2rHsW3qUVf3I41I6AUqlcZ02d4X4uc11ivN4iiGErpXgd7ySLqmSPi0DQSbeviRLpHipPnDEI0Nk5TunWYFn13xOVebUgDKX5KtaCkitrH4vZ73F6+w/LuB6TRHxO6fYba9GcDeobQe4/l3Xt4N98hi88AVH2BP1ttXAlw9ifC+5eYXX2Fq09f4O7yFbbLb7EL3pFS7u+W58iXk64AnP0Fwc9Rsr8hq3O09QWK7CO0kqPCuAvuScBDpbGl0RCDFDabFN4ixGw2sxSkAm+lGq/WJy10paPtwqriYCxFkTMkyc5Sk6qBAOm63XP5CcDpnJfcUpEqYLiz6Zm+n6TeafmC3URsIKvm8zl837e1SkAD8CNApQwOCD2xkABpY5ql7o8i3XOZLD7q8nCv06lt29o+uMJ5ZYGoU/yGTspz3MLOyRfRjE4ldyiLjOWQUlqlGfj6sJ2M4UC9h40Oo6SQRWE4KLY7kESY/n+OyhepzZC1QbEHUah4ZcWWsmzDIdsxLGXJj1jYu0ybKF7kItUYzW384gSiEeNGdPv8SalG+h0AdifuKBJYco/YUdg7+OHPQHdQu3tAs88yJYL6cDHRPUNlMqXmMbWhcQSkWJAOktsUv+12C865BeWTOD38s3gI+B//Dj7jvotv5AAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/488fe61d2aa2d00d12bc91028c27b499/8ac56/004.webp 240w,
/static/488fe61d2aa2d00d12bc91028c27b499/d3be9/004.webp 480w,
/static/488fe61d2aa2d00d12bc91028c27b499/e46b2/004.webp 960w,
/static/488fe61d2aa2d00d12bc91028c27b499/f992d/004.webp 1440w,
/static/488fe61d2aa2d00d12bc91028c27b499/17fe2/004.webp 1484w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/488fe61d2aa2d00d12bc91028c27b499/8ff5a/004.png 240w,
/static/488fe61d2aa2d00d12bc91028c27b499/e85cb/004.png 480w,
/static/488fe61d2aa2d00d12bc91028c27b499/d9199/004.png 960w,
/static/488fe61d2aa2d00d12bc91028c27b499/07a9c/004.png 1440w,
/static/488fe61d2aa2d00d12bc91028c27b499/2a333/004.png 1484w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/488fe61d2aa2d00d12bc91028c27b499/d9199/004.png&quot;
            alt=&quot;GET, POST 둘 다 처리하는 경우의 플로우차트로 다시 살펴봅시다&quot;
            title=&quot;GET, POST 둘 다 처리하는 경우의 플로우차트로 다시 살펴봅시다&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;GET, POST 둘 다 처리하는 경우의 플로우차트로 다시 살펴봅시다&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;내부적으로 어떻게 돌았던 건지 다시 살펴봅시다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;TCP, HTTP까진 알아서 오고&lt;/li&gt;
&lt;li&gt;HTTP 요청인지 확인 후 HTTP 파싱을 요청 (비동기 태스크 시작)&lt;/li&gt;
&lt;li&gt;GET 요청은 body가 없으므로 &lt;code class=&quot;language-text&quot;&gt;receive()&lt;/code&gt; 처리를 안함. POST는 이를 수행&lt;/li&gt;
&lt;li&gt;응답헤더, 바디 각각 완성될 때마다 도착&lt;/li&gt;
&lt;li&gt;완성되면 응답 완료 후 연결 종료&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;마무리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%88%EB%AC%B4%EB%A6%AC&quot; aria-label=&quot;마무리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;마무리&lt;/h1&gt;
&lt;p&gt;이번 글에서는 WSGI와 ASGI의 차이를 살펴보고, ASGI가 등장하게 된 배경과 핵심 개념(&lt;code class=&quot;language-text&quot;&gt;scope&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;receive&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;send&lt;/code&gt;)을 이해하는 데 초점을 맞췄습니다. 또한, 가장 기본적인 형태의 ASGI 애플리케이션을 구현하고, 이를 활용하여 간단한 ASGI 서버를 직접 만들어 보았습니다.&lt;/p&gt;
&lt;p&gt;다음 글에서는 보다 실전적인 활용과 최적화에 초점을 맞추려 합니다. 아래 내용을 다룰 예정입니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ASGI 스펙 상세 분석(WebSocket, lifespan 이벤트 소개 등)&lt;/li&gt;
&lt;li&gt;ASGI 구현체 간단 분석&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;2부에서 계속됩니다.&lt;/p&gt;
&lt;p&gt;감사합니다.&lt;/p&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;daphne 구현체와 asgiref는 현재 Django Software Foundation (DSF)가 현재 관리중입니다. 이번에 알게되었네요!&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-2&quot;&gt;&lt;a href=&quot;https://github.com/encode/uvicorn/blob/master/tests/response.py&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://github.com/encode/uvicorn/blob/master/tests/response.py&lt;/a&gt;&lt;a href=&quot;#fnref-2&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-3&quot;&gt;&lt;a href=&quot;https://github.com/encode/uvicorn/blob/54d9575e75cd821cadef0eff64677ebd2fda4885/tests/protocols/test_http.py#L261-L279&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://github.com/encode/uvicorn/blob/54d9575e75cd821cadef0eff64677ebd2fda4885/tests/protocols/test_http.py#L261-L279&lt;/a&gt;&lt;a href=&quot;#fnref-3&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-4&quot;&gt;&lt;a href=&quot;https://github.com/encode/uvicorn/blob/master/uvicorn/importer.py&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://github.com/encode/uvicorn/blob/master/uvicorn/importer.py&lt;/a&gt;&lt;a href=&quot;#fnref-4&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-5&quot;&gt;&lt;a href=&quot;https://docs.python.org/3/library/asyncio-protocol.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://docs.python.org/3/library/asyncio-protocol.html&lt;/a&gt;&lt;a href=&quot;#fnref-5&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-6&quot;&gt;다른 언어들처럼 overriding을 강제하지는 않지만, 구현을 안 하면 런타임에서 터집니다(!)&lt;br /&gt; 필수로 구현해야 할 메소드는 &lt;code class=&quot;language-text&quot;&gt;BaseProtocol&lt;/code&gt; 을 살펴보시고, &lt;code class=&quot;language-text&quot;&gt;Protocol&lt;/code&gt; 도 함께 살펴봐주세요.&lt;a href=&quot;#fnref-6&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-7&quot;&gt;바디를 포함한 요청이라면 &lt;code class=&quot;language-text&quot;&gt;Content-Length&lt;/code&gt; 까지 함께 파싱하는 편이 좋겠지요.&lt;a href=&quot;#fnref-7&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[파이썬에는 오버로딩이 없다고요?]]></title><description><![CDATA[파이썬이 가지는 언어적 측면과 철학의 차이때문에 의도적으로 없습니다. 그렇다면 어떤 차이가 있고 어떤 개념 차이가 있는지 파악 후 왜 오버로딩이 없으며, 대체제는 무엇인지 살펴봅시다.]]></description><link>https://blog.s3ich4n.me/devlog/python/2025-02-02-python-and-overloading</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/python/2025-02-02-python-and-overloading</guid><pubDate>Sun, 02 Feb 2025 18:45:07 GMT</pubDate><content:encoded>&lt;p&gt;&lt;a href=&quot;https://blog.s3ich4n.me/devlog/python/2025-01-19-refactoring-and-design-pattern&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;지난 글에 소개드린&lt;/a&gt; 글또10기 디자인패턴 스터디를 통해 이야기를 나누다가, 파이썬에선 오버로딩이 되는지를 가만 생각해보았습니다.&lt;/p&gt;
&lt;h1 id=&quot;오버로딩이-되던가&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%98%A4%EB%B2%84%EB%A1%9C%EB%94%A9%EC%9D%B4-%EB%90%98%EB%8D%98%EA%B0%80&quot; aria-label=&quot;오버로딩이 되던가 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;오버로딩이 되던가..?&lt;/h1&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Calculator&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; a&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; a &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    
    &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; a&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; a &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;그러니까, 이런 코드가 도는지 말이죠. 두 &lt;code class=&quot;language-text&quot;&gt;add&lt;/code&gt; 메소드는 공존할까요?&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; pytest

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Calculator&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; a&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; a &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; b

    &lt;span class=&quot;token comment&quot;&gt;# 같은 이름으로 다른 메소드 정의 시도&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; a&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; c&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; a &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; b &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; c&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;테스트코드를 짜고,&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_method_overloading&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    calc &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Calculator&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# 두 개의 인자를 받는 add는 이미 덮어씌워졌으므로 &lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# TypeError가 발생해야 함&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;raises&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;TypeError&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; exc_info&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; calc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# 에러 메시지 검증&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;add() missing 1 required positional argument&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;exc_info&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# 세 개의 인자를 받는 add는 정상 작동&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; calc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_method_signature&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# Calculator 클래스의 add 메소드가 하나만 존재하는지 확인&lt;/span&gt;
    methods &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;method &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; method &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;dir&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Calculator&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; method &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;add&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;methods&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;…한번 테스트해봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;$ pytest &lt;span class=&quot;token parameter variable&quot;&gt;-v&lt;/span&gt; test/qna/test_python_overloading01.py
&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;test&lt;/span&gt; session starts &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;
platform darwin -- Python &lt;span class=&quot;token number&quot;&gt;3.12&lt;/span&gt;.6, pytest-8.3.4, pluggy-1.5.0 -- &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;PYTHONPATH&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
cachedir: .pytest_cache
rootdir: &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;BASEDIR&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
configfile: pytest.ini
collected &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; items

test_python_overloading01.py::test_method_overloading PASSED    &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt;%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
test_python_overloading01.py::test_method_signature PASSED      &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; passed &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.00s &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;주석으로 이미 작성했다시피, 테스트는 통과했습니다. &lt;code class=&quot;language-text&quot;&gt;TypeError&lt;/code&gt;가 런타임에 &lt;code class=&quot;language-text&quot;&gt;raise&lt;/code&gt;된 것이 캐치된 것이죠. 그렇다는 건 위의 자바코드와 같은 구성은 사용할 수 없다는 내용입니다. 😱🙀&lt;/p&gt;
&lt;p&gt;그렇다면 왜 안되는걸까요?&lt;/p&gt;
&lt;h1 id=&quot;먼저-파이썬의-특징을-살펴봅시다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A8%BC%EC%A0%80-%ED%8C%8C%EC%9D%B4%EC%8D%AC%EC%9D%98-%ED%8A%B9%EC%A7%95%EC%9D%84-%EC%82%B4%ED%8E%B4%EB%B4%85%EC%8B%9C%EB%8B%A4&quot; aria-label=&quot;먼저 파이썬의 특징을 살펴봅시다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;먼저 파이썬의 특징을 살펴봅시다&lt;/h1&gt;
&lt;p&gt;파이썬에서의 타입에 대해 살펴보고, 파이썬 객체가 가지는 특징을 통해 오버로딩의 대체방안을 살펴봅시다.&lt;/p&gt;
&lt;h2 id=&quot;초식-1---동적-타입&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%B4%88%EC%8B%9D-1---%EB%8F%99%EC%A0%81-%ED%83%80%EC%9E%85&quot; aria-label=&quot;초식 1   동적 타입 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;초식 (1) - 동적 타입&lt;/h2&gt;
&lt;p&gt;아마도 동적타입에 대한 이야기는 들어보셨을 겁니다&lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;. 타입을 별도로 지정해줄 필요가 없다보니 이런 행동이 가능합니다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_dynamic_type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# int 타입이었다가&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;

    x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;hello&quot;&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 문자열로도 바꿀 수 있고&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;

    x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 리스트로도 수정할 수 있습니다.&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;list&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; python &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;vs test_dynamic_type&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;py
test_dynamic_type&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;py&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;test_dynamic_type &lt;span class=&quot;token number&quot;&gt;4356563592&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;4363171952&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;4363299584&lt;/span&gt;
PASSED&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;다시말해 이렇게 됩니다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;새로운 객체가 생성되고&lt;/li&gt;
&lt;li&gt;변수 &lt;code class=&quot;language-text&quot;&gt;x&lt;/code&gt;는 이 새로운 객체를 가리키게 됩니다&lt;/li&gt;
&lt;li&gt;이전에 참조하던 객체와의 연결은 끊어집니다&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;        &lt;span class=&quot;token comment&quot;&gt;# x ----&gt; [10] (id: 4356563592)&lt;/span&gt;
x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;hello&quot;&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# x ----&gt; [&quot;hello&quot;] (id: 4363171952)&lt;/span&gt;
x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# x ----&gt; [[1,2,3]] (id: 4363299584)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;초식-2---duck-typing&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%B4%88%EC%8B%9D-2---duck-typing&quot; aria-label=&quot;초식 2   duck typing permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;초식 (2) - Duck typing&lt;/h2&gt;
&lt;p&gt;그리고 파이썬은 Duck typing을 지원합니다. 아주 유명한 말이죠:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;오리처럼 생기고, 오리처럼 헤엄치고, 오리처럼 우는 게 있다면 그건 오리일 가능성이 높다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;객체에 빗대자면 이렇게 되겠죠:&lt;/p&gt;
&lt;p&gt;객체가 해당 타입에서 요구하는 모든 메서드와 속성을 가지고 있다면 그 타입으로 간주됩니다. 상속관계를 보지 않고 필요 메소드와 속성을 가지는지만 체크합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Duck&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sound&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;꽥꽥&quot;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Dog&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sound&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;멍멍&quot;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;make_sound&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;animal&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# animal의 구체적인 타입은 중요하지 않음&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# sound() 메소드만 있으면 됨&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; animal&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sound&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_duck_typing&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; make_sound&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Duck&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;꽥꽥&quot;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; make_sound&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Dog&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;멍멍&quot;&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; python &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;vs test_duck_typing&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;py
test_duck_typing&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;py&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;test_duck_typing PASSED&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;즉, 앞서 살펴보았던 자바와 같은 정적 타입 언어는 컴파일 시점에 메서드 시그니처로 오버로딩을 결정합니다. 하지만 파이썬은 런타임에 메서드의 존재 여부만 확인하죠.&lt;/p&gt;
&lt;h2 id=&quot;초식-3---the-dunder-methods&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%B4%88%EC%8B%9D-3---the-dunder-methods&quot; aria-label=&quot;초식 3   the dunder methods permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;초식 (3) - The dunder methods&lt;/h2&gt;
&lt;p&gt;파이썬 클래스는 설계 시 dunder methods&lt;sup id=&quot;fnref-2&quot;&gt;&lt;a href=&quot;#fn-2&quot; class=&quot;footnote-ref&quot;&gt;2&lt;/a&gt;&lt;/sup&gt; 를 이용하여 설계할 수도 있습니다&lt;sup id=&quot;fnref-3&quot;&gt;&lt;a href=&quot;#fn-3&quot; class=&quot;footnote-ref&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;. 이로 인해 파이썬은 특정 인터페이스를 구현하지 않고도 주요 타입에 대해 동작을 정해줄 수 있지요.&lt;/p&gt;
&lt;h3 id=&quot;기본-dunder-method를-살펴봅시다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B8%B0%EB%B3%B8-dunder-method%EB%A5%BC-%EC%82%B4%ED%8E%B4%EB%B4%85%EC%8B%9C%EB%8B%A4&quot; aria-label=&quot;기본 dunder method를 살펴봅시다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;기본 dunder method를 살펴봅시다&lt;/h3&gt;
&lt;p&gt;예를 들어 이런 테스트를 한다고 합시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; pytest

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_dunder_methods&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;raises&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;TypeError&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;2&quot;&lt;/span&gt;     &lt;span class=&quot;token comment&quot;&gt;# 이걸 해주는 연산이 정의되지 않아서 안 되었던거고,&lt;/span&gt;
    
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;2&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;12&quot;&lt;/span&gt;     &lt;span class=&quot;token comment&quot;&gt;# 서로 맞는 타입끼리의 `__add__`는 있으니 가능한 것이지요&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; pytest &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;vs test_dunder_methods&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
test_dunder_methods&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;py&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;test_dunder_methods PASSED&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;예시를-살펴봅시다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%98%88%EC%8B%9C%EB%A5%BC-%EC%82%B4%ED%8E%B4%EB%B4%85%EC%8B%9C%EB%8B%A4&quot; aria-label=&quot;예시를 살펴봅시다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;예시를 살펴봅시다&lt;/h3&gt;
&lt;p&gt;그렇다면, 다양한 dunder를 직접 구현하고 이를 살펴봅시다. 예를들어, 길이를 표현하는 &lt;code class=&quot;language-text&quot;&gt;Length&lt;/code&gt; 라는 객체를 구상하고 이를 파이썬의 클래스로 표현해봅시다.&lt;/p&gt;
&lt;p&gt;이 클래스는 아래와 같은 기능을 제공합니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Length&lt;/code&gt; 클래스를 쓰고자 하는 이에게 값을 설명함
&lt;ul&gt;
&lt;li&gt;단순 엔드유저를 위한 출력 기능&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Length&lt;/code&gt; 클래스 개발 중 디버깅 등을 하기 위한 출력기능&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;값의 길이, 동등여부, less than 연산여부를 가릴 수 있음&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Length&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; meters&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;meters &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; meters

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__str__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;meters&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;m&quot;&lt;/span&gt;&lt;/span&gt;      &lt;span class=&quot;token comment&quot;&gt;# print() 출력용&lt;/span&gt;
    
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__repr__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;Length(&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;meters&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;)&quot;&lt;/span&gt;&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 개발자용 상세 출력&lt;/span&gt;
    
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__len__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;meters&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;       &lt;span class=&quot;token comment&quot;&gt;# len() 호출 시&lt;/span&gt;
    
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__eq__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; other&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;meters &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; other&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;meters  &lt;span class=&quot;token comment&quot;&gt;# == 연산자&lt;/span&gt;
    
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__lt__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; other&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;meters &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; other&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;meters   &lt;span class=&quot;token comment&quot;&gt;# &amp;lt; 연산자&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이를 테스트하면 아래와 같겠죠.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_custom_dunder&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    distance &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Length&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;token comment&quot;&gt;# __str__: 사용자(Length 사용자) 친화적 출력&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;distance&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;5m&quot;&lt;/span&gt;
    
    &lt;span class=&quot;token comment&quot;&gt;# __repr__: 개발자(Length 개발자)를 위한 상세 출력&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;repr&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;distance&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Length(5)&quot;&lt;/span&gt;
    
    &lt;span class=&quot;token comment&quot;&gt;# __len__: len() 함수 지원&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;distance&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;
    
    &lt;span class=&quot;token comment&quot;&gt;# __eq__, __lt__: 비교 연산자 지원&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; Length&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; Length&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; Length&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; Length&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; pytest &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;vs test_custom_dunder&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
test_custom_dunder&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;py&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;test_custom_dunder PASSED&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이런 식으로, 파이썬의 기본문법을 써서 내가 원하는 개념을 표현할 수 있게 됩니다.&lt;/p&gt;
&lt;h2 id=&quot;파이썬의-특징-정리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%8C%8C%EC%9D%B4%EC%8D%AC%EC%9D%98-%ED%8A%B9%EC%A7%95-%EC%A0%95%EB%A6%AC&quot; aria-label=&quot;파이썬의 특징 정리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;파이썬의 특징 정리&lt;/h2&gt;
&lt;p&gt;언어의 특성이 가지는 구조적 설계방안으로 인해 오버로딩 불가능이 아닌, 구현 방법이 달랐던 것입니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;변수에 타입을 지정해주지 않아도 되고&lt;/li&gt;
&lt;li&gt;덕 타이핑의 개념이 지원되고&lt;/li&gt;
&lt;li&gt;파이썬의 문법을 그대로 활용할 수 있도록 dunder method를 구현하면&lt;sup id=&quot;fnref-4&quot;&gt;&lt;a href=&quot;#fn-4&quot; class=&quot;footnote-ref&quot;&gt;4&lt;/a&gt;&lt;/sup&gt; 됩니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;그렇지만 이런 부분이 문제가 있죠.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;런타임에 프로그램 크래쉬를 유발할 수 있다는 점&lt;/li&gt;
&lt;li&gt;명확성 감소 (파이썬이 추구하는 명확성이 떨어짐이 문제)&lt;/li&gt;
&lt;li&gt;‘되겠거니’ 하다보니 유지보수가 힘들어짐 - 이런 코드가 쌓이면 코드의 예측이 어려움&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;그렇지만-타입을-아예-모르고-쓰고싶진-않아요&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B7%B8%EB%A0%87%EC%A7%80%EB%A7%8C-%ED%83%80%EC%9E%85%EC%9D%84-%EC%95%84%EC%98%88-%EB%AA%A8%EB%A5%B4%EA%B3%A0-%EC%93%B0%EA%B3%A0%EC%8B%B6%EC%A7%84-%EC%95%8A%EC%95%84%EC%9A%94&quot; aria-label=&quot;그렇지만 타입을 아예 모르고 쓰고싶진 않아요 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;그렇지만 타입을 아예 모르고 쓰고싶진 않아요…&lt;/h1&gt;
&lt;p&gt;파이썬은 이런 부분에 대해 충분히 인지하고 있었기 때문에 현재는 타입에 &lt;em&gt;힌트를 줄 수도&lt;/em&gt; 있고, 런타임 레벨에서 어느정도 강제할 수 있는 방안을 제공합니다. 이에 대해 하나씩 설명하고자 합니다.&lt;/p&gt;
&lt;h2 id=&quot;타입-힌팅&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%83%80%EC%9E%85-%ED%9E%8C%ED%8C%85&quot; aria-label=&quot;타입 힌팅 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;타입 힌팅&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;파이썬 3.5부터 처음 나온 개념입니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;타입 힌팅은 파이썬 코드에 타입 정보를 명시적으로 추가하는 방법입니다. 파이썬 3.5에서 처음 도입되었고, 코드의 가독성과 유지보수성을 높이는데 큰 도움을 줍니다.&lt;/p&gt;
&lt;p&gt;파이썬 타입힌팅의 주요 특징은 아래와 같습니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;런타임에는 영향을 주지 않음 (단순한 힌트일 뿐)&lt;/li&gt;
&lt;li&gt;IDE와 타입 체커가 코드 분석 시 활용&lt;/li&gt;
&lt;li&gt;코드의 의도를 명확히 전달 가능&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;타입 힌팅은 아래와 같은 장점을 가집니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;코드 이해도 향상
&lt;ul&gt;
&lt;li&gt;함수나 변수의 예상되는 타입을 바로 알 수 있음&lt;/li&gt;
&lt;li&gt;문서화 효과&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;버그 조기 발견
&lt;ul&gt;
&lt;li&gt;IDE나 타입 체커가 타입 관련 오류를 사전에 발견&lt;/li&gt;
&lt;li&gt;런타임 에러를 줄일 수 있음&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;리팩터링 용이성&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;타입 정보가 있어 안전한 코드 수정 가능&lt;/li&gt;
&lt;li&gt;자동 완성 기능 강화&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;파이썬에서 타입힌팅은 다양한 방법으로 기재할 수 있습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;실제 구동할 코드에 타입힌팅을 주는 법(가장 널리 알려진 타입힌팅, 이쪽을 사용)&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;.pyi&lt;/code&gt; 파일 등에 기록하는 것
&lt;ul&gt;
&lt;li&gt;기존 파일을 그대로 두고 타입 힌팅만 제공합니다&lt;/li&gt;
&lt;li&gt;CPython 인터페이스에 주로 사용됩니다&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# mylib.pyi&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;greet&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;py.typed&lt;/code&gt; 파일로 기록하는 것
&lt;ul&gt;
&lt;li&gt;패키지가 타입 힌트를 공식제공함을 알리는 마커 파일입니다&lt;/li&gt;
&lt;li&gt;패키지 루트에 두고 정적 타입 체커가 이를 인식하게 합니다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이렇다보니 보통은 실제 구동코드에 타입힌팅을 주는 부분이 더 익숙합니다. 본 문서에서는 이 내용을 짚고 넘어가려 합니다.&lt;/p&gt;
&lt;h3 id=&quot;타입-힌팅을-어떻게-하나요&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%83%80%EC%9E%85-%ED%9E%8C%ED%8C%85%EC%9D%84-%EC%96%B4%EB%96%BB%EA%B2%8C-%ED%95%98%EB%82%98%EC%9A%94&quot; aria-label=&quot;타입 힌팅을 어떻게 하나요 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;타입 힌팅을 어떻게 하나요?&lt;/h3&gt;
&lt;p&gt;파이썬 공식문서의 예시를 살펴볼까요.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;surface_area_of_cube&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;edge_length&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;The surface area of the cube is &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; edge_length &lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;.&quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;함수 시그니처를 이렇게 힌팅할 수 있습니다. &lt;code class=&quot;language-text&quot;&gt;float&lt;/code&gt; 타입을 받고 &lt;code class=&quot;language-text&quot;&gt;str&lt;/code&gt; 타입을 리턴하는 형식이죠.&lt;/p&gt;
&lt;p&gt;타입에 대한 힌트도 줄 수 있습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;Vector &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;scale&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;scalar&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; vector&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Vector&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; Vector&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;scalar &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; num &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; num &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; vector&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# passes type checking; a list of floats qualifies as a Vector.&lt;/span&gt;
new_vector &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; scale&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2.0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4.2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5.4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;아니면 아예 이런식으로 &lt;code class=&quot;language-text&quot;&gt;TypeAlias&lt;/code&gt; 를 써줄 수도 있지요.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; typing &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; TypeAlias

Vector&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; TypeAlias &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;타입힌팅-심화&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%83%80%EC%9E%85%ED%9E%8C%ED%8C%85-%EC%8B%AC%ED%99%94&quot; aria-label=&quot;타입힌팅 심화 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;타입힌팅 심화&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;TypeVar로 제네릭 타입 만들기&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;TypeVar&lt;/code&gt;는 파이썬에서 제네릭 타입을 정의할 때 사용하는 특별한 타입입니다. Java의 제네릭과 유사한 역할을 하며, 타입의 재사용성과 유연성을 높여줍니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; typing &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; TypeVar&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; List&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Sequence

T &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; TypeVar&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;T&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 어떤 타입이든 될 수 있는 타입 변수&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;first&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;lst&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Sequence&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;T&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; T&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;not&lt;/span&gt; lst&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; ValueError&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Empty sequence&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; lst&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 사용 예시&lt;/span&gt;
numbers&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; List&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
first_num&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; first&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;numbers&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# T는 int로 추론됨&lt;/span&gt;

strings&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; List&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;hello&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;world&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
first_str&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; first&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;strings&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# T는 str로 추론됨&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;bound&lt;/code&gt; 값을 추가하여 타입을 제한할 수도 있습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# bound를 이용한 타입 제한&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Animal&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;feed&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;pass&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Dog&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Animal&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;bark&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;멍멍!&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Animal이나 Animal의 서브클래스만 허용&lt;/span&gt;
BoundT &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; TypeVar&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;BoundT&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; bound&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;Animal&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;take_care&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;animal&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; BoundT&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; BoundT&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    animal&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;feed&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# Animal의 메소드는 항상 사용 가능&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; animal

&lt;span class=&quot;token comment&quot;&gt;# 사용 예시&lt;/span&gt;
dog &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Dog&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
take_care&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;dog&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# OK&lt;/span&gt;
take_care&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;cat&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 타입 체커 에러: str은 Animal의 서브타입이 아님&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;제약 조건이 있는 TypeVar&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;특정 타입들로만 제한하고 싶을 때는 &lt;code class=&quot;language-text&quot;&gt;TypeVar&lt;/code&gt;에 제약 조건을 걸 수 있습니다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; typing &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; TypeVar&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Union&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; List

&lt;span class=&quot;token comment&quot;&gt;# str이나 bytes 타입만 허용&lt;/span&gt;
StrOrBytes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; TypeVar&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;StrOrBytes&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;bytes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;concat&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; StrOrBytes&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; StrOrBytes&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; StrOrBytes&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; x &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; y

&lt;span class=&quot;token comment&quot;&gt;# 이렇게 하면 됨&lt;/span&gt;
result1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; concat&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Hello, &quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;World&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# OK&lt;/span&gt;
result2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; concat&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;b&quot;Hello, &quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;b&quot;World&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# OK&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 이건 타입 체커가 에러를 발생시킴&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# result3 = concat(1, 2)  # Error: int는 허용되지 않음&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;overload 데코레이터 활용하기&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;@overload&lt;/code&gt; 데코레이터를 사용하면 함수가 여러 타입 시그니처를 가질 수 있음을 타입 체커에 알려줄 수 있습니다. 런타임에는 영향을 주지 않지만, 개발 시점에 타입 안전성을 보장하는데 도움을 줍니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; typing &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; overload&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Union

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;StringProcessor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@overload&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    
    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@overload&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Union&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; Union&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;isinstance&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;upper&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;v&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;upper&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; v &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_string_processor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    processor &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; StringProcessor&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;token comment&quot;&gt;# 둘 다 타입 체크를 통과함&lt;/span&gt;
    result1&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; processor&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;process&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;hello&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# &quot;HELLO&quot;&lt;/span&gt;
    result2&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; processor&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;process&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;hello&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;world&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# [&quot;HELLO&quot;, &quot;WORLD&quot;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;선택적 매개변수와 기본값&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Optional&lt;/code&gt; 표기를 통해 필요한 값을 추가적으로 쓸 수 있게 표기할 수도 있습니다. 그리고 기본값도 줄 수 있지요.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; typing &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Optional

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;greet&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; title&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Optional&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; title&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;Hello, &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;title&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt; &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;!&quot;&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;Hello, &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;!&quot;&lt;/span&gt;&lt;/span&gt;

result1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; greet&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Alice&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Ms.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# &quot;Hello, Ms. Alice!&quot;&lt;/span&gt;
result2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; greet&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Bob&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# &quot;Hello, Bob!&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;Union 타입과 Literal 타입&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Literal 은 말 그대로(&lt;em&gt;literally&lt;/em&gt;) 동일한 문자열이 오기를 기대하는 타입입니다.&lt;/p&gt;
&lt;p&gt;Union은 이 값 중 하나의 값을 선택하겠다라는 의미로 사용합니다. 파이썬 3.11부터는 &lt;code class=&quot;language-text&quot;&gt;|&lt;/code&gt; 연산자로 표기할 수도 있지요.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; typing &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Union&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Literal

&lt;span class=&quot;token comment&quot;&gt;# 특정 문자열만 허용하는 타입&lt;/span&gt;
LogLevel &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Literal&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;DEBUG&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;INFO&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;WARNING&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ERROR&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    message&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    level&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; LogLevel&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    code&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Union&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# 파이썬 3.11 이상부터는&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# code: int | str 도 가능합니다.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;[&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;level&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;] &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;code&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;message&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 모두 유효한 호출입니다.&lt;/span&gt;
log&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;System starting&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;INFO&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
log&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;File not found&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ERROR&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;E404&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 타입 체커가 에러를 발생시키는 경우&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# log(&quot;Test&quot;, &quot;INVALID&quot;, 200)  # Error: &quot;INVALID&quot;는 LogLevel에 없으니 안되죠.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol start=&quot;6&quot;&gt;
&lt;li&gt;콜백 함수의 타입 힌팅&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;파이썬의 모든 것은 객체이므로, 이를 &lt;code class=&quot;language-text&quot;&gt;Callable&lt;/code&gt; 이라는 이름으로 매개변수로 받을 수 있게 힌트를 줄 수 있습니다. 이를 이용한 예시는 아래와 같습니다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; typing &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Callable&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; TypeVar

T &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; TypeVar&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;T&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
R &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; TypeVar&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;R&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Callable의 특징을 기재함&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;map_list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;func&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Callable&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;T&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; R&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; items&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;T&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;R&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;func&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;item&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; item &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; items&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 사용 예시&lt;/span&gt;
numbers &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
squares &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; map_list&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;lambda&lt;/span&gt; x&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; x &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; x&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; numbers&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# [1, 4, 9]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol start=&quot;7&quot;&gt;
&lt;li&gt;클래스 메서드와 프로퍼티&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Protocol&lt;/code&gt; 로 클래스 정의를 미리 흉내낼 때는 이렇게 프로퍼티를 미리 정의할 수도 있습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; typing &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; ClassVar&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Protocol

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DataProcessor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Protocol&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    MAX_ITEMS&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ClassVar&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 클래스 변수&lt;/span&gt;
    
    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@property&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;item_count&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;CSVProcessor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    MAX_ITEMS&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ClassVar&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;
    
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_items&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@property&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;item_count&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_items&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;MAX_ITEMS&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; ValueError&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Too many items&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_items&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;extend&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이러한 타입 힌팅을 활용하면 코드의 안정성을 높이고 개발자의 실수를 줄일 수 있습니다. IDE나 타입 체커를 통해 많은 오류를 사전에 발견할 수 있으며, 코드의 자동완성 기능도 더욱 정확해집니다.&lt;/p&gt;
&lt;h3 id=&quot;타입힌팅---structural-subtyping으로&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%83%80%EC%9E%85%ED%9E%8C%ED%8C%85---structural-subtyping%EC%9C%BC%EB%A1%9C&quot; aria-label=&quot;타입힌팅   structural subtyping으로 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;타입힌팅 - Structural Subtyping으로&lt;/h3&gt;
&lt;p&gt;파이썬의 타입 힌팅은 시간이 지나면서 더 파이썬스러운 방식으로 발전했습니다. 위에서 보았던 예시를 다시 살펴볼까요?&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Duck&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sound&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;꽥꽥&quot;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Dog&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sound&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;멍멍&quot;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;make_sound&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;animal&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# animal의 구체적인 타입은 중요하지 않음&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# sound() 메소드만 있으면 됨&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; animal&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sound&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_duck_typing&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; make_sound&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Duck&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;꽥꽥&quot;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; make_sound&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Dog&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;멍멍&quot;&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; python &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;vs test_duck_typing&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;py
test_duck_typing&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;py&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;test_duck_typing PASSED&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이후 structural subtyping 이 도입되면서, 클래스가 특정 메서드들을 구현하기만 하면 자동으로 해당 타입으로 인식되도록 변경되었습니다. &lt;code class=&quot;language-text&quot;&gt;Protocol&lt;/code&gt; 클래스를 통해 새 인터페이스를 정의할 수도 있지요.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;파이썬 3.8에서 처음 나온 개념입니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; typing &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Protocol

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Animal&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Protocol&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sound&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# Protocol은 구현부 없이 메서드 시그니처만 정의&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# make_sound에서, `Animal` 을 정의해주었으니&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# 컴파일 타임에 Protocol이 요구하는 메소드/속성이 있는지 정적으로 확인한다&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# 이제 Duck과 Dog는 자동으로 Animal 프로토콜을 구현한 것으로 인식한다!&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;make_sound&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;animal&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Animal&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; animal&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sound&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;다만 이런 정적 타입 체커(static type checker)를 활용하면 실제 개발에만 도움을 줄 뿐, 기저에 있는 덕 타이핑 방식대로 동작하며 개발 시 문제를 잡을 수 있게 도움을 의미합니다.&lt;/p&gt;
&lt;h3 id=&quot;타입힌팅을-도와주는-도구&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%83%80%EC%9E%85%ED%9E%8C%ED%8C%85%EC%9D%84-%EB%8F%84%EC%99%80%EC%A3%BC%EB%8A%94-%EB%8F%84%EA%B5%AC&quot; aria-label=&quot;타입힌팅을 도와주는 도구 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;타입힌팅을 도와주는 도구&lt;/h3&gt;
&lt;p&gt;앞서말했듯 타입 힌트를 도와주는 도구들을 통해 도움을 받을 수 있습니다. 가령 PyCharm 에서 저장 시 프로젝트의 모든 내 파이썬 파일에 대해 린트를 하는 등의 조치를 의미하죠. 때로는 타입이 맞지 않아 실제 코드를 잘못 사용하고있음을 알 수도 있습니다.&lt;/p&gt;
&lt;p&gt;정적 타입 검사기로는 아래 작업을 수행할 수 있습니다:
- 코드 실행 없이 타입 오류를 분석
- MyPy, Pyright, Pyre 등이 대표적
- PEP 484(타입 힌트) 및 PEP 544(Protocol) 같은 제안을 기반으로 동작&lt;/p&gt;
&lt;p&gt;이런 도구들이 IDE와 결합되면 저장과 동시에 린팅, 타입검사 후 에러체크를 수행해주기도 합니다.&lt;/p&gt;
&lt;p&gt;반면 런타임에 타입을 검사하는 건 &lt;code class=&quot;language-text&quot;&gt;isinstance()&lt;/code&gt; 나 &lt;code class=&quot;language-text&quot;&gt;type()&lt;/code&gt; 이 있습니다. 이런 부분도 적절히 코드에 잘 녹여내서 해결할 수 있지요.&lt;/p&gt;
&lt;h3 id=&quot;타입-힌팅에-대한-예시&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%83%80%EC%9E%85-%ED%9E%8C%ED%8C%85%EC%97%90-%EB%8C%80%ED%95%9C-%EC%98%88%EC%8B%9C&quot; aria-label=&quot;타입 힌팅에 대한 예시 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;타입 힌팅에 대한 예시&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;pyproject.toml&lt;/code&gt; 에 기재하는 타입 힌팅 및 린팅(Black 사용법)을 기존으로 간단한 예시를 설명드리고자 합니다.&lt;/p&gt;
&lt;p&gt;아래 설정은 다음과 같은 내용을 강제합니다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;모든 함수에 타입 힌트 필수 (&lt;code class=&quot;language-text&quot;&gt;disallow_untyped_defs = true&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;불완전한 타입 힌트 불허 (&lt;code class=&quot;language-text&quot;&gt;disallow_incomplete_defs = true&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;Any 타입 반환 시 경고 (&lt;code class=&quot;language-text&quot;&gt;warn_return_any = true&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;테스트 코드는 타입 힌트 옵션 (&lt;code class=&quot;language-text&quot;&gt;[[tool.mypy.overrides]]&lt;/code&gt; 섹션)&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;toml&quot;&gt;&lt;pre class=&quot;language-toml&quot;&gt;&lt;code class=&quot;language-toml&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token table class-name&quot;&gt;tool.black&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token key property&quot;&gt;line-length&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;108&lt;/span&gt;
&lt;span class=&quot;token key property&quot;&gt;target-version&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;py311&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token key property&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;\.pyi?$&apos;&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token table class-name&quot;&gt;tool.mypy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token key property&quot;&gt;python_version&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;3.11&quot;&lt;/span&gt;
&lt;span class=&quot;token key property&quot;&gt;warn_return_any&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;token key property&quot;&gt;warn_unused_configs&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;token key property&quot;&gt;disallow_untyped_defs&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;token key property&quot;&gt;disallow_incomplete_defs&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;token key property&quot;&gt;check_untyped_defs&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;token key property&quot;&gt;disallow_untyped_decorators&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;token key property&quot;&gt;no_implicit_optional&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;token key property&quot;&gt;warn_redundant_casts&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;token key property&quot;&gt;warn_unused_ignores&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;token key property&quot;&gt;warn_no_return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;token key property&quot;&gt;warn_unreachable&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token table class-name&quot;&gt;tool.mypy.overrides&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token key property&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;tests.*&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token key property&quot;&gt;disallow_untyped_defs&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token table class-name&quot;&gt;tool.isort&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token key property&quot;&gt;profile&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;black&quot;&lt;/span&gt;
&lt;span class=&quot;token key property&quot;&gt;multi_line_output&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;black과 함께 사용하면 코드 스타일과 타입 안정성을 모두 확보할 수 있습니다.&lt;/p&gt;
&lt;h1 id=&quot;진짜-오버로딩을-하려면-어떻게-해야해요&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A7%84%EC%A7%9C-%EC%98%A4%EB%B2%84%EB%A1%9C%EB%94%A9%EC%9D%84-%ED%95%98%EB%A0%A4%EB%A9%B4-%EC%96%B4%EB%96%BB%EA%B2%8C-%ED%95%B4%EC%95%BC%ED%95%B4%EC%9A%94&quot; aria-label=&quot;진짜 오버로딩을 하려면 어떻게 해야해요 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;진짜 오버로딩을 하려면 어떻게 해야해요..?&lt;/h1&gt;
&lt;p&gt;이런 특성대신 실제 오버로딩을 활용하고자 한다면 파이썬 기본제공 도구를 사용하거나, 서드파티 라이브러리를 사용하여 해결할 수 있습니다.&lt;/p&gt;
&lt;h2 id=&quot;singledispatch-활용&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#singledispatch-%ED%99%9C%EC%9A%A9&quot; aria-label=&quot;singledispatch 활용 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;@singledispatch&lt;/code&gt; 활용&lt;/h2&gt;
&lt;p&gt;실제 목적으로서의 오버로딩을 구현하기 위해선 &lt;code class=&quot;language-text&quot;&gt;functools&lt;/code&gt; 의 &lt;code class=&quot;language-text&quot;&gt;@singledispatch&lt;/code&gt; 를 이용할 수 있습니다. 예를 들어 아래와 같은 계산기가 있다고 가정합시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Calculator&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@singledispatchmethod&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; NotImplementedError&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Cannot process data of unknown type!&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;token comment&quot;&gt;# 그마저도 한 타입만 체크. 그래서 이름이 `single dispatch`&lt;/span&gt;
    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@add&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;register&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; data1 &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; data2

    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@add&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;register&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; data1 &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; data2&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이런 식으로 변경 후, 아래와 같이 사용할 수 있습니다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_calc_int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    calc &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Calculator&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; calc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;     &lt;span class=&quot;token comment&quot;&gt;# int 값 만을 받는 것은 허용&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; result &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_calc_str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    calc &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Calculator&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; calc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;2&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;     &lt;span class=&quot;token comment&quot;&gt;# str 값도 허용&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; result &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;12&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;하지만, 파이썬 특유의 연산으로도 안 되는 건(프로토콜에 정의되지 않은 건) &lt;code class=&quot;language-text&quot;&gt;TypeError&lt;/code&gt; 가 납니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_single_dispatch_limitation&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    calc &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Calculator&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;token comment&quot;&gt;# 런타임에 뭐가 들어올 지 몰라서, 일단 연산을 시키기 때문에 에러가 날 수 있음&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;raises&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;TypeError&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        calc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;2&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# int + str는 불가능. 그걸 TypeError로 잡음&lt;/span&gt;
    
    &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;raises&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;TypeError&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        calc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# str + int도 불가능. 그걸 TypeError로 잡음&lt;/span&gt;
    
    &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;raises&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;TypeError&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        calc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# int + list도 불가능. 그걸 TypeError로 잡음&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;한계점&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%95%9C%EA%B3%84%EC%A0%90&quot; aria-label=&quot;한계점 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;한계점?&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;@singledispatch&lt;/code&gt; 는 하나의 타입만 체크합니다. 그래서 &lt;a href=&quot;https://pypi.org/project/multipledispatch/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;multipledispatch&lt;/code&gt;&lt;/a&gt; 를 사용한다면, &lt;code class=&quot;language-text&quot;&gt;TypeError&lt;/code&gt; 가 아니라 &lt;code class=&quot;language-text&quot;&gt;NotImplementedError&lt;/code&gt; 를 raise 할 수 있습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; multipledispatch &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; dispatch   &lt;span class=&quot;token comment&quot;&gt;# 이렇게 multipledispatch를 쓰면&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; pytest

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Calculator&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@dispatch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;      &lt;span class=&quot;token comment&quot;&gt;# 여러 타입을 쓸 수 있습니다.&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; data1 &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; data2

    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@dispatch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; data1 &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; data2&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_calc_valid&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    calc &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Calculator&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# 정상 케이스&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; calc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; calc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Hello, &quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;World!&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Hello, World!&quot;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_calc_invalid&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    calc &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Calculator&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# 타입이 맞지 않는 경우 NotImplementedError 발생.&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# 기존 TypeError와는 달랐다는 점에 주의.&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# 다른 타입은 구현을 안해서 NotImplementedError인 것.&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;raises&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;NotImplementedError&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        calc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;2&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# int + str&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;raises&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;NotImplementedError&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        calc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# str + int&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;raises&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;NotImplementedError&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        calc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# int + list&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id=&quot;끝으로&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%81%9D%EC%9C%BC%EB%A1%9C&quot; aria-label=&quot;끝으로 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;끝으로&lt;/h1&gt;
&lt;p&gt;정리하면 아래와 같습니다:&lt;/p&gt;
&lt;p&gt;파이썬은 덕 타이핑과 구조적 타이핑을 지원하는 언어이므로, 전통적인 오버로딩 개념이 잘 맞지 않습니다. 그러나 &lt;code class=&quot;language-text&quot;&gt;@singledispatch&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;Protocol&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;TypeVar&lt;/code&gt; 등을 활용하면 타입 체크를 강화할 수도 있습니다.&lt;/p&gt;
&lt;p&gt;언어가 지니는 특징과 구현방안을 이해한다면 보다 그 언어가 추구하는 방향으로 코드를 짤 수 있을 것입니다.&lt;/p&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Type_system&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://en.wikipedia.org/wiki/Type_system&lt;/a&gt; 을 함께 살펴보면 더욱 좋습니다.&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-2&quot;&gt;&lt;a href=&quot;https://docs.python.org/3/glossary.html#term-special-method&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://docs.python.org/3/glossary.html#term-special-method&lt;/a&gt; 를 의미합니다. dunder(&lt;em&gt;double underscore&lt;/em&gt;) methods, special methods, 매직 메소드(&lt;em&gt;magic methods&lt;/em&gt;) 라고 부르기도 합니다.&lt;a href=&quot;#fnref-2&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-3&quot;&gt;&lt;a href=&quot;https://docs.python.org/3/reference/datamodel.html#special-method-names&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://docs.python.org/3/reference/datamodel.html#special-method-names&lt;/a&gt; 을 참고해 주세요.&lt;a href=&quot;#fnref-3&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-4&quot;&gt;이를 프로토콜 구현이라고 부르기도 합니다.&lt;a href=&quot;#fnref-4&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[파이썬으로 살펴보는 디자인 패턴과 리팩터링]]></title><description><![CDATA[파이썬으로 디자인 패턴과 리팩터링 2판을 읽는 스터디를 시작했습니다. 이를 통해 배운 점을 공유드립니다.]]></description><link>https://blog.s3ich4n.me/devlog/python/2025-01-19-refactoring-and-design-pattern</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/python/2025-01-19-refactoring-and-design-pattern</guid><pubDate>Sun, 19 Jan 2025 18:57:14 GMT</pubDate><content:encoded>&lt;p&gt;이 글은 글또 10기에서 모집된 디자인 패턴 스터디와, 외부 모임에서 리팩터링 2판 스터디를 따라하면 배운 점을 회고하는 글입니다.&lt;/p&gt;
&lt;p&gt;코드 및 해당 내용의 상세한 부분은 아래 경로를 참조 부탁드립니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/s3ich4n/geultto10_gof&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;GoF의 디자인 패턴&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/s3ich4n/refactoring-2nd&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;리팩터링 2판&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;들어가며&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0&quot; aria-label=&quot;들어가며 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;들어가며&lt;/h1&gt;
&lt;p&gt;좋은 코드에 대해 좋은 코드는 어떤 무언가 굉장히 고상하고 완성된 코드라는 환상이 있었습니다. 놀랍게도 그런 코드를 만드는 책을 살펴보자 이는 마치 백조처럼 생존을 위해 허덕이는 발버둥의 연속이었다는 걸&lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt; 알게 되었습니다.&lt;/p&gt;
&lt;img src=&quot;https://images.unsplash.com/photo-1588485256313-f021c74731f1&quot; alt=&quot;??: 달리 그렇지도 않다는데요!?ㅋㅋ&quot; style=&quot;width:60%; height:60%;&quot;&gt;
&lt;p&gt;그렇다면 효율적으로 프로젝트를 순항하기 위한 건강한 방안을 살펴봅시다.&lt;/p&gt;
&lt;h1 id=&quot;건강한-코드베이스를-위해&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B1%B4%EA%B0%95%ED%95%9C-%EC%BD%94%EB%93%9C%EB%B2%A0%EC%9D%B4%EC%8A%A4%EB%A5%BC-%EC%9C%84%ED%95%B4&quot; aria-label=&quot;건강한 코드베이스를 위해 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;건강한 코드베이스를 위해&lt;/h1&gt;
&lt;p&gt;건강한 코드베이스를 위해 어떤 것들이 필요할까요? 우선 마틴 파울러의 유명한 영상&lt;sup id=&quot;fnref-2&quot;&gt;&lt;a href=&quot;#fn-2&quot; class=&quot;footnote-ref&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;을 가지고 이야기 해보고자 합니다.&lt;/p&gt;
&lt;h2 id=&quot;리팩터링의-중요성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A6%AC%ED%8C%A9%ED%84%B0%EB%A7%81%EC%9D%98-%EC%A4%91%EC%9A%94%EC%84%B1&quot; aria-label=&quot;리팩터링의 중요성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;리팩터링의 중요성&lt;/h2&gt;
&lt;p&gt;이는 “리팩터링의 중요성” 에 대한 내용이지요. 2014년 7월(영상 업로드 기준) 당시에만 해도 코드베이스의 높은 품질을 유지하기 위해 핵심기술로 자리잡았습니다. 그렇지만 저는 그러한 리팩터링의 워크플로우를 아직 이해하지 못하기도 했지요.&lt;/p&gt;
&lt;p&gt;결국 리팩터링의 핵심은 지난 몇년의 실전경험에서 배웠던 것입니다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;돌아가는 소프트웨어가 제 1순위다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;그렇다고 해서 돌아만 가면 될까요? 우리의 소프트웨어는 고객에게 유의미한 가치를 계속 주길 원합니다. 그렇다면 계속해서 복잡함이 추가될 수 밖에 없습니다. 손님이 원하는 프로그램은 자꾸만 바뀔테니까요. 그래서 영상에서는 되는 코드를 만들고, 그 코드를 바꾸는 과정을 반복해서 수행하라는, 흔히 말하는 TDD의 방식을 먼저 이야기합니다. 다음 경우는 코드가 역겨울 때 ‘쓰레기 줍기 리팩터링’을 하길 바랍니다. 코드가 지속적으로 유지되기 위함이지요. 마지막 하나는 복잡한 로직이 뒤섞인 코드가 있습니다. 이 실타래를 풀어내는 것 또한 이하하기 쉽게 풀어야 합니다. 그것이 ‘이해를 위한 리팩터링’이지요.&lt;/p&gt;
&lt;p&gt;리팩터링은 코드가 읽기 쉽고 고치기 쉬운(새 기능을 추가하든, 기존 기능을 수정하든) 코드를 만드는 방법입니다. 책의 내용을 발췌하자면:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;좋은 코드를 가늠하는 확실한 방법은 ‘얼마나 수정하기 쉬운가’다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;라는 것입니다.&lt;/p&gt;
&lt;p&gt;그걸 못하고있다고 생각이 들어, 대번에 스터디 신청을 하고 지원하게 되었네요.&lt;/p&gt;
&lt;h2 id=&quot;디자인-패턴의-중요성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%94%94%EC%9E%90%EC%9D%B8-%ED%8C%A8%ED%84%B4%EC%9D%98-%EC%A4%91%EC%9A%94%EC%84%B1&quot; aria-label=&quot;디자인 패턴의 중요성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;디자인 패턴의 중요성&lt;/h2&gt;
&lt;p&gt;디자인 패턴은 물론 다른 쪽에 주안점을 둡니다. 객체지향 소프트웨어 설계는 근본적으로 힘듭니다. 이를 재사용 가능하게 설계하는 것도 마찬가지지요. 그리고 처음부터 제대로 설계하는 것은 저는 그냥 불가능하다고 봅니다. 경험있는 사람들도 손사래를 치는데, 하물며 업계 전반에서는 오죽할까요.&lt;/p&gt;
&lt;p&gt;그래서 경험있는 설계자들은 이를 위해 이전에 좋았던 해결책을 “패턴화” 했습니다. 이럴 때 이게 맞을까? 하는 설계에 주안점을 두고 계속 살펴봅니다. 본문에서 설명하겠지만, 각 패턴이 쓰일 상황을 이해하고, 이를 해결하고, 완성품은 어떤 결과이며 이에 따른 트레이드오프는 무엇인지 알아봅니다.&lt;/p&gt;
&lt;p&gt;크리스토퍼 알렉산더는 이런 말을 했습니다:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;“패턴이란, 우리가 개발 환경에서 반복적으로 마주치는 문제를 설명하고, 그 문제의 핵심 해결책을 제시하는 것입니다. 이 해결책은 마치 템플릿처럼 백만 번이고 재사용할 수 있으나, 실제 상황에 맞추어 매번 다르게 적용할 수 있습니다.” [AIS+77]&lt;/p&gt;
&lt;p&gt;Christopher Alexander, Sara Ishikawa, Murray Silverstein, Max Jacobson, Ingrid Fiksdahl-King, and Shlomo Angel. A Pattern Language. Oxford: Oxford University Press, 1977.&lt;/p&gt;
&lt;p&gt;(Gemma, DeepL, Claude Sonnet 3.5 결과를 토대로 의역)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;이 말은 아래와 같은 뜻이 아닌가 하고 생각했습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;반복되는 문제가 있는데&lt;/li&gt;
&lt;li&gt;주요 “패턴”은 이를 해결하는 핵심 해결책을 제시한다. 어디까지나 기본 원칙으로서.&lt;/li&gt;
&lt;li&gt;그리고 “백만 번(million times)”을 사용해도 상황에 맞추어 응용할 수 있음을 말한다&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;다시말해, 디자인 패턴은 특정 상황에서 일반적인 설계 고민을 해결하기 위한 방안인 것이지요.&lt;/p&gt;
&lt;h1 id=&quot;1회차를-해본-후&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1%ED%9A%8C%EC%B0%A8%EB%A5%BC-%ED%95%B4%EB%B3%B8-%ED%9B%84&quot; aria-label=&quot;1회차를 해본 후 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1회차를 해본 후&lt;/h1&gt;
&lt;p&gt;헬스장도 그렇고 스터디도 그렇고 꾸준히 하는 게 중요하죠. 이런 건 하루이틀 해서 될 것도 아닙니다. 여기선 느낀 점을 위주로 이야기 해보려 합니다.&lt;/p&gt;
&lt;h2 id=&quot;리팩터링-1장을-해본-후&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A6%AC%ED%8C%A9%ED%84%B0%EB%A7%81-1%EC%9E%A5%EC%9D%84-%ED%95%B4%EB%B3%B8-%ED%9B%84&quot; aria-label=&quot;리팩터링 1장을 해본 후 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;리팩터링 1장을 해본 후&lt;/h2&gt;
&lt;p&gt;작게 바꾸는 흐름과 소개해주는 패턴을 체화해보고 시간가는 줄 모르고 계속 짰습니다. 저는 아래 플로우로 짰습니다. 코드베이스는 실제 비즈니스 로직이 있는 코드를, 테스트코드는 우리가 아는 그 테스트코드를 의미합니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;돌아가는 코드베이스를 짭니다&lt;/li&gt;
&lt;li&gt;테스트코드를 구성하고 실행합니다.&lt;/li&gt;
&lt;li&gt;테스트를 패스하게 코드베이스를 수정하고 커밋합니다.&lt;/li&gt;
&lt;li&gt;리팩터 할 코드베이스를 살펴보고 작은단위의 리팩터를 수행합니다.&lt;/li&gt;
&lt;li&gt;기존 테스트코드를 구동합니다&lt;/li&gt;
&lt;li&gt;테스트를 패스하게 코드베이스를 수정하고 커밋합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이 플로우대로 작은 범위를 계속 커밋하고나니 50개에 육박하는 커밋이 생겼더군요. 얼마나 잘게, 그리고 리팩터를 얼마나 신중하게 할 수 있는지 알게 되었습니다.&lt;/p&gt;
&lt;p&gt;왜 이게 필요하고, 어떤 접근을 해야하는지 한번 해보게되어 매우 좋았습니다. 더 공유하고 싶은 내용이 있다면 블로그 글로 정제하여 공유드리겠습니다.&lt;/p&gt;
&lt;h2 id=&quot;디자인패턴-1장-2장을-살펴본-후&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%94%94%EC%9E%90%EC%9D%B8%ED%8C%A8%ED%84%B4-1%EC%9E%A5-2%EC%9E%A5%EC%9D%84-%EC%82%B4%ED%8E%B4%EB%B3%B8-%ED%9B%84&quot; aria-label=&quot;디자인패턴 1장 2장을 살펴본 후 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;디자인패턴 1장, 2장을 살펴본 후&lt;/h2&gt;
&lt;p&gt;분량이 정말 많았습니다만 하나같이 중요해서 대충 넘어갈 수도 없었습니다…ㅠㅠ&lt;/p&gt;
&lt;p&gt;자 그럼 책이 제시하는 예시를 통해 왜 코드를 이렇게 풀어내야하는지 보았습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;해결해야 할 요구사항은 무엇이고&lt;/li&gt;
&lt;li&gt;도입 시 어떤 변화가 예상되며&lt;/li&gt;
&lt;li&gt;프로그램 내에 잠재적으로 변할 수 있는 것은 무엇인지&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;사실상 이것의 연속입니다. 그렇지만…&lt;/p&gt;
&lt;h3 id=&quot;당신은-객체를-제대로-이해하고-있는가&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8B%B9%EC%8B%A0%EC%9D%80-%EA%B0%9D%EC%B2%B4%EB%A5%BC-%EC%A0%9C%EB%8C%80%EB%A1%9C-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B3%A0-%EC%9E%88%EB%8A%94%EA%B0%80&quot; aria-label=&quot;당신은 객체를 제대로 이해하고 있는가 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;당신은 객체를 제대로 이해하고 있는가?&lt;/h3&gt;
&lt;p&gt;객체지향 프로그래밍의 핵심은 객체와 메시지, 그리고 객체 간의 협력에 있습니다. 객체는 데이터와 동작을 하나로 묶어 관리하며, 이러한 객체들이 서로 메시지를 주고받으며 협력하는 방식으로 시스템이 구성됩니다. 이러한 협력은 시스템의 유연성과 확장성을 높이는 데 필수적입니다.&lt;/p&gt;
&lt;p&gt;다시 강조하자면 객체 간의 협력과 책임 분담을 명확하게 정의하는 것이 중요합니다. 이를 통해 시스템의 복잡성을 관리하고, 변경에 유연하게 대응할 수 있는 구조를 설계할 수 있습니다.&lt;/p&gt;
&lt;h3 id=&quot;상속-구현-인터페이스-위임을-넘어&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%83%81%EC%86%8D-%EA%B5%AC%ED%98%84-%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4-%EC%9C%84%EC%9E%84%EC%9D%84-%EB%84%98%EC%96%B4&quot; aria-label=&quot;상속 구현 인터페이스 위임을 넘어 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;상속, 구현, 인터페이스, 위임을 넘어…&lt;/h3&gt;
&lt;p&gt;특히나 이런 것들이:&lt;/p&gt;
&lt;p&gt;캡슐화(Encapsulation): 데이터와 메서드를 하나의 단위로 묶어 외부로부터 보호하는 개념입니다. 이를 통해 데이터의 무분별한 접근을 막고, 데이터의 일관성을 유지할 수 있습니다.&lt;/p&gt;
&lt;p&gt;상속(Inheritance): 기존 클래스의 특성과 메서드를 새로운 클래스에서 재사용할 수 있게 하는 기능입니다. 이를 통해 코드의 재사용성을 높일 수 있습니다.&lt;/p&gt;
&lt;p&gt;다형성(Polymorphism): 동일한 메서드가 다양한 방식으로 동작할 수 있게 하는 기능입니다. 이를 통해 코드의 유연성과 확장성을 높일 수 있습니다.&lt;/p&gt;
&lt;p&gt;이러한 개념들을 이해하고 넘어가는 것부터 시작했습니다.&lt;/p&gt;
&lt;h3 id=&quot;2장은&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2%EC%9E%A5%EC%9D%80&quot; aria-label=&quot;2장은 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2장은?&lt;/h3&gt;
&lt;p&gt;각 개념을 &lt;code class=&quot;language-text&quot;&gt;Lexi&lt;/code&gt; 라는 이름의 텍스트 에디터를 설계하며 어떻게 풀어나갈 지 아는 내용입니다.&lt;/p&gt;
&lt;p&gt;이런 개념을 보면 왜:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;상속보다 구현이 더 괜찮은 선택인지&lt;/li&gt;
&lt;li&gt;코드의 구조를 어떻게 잡을 수 있는지&lt;/li&gt;
&lt;li&gt;다형성을 어떤 식으로 쉽게 추가/수정하게 구성할지&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;를 알 수 있습니다.&lt;/p&gt;
&lt;p&gt;요약하기 좀처럼 쉽지않지만, 추후 디자인패턴을 계속 공부하며 또 소개할 때 다시 언급해보겠습니다.&lt;/p&gt;
&lt;h1 id=&quot;끝으로&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%81%9D%EC%9C%BC%EB%A1%9C&quot; aria-label=&quot;끝으로 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;끝으로&lt;/h1&gt;
&lt;p&gt;2025년은 이런 스터디를 많이 하려 합니다. “이제는 해보자!” 하는 마인드로 하나씩 실현해보면 어떨까 합니다.&lt;/p&gt;
&lt;p&gt;이 글을 읽어보시는 여러분들께도 한번 권해봅니다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;이제는 해봅시다!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;&lt;a href=&quot;https://www.seoul.co.kr/news/society/education-news/2011/06/14/20110614500001&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;실상은 전혀 그렇지 않다네요!?&lt;/a&gt;&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-2&quot;&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=mNPpfB8JSIU&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://www.youtube.com/watch?v=mNPpfB8JSIU&lt;/a&gt;&lt;a href=&quot;#fnref-2&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[2024년 회고]]></title><description><![CDATA[2024년의 저를 회고합니다. 부끄러움이 많은 한 해를 보냈습니다. 함께의 힘을 알게되었습니다. 그리고 다음 나아갈 길을 확인해 보았습니다.]]></description><link>https://blog.s3ich4n.me/retrospect/2024-12-22-2024-retrospect</link><guid isPermaLink="false">https://blog.s3ich4n.me/retrospect/2024-12-22-2024-retrospect</guid><pubDate>Sun, 22 Dec 2024 18:59:16 GMT</pubDate><content:encoded>&lt;p&gt;이 글은 2024년 한 해를 바라보고, 앞으로의 액션 아이템을 세워보는 게시글입니다.&lt;/p&gt;
&lt;h1 id=&quot;와-세상에-이런-모임이-있네&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%99%80-%EC%84%B8%EC%83%81%EC%97%90-%EC%9D%B4%EB%9F%B0-%EB%AA%A8%EC%9E%84%EC%9D%B4-%EC%9E%88%EB%84%A4&quot; aria-label=&quot;와 세상에 이런 모임이 있네 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;와 세상에 이런 모임이 있네?!&lt;/h1&gt;
&lt;p&gt;오늘은 글또10기 분들과 함께 만나 1년회고를 진행해볼 수 있었습니다. 너무 즐거운 경험이었습니다! 글 쓰는 것 만으로 사람을 만날 수 있었다는 게 너무 좋았어요.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 934px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/6fe84ed1420d15321fb34db3f6d14339/078fe/01.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 63.74999999999999%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB80lEQVQ4y31T2XLaQBDkKxwbEELoAN3S6hYSiBBX5TXlcg4nX5GH5PM7NQ2bolJ2Hkba2Zmd6e7ZnUVxijBKYLs+HC/AfLmm3c9XWK42r9rCsN602e9fP/H95Ruenr/i+csL8qJBpio4rs/CkqSb/M903syPUixMG20/oh+OOH/4iG5/RNXsiUYna3sLpeTJ/kyoiRNEGYqqQ5KV8MMUTTfST/MKbTeirHvU7Z5/VTRIsoIgiqqFKhueixKF2cJYY7V2ePiCckKcFlBly72uP2A/noi6bgfkqmZeWXUs3nQDqmszFtSUpEMY5wymeUlf0LF7WrB4nCoekmaCUmLrjQfNkhrqgpIYRCnRyWCiJKeJFBLLi5qNFGOKzSUuA9R0d0F8KShiFmWLqukxHE4cjlAXhMN44oDkL5SbdkDbH0hb8kVriWs9WdAwbXbbODvqeTtJ8SUuvqxNy4Vle6Qqa9NyuG/ZW/p/KYdRBj9MYHsB3F10pZDQ5NJv/RgPCxN390u8ezBo4mvtZC12pWwhyWt0w4SmblDmF83240QJDtMZ4/E99ZUG3i7iqxLk/95TFpwbG9RlBqVypI9PsKdPcHcx4kRRBkHubkMOSP76mb5aUD538zXOQ4Ai8+GcP2Px+ANukMH1AlKTa3Frmt7tk9MF/wAYq4O5GtgWKAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/6fe84ed1420d15321fb34db3f6d14339/8ac56/01.webp 240w,
/static/6fe84ed1420d15321fb34db3f6d14339/d3be9/01.webp 480w,
/static/6fe84ed1420d15321fb34db3f6d14339/7d4d8/01.webp 934w&quot;
              sizes=&quot;(max-width: 934px) 100vw, 934px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/6fe84ed1420d15321fb34db3f6d14339/8ff5a/01.png 240w,
/static/6fe84ed1420d15321fb34db3f6d14339/e85cb/01.png 480w,
/static/6fe84ed1420d15321fb34db3f6d14339/078fe/01.png 934w&quot;
            sizes=&quot;(max-width: 934px) 100vw, 934px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/6fe84ed1420d15321fb34db3f6d14339/078fe/01.png&quot;
            alt=&quot;회사에서 딴짓한 게 이런 좋은 경험을 만들어 줄 거라곤ㅋㅋㅋ&quot;
            title=&quot;회사에서 딴짓한 게 이런 좋은 경험을 만들어 줄 거라곤ㅋㅋㅋ&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;회사에서 딴짓한 게 이런 좋은 경험을 만들어 줄 거라곤ㅋㅋㅋ&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;결론부터 이야기하자면 너무 행복했습니다. 열정있는 사람과 함께 여러 대화를 나누고 이걸로 함께 한 해를 마무리하다니, 그저 영광이라 생각합니다. 이 자리를 빌어서 다시금 감사하다 말씀드리고 싶네요! 🥰🥰&lt;/p&gt;
&lt;h1 id=&quot;저는-이렇게-살았어요&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A0%80%EB%8A%94-%EC%9D%B4%EB%A0%87%EA%B2%8C-%EC%82%B4%EC%95%98%EC%96%B4%EC%9A%94&quot; aria-label=&quot;저는 이렇게 살았어요 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;저는 이렇게 살았어요&lt;/h1&gt;
&lt;p&gt;그럼 본격적으로 저의 한 해를 돌이켜 보겠습니다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://images.unsplash.com/photo-1592903204858-e288251ad9cc?q=80&amp;#x26;w=3266&amp;#x26;auto=format&amp;#x26;fit=crop&amp;#x26;ixlib=rb-4.0.3&amp;#x26;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&quot; alt=&quot;한번 뒤돌아볼까요.&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;해왔던-것들---회사에서&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%95%B4%EC%99%94%EB%8D%98-%EA%B2%83%EB%93%A4---%ED%9A%8C%EC%82%AC%EC%97%90%EC%84%9C&quot; aria-label=&quot;해왔던 것들   회사에서 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;해왔던 것들 - 회사에서&lt;/h2&gt;
&lt;p&gt;직전 회사에서 나온 후 현 회사에서의 일들을 쭉 살펴본 결과를 보니, 아주 대충 산 건 아니었구나 하는 안도감이 들었습니다. 감사하게도 자리가 생겨서 &lt;a href=&quot;https://pyweb.python.or.kr/talks/talk8/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;발표도 한 번 해보고&lt;/a&gt; 리뷰도 받아볼 수 있었습니다.&lt;/p&gt;
&lt;p&gt;현재 회사는 퇴근 시 오늘 한 일을 모두 쓰는 시스템이 되어있다보니 그걸 적극적으로 활용했습니다. 쓸 때는 너무 귀찮다가도, 미래의 저를 생각했을 때 도움되겠다라 생각하면 쓰겠다던게 벌써 8개월이 지났군요. 잘했다 과거의 나!&lt;/p&gt;
&lt;p&gt;기술적으로는 아래 일들이 핵심이었습니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;기존 레거시와 설계문서를 통해 전면 리뉴얼 완료&lt;/li&gt;
&lt;li&gt;전체 인프라를 네이티브 클라우드 형식으로 전면 리뉴얼 및 IaC 도입&lt;/li&gt;
&lt;li&gt;기존 프로젝트 리팩터링 및 테스트코드 확보&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;기술적인-부분&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B8%B0%EC%88%A0%EC%A0%81%EC%9D%B8-%EB%B6%80%EB%B6%84&quot; aria-label=&quot;기술적인 부분 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;기술적인 부분?&lt;/h3&gt;
&lt;p&gt;암만 생각해도 도무지 개선의 여지가 보이지 않았던 레거시를 버리기로 결정했습니다. 치명적인 버그와 유지보수가 배배꼬인 테이블, 그리고 비협조적으로 나오던 외주처의 태도를 보고 시원하게 던졌습니다. “이거 못 합니다. 제게 맡기시면 정말 잘 만들 수 있습니다.” 하고 자신있게 말했습니다.&lt;/p&gt;
&lt;p&gt;그렇다보니 면접때부터 이야기한 네이티브 클라우드 구성부터, 재설계와 전면 리뉴얼을 진행했습니다. 기존 프로젝트 리팩터링 및 배포도 계속 이어가면서 작업하다보니 효율을 찾기 위해 전에 쓰던 IaC를 도입했습니다. 그러다보니 자연스럽게 테라폼 모듈에서 Terragrunt로 이어지게 되었습니다. 개발서버도 회사 내에서만 접근할 수 있도록 했어야해서요.&lt;/p&gt;
&lt;p&gt;실제 비즈니스 로직을 짜기위해선 기획서부터 먼저 읽어보았습니다. 이후 담당자들이 공통적으로 쓰는 용어를 파악했구요. 파악하고 나서는 용어집으로 만들고 회의를 통해 확정지었지요. 이후 이를 코드화하기 위해 구조를 설계했습니다.&lt;/p&gt;
&lt;p&gt;도메인부터 이를 영속화하는 과정, 그리고 API에 이르기까지 계속해서 생각했습니다. 정답은 없겠지만 오답을 피하기 위한 노력을 계속 했던 것 같습니다. 이 과정이 가장 머리아팠지만 그만큼 재밌었다고 생각합니다.&lt;/p&gt;
&lt;h2 id=&quot;해왔던-것들---개인적으로&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%95%B4%EC%99%94%EB%8D%98-%EA%B2%83%EB%93%A4---%EA%B0%9C%EC%9D%B8%EC%A0%81%EC%9C%BC%EB%A1%9C&quot; aria-label=&quot;해왔던 것들   개인적으로 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;해왔던 것들 - 개인적으로&lt;/h2&gt;
&lt;p&gt;나를 찾는 과정이 가장 컸습니다. 이 것은 아마 평생 갈 일이 아닐까 합니다.&lt;/p&gt;
&lt;p&gt;회사 사람과 언쟁을 높인일이 있었습니다. 블로그와 같이 공개된 자리에서 언급하기엔 너무 부끄럽긴 합니다만, 이를 통해 정말 많은 걸 배워 쓰게 되었습니다.&lt;/p&gt;
&lt;h3 id=&quot;上善若水&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%E4%B8%8A%E5%96%84%E8%8B%A5%E6%B0%B4&quot; aria-label=&quot;上善若水 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;上善若水&lt;/h3&gt;
&lt;p&gt;상선약수(上善若水) 라는 말, 아시나요? 이는 물의 성질을 닮아 다른 사람을 이롭게 하는 삶의 자세를 가리킵니다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;물은 막히면 돌아서 흐르고, 깊으면 채워서 흐르며, 만물을 이롭게 할 뿐 다투지 않습니다.&lt;/p&gt;
&lt;p&gt;물은 언제나 낮은 곳으로 흐르고, 깊은 연못처럼 고요하며, 어질고 선한 사람과 같습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;https://media4.giphy.com/media/O0AEyXviC1vtC/giphy.gif&quot; alt=&quot;上善若水. 물과 같이 되어라는 말은 이런 뜻이 아닐까요?&quot;&gt;&lt;/p&gt;
&lt;p&gt;이는 물의 포용력을 일컫기도 하지만, 물의 단호함을 말하기도 하는 말입니다.&lt;/p&gt;
&lt;p&gt;물은 겉으로는 부드럽고 순응하는 것 같지만, 끊임없이 흐르며 바위도 깎아내는 내면의 강인함을 가지고 있습니다. 이처럼 상선약수는 겸손하고 이로움을 주는 삶의 자세와 함께, 자신의 길을 묵묵히 걸어가는 단호함도 가르치고 있습니다.&lt;/p&gt;
&lt;p&gt;상대의 입장을 헤아리고, 저의 입장을 함께 놓고 판단하여 최선의 결과를 낼 필요가 있습니다. 이 과정을 배웠고, 현재도 이를 실천하고 있습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;의견을 제시합니다&lt;/li&gt;
&lt;li&gt;피드백을 받습니다. 이 때 의사소통에 특히 유의합니다
&lt;ol&gt;
&lt;li&gt;주장과 근거를 함께 제시하며, 자유로운 의사소통이 되게 합니다.&lt;/li&gt;
&lt;li&gt;의견이 다르다면 그에 해당하는 명확한 근거와 데이터로 의사소통합니다. 이견을 최대한 줄이며, 나의 근거를 잘 표현하도록 노력합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;정리된 내용을 해당 내용을 명문화하고 버저닝하여 후에 있을 논쟁을 피합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이렇게 상대방을 경청하고 의견을 존중해야 함께 일할 수 있다 생각합니다. 비록 상대가 그렇지 않더라도 내쪽에서 그리 해야할 것이며, 상대가 존중하려 하지만 내가 그렇지 않은지도 유의해야합니다.&lt;/p&gt;
&lt;p&gt;이것이 올해 배운 가장 중요한 요소입니다.&lt;/p&gt;
&lt;h2 id=&quot;해왔던-것들---읽은-책&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%95%B4%EC%99%94%EB%8D%98-%EA%B2%83%EB%93%A4---%EC%9D%BD%EC%9D%80-%EC%B1%85&quot; aria-label=&quot;해왔던 것들   읽은 책 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;해왔던 것들 - 읽은 책&lt;/h2&gt;
&lt;p&gt;올해는 개발도서의 비중이 유독 높았던 것 같습니다. 그 외 도서들은 생각보다 많이 읽지 않았네요.&lt;/p&gt;
&lt;h3 id=&quot;개발도서&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B0%9C%EB%B0%9C%EB%8F%84%EC%84%9C&quot; aria-label=&quot;개발도서 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;개발도서&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;단위 테스트&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;look-back&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#look-back&quot; aria-label=&quot;look back permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Look back&lt;/h1&gt;
&lt;p&gt;오늘까지 총 &lt;code class=&quot;language-text&quot;&gt;1141&lt;/code&gt;번의 커밋을 했습니다. 이슈 뿐 아니라 PR리뷰, 그리고 실제 커밋 등을 다 해낸 결과입니다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/5bd8c7fc04451205ad3e79225cd7b956/dd507/02.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 28.750000000000004%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABNElEQVQY002Qy2rdQBBEtY+v5iXNSKMZSaPXfeKQmxiDk23AOLv8/7+cRGNIvDh0UzRFVRfDfGY+PbLPfjqR1hvjcqHUDZ9EzYO0PKgPSPtPO+iGuh0yVTsg646ijUs28P1CN6zEdKQNM6aO+dDYiDIeZTqU9FR1n3WhPJWJuDbhfMJ1CVl5im7csru2AeP6jLIBd11w9yP1MqHjgJ4S9nnDXVaq24p9WnHftqyrzwtVGHOrIoxHhPHoPYkNqCogY4952WjfrsjvG+JxQnyZMT9PqK8L+veN5tcV/Xrm8GOlvM+U5xFRe4qPyXaqZkA1EX0asc8LMkbEGBFDRLYBtXOf0JcRsyTKdUBvCeUjpWnfDa1P1H7MNGGicj0H4TKlbP6jmlyr3HXR5D+LrqPe0vv+1/APPRydbNY6/qoAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/5bd8c7fc04451205ad3e79225cd7b956/8ac56/02.webp 240w,
/static/5bd8c7fc04451205ad3e79225cd7b956/d3be9/02.webp 480w,
/static/5bd8c7fc04451205ad3e79225cd7b956/e46b2/02.webp 960w,
/static/5bd8c7fc04451205ad3e79225cd7b956/f992d/02.webp 1440w,
/static/5bd8c7fc04451205ad3e79225cd7b956/2be02/02.webp 1528w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/5bd8c7fc04451205ad3e79225cd7b956/8ff5a/02.png 240w,
/static/5bd8c7fc04451205ad3e79225cd7b956/e85cb/02.png 480w,
/static/5bd8c7fc04451205ad3e79225cd7b956/d9199/02.png 960w,
/static/5bd8c7fc04451205ad3e79225cd7b956/07a9c/02.png 1440w,
/static/5bd8c7fc04451205ad3e79225cd7b956/dd507/02.png 1528w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/5bd8c7fc04451205ad3e79225cd7b956/d9199/02.png&quot;
            alt=&quot;1141 commitments&quot;
            title=&quot;1141 commitments&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;1141 commitments&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;많고 적음에 따라 한 조직에 정신놓고 이렇게 기여해본 것은 감사할 일입니다. 어떤 조직에서든 소프트웨어 엔지니어로서 이렇게 일할 수 있단 점에 감사히 생각하고 있습니다. 보다 더 나은 소프트웨어로 만들기 위한 여정은 더 멀지만, 언젠가 먼저 걸은 이 길이 참 밝은 횃불이었다는 평을 받고싶습니다.&lt;/p&gt;
&lt;h1 id=&quot;and-look-forward&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#and-look-forward&quot; aria-label=&quot;and look forward permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;…and Look forward!&lt;/h1&gt;
&lt;p&gt;그렇다면 앞으로의 저를 위해 무엇을 하면 좋을지 생각해봤습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;도메인 주도 설계에 대한 면밀한 이해&lt;/li&gt;
&lt;li&gt;운동하기&lt;/li&gt;
&lt;li&gt;파이썬 딥다이브 하기&lt;/li&gt;
&lt;li&gt;자바로 이사갈 준비를 사이드 프로젝트로 하기&lt;/li&gt;
&lt;li&gt;물과 같이 되려하기&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;결국 “문제를 풀기위한 사람”이 되기 위해 내가 다루는 도구와 언어를 공부하고, 외적으로든 내적으로든 준비해야겠다는 것이 되겠네요.&lt;/p&gt;
&lt;h2 id=&quot;도메인-주도-설계에-대한-면밀한-이해&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8F%84%EB%A9%94%EC%9D%B8-%EC%A3%BC%EB%8F%84-%EC%84%A4%EA%B3%84%EC%97%90-%EB%8C%80%ED%95%9C-%EB%A9%B4%EB%B0%80%ED%95%9C-%EC%9D%B4%ED%95%B4&quot; aria-label=&quot;도메인 주도 설계에 대한 면밀한 이해 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;도메인 주도 설계에 대한 면밀한 이해&lt;/h2&gt;
&lt;p&gt;올해 도메인 기반 주도 설계의 사실과 오해 라는 강의를 참석한 적이 있습니다.&lt;/p&gt;
&lt;p&gt;조영호님께 DDD는 방법론인가요? 라는 질문을 던졌는데요. 그 분이 답변하시기로,&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;DDD는 방법론&lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;이 아니라, 디자인 패턴과 같은 일련의 PATTERN LANGUAGE 입니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;라는 답변을 주셨습니다. 추측컨대 DDD는 오직 소프트웨어로 가치창출을 하기 위한 도구로서 받아들이라는 말씀으로 이해했어요. 이렇게 해석한다면 8시간 내도록 강조하신 말을 함축된다고 이해했기 때문이지요. 흔히 하는 오해로, ‘DDD’를 도입하기 위해 프로젝트를 바꾸었다, 내지는 DDD를 하느라고 일정이 딜레이됐다 라는 것이 나오면 안된다는 것이지요. 요구사항을 보다 빠르고 기민하게 대응하기 위한 전술∙전략 이기 때문이지요.&lt;/p&gt;
&lt;h2 id=&quot;운동하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9A%B4%EB%8F%99%ED%95%98%EA%B8%B0&quot; aria-label=&quot;운동하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;운동하기&lt;/h2&gt;
&lt;p&gt;인간은 태어나고 죽기까지 노화합니다. 건강하게 살기 위해선 운동이 필수라는 것을 깨달았습니다. 오늘 모임에 열심히 운동하셔서 자존감과 건강해짐을 받았다는 분을 보고 깨달았습니다.&lt;/p&gt;
&lt;p&gt;&lt;del&gt;왜 사람은 직접 경험해야 아는걸까요&lt;/del&gt;&lt;/p&gt;
&lt;h2 id=&quot;파이썬-자바-둘-다를-하겠다고&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%8C%8C%EC%9D%B4%EC%8D%AC-%EC%9E%90%EB%B0%94-%EB%91%98-%EB%8B%A4%EB%A5%BC-%ED%95%98%EA%B2%A0%EB%8B%A4%EA%B3%A0&quot; aria-label=&quot;파이썬 자바 둘 다를 하겠다고 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;파이썬, 자바 둘 다를 하겠다고?&lt;/h2&gt;
&lt;p&gt;물론 욕심이죠. 하지만 그 언어가 메인이 되는 순간에는 그 언어에 집중해야한다고 봅니다. 그런 뜻에서 사이드 프로젝트를 풀고, 파이썬 딥다이브도 함께 이어가야 하지 않을까 라고 생각합니다. 2025년에는 이런 게시글로도 여러분과 만나뵐 수 있을 것 같습니다.&lt;/p&gt;
&lt;h1 id=&quot;끝으로&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%81%9D%EC%9C%BC%EB%A1%9C&quot; aria-label=&quot;끝으로 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;끝으로&lt;/h1&gt;
&lt;p&gt;내년의 저는 과연 어떤 리뷰를 쓰게될까요?&lt;/p&gt;
&lt;p&gt;기대됩니다.&lt;/p&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;&lt;strong&gt;교조적인 의미&lt;/strong&gt;에서 쓰이는 방법론을 의미하는 것으로 보입니다.&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[[연재] 파이썬 컨테이너 선택 제 3형 - 파이썬 컨테이너 실전비교]]></title><description><![CDATA[파이썬 컨테이너 최적화 기법을 이용하여 CPU bound 작업과 IO bound 작업을 직접 구동해봅니다.]]></description><link>https://blog.s3ich4n.me/devlog/python/2024-11-24-python-container-101-pt03</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/python/2024-11-24-python-container-101-pt03</guid><pubDate>Sun, 24 Nov 2024 23:57:00 GMT</pubDate><content:encoded>&lt;p&gt;이번 게시글에서는 Debian 기반의 컨테이너와 Alpine 기반의 컨테이너 간 성능을 비교해보도록 하겠습니다.&lt;/p&gt;
&lt;p&gt;지난 게시글의 소개와는 다르게, 구동 시간이 너무 오래걸려 본 게시글에는 테스트 방안을 “소개”하고, 글을 수정하여 보강할 예정입니다. 벌써부터 이렇게 말씀드리는 점 양해 부탁드립니다. 🙇🙇&lt;/p&gt;
&lt;p&gt;아래와 같이 변경될 예정입니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;I/O bound 태스크 중심: &lt;del&gt;API 서비스를 만들고&lt;/del&gt;, DB에는 10만 개의 데이터를 추가한 후, 쿼리 테스트 &lt;del&gt;및 부하 테스트를&lt;/del&gt; 수행하여 성능을 리포트&lt;/li&gt;
&lt;li&gt;CPU bound 태스크 중심: K-means clustering 과 랜덤 포레스트 기법 &lt;del&gt;과 SVD 연산(준비만 되어있습니다!)&lt;/del&gt; 을 사용하여 &lt;del&gt;매우 큰 데이터를 pandas로 처리, matplotlib으로 연산하게 구성해보고&lt;/del&gt; CPU, 메모리 사용량을 리포트&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;그렇다면, 목표와 가설을 세우고, 준비 후 직접 실험해봅시다!&lt;/p&gt;
&lt;h1 id=&quot;목표&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AA%A9%ED%91%9C&quot; aria-label=&quot;목표 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;strong&gt;목표&lt;/strong&gt;&lt;/h1&gt;
&lt;p&gt;파이썬으로 작성한 cpu bound task와 io bound task 를 각각 컨테이너화 했을 때, glibc, musl 구현체의 성능 벤치마킹을 통해 적절한 구현체가 무엇인지 파악해봅시다.&lt;/p&gt;
&lt;h1 id=&quot;가설&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B0%80%EC%84%A4&quot; aria-label=&quot;가설 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;strong&gt;가설&lt;/strong&gt;&lt;/h1&gt;
&lt;p&gt;이번 실험을 통해 세운 가설은 아래와 같습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;glibc, musl은 cpu bound task, io bound task 별로 성능차이가 있을 것입니다.
&lt;ul&gt;
&lt;li&gt;근거: 여러 작업(precondition, postcondition 이나 실제 구현체 이용)을 많이 하면 각 구현체별 성능차가 있을 것이기 때문입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;준비&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A4%80%EB%B9%84&quot; aria-label=&quot;준비 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;strong&gt;준비&lt;/strong&gt;&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;c 라이브러리 구현체 선택
&lt;ul&gt;
&lt;li&gt;앞어 설명드린 바 대로, C 라이브러리의 구현체는 glibc/musl 이 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;저희는 2부에서 설명드린 바와 같이, 도커 컨테이너를 아래와 같이 선택하기로 했습니다
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;glibc&lt;/code&gt; C 라이브러리 기반의 운영체제 이미지&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;musl&lt;/code&gt; C 라이브러리 기반의 운영체제 이밎&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;성능을 가리는 조건은 두가지로 한정짓습니다.
&lt;ol&gt;
&lt;li&gt;cpu bound
&lt;ul&gt;
&lt;li&gt;cpu를 많이 쓰는 태스크 (cpu 연산 그 자체)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;io bound
&lt;ul&gt;
&lt;li&gt;io작업이 많은 태스크 (E.g., 서버 업/다운로드, db 콜)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;해당 코드를 구동하는 환경은 아래와 같습니다
&lt;ol&gt;
&lt;li&gt;(로컬 테스트) - M3 Pro 맥북
&lt;ul&gt;
&lt;li&gt;단 docker compose로 cpu, ram usage를 일부 차단.&lt;/li&gt;
&lt;li&gt;CPU는 최대 &lt;code class=&quot;language-text&quot;&gt;6&lt;/code&gt;개를, memory는 최대 &lt;code class=&quot;language-text&quot;&gt;8GB&lt;/code&gt; 를 할당&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;(&lt;strong&gt;예정&lt;/strong&gt;, 실제 환경과 유사한 테스트) - GitHub Actions&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;cpu-bound-작업을-선별합시다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#cpu-bound-%EC%9E%91%EC%97%85%EC%9D%84-%EC%84%A0%EB%B3%84%ED%95%A9%EC%8B%9C%EB%8B%A4&quot; aria-label=&quot;cpu bound 작업을 선별합시다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;CPU bound 작업을 선별합시다&lt;/h2&gt;
&lt;p&gt;CPU bound 태스크를 테스트하기 위해, 랜덤 포레스트와 K-means clustering을 각각 구동해보기로 했습니다. 선정한 이유는 아래와 같습니다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;여러 복합적인 연산을 수행하기 위해 CPython 구현체나 C 코드로 빌드된 코드를 사용함으로 인해 발생하는 성능차이가 분명히 있을 것이라고 생각했기 때문입니다.&lt;/li&gt;
&lt;li&gt;단순 연산(소수 구하기, 해쉬연산 지속적으로 수행하기)는 CPU 레벨에서 최적화되어 인터프리트 되면 크게 의미없다고 판단했기 때문입니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;따라서, 이에 맞게 각종 머신러닝 기법을 진짜 “맛만보는” 코드를 작성했습니다. 아래는 각 내용에 대한 간략한 설명입니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;랜덤 포레스트
&lt;ul&gt;
&lt;li&gt;다량의 서로 다른 샘플과 특성이 반영된 decision tree를 구성합니다.&lt;/li&gt;
&lt;li&gt;트리 연산은 병렬로 수행하고, 결과값은 다수결로/평균값으로 도출됩니다.&lt;/li&gt;
&lt;li&gt;overfitting(과적합)을 방지하는 앙상블 방법이므로 상대적인 연산이 많을 것으로 판단하여 채택하였습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;k-means clustering
&lt;ul&gt;
&lt;li&gt;k-means - 비지도 학습(unsupervised learning) 알고리즘 - 을 기반으로 한 클러스터링 알고리즘 입니다.&lt;/li&gt;
&lt;li&gt;데이터 포인트들을 K개의 그룹(클러스터)으로 나눕니다.&lt;/li&gt;
&lt;li&gt;비슷한 특성을 가진 데이터끼리 같은 그룹으로 묶습니다&lt;/li&gt;
&lt;li&gt;“비슷하다”의 기준은 데이터 포인트 간의 거리 (주로 유클리드 거리 사용) 계산입니다.&lt;/li&gt;
&lt;li&gt;연산이 많을 것으로 판단하여 채택하였습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;io-bound-작업을-선별합니다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#io-bound-%EC%9E%91%EC%97%85%EC%9D%84-%EC%84%A0%EB%B3%84%ED%95%A9%EB%8B%88%EB%8B%A4&quot; aria-label=&quot;io bound 작업을 선별합니다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;IO bound 작업을 선별합니다.&lt;/h2&gt;
&lt;p&gt;아래와 같이 테이블 구성을 구성합니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;유저 테이블을 구성합니다&lt;/li&gt;
&lt;li&gt;이 테이블의 uuid 값을 fk로 쓰는 테이블을 아래와 같이 구성
&lt;ul&gt;
&lt;li&gt;‘유저 개인정보’&lt;/li&gt;
&lt;li&gt;‘유저 프로필 정보’&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;최대 10만개의 데이터를 추가, 랜덤하게 데이터를 1000개씩 쿼리하여, 성능을 비교&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;작업-순서&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9E%91%EC%97%85-%EC%88%9C%EC%84%9C&quot; aria-label=&quot;작업 순서 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;strong&gt;작업 순서&lt;/strong&gt;&lt;/h1&gt;
&lt;p&gt;여기서부터는 작성한 코드를 참고해주세요. 코드는 &lt;a href=&quot;https://github.com/AmidCode/geultto_10_4th&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 github 링크&lt;/a&gt; 에 준비되어 있습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;컨테이너 만들기
&lt;ol&gt;
&lt;li&gt;debian based&lt;/li&gt;
&lt;li&gt;alpine based&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;cpu bound task를 수행하는 코드 작성하기
&lt;ol&gt;
&lt;li&gt;random forest를 병렬 작업하는 코드&lt;/li&gt;
&lt;li&gt;k-means clustering을 병렬 작업하는 코드&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;io bound task를 수행하는 코드 작성하기
&lt;ol&gt;
&lt;li&gt;10만 건의 유저 데이터(하위 테이블 포함)를 추가하고, 개별 유저에 대해 개인정보를 추가하여 쿼리를 수행&lt;/li&gt;
&lt;li&gt;유저를 1000명씩 임의로 쿼리 수행&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;python 버전, 태스크 별로 각각 테스트 수행 - Docker Compose 파일로 개별 실행이 가능하게 구성하기&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;리뷰-1&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A6%AC%EB%B7%B0-1&quot; aria-label=&quot;리뷰 1 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;strong&gt;리뷰 (1)&lt;/strong&gt;&lt;/h1&gt;
&lt;p&gt;하지만 작업 중간에, 아래와 같은 리뷰사항을 받고 태스크의 내용을 한 번 수정했습니다. 확실히 조사가 필요한 부분 및 보강이 가능한 부분에 대해 다듬었습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;cpu bound task 보완&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;데이터셋 크기, 하이퍼 파라미터는 수행 전 별도로 기재하여 실험상에 어떻게 쓰였는지 글로 작성&lt;/li&gt;
&lt;li&gt;멀티 프로세싱을 고려해야하나? - 현재는 포기
&lt;ul&gt;
&lt;li&gt;(“확실한” 조사 필요) 파이썬에서 이런 태스크가 GIL이 처리하려면 &lt;code class=&quot;language-text&quot;&gt;n_jobs&lt;/code&gt; 파라미터 만으로 처리가능한지&lt;/li&gt;
&lt;li&gt;(“확실한” 조사 필요) 이걸 컨테이너로 처리하면 환경변수로 처리하고, 개별 컨테이너 별 부여받은 최대 CPU만큼 쓰면 되는지&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;io bound task 보완&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;rdbms는 postgres 15버전 사용 예정.&lt;/li&gt;
&lt;li&gt;&lt;del&gt;커넥션 풀링은 sqlalchemy의 기본 사용량을 써보고, 너무 처참한 p95 값이 나오면 (1초 이상) 조절 예정&lt;/del&gt; (API로 부하 테스트까지 해보는 것이 목표입니다만, 거기까지는 아직 진행을 못했습니다.. 🥲)&lt;/li&gt;
&lt;li&gt;쿼리 유형 다각화
&lt;ul&gt;
&lt;li&gt;실질적으로 많이 일어나는건 쿼리이기 때문에, 이는 포기할 수 없는 과정이라 생각했습니다.&lt;/li&gt;
&lt;li&gt;db에 추가하는 건 테스트 데이터 준비과정이기에 쿼리의 성능을 살펴보는 것이 중요할 것으로 판단했습니다.&lt;/li&gt;
&lt;li&gt;복잡한 쿼리에 대해 구성해보고 테스트해보는 것이 목표입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;실제-실험결과&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%8B%A4%EC%A0%9C-%EC%8B%A4%ED%97%98%EA%B2%B0%EA%B3%BC&quot; aria-label=&quot;실제 실험결과 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;strong&gt;실제 실험결과&lt;/strong&gt;&lt;/h1&gt;
&lt;p&gt;실험 결과는 아래와 같으며, CPU bound 부터 소개하고 이어서 IO bound 를 소개합니다.&lt;/p&gt;
&lt;h2 id=&quot;cpu-bound-태스크의-결과-1---k-means-clustering&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#cpu-bound-%ED%83%9C%EC%8A%A4%ED%81%AC%EC%9D%98-%EA%B2%B0%EA%B3%BC-1---k-means-clustering&quot; aria-label=&quot;cpu bound 태스크의 결과 1   k means clustering permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;CPU bound 태스크의 결과 (1) - K-means clustering&lt;/h2&gt;
&lt;p&gt;아래와 같은 전제조건을 취했습니다. 코드는 &lt;a href=&quot;https://github.com/AmidCode/geultto_10_4th/blob/main/third/cpu/01_kmeans.py&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;여기&lt;/a&gt;를 살펴봐주세요.&lt;/p&gt;
&lt;h3 id=&quot;전제조건&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A0%84%EC%A0%9C%EC%A1%B0%EA%B1%B4&quot; aria-label=&quot;전제조건 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;전제조건&lt;/h3&gt;
&lt;p&gt;데이터셋 조건&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;샘플 수: [100,000, 500,000] (n_samples=[100_000, 500_000])&lt;/li&gt;
&lt;li&gt;특성 수: 128차원 (n_features=128)&lt;/li&gt;
&lt;li&gt;make_blobs로 생성된 클러스터링 데이터&lt;/li&gt;
&lt;li&gt;고정된 랜덤 시드: 42 (random_state=42)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;모델 설정&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;클러스터 수: [5, 7] (n_clusters=[5, 7])&lt;/li&gt;
&lt;li&gt;초기화 횟수: 10회 (n_init=10)&lt;/li&gt;
&lt;li&gt;최대 반복 횟수: 300회 (max_iter=300)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;측정 항목&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;실행 시간 (Execution time)&lt;/li&gt;
&lt;li&gt;반복 횟수 (Iterations)&lt;/li&gt;
&lt;li&gt;Inertia (클러스터 내 거리 제곱합)&lt;/li&gt;
&lt;li&gt;CPU 사용률 (평균, 최대)&lt;/li&gt;
&lt;li&gt;메모리 사용률 (평균, 최대)&lt;/li&gt;
&lt;li&gt;리소스 모니터링 주기: 100ms (time.sleep(0.1))&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;재현성 보장&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;데이터셋과 모델 모두 랜덤 시드 42로 고정&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;결과&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B2%B0%EA%B3%BC&quot; aria-label=&quot;결과 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;결과&lt;/h3&gt;
&lt;p&gt;Alpine 기반의 컨테이너로 K-means clustering 로직을 구동해본 결과는 아래와 같았습니다:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;🍅 disclaimer&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;scikit-learn&lt;/code&gt; 의 공식 지원이 3.12 까지라, Alpine 리눅스에서는 3.13 베이스 이미지에서 구동이 어려웠습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th align=&quot;right&quot;&gt;Samples&lt;/th&gt;
&lt;th align=&quot;right&quot;&gt;Clusters&lt;/th&gt;
&lt;th align=&quot;right&quot;&gt;Execution Time (s)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;3.12&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;1,000,000&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;3&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;5.50&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;3.12&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;1,000,000&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;5&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;4.81&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;3.12&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;5,000,000&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;3&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;11.90&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;3.12&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;5,000,000&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;5&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;12.71&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Debian 기반의 컨테이너로 K-means clustering 로직을 구동해본 결과는 아래와 같았습니다:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th align=&quot;right&quot;&gt;Samples&lt;/th&gt;
&lt;th align=&quot;right&quot;&gt;Clusters&lt;/th&gt;
&lt;th align=&quot;right&quot;&gt;Execution Time (s)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;3.12&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;1,000,000&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;3&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;4.72&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;3.12&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;1,000,000&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;5&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;4.90&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;3.12&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;5,000,000&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;3&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;10.37&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;3.12&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;5,000,000&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;5&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;12.18&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;3.13&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;100,000&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;5&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;2.74&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;3.13&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;100,000&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;7&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;3.50&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;3.13&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;500,000&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;5&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;6.92&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;3.13&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;500,000&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;7&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;6.92&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;details&gt;
&lt;summary&gt;베이스 이미지 - Alpine 3.12 의 작업결과&lt;/summary&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;log&quot;&gt;&lt;pre class=&quot;language-log&quot;&gt;&lt;code class=&quot;language-log&quot;&gt;Running benchmark for &lt;span class=&quot;token number&quot;&gt;1000000&lt;/span&gt; samples&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; clusters&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

&lt;span class=&quot;token property&quot;&gt;Execution time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5.50&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Iterations:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Inertia:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;128018685.50&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Average CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;801.99&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Average Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;12.59&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Peak CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1261.70&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Peak Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;17.07&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
Running benchmark for &lt;span class=&quot;token number&quot;&gt;1000000&lt;/span&gt; samples&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; clusters&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Execution time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4.81&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Iterations:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Inertia:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;128018441.10&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Average CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1014.51&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Average Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;23.78&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Peak CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1206.10&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Peak Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;28.70&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
Running benchmark for &lt;span class=&quot;token number&quot;&gt;5000000&lt;/span&gt; samples&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; clusters&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Execution time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;11.90&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Iterations:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Inertia:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;640003227.45&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Average CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;723.35&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Average Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;69.71&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Peak CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1208.10&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Peak Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;92.17&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
Running benchmark for &lt;span class=&quot;token number&quot;&gt;5000000&lt;/span&gt; samples&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; clusters&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Execution time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;12.71&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Iterations:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Inertia:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;640002946.03&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Average CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;945.65&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Average Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;64.20&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Peak CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1206.70&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Peak Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;90.08&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Plotting Data Summary:&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Dataset Size:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1000000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Clusters&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Execution Time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5.50s&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;52&lt;/span&gt; points&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Range&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1261.7&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;52&lt;/span&gt; points&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Range&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;6.5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;17.1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Dataset Size:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1000000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Clusters&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Execution Time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4.81s&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;47&lt;/span&gt; points&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Range&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;93.4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1206.1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;47&lt;/span&gt; points&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Range&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;18.0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;28.7&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Dataset Size:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5000000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Clusters&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Execution Time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;11.90s&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;112&lt;/span&gt; points&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Range&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;47.9&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1208.1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;112&lt;/span&gt; points&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Range&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;37.9&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;92.2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Dataset Size:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5000000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Clusters&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Execution Time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;12.71s&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;121&lt;/span&gt; points&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Range&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;86.0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1206.7&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;121&lt;/span&gt; points&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Range&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;35.7&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;90.1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/details&gt;
&lt;details&gt;
&lt;summary&gt;(수행불가) 베이스 이미지 - Alpine 3.13 의 작업결과&lt;/summary&gt;
&lt;p&gt;구동 불가!&lt;/p&gt;
&lt;/details&gt;
&lt;details&gt;
&lt;summary&gt;베이스 이미지 - Debian 3.12 의 작업결과&lt;/summary&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;log&quot;&gt;&lt;pre class=&quot;language-log&quot;&gt;&lt;code class=&quot;language-log&quot;&gt;Running benchmark for &lt;span class=&quot;token number&quot;&gt;1000000&lt;/span&gt; samples&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; clusters&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Execution time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4.72&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Iterations:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Inertia:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;128018685.50&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Average CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;907.44&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Average Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;12.71&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Peak CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1199.30&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Peak Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;17.33&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
Running benchmark for &lt;span class=&quot;token number&quot;&gt;1000000&lt;/span&gt; samples&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; clusters&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Execution time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4.90&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Iterations:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Inertia:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;128018441.10&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Average CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1044.18&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Average Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;12.94&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Peak CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1218.20&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Peak Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;18.36&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
Running benchmark for &lt;span class=&quot;token number&quot;&gt;5000000&lt;/span&gt; samples&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; clusters&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Execution time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10.37&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Iterations:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Inertia:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;640003227.45&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Average CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;793.64&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Average Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;59.11&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Peak CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1208.20&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Peak Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;83.59&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
Running benchmark for &lt;span class=&quot;token number&quot;&gt;5000000&lt;/span&gt; samples&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; clusters&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Execution time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;12.18&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Iterations:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Inertia:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;640002946.03&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Average CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;959.31&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Average Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;57.18&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Peak CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1210.40&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Peak Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;83.59&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Plotting Data Summary:&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Dataset Size:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1000000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Clusters&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Execution Time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4.72s&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;46&lt;/span&gt; points&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Range&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1199.3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;46&lt;/span&gt; points&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Range&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;6.5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;17.3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Dataset Size:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1000000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Clusters&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Execution Time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4.90s&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;48&lt;/span&gt; points&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Range&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;93.4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1218.2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;48&lt;/span&gt; points&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Range&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;7.5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;18.4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Dataset Size:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5000000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Clusters&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Execution Time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10.37s&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt; points&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Range&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;96.5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1208.2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt; points&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Range&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;29.2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;83.6&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Dataset Size:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5000000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Clusters&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Execution Time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;12.18s&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;118&lt;/span&gt; points&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Range&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;88.9&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1210.4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;118&lt;/span&gt; points&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Range&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;29.2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;83.6&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/details&gt;
&lt;details&gt;
&lt;summary&gt;베이스 이미지 - Debian 3.13 의 작업결과&lt;/summary&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;log&quot;&gt;&lt;pre class=&quot;language-log&quot;&gt;&lt;code class=&quot;language-log&quot;&gt;Running benchmark for &lt;span class=&quot;token number&quot;&gt;100000&lt;/span&gt; samples&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; clusters&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Execution time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2.74&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Iterations:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Inertia:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;12800855.22&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Average CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;392.67&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Average Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2.48&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Peak CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;536.20&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Peak Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2.52&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
Running benchmark for &lt;span class=&quot;token number&quot;&gt;100000&lt;/span&gt; samples&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt; clusters&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Execution time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3.50&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Iterations:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Inertia:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;12800608.95&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Average CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;400.08&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Average Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2.50&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Peak CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;564.40&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Peak Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2.52&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
Running benchmark for &lt;span class=&quot;token number&quot;&gt;500000&lt;/span&gt; samples&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; clusters&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Execution time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6.92&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Iterations:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Inertia:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;64009635.94&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Average CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;366.32&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Average Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;7.00&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Peak CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;671.20&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Peak Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;9.58&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
Running benchmark for &lt;span class=&quot;token number&quot;&gt;500000&lt;/span&gt; samples&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt; clusters&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Execution time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6.92&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Iterations:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Inertia:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;64009455.56&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Average CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;382.56&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Average Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6.93&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Peak CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;601.80&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Peak Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;7.32&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Plotting Data Summary:&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Dataset Size:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Clusters&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Execution Time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2.74s&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;26&lt;/span&gt; points&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Range&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;536.2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;26&lt;/span&gt; points&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Range&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1.7&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2.5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Dataset Size:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Clusters&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Execution Time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3.50s&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;33&lt;/span&gt; points&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Range&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;157.3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;564.4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;33&lt;/span&gt; points&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Range&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2.0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2.5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Dataset Size:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;500000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Clusters&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Execution Time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6.92s&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;64&lt;/span&gt; points&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Range&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;97.0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;671.2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;64&lt;/span&gt; points&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Range&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4.1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;9.6&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Dataset Size:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;500000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Clusters&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Execution Time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6.92s&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;CPU Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;65&lt;/span&gt; points&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Range&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;95.2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;601.8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Memory Usage:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;65&lt;/span&gt; points&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Range&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4.3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;7.3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/details&gt;
&lt;h2 id=&quot;cpu-bound-태스크의-결과-2---random-forest&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#cpu-bound-%ED%83%9C%EC%8A%A4%ED%81%AC%EC%9D%98-%EA%B2%B0%EA%B3%BC-2---random-forest&quot; aria-label=&quot;cpu bound 태스크의 결과 2   random forest permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;CPU bound 태스크의 결과 (2) - Random forest&lt;/h2&gt;
&lt;h3 id=&quot;전제조건-1&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A0%84%EC%A0%9C%EC%A1%B0%EA%B1%B4-1&quot; aria-label=&quot;전제조건 1 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;전제조건&lt;/h3&gt;
&lt;p&gt;아래와 같은 전제조건을 취했습니다. 코드는 &lt;a href=&quot;https://github.com/AmidCode/geultto_10_4th/blob/main/third/cpu/02_random_forest.py&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;여기&lt;/a&gt;를 살펴봐주세요.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;데이터셋 조건&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;샘플 수: 100,000개 (n_samples=100000)&lt;/li&gt;
&lt;li&gt;특성 수: 100개 (n_features=100)&lt;/li&gt;
&lt;li&gt;무작위 정규분포로 생성된 특성 데이터 (np.random.randn)&lt;/li&gt;
&lt;li&gt;이진 분류용 레이블 (0 또는 1, np.random.randint(0, 2))&lt;/li&gt;
&lt;li&gt;고정된 랜덤 시드: 42 (random_state=42)&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;모델 설정&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;트리 개수 변화: [1, 2, 5, 10, 25, 50, 100]&lt;/li&gt;
&lt;li&gt;모든 CPU 코어 사용 (n_jobs=-1)&lt;/li&gt;
&lt;li&gt;모델의 랜덤 시드: 42&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;측정 항목&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;학습 시간 (Training time)&lt;/li&gt;
&lt;li&gt;예측 시간 (Prediction time)&lt;/li&gt;
&lt;li&gt;총 수행 시간 (Total time = Training + Prediction)&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;재현성 보장&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;numpy 랜덤 시드와 모델의 랜덤 시드를 모두 42로 고정하여 실험의 재현성 확보&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;결과-1&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B2%B0%EA%B3%BC-1&quot; aria-label=&quot;결과 1 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;결과&lt;/h3&gt;
&lt;p&gt;Alpine 기반의 컨테이너로 Random forest 로직을 구동해본 결과는 아래와 같았습니다:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th align=&quot;right&quot;&gt;Trees&lt;/th&gt;
&lt;th align=&quot;right&quot;&gt;Training (s)&lt;/th&gt;
&lt;th align=&quot;right&quot;&gt;Prediction (s)&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;Total (s)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;3.12&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;1&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;1.87&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;0.02&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;1.89&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;3.12&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;10&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;5.98&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;0.06&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;6.04&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;3.12&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;100&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;46.62&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;0.44&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;47.06&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;3.13&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;1&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;2.40&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;0.03&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;2.43&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;3.13&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;10&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;6.16&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;0.07&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;6.23&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;3.13&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;100&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;48.25&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;0.53&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;48.78&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Debian 기반의 컨테이너로 Random forest 로직을 구동해본 결과는 아래와 같았습니다:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;th align=&quot;right&quot;&gt;Trees&lt;/th&gt;
&lt;th align=&quot;right&quot;&gt;Training (s)&lt;/th&gt;
&lt;th align=&quot;right&quot;&gt;Prediction (s)&lt;/th&gt;
&lt;th align=&quot;center&quot;&gt;Total (s)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;3.12&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;1&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;1.93&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;0.02&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;1.96&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;3.12&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;10&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;5.93&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;0.07&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;6.00&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;3.12&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;100&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;46.82&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;0.42&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;47.24&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;3.13&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;1&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;2.35&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;0.03&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;2.38&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;3.13&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;10&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;6.34&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;0.10&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;6.44&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;3.13&lt;/code&gt;&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;100&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;49.17&lt;/td&gt;
&lt;td align=&quot;right&quot;&gt;0.49&lt;/td&gt;
&lt;td align=&quot;center&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;49.66&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;details&gt;
&lt;summary&gt;베이스 이미지 - Alpine 3.12 의 작업결과&lt;/summary&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;log&quot;&gt;&lt;pre class=&quot;language-log&quot;&gt;&lt;code class=&quot;language-log&quot;&gt;&lt;span class=&quot;token property&quot;&gt;Dataset generated:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100000&lt;/span&gt; samples with &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt; features

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1.87&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.02&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1.89&lt;/span&gt; seconds

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1.92&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.03&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1.95&lt;/span&gt; seconds

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3.51&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.05&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3.56&lt;/span&gt; seconds

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5.98&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.06&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6.04&lt;/span&gt; seconds

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;25&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;11.93&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.14&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;12.07&lt;/span&gt; seconds

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;22.90&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.24&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;23.14&lt;/span&gt; seconds

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;46.62&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.44&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;47.06&lt;/span&gt; seconds

&lt;span class=&quot;token property&quot;&gt;Summary:&lt;/span&gt;
 Trees   Train&lt;span class=&quot;token operator&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;token operator&quot;&gt;)&lt;/span&gt; Predict&lt;span class=&quot;token operator&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;token operator&quot;&gt;)&lt;/span&gt;   Total&lt;span class=&quot;token operator&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;token operator&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token separator comment&quot;&gt;----------------------------------------&lt;/span&gt;
     &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;1.87&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.02&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;1.89&lt;/span&gt;
     &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;1.92&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.03&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;1.95&lt;/span&gt;
     &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;3.51&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.05&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;3.56&lt;/span&gt;
    &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;5.98&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.06&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;6.04&lt;/span&gt;
    &lt;span class=&quot;token number&quot;&gt;25&lt;/span&gt;      &lt;span class=&quot;token number&quot;&gt;11.93&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.14&lt;/span&gt;      &lt;span class=&quot;token number&quot;&gt;12.07&lt;/span&gt;
    &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt;      &lt;span class=&quot;token number&quot;&gt;22.90&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.24&lt;/span&gt;      &lt;span class=&quot;token number&quot;&gt;23.14&lt;/span&gt;
   &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;      &lt;span class=&quot;token number&quot;&gt;46.62&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.44&lt;/span&gt;      &lt;span class=&quot;token number&quot;&gt;47.06&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/details&gt;
&lt;details&gt;
&lt;summary&gt;베이스 이미지 - Alpine 3.13 의 작업결과&lt;/summary&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;log&quot;&gt;&lt;pre class=&quot;language-log&quot;&gt;&lt;code class=&quot;language-log&quot;&gt;&lt;span class=&quot;token property&quot;&gt;Dataset generated:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100000&lt;/span&gt; samples with &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt; features

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2.40&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.03&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2.43&lt;/span&gt; seconds

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2.32&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.05&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2.37&lt;/span&gt; seconds

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4.15&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.08&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4.23&lt;/span&gt; seconds

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6.16&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.07&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6.23&lt;/span&gt; seconds

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;25&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;12.64&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.15&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;12.80&lt;/span&gt; seconds

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;24.41&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.27&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;24.68&lt;/span&gt; seconds

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;48.25&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.53&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;48.78&lt;/span&gt; seconds

&lt;span class=&quot;token property&quot;&gt;Summary:&lt;/span&gt;
 Trees   Train&lt;span class=&quot;token operator&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;token operator&quot;&gt;)&lt;/span&gt; Predict&lt;span class=&quot;token operator&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;token operator&quot;&gt;)&lt;/span&gt;   Total&lt;span class=&quot;token operator&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;token operator&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token separator comment&quot;&gt;----------------------------------------&lt;/span&gt;
     &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;2.40&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.03&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;2.43&lt;/span&gt;
     &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;2.32&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.05&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;2.37&lt;/span&gt;
     &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;4.15&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.08&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;4.23&lt;/span&gt;
    &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;6.16&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.07&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;6.23&lt;/span&gt;
    &lt;span class=&quot;token number&quot;&gt;25&lt;/span&gt;      &lt;span class=&quot;token number&quot;&gt;12.64&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.15&lt;/span&gt;      &lt;span class=&quot;token number&quot;&gt;12.80&lt;/span&gt;
    &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt;      &lt;span class=&quot;token number&quot;&gt;24.41&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.27&lt;/span&gt;      &lt;span class=&quot;token number&quot;&gt;24.68&lt;/span&gt;
   &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;      &lt;span class=&quot;token number&quot;&gt;48.25&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.53&lt;/span&gt;      &lt;span class=&quot;token number&quot;&gt;48.78&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/details&gt;
&lt;details&gt;
&lt;summary&gt;베이스 이미지 - Debian 3.12 의 작업결과&lt;/summary&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;log&quot;&gt;&lt;pre class=&quot;language-log&quot;&gt;&lt;code class=&quot;language-log&quot;&gt;&lt;span class=&quot;token property&quot;&gt;Dataset generated:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100000&lt;/span&gt; samples with &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt; features

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1.93&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.02&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1.96&lt;/span&gt; seconds

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2.01&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.03&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2.04&lt;/span&gt; seconds

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3.83&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.05&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3.88&lt;/span&gt; seconds

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5.93&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.07&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6.00&lt;/span&gt; seconds

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;25&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;12.12&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.12&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;12.24&lt;/span&gt; seconds

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;23.62&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.27&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;23.89&lt;/span&gt; seconds

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;46.82&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.42&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;47.24&lt;/span&gt; seconds

&lt;span class=&quot;token property&quot;&gt;Summary:&lt;/span&gt;
 Trees   Train&lt;span class=&quot;token operator&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;token operator&quot;&gt;)&lt;/span&gt; Predict&lt;span class=&quot;token operator&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;token operator&quot;&gt;)&lt;/span&gt;   Total&lt;span class=&quot;token operator&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;token operator&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token separator comment&quot;&gt;----------------------------------------&lt;/span&gt;
     &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;1.93&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.02&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;1.96&lt;/span&gt;
     &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;2.01&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.03&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;2.04&lt;/span&gt;
     &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;3.83&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.05&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;3.88&lt;/span&gt;
    &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;5.93&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.07&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;6.00&lt;/span&gt;
    &lt;span class=&quot;token number&quot;&gt;25&lt;/span&gt;      &lt;span class=&quot;token number&quot;&gt;12.12&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.12&lt;/span&gt;      &lt;span class=&quot;token number&quot;&gt;12.24&lt;/span&gt;
    &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt;      &lt;span class=&quot;token number&quot;&gt;23.62&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.27&lt;/span&gt;      &lt;span class=&quot;token number&quot;&gt;23.89&lt;/span&gt;
   &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;      &lt;span class=&quot;token number&quot;&gt;46.82&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.42&lt;/span&gt;      &lt;span class=&quot;token number&quot;&gt;47.24&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/details&gt;
&lt;details&gt;
&lt;summary&gt;베이스 이미지 - Debian 3.13 의 작업결과&lt;/summary&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;log&quot;&gt;&lt;pre class=&quot;language-log&quot;&gt;&lt;code class=&quot;language-log&quot;&gt;&lt;span class=&quot;token property&quot;&gt;Dataset generated:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100000&lt;/span&gt; samples with &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt; features

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2.35&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.03&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2.38&lt;/span&gt; seconds

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2.21&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.05&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2.26&lt;/span&gt; seconds

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4.18&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.05&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4.23&lt;/span&gt; seconds

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6.34&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.10&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6.44&lt;/span&gt; seconds

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;25&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;12.59&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.13&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;12.72&lt;/span&gt; seconds

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;25.04&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.27&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;25.30&lt;/span&gt; seconds

Testing RandomForest with &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt; trees&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;Training time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;49.17&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Prediction time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.49&lt;/span&gt; seconds
&lt;span class=&quot;token property&quot;&gt;Total time:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;49.66&lt;/span&gt; seconds

&lt;span class=&quot;token property&quot;&gt;Summary:&lt;/span&gt;
 Trees   Train&lt;span class=&quot;token operator&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;token operator&quot;&gt;)&lt;/span&gt; Predict&lt;span class=&quot;token operator&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;token operator&quot;&gt;)&lt;/span&gt;   Total&lt;span class=&quot;token operator&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;token operator&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token separator comment&quot;&gt;----------------------------------------&lt;/span&gt;
     &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;2.35&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.03&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;2.38&lt;/span&gt;
     &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;2.21&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.05&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;2.26&lt;/span&gt;
     &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;4.18&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.05&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;4.23&lt;/span&gt;
    &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;6.34&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.10&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;6.44&lt;/span&gt;
    &lt;span class=&quot;token number&quot;&gt;25&lt;/span&gt;      &lt;span class=&quot;token number&quot;&gt;12.59&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.13&lt;/span&gt;      &lt;span class=&quot;token number&quot;&gt;12.72&lt;/span&gt;
    &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt;      &lt;span class=&quot;token number&quot;&gt;25.04&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.27&lt;/span&gt;      &lt;span class=&quot;token number&quot;&gt;25.30&lt;/span&gt;
   &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;      &lt;span class=&quot;token number&quot;&gt;49.17&lt;/span&gt;       &lt;span class=&quot;token number&quot;&gt;0.49&lt;/span&gt;      &lt;span class=&quot;token number&quot;&gt;49.66&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/details&gt;
&lt;h2 id=&quot;io-bound-태스크의-결과-1---10만-건의-데이터-조회-결과&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#io-bound-%ED%83%9C%EC%8A%A4%ED%81%AC%EC%9D%98-%EA%B2%B0%EA%B3%BC-1---10%EB%A7%8C-%EA%B1%B4%EC%9D%98-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A1%B0%ED%9A%8C-%EA%B2%B0%EA%B3%BC&quot; aria-label=&quot;io bound 태스크의 결과 1   10만 건의 데이터 조회 결과 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;I/O bound 태스크의 결과 (1) - 10만 건의 데이터 조회 결과&lt;/h2&gt;
&lt;p&gt;Debian 기반의 컨테이너로 IO bound 태스크를 구동해본 결과는 아래와 같았습니다:&lt;/p&gt;
&lt;p&gt;Alpine 기반의 컨테이너로 IO bound 태스크를 구동해본 결과는 아래와 같았습니다:&lt;/p&gt;
&lt;h1 id=&quot;결론&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B2%B0%EB%A1%A0&quot; aria-label=&quot;결론 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;결론&lt;/h1&gt;
&lt;h2 id=&quot;cpu-bound&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#cpu-bound&quot; aria-label=&quot;cpu bound permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;CPU bound&lt;/h2&gt;
&lt;p&gt;의외로, 미미한 차이가 있었고 심지어는 Alpine 기반 컨테이너가 근소하게나마 빨랐습니다.&lt;/p&gt;
&lt;h2 id=&quot;io-bound&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#io-bound&quot; aria-label=&quot;io bound permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;I/O bound&lt;/h2&gt;
&lt;h1 id=&quot;종합하여&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A2%85%ED%95%A9%ED%95%98%EC%97%AC&quot; aria-label=&quot;종합하여 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;종합하여&lt;/h1&gt;
&lt;p&gt;CPU bound task에서 의외로 미미한 차이로 Alpine이 앞섰다는 점에서 놀라웠습니다.&lt;/p&gt;
&lt;h1 id=&quot;끝으로&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%81%9D%EC%9C%BC%EB%A1%9C&quot; aria-label=&quot;끝으로 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;끝으로…&lt;/h1&gt;
&lt;p&gt;이 시리즈를 통하여 아래 접근방안을 보여드렸습니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;효율적인 컨테이너 제작에 필요한 기초지식&lt;/li&gt;
&lt;li&gt;프로덕션 환경에 알맞는 테스트방안
&lt;ul&gt;
&lt;li&gt;주요 가설과 검증, 벤치마킹 방안&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이 시리즈를 통해, 여러분들의 업무나 벤치마킹 및 PoC 에 작게나마 도움이 되었으면 좋겠습니다.&lt;/p&gt;
&lt;p&gt;긴 글 읽어주셔서 감사합니다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[지난 6개월 간 업무 회고]]></title><description><![CDATA[입사 후 지난 6개월을 회고합니다. 지난 6개월간 무엇을 했고, 무엇을 반성하며 무엇을 향해 나아가야할지 썼습니다.]]></description><link>https://blog.s3ich4n.me/retrospect/2024-11-10-6-month-retrospect</link><guid isPermaLink="false">https://blog.s3ich4n.me/retrospect/2024-11-10-6-month-retrospect</guid><pubDate>Sun, 10 Nov 2024 23:20:16 GMT</pubDate><content:encoded>&lt;p&gt;이번 글은 몸이 안 좋아서 회사에서 있었던 일을 회고하는 글로 대체합니다.&lt;/p&gt;
&lt;p&gt;현재 회사에 들어온 지도 벌써 6개월이 지났네요. 그간 어떤 일들이 있었는지 회고하려 합니다.&lt;/p&gt;
&lt;p&gt;저는 현 회사에서 아래 내용들을 진행했습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;레거시 개선 및 신규 서비스 런칭 준비&lt;/li&gt;
&lt;li&gt;기존 완성된 서비스 일부를 재구성하여 배포&lt;/li&gt;
&lt;li&gt;적극적인 개발문화 조성&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;레거시-개선---준비과정&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A0%88%EA%B1%B0%EC%8B%9C-%EA%B0%9C%EC%84%A0---%EC%A4%80%EB%B9%84%EA%B3%BC%EC%A0%95&quot; aria-label=&quot;레거시 개선   준비과정 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;레거시 개선 - 준비과정&lt;/h1&gt;
&lt;p&gt;주요한 요소는 레거시 개선입니다. 제가 입사하기 전 까지 백엔드 전체가 외주로 관리(!)되고 있었죠. 제가 입사를 결정할 즈음 해서 인수인계 과정이 시작되었습니다. 입사 후 인수인계 문서를 받아보자 프로젝트 생성 시 만들어진 README 문서와 데이터 테이블 엑셀파일이 있었습니다. 어떤 테이블이 어떻게 연관관계를 맺고있는지 파악이 불가능한 상태였고, 연관관계나 설계 의도에 대한 문서도 꽤나 차이가 많아 곤욕을 치렀습니다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.giphy.com/media/v1.Y2lkPTc5MGI3NjExbDAwOXlsZG8xbG5wN3dtdWd1dmc5eXRzcnQzejM5cHhqNWhuZ21sbSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/AWv3UAFkgz39u/giphy.gif&quot; alt=&quot;challenge accepted&quot;&gt;&lt;/p&gt;
&lt;p&gt;하지만 책임지고 해봐야죠. 이 상황을 개선해내고 나은 시스템을 만들어 봐야죠. 이를 위해 기존 기획서와 필요한 요소들을 교차검증하여 무엇부터 재구성 해야하는지 다시 설계했습니다. 더 나아가 회사 내 비즈니스 컨셉에 대해 조금씩 물어보기 시작헀고, 신입교육을 듣고난 후에는 어떤 컨셉의 용어들이 오고가는지를 문서에 작성하기 시작했습니다. 어떤 용어를 쓰며 구성원들이 의사소통 하는지 이해해야, 어떤 것들이 필요하고 또 어떤 것들이 모자란지 그리고 어떤 것을 만들고 개선해야할지 파악할 수 있기 때문입니다.&lt;/p&gt;
&lt;h1 id=&quot;레거시-개선---어떻게-개선했나요&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A0%88%EA%B1%B0%EC%8B%9C-%EA%B0%9C%EC%84%A0---%EC%96%B4%EB%96%BB%EA%B2%8C-%EA%B0%9C%EC%84%A0%ED%96%88%EB%82%98%EC%9A%94&quot; aria-label=&quot;레거시 개선   어떻게 개선했나요 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;레거시 개선 - 어떻게 개선했나요?&lt;/h1&gt;
&lt;h2 id=&quot;백엔드-개선&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%B0%B1%EC%97%94%EB%93%9C-%EA%B0%9C%EC%84%A0&quot; aria-label=&quot;백엔드 개선 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;백엔드 개선&lt;/h2&gt;
&lt;p&gt;빠른 일정에 맞추어 기존 레거시를 도저히 수정할 자신이 없었기 때문에, 제게 익숙한 언어와 프레임워크를 사용하기로 결정했습니다. 이후 앞서 말한 요구사항 도출로부터 다시 시작했습니다. 그리고 기존에 만들어진 웹앱과 네이티브 앱에서는 어떤 API를 사용하는지, 어떤 API를 신규로 만들어야 하는지를 먼저 듣고 회의를 진행한 후 RDB 테이블부터 재설계 했지요. 최소한 RDB 테이블 설계부터 잘 한 다음에 앞으로 어떻게 시스템을 확장해야겠다 라는 생각을 했습니다.&lt;/p&gt;
&lt;p&gt;아키텍처 구성은 새 API로 빠르게 이전될 수 있도록 구성을 가져왔습니다. 엔드포인트-서비스-DB 순의 3계층 구성으로 요청-응답을 그대로 가져왔지만 제 설계대로 로직이 처리될 수 있게 갈아끼웠습니다.&lt;/p&gt;
&lt;p&gt;배포는 컨테이너 기반으로 빠르게 대체했습니다. 기존에 몇번 해본 경험도 있고, ‘안되어있는 것 보단 빠르게 하는게 맞겠다’ 라는 판단 하에 망설일 것 없이 도입했습니다.&lt;/p&gt;
&lt;h2 id=&quot;인프라-구성-자동화&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%B8%ED%94%84%EB%9D%BC-%EA%B5%AC%EC%84%B1-%EC%9E%90%EB%8F%99%ED%99%94&quot; aria-label=&quot;인프라 구성 자동화 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;인프라 구성 자동화&lt;/h2&gt;
&lt;p&gt;전 인프라를 테라폼으로 코드화한 경험을 바탕으로 현재 구조도 코드화를 완료했습니다. 완료된 설계사항은 draw.io로 문서화를 해두었는데, 이 때 &lt;a href=&quot;https://www.drawio.com/doc/layers&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Layer 기능&lt;/a&gt;이 굉장히 좋았습니다. 특히나 네트워크 구성을 문서화해두고, 설계한 VPC 내에서 어떤 서브넷은 얼마만큼 커질지 예상해서 배포해두었습니다.&lt;/p&gt;
&lt;p&gt;필요한 테라폼 모듈은 만들기도 하고, 이미 완성된 모듈을 사용해서 최대한 반복을 줄여서 배포할 수 있도록 Terragrunt 로 구성했습니다. 반드시 필요할 개발서버/스테이징서버/운영서버 생성과정 대응을 환경변수 수정 및 YAML 파일 수정만으로 할 수 있게 구성했지요.&lt;/p&gt;
&lt;h2 id=&quot;devops-문화-조성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#devops-%EB%AC%B8%ED%99%94-%EC%A1%B0%EC%84%B1&quot; aria-label=&quot;devops 문화 조성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;DevOps 문화 조성&lt;/h2&gt;
&lt;p&gt;공유가 필요한 내용은 앞서 말했던 문서화를 다른 팀에게 공유할 수 있도록 위키를 만들었습니다. 사내 업무 시스템을 이용해서, 멘션 시 즉시 알람을 받고 의사소통할 수 있는 환경을 제안했습니다.&lt;/p&gt;
&lt;p&gt;엔드포인트에 대한 현상 공유는 구성원들에게 익숙한 Postman 스펙과 Swagger문서로 제공했습니다. 확실한 예시값/응답값을 전달해서 보다 명확한 의사소통 포인트를 잡았습니다.&lt;/p&gt;
&lt;p&gt;이슈 생성부터 해결과정을 한눈에 보기 위해 이슈 트래커를 적극 활용했습니다. 이슈와 PR 및 머지 내용을 함께 알람으로 받아볼 수 있도록 해서, 필요한 사람은 진행상황을 지속적으로 받아볼 수 있도록 조성해서 누가 언제 이 일을 진행하고 끝낼지 칸반보드로 볼 수 있게 구성했습니다.&lt;/p&gt;
&lt;p&gt;서비스의 현상 파악을 위해 CloudWatch의 대쉬보드 생성을 진행했고 threshold 감지 시 알람을 받을 수 있도록 구성해두었습니다. 서비스 에러 모니터링 대응을 위해선 &lt;a href=&quot;https://develop.sentry.dev/self-hosted/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Self hosted Sentry&lt;/a&gt;를 직접 구축하고 운용을 시작했습니다. 500에러 퍼센티지 메트릭 알람으로 에러를 리포팅받는 것을 넘어, Sentry를 통해 에러를 직접 받아볼 수 있게 하고 업무 메신저나 이슈 트래커로 관리되게 연동했습니다.&lt;/p&gt;
&lt;h1 id=&quot;회고합시다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%9A%8C%EA%B3%A0%ED%95%A9%EC%8B%9C%EB%8B%A4&quot; aria-label=&quot;회고합시다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;회고합시다&lt;/h1&gt;
&lt;p&gt;걸어온 일에 대해 제 스스로 딴지를 걸어보며 되짚어봅시다.&lt;/p&gt;
&lt;h2 id=&quot;회고해보면---백엔드-개선&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%9A%8C%EA%B3%A0%ED%95%B4%EB%B3%B4%EB%A9%B4---%EB%B0%B1%EC%97%94%EB%93%9C-%EA%B0%9C%EC%84%A0&quot; aria-label=&quot;회고해보면   백엔드 개선 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;회고해보면 - 백엔드 개선&lt;/h2&gt;
&lt;p&gt;현 작업을 통해, 최소한 배포 후 서버가 죽었는지 살았는지 파악하기 힘들던 시스템부터 재구성 했습니다.&lt;/p&gt;
&lt;p&gt;도메인 기반 설계는 일부러 진행하지 않았습니다. 이제는 이 기술이 ‘좋아보인다’ 로 판단하지 않고 ‘내게(그리고 회사에) 필요한가?‘로 판단했습니다. 우선 레거시를 넘어 저의 설계로 넘어오는 것이 먼저라고 생각했고 그게 가능하려면 빨리 개발될 수 있는 트랜잭션 스크립트로 개발하면 되는 일이었기 때문이죠. 현재 요구사항이 도메인 기반으로 설계할 만큼 복잡하다고 판단하지 않았기 때문입니다. 서비스가 커지고, 도메인이 해야할 일이 복잡해지면 옮겨야겠지만요.&lt;/p&gt;
&lt;p&gt;개발하면서 저의 의사소통의 방식이 많이 아쉬웠습니다. 기존 API 엔드포인트를 옮기고 신규 엔드포인트를 설계하며, ‘이 내용은 이렇게 설계하면 향후 변화에 더 대응하기 좋을 것이다’ 라는 생각을 보다 적극적으로 어필하지 못했기 때문입니다. 그렇다보니, 변화 후 Swagger 문서 및 Postman 문서로 즉각 제공해도 변화에 대응해야 하는 시간을 가져야 함을 고려하지 못했죠.&lt;/p&gt;
&lt;h2 id=&quot;회고해보면---인프라-구성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%9A%8C%EA%B3%A0%ED%95%B4%EB%B3%B4%EB%A9%B4---%EC%9D%B8%ED%94%84%EB%9D%BC-%EA%B5%AC%EC%84%B1&quot; aria-label=&quot;회고해보면   인프라 구성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;회고해보면 - 인프라 구성&lt;/h2&gt;
&lt;p&gt;현재 구성이 생각보다 복잡한가? 하는 생각을 하기도 했습니다. 저 스스로는 모든 것을 다 할 수 있지만, 앞으로 함께 할 동료도 이런 환경에 익숙해져야 할테니까요. 이런 상황에 대비하여 문서화는 진행했습니다. (감사하게도) 팀이 커진다면, 인프라 팀이 별도로 구성되었을 때 ‘왜 이런 설계를 하셨나요?’ 라고 설계의 근거를 전달할 수 있도록 말이죠.&lt;/p&gt;
&lt;h2 id=&quot;회고해보면---devops-문화-조성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%9A%8C%EA%B3%A0%ED%95%B4%EB%B3%B4%EB%A9%B4---devops-%EB%AC%B8%ED%99%94-%EC%A1%B0%EC%84%B1&quot; aria-label=&quot;회고해보면   devops 문화 조성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;회고해보면 - DevOps 문화 조성&lt;/h2&gt;
&lt;p&gt;누구나 이런 환경에 익숙한 건 아닙니다. 전체 개발팀 구성원이 이러한 방식으로 의사소통을 하고 시너지를 내기 위해서는 모두에게 이 시스템이 왜 좋은지 설득할 수도 있어야 하지요. 일단 만들고 쓰길 기대하는 것에서 더 나아가 이렇게 쓰면 좋음을 사내에 세미나로 공유하기로 했고, 진행할 예정입니다.&lt;/p&gt;
&lt;h1 id=&quot;앞으로의-6개월&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%95%9E%EC%9C%BC%EB%A1%9C%EC%9D%98-6%EA%B0%9C%EC%9B%94&quot; aria-label=&quot;앞으로의 6개월 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;앞으로의 6개월?&lt;/h1&gt;
&lt;p&gt;앞으로의 6개월은 이렇게 나아갈 예정입니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;공유, 공유, 공유!
&lt;ul&gt;
&lt;li&gt;비즈니스와 연관있다면 어떤 문제든지 구성원들과 함께 공유하고 문제 해결을 진행하기&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;백엔드 서비스의 테스트 코드 확보
&lt;ul&gt;
&lt;li&gt;비즈니스 로직부터 API 호출 모두 테스트할 수 있도록 구성하기&lt;/li&gt;
&lt;li&gt;테스트 가능한 구성으로 코드 리팩터링을 진행하기&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;DevOps 문화 강화
&lt;ul&gt;
&lt;li&gt;현재 문화를 혼자 개선하려고 행동하는게 아니라, 모든 구성원을 설득하고 시너지를 낼 수 있도록 적극적으로 설득하기&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;끝으로&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%81%9D%EC%9C%BC%EB%A1%9C&quot; aria-label=&quot;끝으로 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;끝으로&lt;/h1&gt;
&lt;p&gt;제가 배우고 익혔던 것들을 팀원에게 공유하고 이것으로 비즈니스적 가치창출에 도움이 된다면 좋겠다는 생각 뿐입니다. 이를 위해 더 많은 것들을 배우고 그 과정 속에서 구성원들과 더욱 즐겁게 일할 수 있었으면 좋겠습니다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[[연재] 파이썬 컨테이너 선택 제 2형 - 파이썬 컨테이너 최적화]]></title><description><![CDATA[컨테이너 사이즈 최소화의 필요성과, 최소화 과정 중 파이썬 라이브러리 설치 과정에서의 최적화 제안(PEP 656)을 소개합니다.]]></description><link>https://blog.s3ich4n.me/devlog/python/2024-10-26-python-container-101-pt02</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/python/2024-10-26-python-container-101-pt02</guid><pubDate>Sat, 26 Oct 2024 05:08:00 GMT</pubDate><content:encoded>&lt;p&gt;이번 게시글에서는 컨테이너 크기를 줄이기 위한 방안을 살펴보고, 파이썬 컨테이너 이미지 빌드가 가지는 특징을 살펴보도록 하겠습니다.&lt;/p&gt;
&lt;h2 id=&quot;빌드-최적화를-해봅시다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%B9%8C%EB%93%9C-%EC%B5%9C%EC%A0%81%ED%99%94%EB%A5%BC-%ED%95%B4%EB%B4%85%EC%8B%9C%EB%8B%A4&quot; aria-label=&quot;빌드 최적화를 해봅시다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;빌드 최적화를 해봅시다&lt;/h2&gt;
&lt;p&gt;지난 글에서 빌드된 이미지의 크기를 다시 살펴볼까요?&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; images python-hello
REPOSITORY     TAG       IMAGE ID       CREATED         SIZE
python-hello   latest    746136719e90   &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; minutes ago   &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;.46GB&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;1.46GB인 데는 분명 이유가 있을 겁니다. 그러면 &lt;code class=&quot;language-text&quot;&gt;latest&lt;/code&gt; 라는 태그가 무엇을 의미하는지부터 살펴볼까요?&lt;/p&gt;
&lt;h3 id=&quot;잠시만-왜-이렇게-크지&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9E%A0%EC%8B%9C%EB%A7%8C-%EC%99%9C-%EC%9D%B4%EB%A0%87%EA%B2%8C-%ED%81%AC%EC%A7%80&quot; aria-label=&quot;잠시만 왜 이렇게 크지 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;잠시만, 왜 이렇게 크지?&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://hub.docker.com/_/python&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Docker Hub&lt;/a&gt;으로 다시 들어가봐서, 어떤 컨테이너가 있나 살펴봅시다.&lt;/p&gt;
&lt;p&gt;뭔가 되게 많군요. 숫자는 파이썬 버전같은데, &lt;code class=&quot;language-text&quot;&gt;-&lt;/code&gt; 뒤의 값은 뭔지 알아봅시다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 466px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/13c8ea80289a195a226aad717c67eb86/fc1a1/01-python-container-simple.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 143.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAdCAYAAACqhkzFAAAACXBIWXMAABYlAAAWJQFJUiTwAAAE6ElEQVRIx41WW3ubSAz1626TmPttYIABDNgYMI5vceMm6SZpsl///885uxKO225f9kEeNBfNkXSk8WR/POHb+3d8eXrG0/M3/j49fMWXpxfs7k7YHj7j4esLz//1+o7X9+9o+ltcGy40O/hNJot+zQcOnx/Q9Gusd3fYHU+gi+gwSbno0A5bzNsB1XIFEee4MX02MD0bmlo+y8QRCcK0QFJUELGCF8aQagYniLDZHXB6eIJmufjjWsenqclyYzjQbQ+adRbb/4GwqOaw1Rqf5B7XcgNNHaGpO+jqDldygz/FGkZxgpntYdJYnGBkB+jJBkZ2hJ4d4aQdDGdEOUnyEsmsRVj0iMsBZjiD5ufQg4LFEAU0nyTj+Yt42WXU3fji9qS/3eH59Q3dsMHLtzcEMsWVbrMrU9P9f0J7LZ9dn1wZLq50Bzemy5kzHAHTDaE7AroTXHTDFYyCvk0v5DX9spfiJzhBE5q0ggROXCHIlohmHcK8heaEsMICYdEhqQd46Rw3loDIGshqBTepYQYp4nrN54ywxtQWmNCttkjh5z1EMSCsNpD1FqrZQ+QdzKiEnw+IqlvIao14sUdQrGAEGWS9gavGyz88mJCrgVqg3PyFaH6ElzZImgOy7h5Ze4Qbz+EkC0TVFklzx0Zpj5d1rNuyhKcaiHw5uqxZPkw/QThbwYpqGG7EcmMF7ILB8QuhuyGm1hi3UY84buN6BM2NzzGkQHsRzLCArxZsWBQdNFfCikoEeQdZDewFzX3oXlLDEhkjDrIGuqj4ggml2o1ogWK0QbLYIWvvUHRHyFkPW1YQ5ZbX43pcJ87qXsqxDrL2XIbn0puaHryk4gATCro1KteIygFxtWaDTOCfyuuDxBfd+lHX7DLRhm6KqwF5u2MkMVEjrtgltdggXWyRLjbw0xqypH17qGaHMG9AoC61TFm2hMJ8/wrVP8DLb2H4Kdx0eY7XGnZUwhQFPNWe9RnHlzzxVfMLWs4yZclPSthhDjPIYHkhDC/iDZRFy49hBTEnTzsn8UOn7P/SDyk2TphBdSdkqwfmn5jfM7+IvG7aIJwR6Xv+NgMFXy0RlStGbIqcXb70Q/ohbrlyBiea8Wj4im/TnfA8CthBckkGob/w0Rm9+UDKLgeqRjE8olw/Qs73aA5vWBzeUG6fka0ekQ9PqLYvyPt7qOURYb1Dc3xHc/wb5eYZxfDE8dddOSbFiefI+gfm2LVbQHMTTozuJSxcBY7k+NL8teH9tDau6376gzb0DARpDaHmSMoWSbmESEsWLy5Y9+MCpi8hVMW6LBaXPUEyw80504yQSi5a3MFOW8TtCdnwxGPUfIaoD5DLE8RsgJv1yG+fkfaPkMt7RM0oSXeCEc4/Si9gWjhRDk8WkMUSUd5wkCn79J2UHdNq6mW4MVx+pKhLE5ixMTsXLrJB04/hpi2cpGEkYrZmUpNuyTn3Q+qBnlpyeRITqNsQwe2o4NKlbDNtiIeEMJoN3H3HptkhUHNuvOxBoNgDQkl9jzqN7sVwZMlGqRx/MUgI7aTh7utnLbd36iBEYqpnOkAGr+0YV5qNa93mx4lc/81l/RxDgu3FFaKihSx7ePEMblwymvGdWcKRNZxQ8X7NS3/7G3JGOMbQjhewZA0/6+DnHcJyzQaJaxRLX7UQec/z9CjxW/3fNvYvwn8A+TEY7RVYJ8oAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/13c8ea80289a195a226aad717c67eb86/8ac56/01-python-container-simple.webp 240w,
/static/13c8ea80289a195a226aad717c67eb86/fbab0/01-python-container-simple.webp 466w&quot;
              sizes=&quot;(max-width: 466px) 100vw, 466px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/13c8ea80289a195a226aad717c67eb86/8ff5a/01-python-container-simple.png 240w,
/static/13c8ea80289a195a226aad717c67eb86/fc1a1/01-python-container-simple.png 466w&quot;
            sizes=&quot;(max-width: 466px) 100vw, 466px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/13c8ea80289a195a226aad717c67eb86/fc1a1/01-python-container-simple.png&quot;
            alt=&quot;Figure 1. 어떤 파이썬 컨테이너가 있나 살펴봅시다 (simple tags)&quot;
            title=&quot;Figure 1. 어떤 파이썬 컨테이너가 있나 살펴봅시다 (simple tags)&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;Figure 1. 어떤 파이썬 컨테이너가 있나 살펴봅시다 (simple tags)&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/c7fe6111e7706fe4a29ae1f54cdd0e5c/fcda8/02-python-container-shared.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 107.5%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAABYlAAAWJQFJUiTwAAAC1klEQVQ4y41V7XKjOBD0CySAQehbCIHAENvx5urux27tVu29/zv1lQZw7MS5ux9TIwk0zHRPD7vvP3/jx6/f+Ov7T/z49TcqaZFVEjlTn+yr81vbNd0BbZxgfMQwn1HUmi5u9lyK6/r/BN097Tld2nONp6LGvta0LphCKQy48SjqD5km/0XgXcqoFBa19qhUi9oEcNuTZ6YDt92ambrLPGPqLvNrwHSQMihlA94coLsTbHyFi2dU9oC8dijY8g5lXmvkTH+d4TWgcKhMBHcjpJ+gwgtkO0H6GcLP4M0EN15onYkOeSUeErYG1KiUh/Av0P0r3OEP+OlPmOEb7WU4wY1vEN0rMh4oWLbBcBMs+d2Cg3gHuzZkBbdU2nJJX/dLRvLdPrBPpEgX4LoRrhvQDjPCMEO5gKYf4cIAYTyM7+DjRO+ppoN0HYQN1Al7bu5L5qaF9hGq6Sm49j1q3dBFG9YANsD4Hkw1yGv7mZDbgGmTSqrMCO5fCDMTLxDtEXWTCFksnaV9JgLB9LF1rhgSKdQ2M1Rqm+GC5vAGE1+h+zNke4Qbv0G0Jzxzj7zid1ndYbgdJByST8EX+al3WxndCPlPpVTSEWapcZNnukFBbOsbZh9L71+U4lC7EcJPVKrtTyjtAVltkZX1glnJlxa7kd5jpaSSV6UwEymobGeSIm9G8uljNp7A/XSnlA2Ku7ZJ+DHlwd0A6Q/w4wVhfoMbzjD9ETrMcMMJOl5QqH6F4vGc3G20J8z2qkMuAvaqR6kj+W1dmQG5aPFUKjztaxp526zMb9pnJcWCSYtKGGhq4pb2XDuUNBsFmDQQ1i/PXUsqEbb9NCt3W8sw5cBtgPIDmniEH46w3QTdjpBNJAuHM0w3ozSRJJfm6MOS85UU5iZUbgL3R2pi1ryAuZlMhBN4e0ahIjJmkD34NdwpZZuHzA7Q3REmnteZOBPrac3siGdmH8zC95L/ATI2OhhUfcsaAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/c7fe6111e7706fe4a29ae1f54cdd0e5c/8ac56/02-python-container-shared.webp 240w,
/static/c7fe6111e7706fe4a29ae1f54cdd0e5c/d3be9/02-python-container-shared.webp 480w,
/static/c7fe6111e7706fe4a29ae1f54cdd0e5c/5ca24/02-python-container-shared.webp 590w&quot;
              sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/c7fe6111e7706fe4a29ae1f54cdd0e5c/8ff5a/02-python-container-shared.png 240w,
/static/c7fe6111e7706fe4a29ae1f54cdd0e5c/e85cb/02-python-container-shared.png 480w,
/static/c7fe6111e7706fe4a29ae1f54cdd0e5c/fcda8/02-python-container-shared.png 590w&quot;
            sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/c7fe6111e7706fe4a29ae1f54cdd0e5c/fcda8/02-python-container-shared.png&quot;
            alt=&quot;Figure 2. 어떤 파이썬 컨테이너가 있나 살펴봅시다 (shared tags)&quot;
            title=&quot;Figure 2. 어떤 파이썬 컨테이너가 있나 살펴봅시다 (shared tags)&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;Figure 2. 어떤 파이썬 컨테이너가 있나 살펴봅시다 (shared tags)&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;이 값들은 각각 Simple tags, Shared tags 인데요. 이 값은 아래와 같습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;simple tags&lt;/code&gt;: 태그로 기재된 리눅스 배포판 혹은 윈도우즈에서만 동작을 보장하는 컨테이너 이미지 입니다. 이 값을 사용하면 해당 태그에 명시된 플랫폼(리눅스나 윈도우즈 등)의 하나의 이미지 정보(이미지의 구성 정보, 레이어 정보, 실행 환경 등을 담은 매니페스트)에 연결됩니다. 이 경우, 명확히 지정한 플랫폼의 이미지만 사용할 수 있습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;shared tags&lt;/code&gt;: 여러 운영체제(리눅스 및 다양한 윈도우즈 버전)와 아키텍처에서 동작하는 컨테이너 이미지를 나타냅니다. 이 값을 Docker Engine이 구동되는 환경(운영체제, 아키텍처 등)에 맞는 적절한 이미지를 자동으로 선택해서 pull하게 됩니다. 예를 들어, mongo:4.0 같은 shared tag를 사용하면 Docker Engine이 현재 실행 중인 호스트의 운영체제와 아키텍처에 맞는 이미지를 알아서 가져옵니다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;summary&gt;🤔 도커의 매니페스트란?&lt;/summary&gt;
&lt;p&gt;도커 매니페스트는 컨테이너 이미지에 대한 상세 정보를 담고 있는 메타데이터입니다. 여기에는:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;이미지가 실행될 수 있는 운영체제와 아키텍처&lt;/li&gt;
&lt;li&gt;이미지를 구성하는 레이어들의 정보&lt;/li&gt;
&lt;li&gt;이미지의 설정값 (환경 변수, 실행 명령어 등)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;등이 포함됩니다. 도커는 이 매니페스트를 읽어 해당 이미지가 현재 환경에서 실행 가능한지, 어떤 레이어들이 필요한지 등을 파악합니다.&lt;/p&gt;
&lt;/details&gt;
&lt;h3 id=&quot;그럼-어떻게-하죠&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B7%B8%EB%9F%BC-%EC%96%B4%EB%96%BB%EA%B2%8C-%ED%95%98%EC%A3%A0&quot; aria-label=&quot;그럼 어떻게 하죠 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;그럼 어떻게 하죠?&lt;/h3&gt;
&lt;p&gt;도커 이미지 크기를 줄이기 위해서는 아래와 같은 과정을 처리할 수 있습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;가능하면 가벼운 베이스 이미지를 선택할 것&lt;/li&gt;
&lt;li&gt;멀티-스테이지를 사용해서, 빌드-런타임 환경을 분리할 것&lt;/li&gt;
&lt;li&gt;다양한 최적화 방안을 고려해보기
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;.dockerignore&lt;/code&gt; 파일 작성&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;RUN&lt;/code&gt; 레이어 최적화&lt;/li&gt;
&lt;li&gt;나에게 맞는 패키지&lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;/파일을 취사선택하기&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;step-1-simple-tag를-골라봅시다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#step-1-simple-tag%EB%A5%BC-%EA%B3%A8%EB%9D%BC%EB%B4%85%EC%8B%9C%EB%8B%A4&quot; aria-label=&quot;step 1 simple tag를 골라봅시다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;step 1. simple tag를 골라봅시다&lt;/h3&gt;
&lt;p&gt;앞서 말씀드린 &lt;code class=&quot;language-text&quot;&gt;latest&lt;/code&gt; 는 shared tags 입니다. 구동하려는 호스트에 맞게 구동될 수는 있지만, 최적화는 다른 문제죠. 이럴 땐 최소한의 내용만을 컨테이너를 통한 배포를 수행할 때는 최소한의 내용만 맞추고 배포하는 것이 보다 나은 접근입니다.&lt;/p&gt;
&lt;p&gt;대표적인 베이스 이미지는 &lt;code class=&quot;language-text&quot;&gt;Debian linux&lt;/code&gt; 기반의  &lt;code class=&quot;language-text&quot;&gt;slim&lt;/code&gt; 과 &lt;code class=&quot;language-text&quot;&gt;Alpine linux&lt;/code&gt; 기반의 &lt;code class=&quot;language-text&quot;&gt;alpine&lt;/code&gt;이 있습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;slim 이미지는,
&lt;ul&gt;
&lt;li&gt;Debian linux의 최소화 버전이며&lt;/li&gt;
&lt;li&gt;필수적인 시스템 라이브러리를 갖추고 있습니다&lt;/li&gt;
&lt;li&gt;C 라이브러리 구현체로 &lt;code class=&quot;language-text&quot;&gt;glibc&lt;/code&gt; 를 사용합니다. 이는 거의 대부분의 라이브러리와 호환됩니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;alpine 이미지는,
&lt;ul&gt;
&lt;li&gt;Alpine linux에 대한 최소한의 버전이며&lt;/li&gt;
&lt;li&gt;필수적인 시스템 라이브러리로 &lt;code class=&quot;language-text&quot;&gt;busybox&lt;/code&gt; 를 이용합니다&lt;/li&gt;
&lt;li&gt;C 라이브러리 구현체로 &lt;code class=&quot;language-text&quot;&gt;musl&lt;/code&gt; libc를 사용합니다. 경량버전의 라이브러리를 추구하는 것이 목표이므로, 일부 라이브러리와 호환되지 않을 수도 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;그러면 이 둘을 사용해서 각각 빌드해볼까요?&lt;/p&gt;
&lt;details&gt;
&lt;summary&gt;👨‍💻 `slim` 빌드를 해봅시다. &lt;/summary&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Dockerfile&lt;/code&gt; 을 제작합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;dockerfile&quot;&gt;&lt;pre class=&quot;language-dockerfile&quot;&gt;&lt;code class=&quot;language-dockerfile&quot;&gt;&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; python:3.12-slim       # slim은 Debian slim 이미지를 의미합니다.&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;WORKDIR&lt;/span&gt; /app&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;COPY&lt;/span&gt; hello.py .&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;CMD&lt;/span&gt; [&lt;span class=&quot;token string&quot;&gt;&quot;python&quot;&lt;/span&gt;, &lt;span class=&quot;token string&quot;&gt;&quot;hello.py&quot;&lt;/span&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;빌드를 동일하게 해보고,&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;ocker build &lt;span class=&quot;token parameter variable&quot;&gt;-t&lt;/span&gt; python-hello:slim &lt;span class=&quot;token builtin class-name&quot;&gt;.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;사이즈를 확인해볼까요?&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; images
REPOSITORY          TAG            IMAGE ID       CREATED         SIZE
python-hello        slim           2f648897463c   &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; seconds ago   212MB
python-hello        latest         746136719e90   &lt;span class=&quot;token number&quot;&gt;12&lt;/span&gt; days ago     &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;.46GB&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/details&gt;
&lt;details&gt;
&lt;summary&gt;👨‍💻 `alpine` 빌드를 해봅시다. &lt;/summary&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Dockerfile&lt;/code&gt; 을 제작합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;dockerfile&quot;&gt;&lt;pre class=&quot;language-dockerfile&quot;&gt;&lt;code class=&quot;language-dockerfile&quot;&gt;&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; python:3.12-alpine       # alpine은 Alpine 이미지를 의미합니다.&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;WORKDIR&lt;/span&gt; /app&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;COPY&lt;/span&gt; hello.py .&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;CMD&lt;/span&gt; [&lt;span class=&quot;token string&quot;&gt;&quot;python&quot;&lt;/span&gt;, &lt;span class=&quot;token string&quot;&gt;&quot;hello.py&quot;&lt;/span&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;빌드를 동일하게 해보고,&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;ocker build &lt;span class=&quot;token parameter variable&quot;&gt;-t&lt;/span&gt; python-hello:alpine &lt;span class=&quot;token builtin class-name&quot;&gt;.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;사이즈를 확인해볼까요?&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; images
REPOSITORY          TAG            IMAGE ID       CREATED         SIZE
python-hello        slim           2f648897463c   &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; seconds ago   212MB
python-hello        alpine         37a9f605a036   &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; minutes ago   &lt;span class=&quot;token number&quot;&gt;78&lt;/span&gt;.4MB
python-hello        latest         746136719e90   &lt;span class=&quot;token number&quot;&gt;12&lt;/span&gt; days ago     &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;.46GB&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/details&gt;
&lt;h3 id=&quot;step-2-멀티-스테이지-사용해보기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#step-2-%EB%A9%80%ED%8B%B0-%EC%8A%A4%ED%85%8C%EC%9D%B4%EC%A7%80-%EC%82%AC%EC%9A%A9%ED%95%B4%EB%B3%B4%EA%B8%B0&quot; aria-label=&quot;step 2 멀티 스테이지 사용해보기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;step 2. 멀티-스테이지 사용해보기&lt;/h3&gt;
&lt;p&gt;멀티-스테이지는 하나의 &lt;code class=&quot;language-text&quot;&gt;Dockerfile&lt;/code&gt;에서 다양한 스테이지로 나누어서 레이어를 쌓는 개념을 의미합니다. 그렇다면 어떤 스테이지가 있는지 살펴볼까요?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;빌드 스테이지
&lt;ul&gt;
&lt;li&gt;빌드 도구에 필요한 내용만을 포함합니다&lt;/li&gt;
&lt;li&gt;빌드 결과를 저장합니다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;런타임 스테이지
&lt;ul&gt;
&lt;li&gt;직전 phase에서 저장한 파일들을 복사합니다.&lt;/li&gt;
&lt;li&gt;빌드 후의 내용을 구동할 최소한의 파일만을 설치합니다&lt;/li&gt;
&lt;li&gt;본 내용에서는 런타임 스테이지를 run stage, service stage 둘로 나눕니다.
&lt;ul&gt;
&lt;li&gt;이는 각각 실행환경 구성, 앱 실행환경 구성을 의미합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;그렇다면 멀티-스테이지로 빌드를 수행해볼까요?&lt;/p&gt;
&lt;p&gt;이번 예시부터는 이 &lt;a href=&quot;https://github.com/max-pfeiffer/python-poetry&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;GitHub repo&lt;/a&gt;를 사용해보겠습니다.&lt;/p&gt;
&lt;h3 id=&quot;멀티-스테이지가-없다면&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A9%80%ED%8B%B0-%EC%8A%A4%ED%85%8C%EC%9D%B4%EC%A7%80%EA%B0%80-%EC%97%86%EB%8B%A4%EB%A9%B4&quot; aria-label=&quot;멀티 스테이지가 없다면 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;멀티-스테이지가 없다면?&lt;/h3&gt;
&lt;p&gt;그렇다면, 멀티-스테이지 없이 헬로글또를 찍어볼까요?&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;dockerfile&quot;&gt;&lt;pre class=&quot;language-dockerfile&quot;&gt;&lt;code class=&quot;language-dockerfile&quot;&gt;&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; python:3.12-slim&lt;/span&gt;

&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;ARG&lt;/span&gt; POETRY_VERSION=1.6.1&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;ARG&lt;/span&gt; APPLICATION_SERVER_PORT=8000&lt;/span&gt;

&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;ENV&lt;/span&gt; PIP_NO_CACHE_DIR=off &lt;span class=&quot;token operator&quot;&gt;\&lt;/span&gt;
    PIP_DISABLE_PIP_VERSION_CHECK=on &lt;span class=&quot;token operator&quot;&gt;\&lt;/span&gt;
    PIP_DEFAULT_TIMEOUT=100 &lt;span class=&quot;token operator&quot;&gt;\&lt;/span&gt;
    POETRY_VERSION=&lt;span class=&quot;token variable&quot;&gt;${POETRY_VERSION}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;\&lt;/span&gt;
    POETRY_HOME=&lt;span class=&quot;token string&quot;&gt;&quot;/opt/poetry&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;\&lt;/span&gt;
    PYTHONUNBUFFERED=1 &lt;span class=&quot;token operator&quot;&gt;\&lt;/span&gt;
    PYTHONDONTWRITEBYTECODE=1 &lt;span class=&quot;token operator&quot;&gt;\&lt;/span&gt;
    PYTHONPATH=/application_root &lt;span class=&quot;token operator&quot;&gt;\&lt;/span&gt;
    POETRY_VIRTUALENVS_IN_PROJECT=true &lt;span class=&quot;token operator&quot;&gt;\&lt;/span&gt;
    POETRY_CACHE_DIR=&lt;span class=&quot;token string&quot;&gt;&quot;/application_root/.cache&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;\&lt;/span&gt;
    VIRTUAL_ENVIRONMENT_PATH=&lt;span class=&quot;token string&quot;&gt;&quot;/application_root/.venv&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;\&lt;/span&gt;
    APPLICATION_SERVER_PORT=&lt;span class=&quot;token variable&quot;&gt;$APPLICATION_SERVER_PORT&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;\&lt;/span&gt;
    PATH=&lt;span class=&quot;token string&quot;&gt;&quot;/opt/poetry/bin:$PATH&quot;&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 빌드 도구 설치&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; apt-get update &lt;span class=&quot;token operator&quot;&gt;\&lt;/span&gt;
    &amp;amp;&amp;amp; apt-get install --no-install-recommends -y &lt;span class=&quot;token operator&quot;&gt;\&lt;/span&gt;
        build-essential&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Poetry 설치&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; python -m venv &lt;span class=&quot;token variable&quot;&gt;${POETRY_HOME}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;${POETRY_HOME}&lt;/span&gt;/bin/pip install -U pip setuptools&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;${POETRY_HOME}&lt;/span&gt;/bin/pip install &lt;span class=&quot;token string&quot;&gt;&quot;poetry==${POETRY_VERSION}&quot;&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 사용자 생성&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; groupadd -g 1001 python_application &amp;amp;&amp;amp; &lt;span class=&quot;token operator&quot;&gt;\&lt;/span&gt;
    useradd -r -u 1001 -g python_application python_application&lt;/span&gt;

&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;WORKDIR&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;${PYTHONPATH}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;COPY&lt;/span&gt; . &lt;span class=&quot;token variable&quot;&gt;${PYTHONPATH}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; chown python_application:python_application &lt;span class=&quot;token variable&quot;&gt;${PYTHONPATH}&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; mkdir &lt;span class=&quot;token variable&quot;&gt;${POETRY_CACHE_DIR}&lt;/span&gt; &amp;amp;&amp;amp; chown python_application:python_application &lt;span class=&quot;token variable&quot;&gt;${POETRY_CACHE_DIR}&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;EXPOSE&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;${APPLICATION_SERVER_PORT}&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;COPY&lt;/span&gt; ./docker/dev/entrypoint /entrypoint&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; sed -i &lt;span class=&quot;token string&quot;&gt;&apos;s/\r$//g&apos;&lt;/span&gt; /entrypoint&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; chmod +x /entrypoint&lt;/span&gt;

&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;USER&lt;/span&gt; 1001&lt;/span&gt;

&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; poetry install --without dev&lt;/span&gt;

&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;ENTRYPOINT&lt;/span&gt; [&lt;span class=&quot;token string&quot;&gt;&quot;/entrypoint&quot;&lt;/span&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이걸로 만든 이미지의 크기를 살펴봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; images
REPOSITORY          TAG                  IMAGE ID       CREATED          SIZE
python-hello        slim-without-multi   f4be58bb8080   &lt;span class=&quot;token number&quot;&gt;38&lt;/span&gt; seconds ago   700MB&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;멀티-스테이지가-있다면&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A9%80%ED%8B%B0-%EC%8A%A4%ED%85%8C%EC%9D%B4%EC%A7%80%EA%B0%80-%EC%9E%88%EB%8B%A4%EB%A9%B4&quot; aria-label=&quot;멀티 스테이지가 있다면 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;멀티-스테이지가 있다면?&lt;/h3&gt;
&lt;p&gt;반대로 멀티-스테이지를 추가해서 헬로글또를 찍어봅시다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;빌드 스테이지&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;빌드 스테이지는 실제 필요한 내용들만을 설치합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;dockerfile&quot;&gt;&lt;pre class=&quot;language-dockerfile&quot;&gt;&lt;code class=&quot;language-dockerfile&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;### ### ### ### ### ### ###&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# STAGE 0. Prerequisites  #&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;### ### ### ### ### ### ###&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;ARG&lt;/span&gt; OFFICIAL_PYTHON_IMAGE=3.12&lt;/span&gt;

&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; python:&lt;span class=&quot;token variable&quot;&gt;${OFFICIAL_PYTHON_IMAGE}&lt;/span&gt;-slim &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; build-stage        # debian slim 이미지를 빌드 스테이지로 설정합시다.&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;ARG&lt;/span&gt; POETRY_VERSION=1.6.1                                        # 패키지 매니저로 poetry v1.6.1를 씁니다.&lt;/span&gt;

&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;ENV&lt;/span&gt; PIP_NO_CACHE_DIR=off \                                      # 최적화 옵션입니다. 자세한 것은 위의 GitHub 링크를 확인해주세요!&lt;/span&gt;
    PIP_DISABLE_PIP_VERSION_CHECK=on \
    PIP_DEFAULT_TIMEOUT=100 \
    POETRY_VERSION=${POETRY_VERSION} \
    POETRY_HOME=&quot;/opt/poetry&quot;

&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; apt-get update &lt;span class=&quot;token operator&quot;&gt;\&lt;/span&gt;
    &amp;amp;&amp;amp; apt-get install --no-install-recommends -y build-essential \   # 빌드에 필요한 핵심 내용들만 설치합니다.&lt;/span&gt;
    &amp;amp;&amp;amp; rm -rf /var/lib/apt/lists/*

&lt;span class=&quot;token comment&quot;&gt;# https://python-poetry.org/docs/#installing-manually&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; python -m venv &lt;span class=&quot;token variable&quot;&gt;${POETRY_HOME}&lt;/span&gt;                               # 가상환경을 구성하고, poetry를 설치합니다.&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;${POETRY_HOME}&lt;/span&gt;/bin/pip install -U pip setuptools&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;${POETRY_HOME}&lt;/span&gt;/bin/pip install &lt;span class=&quot;token string&quot;&gt;&quot;poetry==${POETRY_VERSION}&quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;Run 스테이지&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;실행환경을 구성하는 중간단계 입니다.&lt;/li&gt;
&lt;li&gt;필요한 부분만을 복사하고, 빌드도구를 제외합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;dockerfile&quot;&gt;&lt;pre class=&quot;language-dockerfile&quot;&gt;&lt;code class=&quot;language-dockerfile&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;### ### ### ### ###&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# STAGE 1. &apos;run&apos;  #&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;### ### ### ### ###&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; python:&lt;span class=&quot;token variable&quot;&gt;${OFFICIAL_PYTHON_IMAGE}&lt;/span&gt;-slim &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; run-stage&lt;/span&gt;

&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;ENV&lt;/span&gt; PATH=&lt;span class=&quot;token string&quot;&gt;&quot;/opt/poetry/bin:$PATH&quot;&lt;/span&gt;                    # 환경변수를 추가하여, poetry를 쓸 수 있게 구성합니다.&lt;/span&gt;

&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;COPY&lt;/span&gt; &lt;span class=&quot;token options&quot;&gt;&lt;span class=&quot;token property&quot;&gt;--from&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;build-stage&lt;/span&gt;&lt;/span&gt; /opt/poetry /opt/poetry/    # build-stage에서 필요한 내용만 가져옵니다.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;Service 스테이지&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;실제 애플리케이션이 구동될 환경을 구성합니다.&lt;/li&gt;
&lt;li&gt;보안설정, 런타임에 필요한 의존성을 구성하고 서비스를 구동합니다.&lt;/li&gt;
&lt;li&gt;구동 전 &lt;code class=&quot;language-text&quot;&gt;entrypoint&lt;/code&gt; 파일을 별도로 두고 이 파일을 entrypoint 로 구성합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;dockerfile&quot;&gt;&lt;pre class=&quot;language-dockerfile&quot;&gt;&lt;code class=&quot;language-dockerfile&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;### ### ### ### ### ###&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# STAGE 2. &apos;service&apos;  #&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;### ### ### ### ### ###&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; run-stage &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; service-stage&lt;/span&gt;

&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;ARG&lt;/span&gt; APPLICATION_SERVER_PORT=8000&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# https://docs.python.org/3/using/cmdline.html#envvar-PYTHONUNBUFFERED&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;ENV&lt;/span&gt; PYTHONUNBUFFERED=1 &lt;span class=&quot;token operator&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# https://docs.python.org/3/using/cmdline.html#envvar-PYTHONDONTWRITEBYTECODE&lt;/span&gt;
    PYTHONDONTWRITEBYTECODE=1 &lt;span class=&quot;token operator&quot;&gt;\&lt;/span&gt;
    PYTHONPATH=/application_root &lt;span class=&quot;token operator&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# https://python-poetry.org/docs/configuration/#virtualenvsin-project&lt;/span&gt;
    POETRY_VIRTUALENVS_IN_PROJECT=true &lt;span class=&quot;token operator&quot;&gt;\&lt;/span&gt;
    POETRY_CACHE_DIR=&lt;span class=&quot;token string&quot;&gt;&quot;/application_root/.cache&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;\&lt;/span&gt;
    VIRTUAL_ENVIRONMENT_PATH=&lt;span class=&quot;token string&quot;&gt;&quot;/application_root/.venv&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;\&lt;/span&gt;
    APPLICATION_SERVER_PORT=&lt;span class=&quot;token variable&quot;&gt;$APPLICATION_SERVER_PORT&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 가상환경이 먼저 실행될 수 있도록 PATH의 앞에 추가&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# https://docs.python.org/3/library/venv.html#how-venvs-work&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;ENV&lt;/span&gt; PATH=&lt;span class=&quot;token string&quot;&gt;&quot;$VIRTUAL_ENVIRONMENT_PATH/bin:$PATH&quot;&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 권한분리를 위해 처리&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; groupadd -g 1001 python_application &amp;amp;&amp;amp; &lt;span class=&quot;token operator&quot;&gt;\&lt;/span&gt;
    useradd -r -u 1001 -g python_application python_application&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# WORKDIR를 애플리케이션 루트 디렉터리로 지정&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# https://www.uvicorn.org/settings/#development&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# https://docs.docker.com/engine/reference/builder/#workdir&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;WORKDIR&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;${PYTHONPATH}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;COPY&lt;/span&gt; . &lt;span class=&quot;token variable&quot;&gt;${PYTHONPATH}&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; chown python_application:python_application &lt;span class=&quot;token variable&quot;&gt;${PYTHONPATH}&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# poetry 캐시 디렉터리를 만들고, 권한을 부여함. 링크 참조&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# https://python-poetry.org/docs/configuration/#cache-directory&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; mkdir &lt;span class=&quot;token variable&quot;&gt;${POETRY_CACHE_DIR}&lt;/span&gt; &amp;amp;&amp;amp; chown python_application:python_application &lt;span class=&quot;token variable&quot;&gt;${POETRY_CACHE_DIR}&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# API 엔드포인트에 대해 문서화를 수행&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# https://docs.docker.com/engine/reference/builder/#expose&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;EXPOSE&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;${APPLICATION_SERVER_PORT}&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# ENTRYPOINT로 사용할 파일에 대해 복사 후 내용 구성&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;COPY&lt;/span&gt; ./docker/dev/entrypoint /entrypoint&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; sed -i &lt;span class=&quot;token string&quot;&gt;&apos;s/\r$//g&apos;&lt;/span&gt; /entrypoint&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; chmod +x /entrypoint&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 컨테이너 구동 시에 부여하는 권한을 명시함&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;USER&lt;/span&gt; 1001&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# poetry를 이용하여 의존성 설치&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; poetry install --without dev&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Entrypoint 로 추가한 파일을 사용.&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# https://www.docker.com/blog/docker-best-practices-choosing-between-run-cmd-and-entrypoint/&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;ENTRYPOINT&lt;/span&gt; [&lt;span class=&quot;token string&quot;&gt;&quot;/entrypoint&quot;&lt;/span&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이렇게 되면 용량은 얼마나 줄어들까요?&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; images
REPOSITORY          TAG            IMAGE ID       CREATED          SIZE
python-hello        slim-multi     4f8e4848dc55   &lt;span class=&quot;token number&quot;&gt;27&lt;/span&gt; minutes ago   324MB&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;절반이나 줄어들었군요!&lt;/p&gt;
&lt;h3 id=&quot;step-2-빌드-타임을-줄여봅시다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#step-2-%EB%B9%8C%EB%93%9C-%ED%83%80%EC%9E%84%EC%9D%84-%EC%A4%84%EC%97%AC%EB%B4%85%EC%8B%9C%EB%8B%A4&quot; aria-label=&quot;step 2 빌드 타임을 줄여봅시다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;step 2. 빌드 타임을 줄여봅시다&lt;/h3&gt;
&lt;p&gt;멀티-스테이지는 빌드타임이 얼마나 걸리는지 살펴볼까요? 이번에는 외부 패키지를 추가로 설치해서 테스트 해봅시다.
설치 대상은 &lt;code class=&quot;language-text&quot;&gt;pandas&lt;/code&gt; 와 &lt;code class=&quot;language-text&quot;&gt;matplotlib&lt;/code&gt; 입니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; build &lt;span class=&quot;token parameter variable&quot;&gt;-t&lt;/span&gt; python-hello:slim-multi-2 --no-cache &lt;span class=&quot;token builtin class-name&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;+&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; Building &lt;span class=&quot;token number&quot;&gt;45&lt;/span&gt;.6s &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;/20&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; FINISHED                                                                                                    docker:desktop-linux
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;internal&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; load build definition from Dockerfile                                                                                                   &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; transferring dockerfile: &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;.53kB                                                                                                                 &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;internal&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; load metadata &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; docker.io/library/python:3.12-slim                                                                                    &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;.6s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;internal&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; load .dockerignore                                                                                                                      &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; transferring context: 2B                                                                                                                        &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;internal&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; load build context                                                                                                                      &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; transferring context: &lt;span class=&quot;token number&quot;&gt;87&lt;/span&gt;.08kB                                                                                                                   &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;build-stage &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;/5&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; FROM docker.io/library/python:3.12-slim@sha256:032c52613401895aa3d418a4c563d2d05f993bc3ecc065c8f4e2280978acd249                  &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;.6s
&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;build-stage &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;/5&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; RUN &lt;span class=&quot;token function&quot;&gt;apt-get&lt;/span&gt; update     &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt-get&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; --no-install-recommends &lt;span class=&quot;token parameter variable&quot;&gt;-y&lt;/span&gt; build-essential     &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-rf&lt;/span&gt; /var/lib/apt/lists/*          &lt;span class=&quot;token number&quot;&gt;12&lt;/span&gt;.4s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;build-stage &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;/5&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; RUN python &lt;span class=&quot;token parameter variable&quot;&gt;-m&lt;/span&gt; venv /opt/poetry                                                                                                   &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;.9s 
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;build-stage &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;/5&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; RUN /opt/poetry/bin/pip &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-U&lt;/span&gt; pip setuptools                                                                                &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;.1s 
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;build-stage &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;/5&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; RUN /opt/poetry/bin/pip &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;poetry==1.6.1&quot;&lt;/span&gt;                                                                                  &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;.1s 
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;run-stage &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;/2&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; COPY &lt;span class=&quot;token parameter variable&quot;&gt;--from&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;build-stage /opt/poetry /opt/poetry/                                                                                   &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.2s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;service-stage &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;/9&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; RUN &lt;span class=&quot;token function&quot;&gt;groupadd&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-g&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1001&lt;/span&gt; python_application &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;     &lt;span class=&quot;token function&quot;&gt;useradd&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1001&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-g&lt;/span&gt; python_application python_application                     &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.2s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;service-stage &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;/9&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; WORKDIR /application_root                                                                                                      &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;service-stage &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;/9&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; COPY &lt;span class=&quot;token builtin class-name&quot;&gt;.&lt;/span&gt; /application_root                                                                                                       &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;service-stage &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;/9&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; RUN &lt;span class=&quot;token function&quot;&gt;chown&lt;/span&gt; python_application:python_application /application_root                                                              &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.1s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;service-stage &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;/9&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; RUN &lt;span class=&quot;token function&quot;&gt;mkdir&lt;/span&gt; /application_root/.cache &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;chown&lt;/span&gt; python_application:python_application /application_root/.cache                     &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.1s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;service-stage &lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt;/9&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; COPY entrypoint /entrypoint                                                                                                    &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;service-stage &lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt;/9&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; RUN &lt;span class=&quot;token function&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;s/\r$//g&apos;&lt;/span&gt; /entrypoint                                                                                              &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.1s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;service-stage &lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;/9&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; RUN &lt;span class=&quot;token function&quot;&gt;chmod&lt;/span&gt; +x /entrypoint                                                                                                       &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.1s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;service-stage &lt;span class=&quot;token number&quot;&gt;9&lt;/span&gt;/9&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; RUN poetry &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;--without&lt;/span&gt; dev                                                                                               &lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt;.4s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; exporting to image                                                                                                                                 &lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;.3s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; exporting layers                                                                                                                                &lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt;.5s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; exporting manifest sha256:2e1a026e67ea60a968a576838692cc7661011085b146d3b94bff86e21c10fedd                                                      &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; exporting config sha256:f7b5913e1edb9f4566cd1bf1c1f32e0baa757f9fae90fea096917d7241a0fd6d                                                        &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; exporting attestation manifest sha256:6482e53034c92e947f0c26372d5a0fc24e24d510ec9a4a5c5ff6901310ef5263                                          &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; exporting manifest list sha256:a23299c55409341354951e7931f8bf1f38137fd21391853773255b17062c1c0f                                                 &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; naming to docker.io/library/python-hello:slim-multi-2                                                                                           &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; unpacking to docker.io/library/python-hello:slim-multi-2                                                                                        &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;.8s&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;그렇다면, alpine 베이스 이미지로 빌드를 수행해봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; build &lt;span class=&quot;token parameter variable&quot;&gt;-t&lt;/span&gt; python-hello:alpine-multi-2 --no-cache &lt;span class=&quot;token builtin class-name&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;+&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; Building &lt;span class=&quot;token number&quot;&gt;90&lt;/span&gt;.4s &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;21&lt;/span&gt;/21&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; FINISHED                                                                                                     docker:desktop-linux
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;internal&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; load build definition from Dockerfile                                                                                                    &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; transferring dockerfile: &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;.18kB                                                                                                                  &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;internal&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; load metadata &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; docker.io/library/python:3.12-alpine                                                                                   &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;.4s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;internal&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; load .dockerignore                                                                                                                       &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; transferring context: 2B                                                                                                                         &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;internal&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; load build context                                                                                                                       &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; transferring context: &lt;span class=&quot;token number&quot;&gt;85&lt;/span&gt;.72kB                                                                                                                    &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;build-stage &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;/5&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; FROM docker.io/library/python:3.12-alpine@sha256:38e179a0f0436c97ecc76bcd378d7293ab3ee79e4b8c440fdc7113670cb6e204                 &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;.3s
&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;build-stage &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;/5&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; RUN apk &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt; --no-cache     gcc     python3-dev                                                                                   &lt;span class=&quot;token number&quot;&gt;12&lt;/span&gt;.1s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;build-stage &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;/5&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; RUN python &lt;span class=&quot;token parameter variable&quot;&gt;-m&lt;/span&gt; venv /opt/poetry                                                                                                    &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;.2s 
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;build-stage &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;/5&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; RUN /opt/poetry/bin/pip &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-U&lt;/span&gt; pip setuptools                                                                                 &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;.3s 
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;build-stage &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;/5&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; RUN /opt/poetry/bin/pip &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;poetry==1.6.1&quot;&lt;/span&gt;                                                                                   &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;.7s 
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;run-stage &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;/2&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; COPY &lt;span class=&quot;token parameter variable&quot;&gt;--from&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;build-stage /opt/poetry /opt/poetry/                                                                                    &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.2s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;service-stage  &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;/10&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; RUN addgroup &lt;span class=&quot;token parameter variable&quot;&gt;-g&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1001&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-S&lt;/span&gt; python_application &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;     adduser &lt;span class=&quot;token parameter variable&quot;&gt;-S&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1001&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-G&lt;/span&gt; python_application python_application                 &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.1s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;service-stage  &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;/10&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; WORKDIR /application_root                                                                                                     &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;service-stage  &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;/10&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; COPY &lt;span class=&quot;token builtin class-name&quot;&gt;.&lt;/span&gt; /application_root                                                                                                      &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;service-stage  &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;/10&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; RUN &lt;span class=&quot;token function&quot;&gt;chown&lt;/span&gt; python_application:python_application /application_root                                                             &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.1s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;service-stage  &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;/10&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; RUN &lt;span class=&quot;token function&quot;&gt;mkdir&lt;/span&gt; /application_root/.cache &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;chown&lt;/span&gt; python_application:python_application /application_root/.cache                    &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.2s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;service-stage  &lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt;/10&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; COPY entrypoint /entrypoint                                                                                                   &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;service-stage  &lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt;/10&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; RUN &lt;span class=&quot;token function&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;s/\r$//&apos;&lt;/span&gt; /entrypoint                                                                                              &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.2s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;service-stage  &lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;/10&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; RUN &lt;span class=&quot;token function&quot;&gt;chmod&lt;/span&gt; +x /entrypoint                                                                                                      &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.1s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;service-stage  &lt;span class=&quot;token number&quot;&gt;9&lt;/span&gt;/10&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; RUN apk &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt; --no-cache     g++     openssl                                                                                    &lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;.2s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;service-stage &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;/10&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; RUN poetry &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;--without&lt;/span&gt; dev                                                                                             &lt;span class=&quot;token number&quot;&gt;44&lt;/span&gt;.2s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; exporting to image                                                                                                                                 &lt;span class=&quot;token number&quot;&gt;11&lt;/span&gt;.8s```
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; exporting layers                                                                                                                                 &lt;span class=&quot;token number&quot;&gt;9&lt;/span&gt;.2s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; exporting manifest sha256:6b7bcd80340bf252c06947fde85a4fb53012c3d8bb07ff6dfd3a8b6fe6d1022c                                                       &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; exporting config sha256:58c4058d992779af8b0e3aa67ceabd655d234d871e38af0e6996155a56ed953e                                                         &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; exporting attestation manifest sha256:e88ed3098ce10fbce9ed2452c82ada1f5ccccb7c9d094b6f2da495754249db26                                           &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; exporting manifest list sha256:b0b8cc043f1436abf29e9b45bcbcf618d0838de9d1678086c9b2b5acc1541e9b                                                  &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; naming to docker.io/library/python-hello:alpine-multi-2                                                                                          &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; unpacking to docker.io/library/python-hello:alpine-multi-2                                                                                       &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;.6s&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;빌드 시간과 크기에 대해 한번 살펴보죠.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; images
REPOSITORY     TAG              IMAGE ID       CREATED         SIZE
python-hello   alpine-multi-2   b0b8cc043f14   &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; minutes ago   &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;.13GB
python-hello   slim-multi-2     a23299c55409   &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; minutes ago   755MB&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;베이스이미지&lt;/th&gt;
&lt;th&gt;빌드된 이미지 크기&lt;/th&gt;
&lt;th&gt;소요시간(단위: 초)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;debian slim&lt;/td&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;755 MB&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;45.6&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;alpine&lt;/td&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;1.13 GB&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;90.4&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;debian 베이스 이미지는 용량, 소요시간 측면 모두에서 안정적이었습니다.&lt;/li&gt;
&lt;li&gt;alpine 베이스 이미지는 빌드시간 자체도 늦고, 크기도 커졌습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;그렇다면 alpine 베이스 이미지는 사용할 수 없는 걸까요? 왜 그런건지 알아보기에 앞서, 앞서  알아봅시다.&lt;/p&gt;
&lt;h2 id=&quot;c-라이브러리-구현체와-빌드의-차이&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#c-%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC-%EA%B5%AC%ED%98%84%EC%B2%B4%EC%99%80-%EB%B9%8C%EB%93%9C%EC%9D%98-%EC%B0%A8%EC%9D%B4&quot; aria-label=&quot;c 라이브러리 구현체와 빌드의 차이 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;C 라이브러리 구현체와 빌드의 차이&lt;/h2&gt;
&lt;p&gt;그렇다면 앞서 alpine linux 배포판과 debian 배포판의 차이를 알아봅시다. 이 글에서 살펴볼 둘의 주요 차이점은 C 라이브러리 구현체의 선택입니다. 각각의 특징을 살펴보겠습니다:&lt;/p&gt;
&lt;h3 id=&quot;glibc-debian-계열&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#glibc-debian-%EA%B3%84%EC%97%B4&quot; aria-label=&quot;glibc debian 계열 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;glibc&lt;/code&gt; (Debian 계열)&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;리눅스 생태계의 사실상 표준 구현체입니다&lt;/li&gt;
&lt;li&gt;대부분의 파이썬 패키지가 &lt;code class=&quot;language-text&quot;&gt;glibc&lt;/code&gt; 기준으로 빌드되어있으니, 안정성과 호환성이 검증되어 있습니다.&lt;/li&gt;
&lt;li&gt;그런 이유로 베이스 이미지 크기가 상대적으로 큽니다&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;musl-alpine-linux&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#musl-alpine-linux&quot; aria-label=&quot;musl alpine linux permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;musl&lt;/code&gt; (Alpine Linux)&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;경량화된 C 라이브러리 구현체입니다&lt;/li&gt;
&lt;li&gt;단순한 구현으로 보안 공격 표면이 작습니다&lt;/li&gt;
&lt;li&gt;베이스 이미지 크기가 매우 작습니다 (Debian 대비 약 1/20)&lt;/li&gt;
&lt;li&gt;일부 바이너리와 호환성 이슈가 발생할 수 있습니다&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;python-wheels의-발전과-alpine-linux-지원&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#python-wheels%EC%9D%98-%EB%B0%9C%EC%A0%84%EA%B3%BC-alpine-linux-%EC%A7%80%EC%9B%90&quot; aria-label=&quot;python wheels의 발전과 alpine linux 지원 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Python Wheels의 발전과 Alpine Linux 지원&lt;/h2&gt;
&lt;p&gt;과거에는 Alpine Linux에서 많은 파이썬 패키지를 설치할 때 소스로부터 직접 빌드해야 했고, 이는 컨테이너 빌드 시간을 길어지게 하는 주요 요소였습니다. 하지만 Python 패키징 생태계의 발전으로 상황이 크게 개선되었습니다.&lt;/p&gt;
&lt;h3 id=&quot;python-패키징의-발전-과정&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#python-%ED%8C%A8%ED%82%A4%EC%A7%95%EC%9D%98-%EB%B0%9C%EC%A0%84-%EA%B3%BC%EC%A0%95&quot; aria-label=&quot;python 패키징의 발전 과정 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Python 패키징의 발전 과정&lt;/h3&gt;
&lt;p&gt;다양한 배포판에서 파이썬 패키지를 바로 설치할 수 있도록 하기 위해, 아래와 같은 PEP가 지속적으로 제안되어 왔고 또 받아들여졌습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;PEP 513 (manylinux1): 최초의 호환성 있는 Linux wheel 표준 도입&lt;/li&gt;
&lt;li&gt;PEP 571 (manylinux2010): glibc 2.12 기반 호환성 확장&lt;/li&gt;
&lt;li&gt;PEP 599 (manylinux2014): 더 새로운 시스템 라이브러리 지원&lt;/li&gt;
&lt;li&gt;PEP 600 (Future manylinux): 향후 확장성을 고려한 태그 체계 도입&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;PEP 656 (musllinux)&lt;/strong&gt;: Alpine Linux 등 &lt;code class=&quot;language-text&quot;&gt;musl&lt;/code&gt; 기반 배포판 공식 지원&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;PEP 656이 accept 되며, &lt;code class=&quot;language-text&quot;&gt;musl&lt;/code&gt; 기반의 빌드가 이루어진 파이썬 패키지도 직접 다운로드 받게 되어, 이를 지원하고 빌드한 라이브러리라면 누구나 쓸 수 있게 되었습니다.&lt;/p&gt;
&lt;h3 id=&quot;manylinux&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#manylinux&quot; aria-label=&quot;manylinux permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;manylinux?&lt;/h3&gt;
&lt;p&gt;manylinux는 “Python wheels that work on any linux (almost).” 라는 목표를 가지고 다양한 배포판을 타겟으로 빌드하기 위해 시작된 프로젝트 입니다. 원하는 리눅스 배포판에서 라이브러리를 빌드없이 직접 다운로드 받아 쓸 수 있도록 규약을 잡기 시작한 것이라고 이해할 수 있지요(&lt;a href=&quot;https://github.com/pypa/manylinux&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;manylinux 링크&lt;/a&gt;에서 발췌하였습니다).&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;markdown&quot;&gt;&lt;pre class=&quot;language-markdown&quot;&gt;&lt;code class=&quot;language-markdown&quot;&gt;&lt;span class=&quot;token title important&quot;&gt;manylinux
&lt;span class=&quot;token punctuation&quot;&gt;---&lt;/span&gt;&lt;/span&gt;

Older archives: https://groups.google.com/forum/#!forum/manylinux-discuss

The goal of the manylinux project is to provide a convenient way to distribute binary Python extensions as wheels on Linux. This effort has produced PEP 513 (manylinux1), PEP 571 (manylinux2010), PEP 599 (manylinux2014), PEP 600 (manylinux_x_y) and PEP 656 (musllinux_x_y).&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;pep-656의-의의&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#pep-656%EC%9D%98-%EC%9D%98%EC%9D%98&quot; aria-label=&quot;pep 656의 의의 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;PEP 656의 의의&lt;/h3&gt;
&lt;p&gt;Alpine linux와 관련해서는 PEP 656(Platform Tag for Linux Distributions Using Musl)은 위 PEP의 연장선상이라 할 수 있지요. 이 표준이 받아들여지면서, &lt;code class=&quot;language-text&quot;&gt;musl&lt;/code&gt; 기반의 빌드된 wheel을 배포자가 업데이트 하면 사용자가 즉시 설치할 수 있게 된 것입니다. 이로 인해 alpine linux 기반의 베이스 이미지를 선택해도 빌드 시간 단축 및 의존성 문제를 해결할 수 있게 된 겁니다.&lt;/p&gt;
&lt;p&gt;이로인해 Alpine 베이스 파이썬 컨테이너를 선택하더라도 빌드 시간 단축과 이미지 크기 최적화의 이점을 누릴 수 있게 되었습니다. 특히 PEP 656 도입 이후에는 많은 패키지가 musllinux wheel을 제공하고 있고, 코어 로직이 Rust로 짜여진 파이썬 패키지들은 크로스플랫폼을 쉽게 지원하기 때문에 이런 부분에서도 선택에 제약이 크게 없습니다.&lt;/p&gt;
&lt;h2 id=&quot;마지막으로&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%88%EC%A7%80%EB%A7%89%EC%9C%BC%EB%A1%9C&quot; aria-label=&quot;마지막으로 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;마지막으로&lt;/h2&gt;
&lt;p&gt;그렇지만 여전히 의문입니다. 그러면 언제, 어떤 시기에 적절한 베이스 이미지를 선택하면 될까요? 무턱대고 고르기에는 아무래도 의심이 듭니다. 간단하게나마 있을법한 일을 검증해보고 적절한지 예시 데이터를 보면 더욱 안심이겠죠. 그래서 다음장에는 아래의 상황에서 어떤 베이스 이미지가 좋은지 함께 살펴볼 예정입니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;I/O bound 태스크 중심: API 서비스를 만들고, DB에는 1억개의 데이터을 추가한 후, 쿼리 테스트 및 부하 테스트를 수행하여 성능을 리포트&lt;/li&gt;
&lt;li&gt;CPU bound 태스크 중심: 매우 큰 데이터를 pandas로 처리, matplotlib으로 연산하게 구성해보고 성능을 리포트&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;긴 글 읽어주셔서 감사합니다.&lt;/p&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;패키지(이 글에서는 파이썬 패키지를 의미)는 &lt;code class=&quot;language-text&quot;&gt;pip&lt;/code&gt; 등으로 설치할 수 있는 외부 모듈의 모음을 의미합니다. 쉽게 말하자면 파이썬 라이브러리라고 할 수 있지요.&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[[연재] 파이썬 컨테이너 선택 제 1형 - 컨테이너에 대해]]></title><description><![CDATA[컨테이너 기술에 대해 간략히 설명하고, 파이썬 컨테이너는 어떻게 선택할 수 있는지 대해 설명합니다.]]></description><link>https://blog.s3ich4n.me/devlog/python/2024-10-13-python-container-101-pt01</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/python/2024-10-13-python-container-101-pt01</guid><pubDate>Sun, 13 Oct 2024 03:00:00 GMT</pubDate><content:encoded>&lt;p&gt;이번 게시글에서는 컨테이너 기술에 대해 간략히 설명하고, 파이썬 컨테이너를 구성하기 위한 선택지를 살펴봅니다.&lt;/p&gt;
&lt;p&gt;이 게시글은, 파이썬으로 서버 개발을 진행한 경험이 있으시다면 보다 쉽게 이해하실 수 있습니다.&lt;/p&gt;
&lt;h2 id=&quot;컨테이너-기술&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88-%EA%B8%B0%EC%88%A0&quot; aria-label=&quot;컨테이너 기술 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;컨테이너 기술?&lt;/h2&gt;
&lt;p&gt;요즘은 컨테이너로 서비스를 배포하는 것이 굉장히 일상적입니다. 각종 기고문 등에서도 컨테이너를 사용한 배포가 일상화 되어있고, 국내의 큰 회사도 100만개의 컨테이너가 동시에(!) 돌기도 한다고 합니다. 그렇다면 컨테이너가 어떤 것인지 먼저 살펴볼까요?&lt;/p&gt;
&lt;h3 id=&quot;컨테이너-이전에는&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88-%EC%9D%B4%EC%A0%84%EC%97%90%EB%8A%94&quot; aria-label=&quot;컨테이너 이전에는 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;컨테이너 이전에는…&lt;/h3&gt;
&lt;p&gt;과거 서버를 구성할 때는 개발팀(Dev)의 개발 후 품질보증팀(QA), 보안팀(Infosec)의 검증을 거쳐서 운영팀(Ops)이 배포하는 흐름이었습니다. 이러한 개발 방식은 서비스를 기획하고 지속적으로 운영하며 여러 문제를 겪는데요. 첫 번째 문제는, 개발한 코드가 배포되기까지의 흐름이 너무 늦다는 것입니다.&lt;/p&gt;
&lt;p&gt;우리는 배포에 가까워지며 버그를 패치할 때는 임시방편으로 일정을 맞추기 위한 코드를 짜죠. 이런 ‘기술 부채’들은 지속적으로 쌓이고, 언젠간 해결해야지 하는 방법으로 계속 때우는 것으론 한계가 발생합니다. 근본결함을 수정하기에는 문제 해결에 대한 시간이 너무 짧다는 것입니다.&lt;/p&gt;
&lt;p&gt;두 번째 문제는 배포와 관리를 하기 위한 서버 관리 비용 또한 고려의 대상이라는 것입니다. 배포를 할 땐 서버 환경을 모두 알고 잘 구성해야 합니다. 하나라도 어긋나면 서버구동이 되지 않을 수 있습니다. 서버를 늘리고 줄이기 위해서는 물리 서버에 동일한 작업을 여러 번 반복하는 것 또한 일입니다.&lt;/p&gt;
&lt;p&gt;이 두 가지 단점에 대해서는, 후술할 DevOps 개념과 컨테이너가 본격적으로 쓰이기 전인 2011년 IDC와 가트너(Gartner)는 전 세계 GDP의 약 3.1조 달러가 IT에 지출된다고 추정했습니다&lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;🍎 tips&lt;/p&gt;
&lt;p&gt;컨테이너가 등장하기 이전에도 이를 위한 많은 시도가 있었지만, 주제와 어긋나므로 과감히 생략합니다. 관련해서는 이 글&lt;sup id=&quot;fnref-2&quot;&gt;&lt;a href=&quot;#fn-2&quot; class=&quot;footnote-ref&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;의 단락을 읽어주세요.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;컨테이너-iac-devops-lets-go&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88-iac-devops-lets-go&quot; aria-label=&quot;컨테이너 iac devops lets go permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;컨테이너, IaC, DevOps, let’s go&lt;/h3&gt;
&lt;p&gt;보통 말하는 컨테이너의 정의는 아래와 같습니다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;애플리케이션을 패키징화하고 실행을 격리한다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;다시말해, 서버 구성 환경 하나하나 고정하여 어디서든 동일하게 실행가능한 프로세스 입니다. 좀 뭉뚱그려 말하면 이게 구동되면 서버가 돌 수 있는 것이지요. 그런 컨테이너 기술로 널리 사용되는 것은 단연 Docker 입니다. 컨테이너 기술의 등장으로 인해 기존 배포과정에서의 단점이 훌륭하게 해결되었지요. 실행 당시의 환경을 별도로 격리시켜주고, 종속성을 유지할 수 있게 할 수 있게 되다보니 아래와 같은 장점을 누릴 수 있게 되었습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;개발환경과 운영환경의 차이점을 최소화 할 수 있습니다.&lt;/li&gt;
&lt;li&gt;다른 사람이 만든 “서버”를 쉽게 가져다 사용할 수 있습니다.&lt;/li&gt;
&lt;li&gt;서버 가용성을 확장하기 위해 컨테이너를 한 서버/다른 서버 에서 동시에 구동하여 처리할 수도 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;summary&gt;🤔 컨테이너 기술이 DevOps에 끼치는 영향&lt;/summary&gt;
&lt;blockquote&gt;
&lt;p&gt;🍎 tips&lt;/p&gt;
&lt;p&gt;글의 방향을 이해하는 데는 크게 필요없지만, 만약 더 알아보시고 싶으시다면 아래 내용도 참고해주세요.&lt;/p&gt;
&lt;p&gt;만일 IaC 중 Terraform에 대해 관심이 있으시다면 저의 &lt;a href=&quot;https://velog.io/@s3ich4n/series/2022%EB%85%84-Terraform-%EC%8A%A4%ED%84%B0%EB%94%94&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;다른 연재글&lt;/a&gt;을 함께 살펴봐주시면 감사하겠습니다. 🙇&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;클라우드 컴퓨팅의 시대로 들어오며 이런 장점은 더욱 극대화 되기 시작했습니다. 기존에는 서버실 구성, 각종 배선작업 및 쿨링 시스템 구축을 거의 모든 회사가 직접 해야했으나, 원격지의 서버를 임대하여 사용할 수 있는 시스템이 등장함으로 인해 이런 컨테이너를 통한 장점이 더욱 극대화될 수 있는 환경마저 제공된 것이죠. 심지어는 이런 구성마저도 코드로 관리하여(IaC, Infrastructure as Code) 처리하는 접근법이 대두되기도 합니다.&lt;/p&gt;
&lt;p&gt;이런 식으로 기존 개발 방식에서 개발팀(Dev)와 운영팀(Ops)의 역할 사이클을 한 번에 줄이고 보다 자주, 그리고 견고하게 배포하도록 하는 과정이 DevOps의 일부라고 할 수 있겠습니다.&lt;/p&gt;
&lt;/details&gt;
&lt;h2 id=&quot;컨테이너에-대해&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88%EC%97%90-%EB%8C%80%ED%95%B4&quot; aria-label=&quot;컨테이너에 대해 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;컨테이너에 대해&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;🍎 note&lt;/p&gt;
&lt;p&gt;이 글 이후로 컨테이너 관련 플랫폼은 Docker(이하 도커)를 사용하도록 하겠습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;지금까지 컨테이너에 대한 말이 굉장히 많이 나왔는데요. 그렇다면 이건 어떻게 만들고 구동해볼 수 있을까요? 설명에 앞서 용어부터 정리해봅시다. 컨테이너 기술을 이야기할 때는 흔히 “도커 이미지”와 “도커 컨테이너”라는 용어를 사용하여 실행가능한 형태와 실제 구동중인 형태를 각각 표현합니다. “도커 이미지”에 대한 설계도는 &lt;code class=&quot;language-text&quot;&gt;Dockerfile&lt;/code&gt; 이구요.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/3e98425217ba1cc676b279553aac1cf6/e8950/01-docker-image-container-explained.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 34.583333333333336%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAPoAAAD6AG1e1JrAAABjElEQVQY021PS0sCURi9UO3b9Rdatok2EZjQov5A0LZdmyAIwkUEEVL00KZ8JTaViAZqSgZBY6OUlpb5GMukIsxSxx5j2kw6c7/Q2XZWh8PhPJDDZrWY9LukxULu8LwAAK4Dj3ppmdAbN/WGxZVV8zYJLew7nRpiY43Y0BlNy5p1z+EhGrMEu+d9fdN6u/dINsVTDEVRkfAZRQdO6UD4Mirr1/EEHQi6fUc214GfDiSZNOr3CUj3jlQn4/ZrAKiLEgBUGmBOcZtXLABIGOqiiLGcAEJDLHJVmSOls9CxxLSrYyPW9FM+H7nLZkvcAJlGsxc9hsSo65GIFPPFQiidrQnNU1zlM/f2hqVmB1K4yp3GFzQXHd5jAECs857MJ9LmurZLaOVVYc+9VnhJwjX+J/vVsDIfxiS3FXpY8F5QmQKaPK8p3GXlTkpFPctjvgXx+J6dCbLTNMtWfwGgITVHG5IVNHfTtnjbofKjqZMhrR/B/8AAEgDGuMVah92PP91krteWHzTHeojIhCP6B14NRtjhLb+IAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/3e98425217ba1cc676b279553aac1cf6/8ac56/01-docker-image-container-explained.webp 240w,
/static/3e98425217ba1cc676b279553aac1cf6/d3be9/01-docker-image-container-explained.webp 480w,
/static/3e98425217ba1cc676b279553aac1cf6/e46b2/01-docker-image-container-explained.webp 960w,
/static/3e98425217ba1cc676b279553aac1cf6/f992d/01-docker-image-container-explained.webp 1440w,
/static/3e98425217ba1cc676b279553aac1cf6/882b9/01-docker-image-container-explained.webp 1920w,
/static/3e98425217ba1cc676b279553aac1cf6/b84eb/01-docker-image-container-explained.webp 2000w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/3e98425217ba1cc676b279553aac1cf6/8ff5a/01-docker-image-container-explained.png 240w,
/static/3e98425217ba1cc676b279553aac1cf6/e85cb/01-docker-image-container-explained.png 480w,
/static/3e98425217ba1cc676b279553aac1cf6/d9199/01-docker-image-container-explained.png 960w,
/static/3e98425217ba1cc676b279553aac1cf6/07a9c/01-docker-image-container-explained.png 1440w,
/static/3e98425217ba1cc676b279553aac1cf6/29114/01-docker-image-container-explained.png 1920w,
/static/3e98425217ba1cc676b279553aac1cf6/e8950/01-docker-image-container-explained.png 2000w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/3e98425217ba1cc676b279553aac1cf6/d9199/01-docker-image-container-explained.png&quot;
            alt=&quot;귀여운 고래와 함께 보시죠&quot;
            title=&quot;귀여운 고래와 함께 보시죠&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;귀여운 고래와 함께 보시죠&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&quot;도커-이미지와-dockerfile에-대해&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8F%84%EC%BB%A4-%EC%9D%B4%EB%AF%B8%EC%A7%80%EC%99%80-dockerfile%EC%97%90-%EB%8C%80%ED%95%B4&quot; aria-label=&quot;도커 이미지와 dockerfile에 대해 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;도커 이미지와 &lt;code class=&quot;language-text&quot;&gt;Dockerfile&lt;/code&gt;에 대해&lt;/h3&gt;
&lt;p&gt;이미지는 애플리케이션을 실행하는데 필요한 모든 것을 포함하는 ‘불변의 템플릿’입니다. 여기엔 소스 코드, 런타임, 라이브러리, 환경 변수, 설정 파일 등이 포함됩니다. 그리고 이 이미지를 만드는 명세서가 바로 &lt;code class=&quot;language-text&quot;&gt;Dockerfile&lt;/code&gt;입니다. Dockerfile에는 이미지를 어떻게 만들지 순서대로 적어둡니다. 기준이 되는 이미지부터 우리가 원하는 내용을 추가할 수 있지요. 한번 살펴봅시다.&lt;/p&gt;
&lt;p&gt;Dockerfile의 각 명령어는 하나의 “레이어”가 되어 이미지를 겹겹이 쌓아갑니다. 각각의 레이어는 그 명령어로 인한 파일 시스템의 변경사항을 담고 있죠. 한번 만들어진 레이어는 읽기 전용이 되어 “불변성”을 보장합니다. 이렇게 모든 레이어가 쌓이면 하나의 이미지가 완성되는 거죠.&lt;/p&gt;
&lt;p&gt;도커 이미지를 만들기 위한 바탕을 베이스 이미지&lt;sup id=&quot;fnref-3&quot;&gt;&lt;a href=&quot;#fn-3&quot; class=&quot;footnote-ref&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;라고 부르기도 합니다. 파이썬 베이스 이미지는 &lt;a href=&quot;https://hub.docker.com/_/python&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Docker Hub&lt;/a&gt;에서 확인하실 수 있어요. 필요한 파이썬 버전이 있다면 그에 맞는 값을 바꿔주면 됩니다. &lt;code class=&quot;language-text&quot;&gt;3.12&lt;/code&gt; 버전이 필요하면 그 값을 입력하면 되죠. 심지어는 어떤 운영체제에서 구동되는 걸 기대하는지도 지정해줄 수 있습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;dockerfile&quot;&gt;&lt;pre class=&quot;language-dockerfile&quot;&gt;&lt;code class=&quot;language-dockerfile&quot;&gt;&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; python:3.12            # 앞서 살펴본 베이스 이미지 입니다. 여기서는 파이썬 3.12를 사용해요.&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;WORKDIR&lt;/span&gt; /app                # 이제부터의 명령어들이 실행될 작업 디렉터리를 지정합니다.&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;COPY&lt;/span&gt; hello.py .             # 현재 디렉터리의 hello.py 파일을 컨테이너의 /app 디렉터리로 복사합니다.&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;CMD&lt;/span&gt; [&lt;span class=&quot;token string&quot;&gt;&quot;python&quot;&lt;/span&gt;, &lt;span class=&quot;token string&quot;&gt;&quot;hello.py&quot;&lt;/span&gt;]  # 컨테이너가 시작될 때 실행할 명령어를 지정합니다.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;만들어봅시다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%8C%EB%93%A4%EC%96%B4%EB%B4%85%EC%8B%9C%EB%8B%A4&quot; aria-label=&quot;만들어봅시다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;만들어봅시다!&lt;/h3&gt;
&lt;p&gt;그러면 헬로월드를 출력하는 도커 이미지를 만들어봅시다. &lt;a href=&quot;https://www.docker.com/products/docker-desktop/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Docker Desktop&lt;/a&gt;을 설치하고 한번 만들어볼까요!&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;hello.py&lt;/code&gt; 파일 생성:&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Hello, geultto!&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Dockerfile&lt;/code&gt; 생성(위에서 본 내용입니다):&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;dockerfile&quot;&gt;&lt;pre class=&quot;language-dockerfile&quot;&gt;&lt;code class=&quot;language-dockerfile&quot;&gt;&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; python:3.12&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;WORKDIR&lt;/span&gt; /app&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;COPY&lt;/span&gt; hello.py .&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;CMD&lt;/span&gt; [&lt;span class=&quot;token string&quot;&gt;&quot;python&quot;&lt;/span&gt;, &lt;span class=&quot;token string&quot;&gt;&quot;hello.py&quot;&lt;/span&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;이미지 빌드:&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;3을 실행시키면 아래와 같은 결과가 나옵니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; build &lt;span class=&quot;token parameter variable&quot;&gt;-t&lt;/span&gt; python-hello &lt;span class=&quot;token builtin class-name&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;+&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; Building &lt;span class=&quot;token number&quot;&gt;26&lt;/span&gt;.1s &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;/8&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; FINISHED                           docker:desktop-linux
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;internal&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; load build definition from Dockerfile                        &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; transferring dockerfile: 151B                                        &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;internal&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; load metadata &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; docker.io/library/python:3                 &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;.7s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;internal&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; load .dockerignore                                           &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; transferring context: 2B                                             &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;/3&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; FROM docker.io/library/python:3.12@sha256:&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;생략&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;                 &lt;span class=&quot;token number&quot;&gt;22&lt;/span&gt;.7s
 &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; extracting sha256:&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;생략&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;internal&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; load build context                                           &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; transferring context: 98B                                            &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;/3&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; WORKDIR /app                                                      &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.5s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;/3&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; COPY hello.py &lt;span class=&quot;token builtin class-name&quot;&gt;.&lt;/span&gt;                                                   &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; exporting to image                                                      &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.1s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; exporting layers                                                     &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; naming to docker.io/library/python-hello:latest                      &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s
 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; unpacking to docker.io/library/python-hello:latest                   &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.0s

What&apos;s next:
    View a summary of image vulnerabilities and recommendations → &lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; scout quickview&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;축하합니다. 당신은 첫 파이썬 컨테이너를 빌드했습니다! 🎉🎉&lt;/p&gt;
&lt;h3 id=&quot;도커-컨테이너&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8F%84%EC%BB%A4-%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88&quot; aria-label=&quot;도커 컨테이너 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;도커 컨테이너?&lt;/h3&gt;
&lt;p&gt;그렇다면 도커 컨테이너는 무엇일까요? 바로 도커 이미지를 실행한 프로세스를 말합니다. 이 프로세스는:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;격리된 프로세스 공간 확보&lt;/li&gt;
&lt;li&gt;호스트로부터 컨테이너 자신만의 독립된 파일시스템을 확보&lt;/li&gt;
&lt;li&gt;컨테이너 만의 네트워크 환경을 개별적으로 확보&lt;/li&gt;
&lt;li&gt;심지어 실행 권한도 별도로 부여받을 수 있습니다!&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이런 특성들 덕분에:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;어떤 환경에서도 동일하게 실행됩니다
&lt;ul&gt;
&lt;li&gt;내 컴퓨터에서 잘 돌던 게 서버에서도 그대로!&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;다른 프로세스와 충돌 없이 실행됩니다
&lt;ul&gt;
&lt;li&gt;Python 2.7과 3.8이 필요한 프로그램들도 걱정 없이!&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;문제가 생겨도 다른 프로그램에 영향을 주지 않습니다
&lt;ul&gt;
&lt;li&gt;하나의 컨테이너가 문제가 생겨도 다른 건 멀쩡해요&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;그러면 컨테이너를 한번 실행해볼까요?&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; run python-hello
Hello, geultto&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;컨테이너 실행 완료! 이제 더 이상 환경에 구애받지 않는 실행환경이 만들어졌어요! 🎉🎉&lt;/p&gt;
&lt;h2 id=&quot;그런데&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B7%B8%EB%9F%B0%EB%8D%B0&quot; aria-label=&quot;그런데 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;그런데?&lt;/h2&gt;
&lt;p&gt;성공적으로 실행했으니 이제 빌드한 이미지의 크기를 확인해봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; images python-hello
REPOSITORY     TAG       IMAGE ID       CREATED         SIZE
python-hello   latest    746136719e90   &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; minutes ago   &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;.46GB&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;헬로월드 하나 찍는데 &lt;code class=&quot;language-text&quot;&gt;1.46GB&lt;/code&gt; 나 쓴다구요?????? 이건 무슨 의미일까요?&lt;/p&gt;
&lt;h3 id=&quot;컨테이너-크기가-커지는-이유&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88-%ED%81%AC%EA%B8%B0%EA%B0%80-%EC%BB%A4%EC%A7%80%EB%8A%94-%EC%9D%B4%EC%9C%A0&quot; aria-label=&quot;컨테이너 크기가 커지는 이유 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;컨테이너 크기가 커지는 이유&lt;/h3&gt;
&lt;p&gt;컨테이너 크기가 비대한 이유는 아래와 같습니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;기본 파이썬 이미지의 크기
&lt;ul&gt;
&lt;li&gt;기본 파이썬 인터프리터, 표준 라이브러리, pip 뿐 아니라 개발 도구와 디버깅 도구도 포함될 수 있기 때문입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;운영체제 레이어와 각종 의존성
&lt;ul&gt;
&lt;li&gt;기본 OS 파일 시스템, 유틸리티 등이 함께 포함될 수 있기 때문입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;그런데 여기서 애플리케이션 코드 및 데이터가 들어가면?
&lt;ul&gt;
&lt;li&gt;프로젝트에 필요한 라이브러리 설치 시 크기 증가&lt;/li&gt;
&lt;li&gt;프로젝트 파일, 정적 자산 등이 추가될 때마다 크기 증가&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;그렇다면 이미지는 현재라면 더 커지는 수 밖에 없겠습니다. 점점 커지는 이미지는 지양해야 할 것 같은 예감이 드는데요. 어떤 단점이 있는지 살펴보았습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;배포 시간 증가
&lt;ul&gt;
&lt;li&gt;큰 이미지는 다운로드와 업로드에 더 많은 시간을 소요합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;스토리지 비용 증가
&lt;ul&gt;
&lt;li&gt;컨테이너 레지스트리(일종의 컨테이너 저장소입니다)와 호스트 시스템에서 더 많은 공간 차지할 수 있습니다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;보안 취약점 증가 가능성
&lt;ul&gt;
&lt;li&gt;불필요한 패키지가 포함될 경우 공격 표면(attack vector, 공격받을 수 있는 pain point를 의미)이 잠재적으로 많아집니다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;컨테이너 시작 시간 증가
&lt;ul&gt;
&lt;li&gt;큰 이미지는 로딩에 더 많은 시간 소요&lt;/li&gt;
&lt;li&gt;앞으로 더 커진다면 더 로딩되는 시간이 길어지겠지요&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;리소스 사용 효율성 저하
&lt;ul&gt;
&lt;li&gt;불필요한 컴포넌트로 인한 메모리 및 CPU 사용량 증가&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;끝으로&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%81%9D%EC%9C%BC%EB%A1%9C&quot; aria-label=&quot;끝으로 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;끝으로&lt;/h2&gt;
&lt;p&gt;그렇다면 다음 글에서는 파이썬 컨테이너 이미지 크기를 줄이기 위한 여러 방안을 살펴보고, 파이썬 컨테이너 이미지 빌드가 가지는 특징을 살펴보도록 하겠습니다.&lt;/p&gt;
&lt;p&gt;긴 글 읽어주셔서 감사합니다.&lt;/p&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;자세한 내용은 &lt;a href=&quot;https://www.itjungle.com/2011/07/11/tfh071111-story03/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 링크를&lt;/a&gt;, 관련 출처는 &lt;a href=&quot;https://readingraphics.com/book-summary-the-devops-handbook/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 링크&lt;/a&gt;에서 확인할 수 있습니다.&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-2&quot;&gt;&lt;a href=&quot;https://www.44bits.io/ko/post/why-should-i-use-docker-container#%EC%9A%B4%EC%98%81%ED%95%98%EB%A9%B4%EC%84%9C-%EB%A7%8C%EB%93%A4%EC%96%B4%EC%A7%80%EB%8A%94-%EB%88%88%EC%86%A1%EC%9D%B4-%EC%84%9C%EB%B2%84%EB%93%A4snowflake-servers&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://www.44bits.io/ko/post/why-should-i-use-docker-container#운영하면서-만들어지는-눈송이-서버들snowflake-servers&lt;/a&gt;&lt;a href=&quot;#fnref-2&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-3&quot;&gt;모든 이미지의 베이스 이미지도 있습니다. &lt;a href=&quot;https://docs.docker.com/build/building/base-images/#creating-a-simple-parent-image-using-scratch&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;참고 링크&lt;/a&gt;&lt;a href=&quot;#fnref-3&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[[글또10기] 삶의 지도]]></title><description><![CDATA[글또 10기를 지원하며, 개발자로 걸어온 길을 반추해 보았습니다. 어떤 삶을 살았고 앞으로는 어떤 길을 걸어야 할지 생각해 보았습니다. 이 이정표는 역시나 글이겠지요.]]></description><link>https://blog.s3ich4n.me/retrospect/2024-09-17-geultto-10th-life-retrospect</link><guid isPermaLink="false">https://blog.s3ich4n.me/retrospect/2024-09-17-geultto-10th-life-retrospect</guid><pubDate>Tue, 17 Sep 2024 01:01:00 GMT</pubDate><content:encoded>&lt;p&gt;프로그래밍을 업으로 삼게 된 시절부터, 집에서 글을 쓰는 현재까지 돌아보려 합니다.&lt;/p&gt;
&lt;h2 id=&quot;제1장-프로그래밍에-입문&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A0%9C1%EC%9E%A5-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D%EC%97%90-%EC%9E%85%EB%AC%B8&quot; aria-label=&quot;제1장 프로그래밍에 입문 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;제1장: 프로그래밍에 입문&lt;/h2&gt;
&lt;p&gt;남들처럼 단순히 고등학교에 다니며 게임이 좋던 한 학생은 우연한 계기로 직업에 대한 고민을 시작하게 됩니다. 이런저런 고민을 하다 컴퓨터 관련 직종을 업으로 삼자는 결론에 도달하자, 비로소 주도적인 행동이 시작됩니다. 이미 문과를 선택했으니 교차지원이라는 제도를 이용하자는 결정과 함께, 입시를 마치고 대학합격 통보부터는 무엇을 해야 할지 공부하기 시작했습니다.
대학생활은 흥미의 연속이었습니다. 이 분야 저 분야에 도전한 기억이 남네요. 학교 내 과제 뿐 아니라 외부 행사를 다니고, Let’s Encrypt 사용을 위한 HTTPS 가이드북 eBook 집필 과정에 참여도 하고, 프로그램 경진대회에도 나가보는 등 많은 일들을 진행해 봤습니다.
그 결과로, ‘컴퓨터공학 분야가 나와 맞는구나. 지향하는 삶의 방향과 일치하는구나’ 하는 결론을 내리게 되었습니다. 이 분야는 계속해서 공부해야 한다는 점, 기초를 충실히 해야 한다는 점, 그리고 다른 사람과 함께 일해야 한다는 점에서 말이지요. 무엇보다도 제 삶이 가장 원하는 부분이기도 했으니까요. 그렇게 졸업 후 고집 있게 원하는 회사를 찾기위한 노력을 기울였고, 인턴쉽을 시작하게 되었습니다.&lt;/p&gt;
&lt;h2 id=&quot;제2장-즐기면서도-프로정신을-유지하기-위해&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A0%9C2%EC%9E%A5-%EC%A6%90%EA%B8%B0%EB%A9%B4%EC%84%9C%EB%8F%84-%ED%94%84%EB%A1%9C%EC%A0%95%EC%8B%A0%EC%9D%84-%EC%9C%A0%EC%A7%80%ED%95%98%EA%B8%B0-%EC%9C%84%ED%95%B4&quot; aria-label=&quot;제2장 즐기면서도 프로정신을 유지하기 위해 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;제2장: 즐기면서도 프로정신을 유지하기 위해&lt;/h2&gt;
&lt;p&gt;인턴쉽을 시작하며 미니프로젝트를 시작했습니다. 이 때 저의 가장 큰 패착은 일정준수와 기술간의 갈등이 아니었나 싶습니다. 팀원과 많은 이야기를 나누었다고 생각했지만 현재 논의할 필요가 없는 태스크이기도 했고 그렇게 종료되었습니다.
이후 보안 스타트업에서 백엔드 프로그래머로 일을 다시 시작하며, 글쓰기를 처음 시작해 보았습니다. 내가 무엇을 배웠고, 어떤 실수를 했으며 앞으로 어떤 걸 배워야할지를 썼지요. 이 때부터 글쓰기의 중요성을 깨달았습니다. 특히 복잡한 기술 개념을 글로 설명하는 과정에서, 제가 그 기술을 얼마나 깊이 이해하고 있는지 스스로 확인할 수 있었고, 이는 실제 코딩 시 더 명확한 로직을 구현하는 데 큰 도움이 되었습니다.
이 시기엔 내가 무엇을 했는지부터 간단히 메모하고 정리했습니다. 이후 퇴사하며 클라우드 관련 스터디를 시작하게 됐습니다. 썼던 내용을 정리하고 어떤 내용이 훗날의 제게, 그리고 누군가에게 도움이 되도록 써야 하는 게 너무 어려운 과정이었지만 탈고해가며 완성했습니다(돌이켜보면 이 시기 쓴 글이 제게 가장 큰 도움이 되었던 것 같습니다).&lt;/p&gt;
&lt;h2 id=&quot;제3장-오랜-휴식기와-복귀-그-시기에-함께한-글&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A0%9C3%EC%9E%A5-%EC%98%A4%EB%9E%9C-%ED%9C%B4%EC%8B%9D%EA%B8%B0%EC%99%80-%EB%B3%B5%EA%B7%80-%EA%B7%B8-%EC%8B%9C%EA%B8%B0%EC%97%90-%ED%95%A8%EA%BB%98%ED%95%9C-%EA%B8%80&quot; aria-label=&quot;제3장 오랜 휴식기와 복귀 그 시기에 함께한 글 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;제3장: 오랜 휴식기와 복귀, 그 시기에 함께한 “글”&lt;/h2&gt;
&lt;p&gt;저는 휴식기가 굉장히 길었습니다. 재취업을 위해 부단히 노력했고 이를 위해 충분히 준비했다 생각했지만 그렇지 못한 부분이 많았습니다. 아예 새로운 학습과 미니 프로젝트들로 준비했고, 많은 것들을 다시 공부하며 이를 글로 남겼습니다.
코딩테스트에 떨어진 부분부터 각종 도서를 읽고 배운 부분을 공유하기까지 필요한 모든 것을 공유했습니다. 결코 헛되이 시간을 보내지 않기 위해 노력을 가했던 기억이 아직도 생생합니다. 때로는 날밤을 지새우며 실무에 필요한 기술을 되짚기도 하고, 때로는 그 긴장탓에 아무 의욕도 나지 않았을 정도였기 때문이지요.
이후 좋은 기회를 잡고 새로운 조직에서, 저는 소프트웨어 조직의 일환으로써 제 맡은 바 일을 수행하는 것 뿐 아니라 위키나 각종 문서를 구성하기 시작했습니다. 앞으로는 사내 세미나를 진행하며 발표자료를 만들기도 하고, 배운 점과 회고하는 부분을 요약하는 것에 재미를 느끼고 더 많은 글을 남기려고 합니다.&lt;/p&gt;
&lt;h2 id=&quot;제4장-앞으로의-삶을-생각해보다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A0%9C4%EC%9E%A5-%EC%95%9E%EC%9C%BC%EB%A1%9C%EC%9D%98-%EC%82%B6%EC%9D%84-%EC%83%9D%EA%B0%81%ED%95%B4%EB%B3%B4%EB%8B%A4&quot; aria-label=&quot;제4장 앞으로의 삶을 생각해보다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;제4장: 앞으로의 삶을 생각해보다&lt;/h2&gt;
&lt;p&gt;앞으로 어떻게 살아갈지는 정답이 없지만, 개발자로서 저의 열과 성을 다해 일할 기간을 두고 생각하는 것이 더 좋을 것으로 생각하고 있습니다.
기술이야기를 앞으로 자주 할 예정이고, 이를 공유하는 습관을 갖도록 하는 것이 첫 번째 입니다. 글쓰기가 꾸준해진다면, 그리고 커뮤니티 내의 사람들과 논의한다면 서로 배우며 풍성한 글로 업데이트 해나갈 수 있겠지요.
이어서, 기술검증에 대한 간단한 테스트가 실린 글을 자주 기고하고 싶습니다. 특정 상황에서 테스트한 결과를 보여주는 글을 통해, 필요한 내용을 자신이 직접 검증해보는 문화로 이어지는 작은 계기가 되었으면 합니다.
끝으로, 함께 일을하는 사람으로써 느꼈던 내용을 쓰려 합니다. 무슨 장소에 있든 결과를 내기 위해 때로는 의견이 맞지 않을 수 있지요. 하지만 이를 맞추어가며 함께 자라고 나아가는 과정을 꼭 공유하는 것이 목표입니다.&lt;/p&gt;
&lt;p&gt;늦은 밤까지 삶을 돌아볼 수 있게 되어 기쁩니다. 한 번은 이런 시기가 있었으면 했는데 좋은 계기로 진행해볼 수 있게 되어 매우 기쁩니다. 이 글에서 보인 의지가 끊어지지 않고 이어졌으면 좋겠습니다.&lt;/p&gt;
&lt;p&gt;긴 글 읽어주셔서 감사합니다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[단위 테스트 (4)]]></title><description><![CDATA[단위 테스트 를 읽고 이해한 내용을 작성합니다. 챕터 4, 좋은 테스트의 4대 요소에 대한 내용입니다.]]></description><link>https://blog.s3ich4n.me/books/unit-testing/2023-07-04-pt02-ch04</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/unit-testing/2023-07-04-pt02-ch04</guid><pubDate>Tue, 04 Jul 2023 19:08:04 GMT</pubDate><content:encoded>&lt;p&gt;이 내용은 “단위 테스트” 를 읽고 작성한 내용입니다. 블로그 게시글과, 작성한 코드를 함께 보시면 더욱 좋습니다.&lt;/p&gt;
&lt;p&gt;4장은 해당 코드를 살펴봐주세요. &lt;a href=&quot;https://github.com/s3ich4n/unit-testing-101/tree/main/pt2/ch04&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;코드 링크&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Chapter 4. 좋은 테스트의 4대 요소&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;커맨드로 테스트를 직접 실행하기 위해선 현재 디렉토리로 이동한다.
&lt;code class=&quot;language-text&quot;&gt;cd pt2/ch04&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h1 id=&quot;들어가며&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0&quot; aria-label=&quot;들어가며 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;들어가며&lt;/h1&gt;
&lt;p&gt;1장에서 살펴본 좋은 단위 테스트 스위트의 특성을 상기시켜보자&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;개발 주기에 통합되어있다. 실제로 사용하는 테스트만 가치있다.&lt;/li&gt;
&lt;li&gt;코드베이스의 가장 중요한 부분만을 테스트 대상으로 한다. 애플리케이션의 핵심(도메인 모델)을 다른 것과 구별하는 것이 중요하다 (7장 참고)&lt;/li&gt;
&lt;li&gt;최소한의 유지비로 최대 가치를 끌어낸다. 이를 위해선 아래 두 가지를 할 수 있어야 한다
&lt;ul&gt;
&lt;li&gt;가치 있는 테스트 &lt;em&gt;식별&lt;/em&gt;(고가치, 저가치)&lt;/li&gt;
&lt;li&gt;가치 있는 테스트 &lt;em&gt;작성&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이 장은 가치 있는 테스트를 &lt;em&gt;식별&lt;/em&gt; 하는 것 부터 알아본다.&lt;/p&gt;
&lt;h1 id=&quot;41-좋은-단위-테스트의-4대-요소&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#41-%EC%A2%8B%EC%9D%80-%EB%8B%A8%EC%9C%84-%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%9D%98-4%EB%8C%80-%EC%9A%94%EC%86%8C&quot; aria-label=&quot;41 좋은 단위 테스트의 4대 요소 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.1 좋은 단위 테스트의 4대 요소&lt;/h1&gt;
&lt;p&gt;좋은 단위 테스트는 아래 네 가지 특성을 가진다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;회귀 방지&lt;/li&gt;
&lt;li&gt;리팩토링 내성&lt;/li&gt;
&lt;li&gt;빠른 피드백&lt;/li&gt;
&lt;li&gt;유지 보수성&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이 네 특성을 바탕으로 어떠한 자동화된 테스트(단위 테스트, 통합 테스트, e2e 테스트)든 분석 가능하다.&lt;/p&gt;
&lt;h2 id=&quot;411-회귀-방지protection-against-regressions&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#411-%ED%9A%8C%EA%B7%80-%EB%B0%A9%EC%A7%80protection-against-regressions&quot; aria-label=&quot;411 회귀 방지protection against regressions permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.1.1 회귀 방지(&lt;em&gt;Protection against regressions&lt;/em&gt;)&lt;/h2&gt;
&lt;p&gt;여기서 말하는 회귀는 ‘소프트웨어 버그’다. 코드 수정 후(신규기능 출시 후) 기능이 의도대로 작동하지 않는 경우다.&lt;/p&gt;
&lt;p&gt;버그는 코드베이스가 커지면 커질 수록 잠재적인 버그에 더 많이 노출된다. 따라서 코드보호를 통해 이를 방지해야 한다.&lt;/p&gt;
&lt;p&gt;회귀 방지 지표에 대한 테스트 점수가 얼마나 잘 나오는지 평가하려면 아래 사항을 고려한다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;테스트 중에 실행되는 코드의 양&lt;/li&gt;
&lt;li&gt;코드 복잡도&lt;/li&gt;
&lt;li&gt;코드의 도메인 유의성(&lt;em&gt;significance&lt;/em&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;실행되는 코드가 많을 수록 테스트에서 회귀가 나타날 가능성이 높다. 물론 이 테스트에 대한 일련의 검증이 있다고 가정할 때, 단순히 코드를 실행시키는 것 만으로는 충분하지 않다. 테스트 수행을 통한 코드베이스의 실행결과도 검증해야 한다.&lt;/p&gt;
&lt;p&gt;코드 양 뿐 아니라 복잡도와 도메인 유의성 또한 중요하다. 복잡한 비즈니스 로직이 보일러플레이트 등을 통한 자동생성코드 보다 훨씬 중요하다. 비즈니스에 중요한 기능버그가 가장 큰 피해를 일으키기 때문이다.&lt;/p&gt;
&lt;p&gt;반면에 단순한 코드를 검증하는 것은 가치가 거의 없다. attribute 하나를 검증하기 위한 로직은 실수할 여지가 그리 많지 않다.&lt;/p&gt;
&lt;p&gt;작성하지 않은 코드(E.g., 라이브러리, 프레임워크, 외부 시스템 등)도 중요하다. 최상의 보호를 위해선 이런 코드 또한 검증이 올바른지 확인한다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;🍅 tips&lt;/p&gt;
&lt;p&gt;회귀 방지 지표를 극대화하려면 테스트가 가능한 한 많은 코드를 실행하도록 목표해야한다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;412-리팩토링-내성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#412-%EB%A6%AC%ED%8C%A9%ED%86%A0%EB%A7%81-%EB%82%B4%EC%84%B1&quot; aria-label=&quot;412 리팩토링 내성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.1.2 리팩토링 내성&lt;/h2&gt;
&lt;p&gt;좋은 단위 테스트의 두 번째 특성은 리팩토링 내성이다. 이는 ‘빨간막대’로 바꾸지 않고 기본 애플리케이션 코드를 리팩토링할 수 있는지에 대한 척도다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;‼️ 정의&lt;/p&gt;
&lt;p&gt;리팩토링은 식별할 수 있는 동작을 수정하지 않고 기존 코드를 변경하는 것을 의미한다.&lt;/p&gt;
&lt;p&gt;코드의 비기능적 특징을 개선하는 것으로 가독성을 높이고 복잡도를 낮추는 것이 주요 의도다.&lt;/p&gt;
&lt;p&gt;E.g., 메소드 명 변경, 코드 조각을 새 클래스로 추출.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;예를 들어 이런 상황이 발생했다고 생각해보자.&lt;/p&gt;
&lt;p&gt;새 기능 추가, 테스트코드 올패스 후 코드 리팩토링을 하려 한다. 리팩토링을 하니 테스트코드가 말썽이다. 기능은 의도대로 돌아가고 있다. 테스트만 ‘빨간막대’ 로 변했다. 이런 상황을 거짓 양성(&lt;em&gt;false positive&lt;/em&gt;, 긍정 오류. Type 1 에러라고도 함)이라고 한다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;이하 &lt;strong&gt;오탐&lt;/strong&gt; 으로 지칭하도록 하겠다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;이는 허위 경보다. 기능은 의도대로 돌지만 테스트가 실패하는 경우다. 이러한 ‘오탐’은 코드 리팩토링 시 발생한다. 좋은 단위 테스트의 한 가지 특성으로 이름붙이자면 ‘리팩토링 내성’이라고 일컫는다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Q: 거짓 양성, 거짓 음성이 헷갈려요&lt;/p&gt;
&lt;p&gt;A: 아래 짤방을 보세요&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;https://effectsizefaq.files.wordpress.com/2010/05/type-i-and-type-ii-errors.jpg&quot; alt=&quot;P는 작대기가 한개니까 Type I Error, N은 작대기가 2개니까 Type II Error&quot;&gt; &lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;p&gt;리팩토링 내성 지표에서 테스트 점수가 얼마나 잘 나오는지 평가하려면 테스트에서 얼마나 많은 ‘오탐’이 발생했는지 살펴봐야한다. 이는 적을 수록 좋다.&lt;/p&gt;
&lt;p&gt;‘오탐’을 신경써야 하는 이유는 전체 테스트 스위트에 치명적인 영향을 줄 수 있기 때문이다. 단위 테스트의 목표는 프로젝트 성장을 지속가능하게 하는 것이다. 테스트가 지속 가능한 성장을 하기 위한 메커니즘은 회귀없이 주기적으로 리팩토링하고 새 기능을 추가할 수 있는 것이다. 이로 인한 장점은 아래와 같다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;기존 기능이 고장났을 시 테스트로 조기경고를 받아볼 수 있다&lt;sup id=&quot;fnref-2&quot;&gt;&lt;a href=&quot;#fn-2&quot; class=&quot;footnote-ref&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;
&lt;ul&gt;
&lt;li&gt;결함 있는 코드를 배포 전 점검가능&lt;/li&gt;
&lt;li&gt;프로덕션 환경에서 문제 처리하려면 더 골치아팠을 것&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;코드 변경이 회귀로 이어지지 않을 것이라고 확신할 수 있다
&lt;ul&gt;
&lt;li&gt;좀더 공격적인 리팩토링을 할 수 있는 추진력이 된다&lt;/li&gt;
&lt;li&gt;코드베이스를 보다 깔끔하게 가져갈 수 있다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;‘오탐’은 두 이점을 모두 방해한다! 이유는 아래와 같다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;테스트가 타당한 이유 없이 실패하면, 코드 대응능력과 의지가 희석된다
&lt;ul&gt;
&lt;li&gt;실패에 익숙해지면 신경을 저절로 쓰지 않게 된다&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;타당한 실패까지 무시&lt;/strong&gt; 하게 된다! 이는 프로덕션 환경에 버그가 살포됨을 의미한다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;‘오탐’이 빈번하면 테스트 스위트를 신뢰할 수 없게 된다
&lt;ul&gt;
&lt;li&gt;믿을 만한 안전망으로 인식하지 않게 된다. &lt;em&gt;양치기 소년&lt;/em&gt; 이 되어버린다!&lt;/li&gt;
&lt;li&gt;신뢰가 부족해지면 리팩토링을 시도하기 어려워진다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이에 대한 대응은 테스트 스위트를 다시 살펴보고, 안정성을 높이는 것이다. (7장에서 다시 볼 것)&lt;/p&gt;
&lt;h2 id=&quot;413-무엇이-오탐의-원인인가&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#413-%EB%AC%B4%EC%97%87%EC%9D%B4-%EC%98%A4%ED%83%90%EC%9D%98-%EC%9B%90%EC%9D%B8%EC%9D%B8%EA%B0%80&quot; aria-label=&quot;413 무엇이 오탐의 원인인가 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.1.3 무엇이 ‘오탐’의 원인인가?&lt;/h2&gt;
&lt;p&gt;테스트에서 발생하는 ‘오탐’의 수는 테스트 구성방식과 관련되어있다. &lt;strong&gt;테스트와 SUT의 구현 세부 사항이 많이 결합할 수록&lt;/strong&gt; ‘오탐’이 많이 생긴다. 이를 위해선 테스트를 구현 세부 사항에서 분리해야한다.&lt;/p&gt;
&lt;p&gt;테스트는 SUT의 최종결과, 즉 동작을 검증하는 것이다. 동작하기 위한 과정을 테스트하는 것이 아니다. 테스트는 최종 사용자(end user)의 관점에서 SUT 검증하고, 최종 사용자에게 의미있는 결과가 나오는지 확인해야한다. (5장에서 다시 볼 것)&lt;/p&gt;
&lt;p&gt;테스트를 구성하기에 가장 좋은 방법은 문제 영역을 이야기하는 것이다. 테스트가 실패하면, 해당 애플리케이션 동작과 테스트 시나리오가 분리되는 것을 의미한다. 이런 구조라면 실패는 ‘시나리오 밖의 동작 시’ 발생하며, 이는 문제 파악에 도움이 된다.&lt;/p&gt;
&lt;p&gt;예시를 통해 살펴보자. 예시코드를 구동가능한 파이썬 코드로 고치면 아래와 같다. (좋은 코드는 아닙니다!)&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Message&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    header&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;
    body&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;
    footer&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Renderer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Protocol&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; msg&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Message&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;HeaderRenderer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Renderer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; msg&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Message&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;&amp;lt;h1&gt;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;msg&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;header&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&amp;lt;/h1&gt;&quot;&lt;/span&gt;&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;BodyRenderer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Renderer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; msg&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Message&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;&amp;lt;b&gt;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;msg&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;body&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&amp;lt;/b&gt;&quot;&lt;/span&gt;&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;FooterRenderer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Renderer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; msg&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Message&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;&amp;lt;i&gt;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;msg&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;footer&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&amp;lt;/i&gt;&quot;&lt;/span&gt;&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MessageRenderer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Renderer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    sub_renderers&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; List&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;Callable&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
        HeaderRenderer&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        BodyRenderer&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        FooterRenderer&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; msg&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Message&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# 결과를 계속 받아서 지속적으로 하나의 string에 aggregate&lt;/span&gt;
        output &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;render&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;msg&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; x &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sub_renderers&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;join&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;output&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; result&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;테스트는 아래 명령으로 구동한다:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;pytest test\test_01_html_message.py -v&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;=============================================== test session starts ================================================
platform win32 &lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt; Python 3&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;10&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;11&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pytest-7&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;4&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;0&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pluggy-1&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;2&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;0 &lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt; C:\python&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;exe
cachedir: &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pytest_cache
rootdir: C:\unit_testing\pt2\ch04
plugins: cov-4&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;1&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;0&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; mock-3&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;11&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;1
collected 2 items

test/test_01_html_message&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;py::test_message_renderer_uses_correct_sub_renderers PASSED                         &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; 50%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; 
test/test_01_html_message&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;py::test_rendering_a_message PASSED                                                 &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;100%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; 

================================================ 2 passed in 0&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;04s =================================================&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;test_message_renderer_uses_correct_sub_renderers&lt;/code&gt; 테스트 케이스를 살펴보자&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_message_renderer_uses_correct_sub_renderers&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    sut &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; MessageRenderer&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    renderers &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sut&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sub_renderers

    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;renderers&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;isinstance&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;renderers&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; HeaderRenderer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;isinstance&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;renderers&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; BodyRenderer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;isinstance&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;renderers&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; FooterRenderer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;MessageRenderer&lt;/code&gt; 안의 렌더러 갯수가 3개인 것을 확인하고, 헤더-바디-푸터를 파싱하고있다. 하지만, 이 테스트는 실제 &lt;code class=&quot;language-text&quot;&gt;MessageRenderer&lt;/code&gt;의 &lt;code class=&quot;language-text&quot;&gt;render()&lt;/code&gt; 의 &lt;strong&gt;동작&lt;/strong&gt; 을 확인하지 않는다. 하위 렌더링 클래스의 구성을 변경해도 HTML 문서가 동일하게 유지될 수는 있으나, 이 테스트는 구현 세부사항과 매우 결합되어있다. 예를 들어, &lt;code class=&quot;language-text&quot;&gt;BodyRenderer&lt;/code&gt;를 &lt;code class=&quot;language-text&quot;&gt;BoldRenderer&lt;/code&gt;로 바꾼다거나, &lt;code class=&quot;language-text&quot;&gt;MessageRenderer&lt;/code&gt;에서 한번에 렌더링을 구현해버리거나 하면 테스트는 &lt;strong&gt;깨진다&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;이런 그림으로 테스트를 수행하고 있음을 알 수 있다. 아래 그림과 함께 정리해보자:&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 885px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/f326b97b578fb1d3ac72198cb1ce358c/efc66/001.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 49.16666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABY0lEQVQoz3VSPVPCQBDNjxNbIrV2WgotjZXa6C+w4mfoDP4BHTO0qAydEE8gR5JL7vL1nN14DATcmTd7udt7+7L3nKqq0AQFZWMyZFmGoih29m226+1wmhu2yBiDvCiQZTkTa22Y+BDpNpw8z5EkCZI0ZVDQRVoHgUQgJbTWdJtJ8wbpnsKHwQDnl130+n1cdHt49TwmDKOoJgwkoihCHMdMGMdqo5TEUDMSpI3hc+fq5hYt9wSd0zO02i6ehs+bYoqyLFnNcrmClBLr9RpKKaRpypn2Pj4n+JrN+Y5zfXePo7bLhMduB4/D4d8Ms82v0RwjVhwgDEPESvGMSRkpH4/f4X8LHocjFgt4oxFe3jxMplMolXCx7S6EwCoIuDvBvrydNX1Trs/M/ivbSLVmVURqf7/ih9ENy+zazaEZbcMeEAmpZAcwUiajmv8sw7ZpmrRe171932fM5j6E+Nnz6iFj/wKq8vjdc5LfAwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/f326b97b578fb1d3ac72198cb1ce358c/8ac56/001.webp 240w,
/static/f326b97b578fb1d3ac72198cb1ce358c/d3be9/001.webp 480w,
/static/f326b97b578fb1d3ac72198cb1ce358c/dad35/001.webp 885w&quot;
              sizes=&quot;(max-width: 885px) 100vw, 885px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/f326b97b578fb1d3ac72198cb1ce358c/8ff5a/001.png 240w,
/static/f326b97b578fb1d3ac72198cb1ce358c/e85cb/001.png 480w,
/static/f326b97b578fb1d3ac72198cb1ce358c/efc66/001.png 885w&quot;
            sizes=&quot;(max-width: 885px) 100vw, 885px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/f326b97b578fb1d3ac72198cb1ce358c/efc66/001.png&quot;
            alt=&quot;SUT 내의 알고리즘과 결합된 테스트. 리팩토링 시 테스트도 함께 깨진다&quot;
            title=&quot;SUT 내의 알고리즘과 결합된 테스트. 리팩토링 시 테스트도 함께 깨진다&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;SUT 내의 알고리즘과 결합된 테스트. 리팩토링 시 테스트도 함께 깨진다&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;리팩토링 과정은 애플리케이션의 식별동작에 영향을 주지 않으면서 구현을 변경하는 것이다&lt;/li&gt;
&lt;li&gt;상기 예시대로 코드를 바꾸면 이 테스트 케이스는 ‘빨간막대’로 변한다&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;즉, SUT의 구현 세부 사항과 결합된 테스트는 리팩토링 내성이 없다. 위에서 살펴본 모든 단점이 보인다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;회귀 발생 시 조기 경고를 제공하지 않는다. 대부분 잘못된 것이므로 경고를 무시하게 된다&lt;/li&gt;
&lt;li&gt;리팩토링에 대한 능력과 의지를 방해한다. 테스트의 방향성을 알 수가 없으므로 버려진 테스트코드가 된다!&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;깨지기 쉬운 테스트코드를 한번 더 살펴보자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_message_renderer_is_implemented_correctly&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;whole_code&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; pathlib
    cwd &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; pathlib&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Path&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cwd&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;pt2/ch04/test/test_01_html_message.py&quot;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;cwd&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;r&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; encoding&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;utf-8&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; source_code&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; whole_code &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; source_code&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;read&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이 코드는 테스트코드의 &lt;strong&gt;단 하나라도&lt;/strong&gt; 수정하면 실패한다! SUT의 식별동작이 아니라 특정 구현이 동일한지를 고집한다. 구현을 바꿀 때마다 ‘빨간막대’가 뜬다.&lt;/p&gt;
&lt;h2 id=&quot;414-구현-세부-사항-대신-최종-결과를-목표로-하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#414-%EA%B5%AC%ED%98%84-%EC%84%B8%EB%B6%80-%EC%82%AC%ED%95%AD-%EB%8C%80%EC%8B%A0-%EC%B5%9C%EC%A2%85-%EA%B2%B0%EA%B3%BC%EB%A5%BC-%EB%AA%A9%ED%91%9C%EB%A1%9C-%ED%95%98%EA%B8%B0&quot; aria-label=&quot;414 구현 세부 사항 대신 최종 결과를 목표로 하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.1.4 구현 세부 사항 대신 최종 결과를 목표로 하기&lt;/h2&gt;
&lt;p&gt;리팩토링 내성을 높이려면 SUT의 구현 세부 사항과 테스트 간의 결합도를 낮추는 것이다. 이를 위해서 필요한 것이 어떤 것인지 살펴보자:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;MessageRender&lt;/code&gt;에서 얻는 최종 결과는 메시지의 HTML 표현이다. 클래스에서 얻을 수 있는 관찰 가능한 결과이기 때문에 이를 확인하는 것 또한 마땅하다. 즉, &lt;code class=&quot;language-text&quot;&gt;MessageRenderer&lt;/code&gt;를 블랙박스로 취급하고 식별 가능한 동작에만 신경쓰기로 한 것이다. 관련 테스트 코드는 아래와 같다:&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_rendering_a_message&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    sut &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; MessageRenderer&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    message&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Message &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Message&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    message&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;header &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;h&quot;&lt;/span&gt;
    message&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;body &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;b&quot;&lt;/span&gt;
    message&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;footer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;f&quot;&lt;/span&gt;

    html &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sut&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;render&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;message&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&amp;lt;h1&gt;h&amp;lt;/h1&gt;&amp;lt;b&gt;b&amp;lt;/b&gt;&amp;lt;i&gt;f&amp;lt;/i&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; html&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이런 그림으로 테스트를 개선하였음을 알 수 있다. 상기 테스트로 아래 이점을 얻었다:&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 922px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/b6c0103b1f16506967995e1da4c738dd/6da96/002.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 40%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABXUlEQVQoz2VSW0rDQBSdzfhTBOmPuAxBUfGj/ZCCuAlB3ICgOxBdhK07MPXVSP0wYx+pJmmah0kmbdIj90JkqAcud+aeO/c5oixLVLJcLkEgrZ91XhfdtxIBDUVRIAxDRFGM+XyOxWLBNh1pmjKf5/k/jiAGwyEen57xYVlIkgSj0RiO67IzBf12HLy89tAz3xAEIRzHwWTyxb5KKfYjXYloHZ9grbaO7d09zGYBZ6H2LCmRphmub25R26ijvrmFu3bnrxPP82BZkpOYpgnD6ELKT4iLyyvs7B/g9Owc06nPFdj2hNuih+3OPQ4bTTSPWngwusiVgut68H2fx/OTJAiCAIPBkO+CyqQgNBOlcg5ElRGIo7azLOMzgbrwvCkno070OfJS+v13GIYBKSUbaH62bXOVlJ0S6YjjGGPmba5y9VeIKIq4XN+fsYE2S0GqLZPWH5RlwTwJ8atf5xcoW1Xva5U8qwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/b6c0103b1f16506967995e1da4c738dd/8ac56/002.webp 240w,
/static/b6c0103b1f16506967995e1da4c738dd/d3be9/002.webp 480w,
/static/b6c0103b1f16506967995e1da4c738dd/88718/002.webp 922w&quot;
              sizes=&quot;(max-width: 922px) 100vw, 922px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/b6c0103b1f16506967995e1da4c738dd/8ff5a/002.png 240w,
/static/b6c0103b1f16506967995e1da4c738dd/e85cb/002.png 480w,
/static/b6c0103b1f16506967995e1da4c738dd/6da96/002.png 922w&quot;
            sizes=&quot;(max-width: 922px) 100vw, 922px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/b6c0103b1f16506967995e1da4c738dd/6da96/002.png&quot;
            alt=&quot;SUT의 식별 가능 동작과 결합된 테스트. 리팩토링 내성이 있어서, &amp;#39;오탐&amp;#39;발생률이 거의 적다.&quot;
            title=&quot;SUT의 식별 가능 동작과 결합된 테스트. 리팩토링 내성이 있어서, &amp;#39;오탐&amp;#39;발생률이 거의 적다.&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;SUT의 식별 가능 동작과 결합된 테스트. 리팩토링 내성이 있어서, ‘오탐’발생률이 거의 적다.&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;최종 사용자에게 의미있는 유일한 결과를 검증했다&lt;/li&gt;
&lt;li&gt;고객에게 영향을 줄 수 있는 애플리케이션 동작을 점검한다&lt;/li&gt;
&lt;li&gt;(책처럼 C# 혹은 Java, Kotlin을 쓴다할 때) 컴파일이 잘못된다거나 하면 테스트에 ‘오탐’이 발생할 수 있으나, 이는 훨씬 쉽게 캐치할 수 있는 문제다&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;42-첫-번째-특성과-두-번째-특성-간의-본질적인-관계&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#42-%EC%B2%AB-%EB%B2%88%EC%A7%B8-%ED%8A%B9%EC%84%B1%EA%B3%BC-%EB%91%90-%EB%B2%88%EC%A7%B8-%ED%8A%B9%EC%84%B1-%EA%B0%84%EC%9D%98-%EB%B3%B8%EC%A7%88%EC%A0%81%EC%9D%B8-%EA%B4%80%EA%B3%84&quot; aria-label=&quot;42 첫 번째 특성과 두 번째 특성 간의 본질적인 관계 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.2 첫 번째 특성과 두 번째 특성 간의 본질적인 관계&lt;/h1&gt;
&lt;p&gt;좋은 단위 테스트의 처음 두 요소(회귀 방지, 리팩토링 내성) 사이에는 본질적인 관계가 있다. 둘 다 정 반대의 관점에서도 테스트 스위트의 정확도에 기여한다. 이 두가지 특성은 시간이 흐르며 프로젝트에 영향을 다르게 미치는 경향이 있다. 프로젝트가 시작된 직후에는 회귀 방지를 훌륭히 갖추는 것이 중요하지만, 리팩토링 내성은 바로 필요하지 않다.&lt;/p&gt;
&lt;p&gt;이 절에는 아래 내용을 살펴볼 것이다&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;테스트 정확도 극대화&lt;/li&gt;
&lt;li&gt;‘오탐’과 거짓 음성(&lt;em&gt;false negative&lt;/em&gt;, 부정 오류. Type 2 에러라고도 함. 이하 &lt;strong&gt;미탐&lt;/strong&gt; 으로 지칭)의 중요성&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;421-테스트-정확도&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#421-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%A0%95%ED%99%95%EB%8F%84&quot; aria-label=&quot;421 테스트 정확도 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.2.1 테스트 정확도&lt;/h2&gt;
&lt;p&gt;테스트 결과를 다시 큰 그림으로 보고, 이를 분석해보자:&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 857px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/6bc00fb8657ed1cff2897da758c4c668/3cd52/003.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 51.25000000000001%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAACNklEQVQoz42SyU9TURSH+7foQo1/hQvjkIgpoIRJhSYmSlUUScAxLjS6ALRAmAepQAxidOMKx52JjSiizPD6OtD2Te0bCqHtZ95FIhsTT/LlnJvc/M7vnnM9juNg2Ra242A7tsiWZZHOZDAtS+DWqqYJdMPAtExM0yRjmli2TT5foFDYxqMZOmuyJJAiYVbDayQ1hfVUAkVX0dI6STXF4soSc4sLrEiraGkDPWOgZQwUTSWXy7MTHlXXkCKyIBKLiuwKuA1WZYmZXz/5HPrCsrRGOBphYXmJbz9meP/pI7Pzc4QjsnCraTqbm5vbgqqhCUexxDrR9Riu6+evX/Goo53OwQHaB/oJ9PXS2t1FZU0tZVXVVNf6KCop5dbde8iyzNt3H4SoR1FV5HhUuHLdzS8vklIVRl9O8iDwhJ5nQfrHRul6Osz9wGOOnvTiLT1N5ZmzHDtRxPkLddi2japqZLNZPLF4nND0tHCXUJLEkwksx+JhSyvHvSVU1PgoP1fDqapqissr8NX5udjQIPD5/bR0dLA7PLo7YNMgpSnIsQjfZ2ewNxyuNFxn7/6DFJeVU+Qt4dDhI+zZd4DLTU10B0foHB6ira+XofFx8vn83y0b6bTYVFJJiVm6m3U2sgyNBLlUf43m23dobL5JY9MN/PVXCfT0MDr5guDEBIPjY7yZmoJCQbgTgq761tYWuVxO5J3a/YuKomBZNv8ThT+inn9dSCQShEJfkaSwOLtNXHY/bzc7Dn8DujmtyO/2kYoAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/6bc00fb8657ed1cff2897da758c4c668/8ac56/003.webp 240w,
/static/6bc00fb8657ed1cff2897da758c4c668/d3be9/003.webp 480w,
/static/6bc00fb8657ed1cff2897da758c4c668/a145c/003.webp 857w&quot;
              sizes=&quot;(max-width: 857px) 100vw, 857px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/6bc00fb8657ed1cff2897da758c4c668/8ff5a/003.png 240w,
/static/6bc00fb8657ed1cff2897da758c4c668/e85cb/003.png 480w,
/static/6bc00fb8657ed1cff2897da758c4c668/3cd52/003.png 857w&quot;
            sizes=&quot;(max-width: 857px) 100vw, 857px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/6bc00fb8657ed1cff2897da758c4c668/3cd52/003.png&quot;
            alt=&quot;회귀 방지와 리팩토링 내성 간의 관계. 회귀 방지는 &amp;#39;미탐&amp;#39;을 예방하며, 리팩토링 내성은 &amp;#39;오탐&amp;#39;을 예방한다&quot;
            title=&quot;회귀 방지와 리팩토링 내성 간의 관계. 회귀 방지는 &amp;#39;미탐&amp;#39;을 예방하며, 리팩토링 내성은 &amp;#39;오탐&amp;#39;을 예방한다&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;회귀 방지와 리팩토링 내성 간의 관계. 회귀 방지는 ‘미탐’을 예방하며, 리팩토링 내성은 ‘오탐’을 예방한다&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;버그가 있어서 있다고 하거나(참 양성), 버그가 없어서 없다고 하는 건(참 음성) 지극히 정상이다.&lt;/li&gt;
&lt;li&gt;테스트에서 의도한 오류가 발생하지 않으면 ‘미탐’ 이다. 회귀 방지가 훌륭한 테스트는 ‘미탐’을 최소화하는데 도움이 된다.&lt;/li&gt;
&lt;li&gt;기능은 올바르지만, 테스트에서 실패를 보고하면 ‘오탐’ 이다. 리팩토링 내성이 훌륭한 테스트는 ‘오탐’을 최소화 하는데 도움이 된다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;결국 테스트의 정확도는 좋은 단위 테스트의 처음 두 특성에 대한 것이다. 회귀 방지와 리팩토링 내성은 테스트 스위트의 정확도를 극대화 하는 것을 목표로 한다. 정확도 지표는 아래 두 가지 요소를 의미한다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;테스트가 버그 있음을 얼마나 잘 나타내는가(‘미탐’ 제외)&lt;/li&gt;
&lt;li&gt;테스트가 버그 없음을 얼마나 잘 나타내는가(‘오탐’ 제외)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;‘오탐’과 ‘미탐’을 생각해보는 다른 방법은 소음 대비 신호 비율 측면에서 볼 수 있다. 하기 분모를 줄이거나, 분자를 늘리는 테스트로 개선하는 것을 의미한다.&lt;/p&gt;
&lt;p&gt;$테스트 정확도 = \dfrac{신호(발견된 버그 수)}{소음(허위 경보 발생 수)}$&lt;/p&gt;
&lt;h2 id=&quot;422-오탐과-미탐의-중요성-역학관계&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#422-%EC%98%A4%ED%83%90%EA%B3%BC-%EB%AF%B8%ED%83%90%EC%9D%98-%EC%A4%91%EC%9A%94%EC%84%B1-%EC%97%AD%ED%95%99%EA%B4%80%EA%B3%84&quot; aria-label=&quot;422 오탐과 미탐의 중요성 역학관계 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.2.2 ‘오탐’과 ‘미탐’의 중요성: 역학관계&lt;/h2&gt;
&lt;p&gt;단기적으로 ‘오탐’도 ‘미탐’만큼 나쁘지 않다. 초기 프로젝트에서는 버그를 프로덕션에 풀지 않는 것이 중요하기 때문이다. 하지만 프로젝트가 성장함에 따라 ‘오탐’은 테스트 스위트에 점차 큰 영향을 미친다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 621px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/046d431fcaf8d57fe57b40cb6d76f1ab/3075e/004.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 79.16666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAABxUlEQVQ4y51U207CQBDt/z/5YvwEX4xGMNDgBQQTI0Gw1WhUKm1Aq1YDhO29cMwsbN0W6oObTGYze+bkzOzsKihYi8Ui4/PxohzF8zx4no8wDBFFESaTKWaMpQCZWOwphzEXrutyLOWLM8W2bWiajvuHR9D+oHyEy6s2P0zm842qvhwHb282RsMRnvsGhqNXzFdYhcCO48B+/0AcxWi0LtDTdX5IIFlhHMe8kqVFCKNo6cPwV2G+D/VmC9rtbUpIi1rhuh6CIOB7ipNnjMH3fR4nUoorojdJkqSENytCivt+wJPkskkV4T8/HZiWBdO0YBgGHOf7V6FQwwn1JaEfLMnkPpIyKl2+WbktGwlFybMZy5CJUvNEMmYjoX53x/dBEGbAok8yYd7WCVurkhfZW46TJC21aOg3KqSx6XR7a4nyaBSpKyRMBztJuNHFkDrC8Bh5yeRK1gjPmk30NB3/WZkeimd22mhga3sHR6qK/cMSSpUqylUVZfLCqioqtWNUajWoxyfY3duDNRxmFQrJVN7AsmAMBngZmNyn9kLexFO/j3ang/b1Nbo3GurnTf6e157eX19TfrEZw2Q65bM6Ho/50yTCH5v6zxMDv4afAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/046d431fcaf8d57fe57b40cb6d76f1ab/8ac56/004.webp 240w,
/static/046d431fcaf8d57fe57b40cb6d76f1ab/d3be9/004.webp 480w,
/static/046d431fcaf8d57fe57b40cb6d76f1ab/b2315/004.webp 621w&quot;
              sizes=&quot;(max-width: 621px) 100vw, 621px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/046d431fcaf8d57fe57b40cb6d76f1ab/8ff5a/004.png 240w,
/static/046d431fcaf8d57fe57b40cb6d76f1ab/e85cb/004.png 480w,
/static/046d431fcaf8d57fe57b40cb6d76f1ab/3075e/004.png 621w&quot;
            sizes=&quot;(max-width: 621px) 100vw, 621px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/046d431fcaf8d57fe57b40cb6d76f1ab/3075e/004.png&quot;
            alt=&quot;&amp;#39;오탐&amp;#39;이 영향도 증가 추이와 &amp;#39;미탐&amp;#39;의 영향도 증가추이&quot;
            title=&quot;&amp;#39;오탐&amp;#39;이 영향도 증가 추이와 &amp;#39;미탐&amp;#39;의 영향도 증가추이&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;‘오탐’이 영향도 증가 추이와 ‘미탐’의 영향도 증가추이&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;초기에는 ‘오탐’이 크게 중요하지는 않다. 리팩토링보다는 제품을 내어놓아야 하니까. 초반에는 코드에 대해 리팩토링을 빠르게 할 수 있다. 아직 머릿속에 있으니까. 그렇지만 가면 갈 수록 그 중요성이 점차 중요해진다.&lt;/p&gt;
&lt;p&gt;하지만 시간이 지날 수록 코드베이스는 나빠진다. 이 경향을 줄이려면 정기적으로 리팩토링을 해야한다. 그렇지 않으면 그 모든 것이 비용이다.&lt;/p&gt;
&lt;p&gt;리팩토링이 점차 필요함에 따라 테스트의 리팩토링 내성도 중요해진다. ‘오탐’을 말하는 테스트를 계속 둔다면 이른바 &lt;em&gt;양치기 소년&lt;/em&gt; 테스트가 된다.&lt;/p&gt;
&lt;p&gt;후반까지 가는 프로젝트라면 ‘오탐’, ‘미탐’ 이 두가지에 대해 특히나 신경써야 한다.&lt;/p&gt;
&lt;h1 id=&quot;43-세-번째-요소와-네-번째-요소-빠른-피드백과-유지-보수성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#43-%EC%84%B8-%EB%B2%88%EC%A7%B8-%EC%9A%94%EC%86%8C%EC%99%80-%EB%84%A4-%EB%B2%88%EC%A7%B8-%EC%9A%94%EC%86%8C-%EB%B9%A0%EB%A5%B8-%ED%94%BC%EB%93%9C%EB%B0%B1%EA%B3%BC-%EC%9C%A0%EC%A7%80-%EB%B3%B4%EC%88%98%EC%84%B1&quot; aria-label=&quot;43 세 번째 요소와 네 번째 요소 빠른 피드백과 유지 보수성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.3 세 번째 요소와 네 번째 요소: 빠른 피드백과 유지 보수성&lt;/h1&gt;
&lt;p&gt;아래 두 내용을 마저 살펴보자:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;빠른 피드백&lt;/li&gt;
&lt;li&gt;유지 보수성&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;빠른 피드백은 단위 테스트의 필수 속성이다. 테스트를 빠르고 자주 돌리면 코드 결함을 빠르게 캐치할 수 있다. 이를 피드백 루프라고 일컫는데, 이것이 줄어들면 버그 수정비용이 상당히 줄어든다.&lt;/p&gt;
&lt;p&gt;유지 보수성 지표는 유지비를 평가한다. 이 지표는 아래 두 가지 요소로 구성된다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;테스트가 얼마나 이해하기 어려운가?
&lt;ul&gt;
&lt;li&gt;이 구성요소는 테스트의 크기와 관련있다. 테스트가 짧으면 더 읽기 쉽다. (쓸데없이 코드를 줄이는 경우를 말하는 것이 아니다!)&lt;/li&gt;
&lt;li&gt;테스트 코드의 품질 또한 중요하다. 테스트 작성 시에도 절차를 생략하지 말자&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;테스트가 얼마나 실행하기 어려운가?
&lt;ul&gt;
&lt;li&gt;테스트가 프로세스 외부 종속성으로 작동하면, 외부 의존성을 갖추는 시간 또한 들여야 한다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;44-이상적인-테스트를-찾아서&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#44-%EC%9D%B4%EC%83%81%EC%A0%81%EC%9D%B8-%ED%85%8C%EC%8A%A4%ED%8A%B8%EB%A5%BC-%EC%B0%BE%EC%95%84%EC%84%9C&quot; aria-label=&quot;44 이상적인 테스트를 찾아서 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.4 이상적인 테스트를 찾아서&lt;/h1&gt;
&lt;p&gt;다시, 좋은 단위 테스트의 4대 특성을 보자.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;회귀 방지&lt;/li&gt;
&lt;li&gt;리팩토링 내성&lt;/li&gt;
&lt;li&gt;빠른 피드백&lt;/li&gt;
&lt;li&gt;유지 보수성&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이 네 특성을 &lt;em&gt;곱하면&lt;/em&gt; 테스트의 가치가 결정된다. 즉, 어떤 특성이라도 &lt;code class=&quot;language-text&quot;&gt;0&lt;/code&gt;이 되면 전체가 &lt;code class=&quot;language-text&quot;&gt;0&lt;/code&gt;이 되어버린다(!)&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;가치 추정치 = [0..1] * [0..1] * [0..1] * [0..1]&lt;/code&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;🍅 tips&lt;/p&gt;
&lt;p&gt;가치가 있으려면 테스트는 네 가지 범주 모두에서 점수를 내야 한다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;이 수치는 정확히 산정할 수 없다. 이런 것을 할 수 있는 도구 또한 없다. 다만 네 가지 특성과 관련하여 테스트가 어느정도 레벨인지는 비교할 수 있다. 이 평가를 통해 테스트의 가치평가가 가능하고, 테스트 스위트에서 계속 활용할지/말지 를 결정할 수 있다.&lt;/p&gt;
&lt;p&gt;테스트 코드를 포함한 모든 코드는 책임(&lt;em&gt;liability&lt;/em&gt;) 이다. 최소 필수값에 대해 매우 높은 임계치를 정하고, 이 임계치를 충족하는 테스트만 남기자. 매우 가치있는 테스트를 기반으로 쌓아올리자.&lt;/p&gt;
&lt;p&gt;이상적인 테스트는 짤 수 있을까?&lt;/p&gt;
&lt;h2 id=&quot;441-이상적인-테스트를-만들-수-있는가&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#441-%EC%9D%B4%EC%83%81%EC%A0%81%EC%9D%B8-%ED%85%8C%EC%8A%A4%ED%8A%B8%EB%A5%BC-%EB%A7%8C%EB%93%A4-%EC%88%98-%EC%9E%88%EB%8A%94%EA%B0%80&quot; aria-label=&quot;441 이상적인 테스트를 만들 수 있는가 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.4.1 이상적인 테스트를 만들 수 있는가?&lt;/h2&gt;
&lt;p&gt;아쉽지만 그럴 수 없다. 회귀 방지, 리팩토링 내성, 빠른 피드백은 상호 배타적(&lt;em&gt;mutually exclusive&lt;/em&gt;)이다. 셋 중 하나는 희생해야 한다. 그렇지만 어느 것 하나라도 &lt;code class=&quot;language-text&quot;&gt;0&lt;/code&gt;점이 되면 안 된다. 두 특성을 최대로 하는 것을 목표하되, 한가지 특성을 희생하는 케이스를 살펴보자.&lt;/p&gt;
&lt;h2 id=&quot;442-극단적-사례-1-엔드-투-엔드e2e-테스트&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#442-%EA%B7%B9%EB%8B%A8%EC%A0%81-%EC%82%AC%EB%A1%80-1-%EC%97%94%EB%93%9C-%ED%88%AC-%EC%97%94%EB%93%9Ce2e-%ED%85%8C%EC%8A%A4%ED%8A%B8&quot; aria-label=&quot;442 극단적 사례 1 엔드 투 엔드e2e 테스트 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.4.2 극단적 사례 1: 엔드 투 엔드(e2e) 테스트&lt;/h2&gt;
&lt;p&gt;e2e 테스트는 최종 사용자의 관점에서 시스템을 살펴본다. UI, DB, 외부 앱을 포함한 모든 시스템 구성을 거친다.&lt;/p&gt;
&lt;p&gt;이는 많은 코드를 테스트하므로 회귀 방지를 잘 수행한다. 많은 코드에는 직접 작성한 코드 뿐 아니라 외부 라이브러리, 프레임워크, 서드파티 앱 등 간접적으로 사용하는 모든 코드까지 테스트하게 된다.&lt;/p&gt;
&lt;p&gt;‘오탐’에도 면역이다. 리팩토링 내성에도 우수하다. 리팩토링을 올바르게 했다면 식별할 수 있는 동작을 변경하지 않으므로 e2e 테스트에도 영향이 없다. 또한 기능이 되는지만을 보기 때문에 특정 구현에 구애받지 않는다.&lt;/p&gt;
&lt;p&gt;그러나 너무 느리다. &lt;strong&gt;e2e 테스트에만&lt;/strong&gt; 의존하면 피드백이 너무 느릴 수 밖에 없다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 627px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/efb79f55bd6037a58f5cf44ae0787424/e9c9b/005.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 81.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAACvUlEQVQ4y22U608aQRTF+WebflA/aGM0WFsrz12eSwB57/IwNtqaVgVEHoohTdtYE1sDEhNFjfFRkkqkK8jjNHMjdFFvcnN3Z2Z/uWfO7KjwKLrdLiWLzkNlcXt7i9/VKtVe9Oa7inWqHkCZtLjToVqv17ESj8PucsFoscDudNI7G1fCelWFZ6I3+VeW4QuF8Eajgd5kgsFspsre2bgsy09UqRqNBprNJtrtNu7v79FqtfqTqUyGPjYLAnibDZzVCs5mhdlup/GNbHZADQErlQr294s4OjrGwUEZxdIBZPkO7U4Hbp8POp7HrMGA6dlZvNVoMaPTQcvx0HIcPIEANaPs8lnJrMtarQanx0MytUYjxiYm8WpiEuPqKeh4E+3nnN9PqpRdDpiibP3s/BzCnBsGiwVmh0BgHccT7J1ej4npaYKWDw8HjFE9NqLVbmNnbw+pfB7S+wVMaTTQWszgBTt4uw3jajWGRkfxYngYerMJPknESiJOBvZdVrr0q1TCajqN9PY2soUCvGEJM0YDNCYer3VaDI2N4eXICO2lGItCikXh9vuQTG8MAunw1uvYyOcJFs9k8Hl9HSupFKKLi7DOuaHWajFjMMDiEAjGMhSNUPVLIi4uLweBl9fXSGSzD8A0PEERLn8AiWwOC8vLMAoCvJJIXXFsb+0CgpEwAb2hIPaLxUHgdbXaB35KJOAVJQQiUXxYXUNsaQmcwwGPGIInGIBFEOh8+sRQH1gqlweBjWYTuUIBqa0tyvXNTapsGz4lkzA7nQhEwpDmo5DmY5QMxrpk0v/c3Dx1uXJ2hrVMhkCsUwZjz8kck/0RnlAQgbBEAJYM5vJ58f3HzlOXe9Dj01NyOJHLUTLgz1IJ8t0dvnz7SiAmkSXrcmd39/+v9/jGUMq/qlZxcXVF7ivjplbDUaWCysnJwHXGDvY/DLU7B5NDaIEAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/efb79f55bd6037a58f5cf44ae0787424/8ac56/005.webp 240w,
/static/efb79f55bd6037a58f5cf44ae0787424/d3be9/005.webp 480w,
/static/efb79f55bd6037a58f5cf44ae0787424/c4111/005.webp 627w&quot;
              sizes=&quot;(max-width: 627px) 100vw, 627px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/efb79f55bd6037a58f5cf44ae0787424/8ff5a/005.png 240w,
/static/efb79f55bd6037a58f5cf44ae0787424/e85cb/005.png 480w,
/static/efb79f55bd6037a58f5cf44ae0787424/e9c9b/005.png 627w&quot;
            sizes=&quot;(max-width: 627px) 100vw, 627px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/efb79f55bd6037a58f5cf44ae0787424/e9c9b/005.png&quot;
            alt=&quot;e2e 테스트: 회귀 방지, &amp;#39;오탐&amp;#39;에 대한 보호 가능, 피드백이 느림&quot;
            title=&quot;e2e 테스트: 회귀 방지, &amp;#39;오탐&amp;#39;에 대한 보호 가능, 피드백이 느림&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;e2e 테스트: 회귀 방지, ‘오탐’에 대한 보호 가능, 피드백이 느림&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;443-극단적-사례-2-간단한-테스트&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#443-%EA%B7%B9%EB%8B%A8%EC%A0%81-%EC%82%AC%EB%A1%80-2-%EA%B0%84%EB%8B%A8%ED%95%9C-%ED%85%8C%EC%8A%A4%ED%8A%B8&quot; aria-label=&quot;443 극단적 사례 2 간단한 테스트 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.4.3 극단적 사례 2: 간단한 테스트&lt;/h2&gt;
&lt;p&gt;너무 간단한 테스트… getter/setter 를 테스트 하는 수준의 코드는 빨리돈다. 피드백도 빠르다. 리팩토링 내성도 우수하다. ‘오탐’이 생길 여지가 없기 때문이다.&lt;/p&gt;
&lt;p&gt;그러나 기반 코드에 실수할 여지가 많지 않기 때문에 간단한 테스트는 회귀를 나타내지 않을 것이다.&lt;/p&gt;
&lt;p&gt;이름만 다르고 동일한 테스트를 할 수도 있다. 이런 테스트는 항상 통과하거나 검증이 무의미하므로 제대로된 테스트라 하기 힘들다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 674px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/9e08c9b1613989fab3630dd2f8197a21/fdaf8/006.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 67.08333333333334%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAACGklEQVQ4y4VT/VMSURTlj+0nf6omoxpqLFpkYVmCUeRjd1k+otCYkEpNdHGYHHWmzJrGmZIKXJRQEZZgS5nlNPtsGxSMM3Pnvrnv3vPuefc9Ey6g2+0SM9a98WFrHSaDoNd0aH999eAAzzMZCNEokqkUvpdK5w6+WGfCABibP6pVMB4PxigKD2ka92024r8UCriszqSqKur1BtqqCkVR0Gq1oGkaSUil07hntYJ2sRhnGNAsS0i5SITs6/mNRgPNZhOnp52zDo9rxyh8/YZyeQ/FYon4dlslp3GiSLq7br6FqzduYvT2HVjtNCaDQTQUBZVKhdQUS7v42WpdLlmHnhASRVBOJ+wuF6x2O7G7D6ywORzYleXBknsv1ZBaq9eR39jAdGYWY/ZxUC4G9CM3rpnNuDIyAhvjhPg4jrfvN88GqGn9QzECnU4H+fV1vFhcxIIkIT4zA4fXAwtFYdRigcPtRvRJAnw0Aj/PQd4rn3sVfYSHtRrmcznMSxL4WBxi4imS6TSYiQn4wwImAwEy+XA8RgjfrK396/K/hK+yWUxxAoJiBLHkNFifDz6eA+v1wsG6EQwL8Av8cEJD8sulJSzkcni9soK55WV4AgFCEEnEyf0NldxLqg9FWl3FnCQRsmw+j3cfPyCZeoYpLoSAwCMkhrG5tdX3Xfs6NPzvkxPI+/soyjKUZpPE1F8qPu/s4NP2Ng6Pjgb+5z8eo5YBrq+NbQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/9e08c9b1613989fab3630dd2f8197a21/8ac56/006.webp 240w,
/static/9e08c9b1613989fab3630dd2f8197a21/d3be9/006.webp 480w,
/static/9e08c9b1613989fab3630dd2f8197a21/853dc/006.webp 674w&quot;
              sizes=&quot;(max-width: 674px) 100vw, 674px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/9e08c9b1613989fab3630dd2f8197a21/8ff5a/006.png 240w,
/static/9e08c9b1613989fab3630dd2f8197a21/e85cb/006.png 480w,
/static/9e08c9b1613989fab3630dd2f8197a21/fdaf8/006.png 674w&quot;
            sizes=&quot;(max-width: 674px) 100vw, 674px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/9e08c9b1613989fab3630dd2f8197a21/fdaf8/006.png&quot;
            alt=&quot;간단한 테스트: 리팩토링 내성 우수, 빠른 피드백 제공, 회귀 방지가 없음&quot;
            title=&quot;간단한 테스트: 리팩토링 내성 우수, 빠른 피드백 제공, 회귀 방지가 없음&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;간단한 테스트: 리팩토링 내성 우수, 빠른 피드백 제공, 회귀 방지가 없음&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;444-극단적-사례-3-깨지기-쉬운-테스트brittle-test&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#444-%EA%B7%B9%EB%8B%A8%EC%A0%81-%EC%82%AC%EB%A1%80-3-%EA%B9%A8%EC%A7%80%EA%B8%B0-%EC%89%AC%EC%9A%B4-%ED%85%8C%EC%8A%A4%ED%8A%B8brittle-test&quot; aria-label=&quot;444 극단적 사례 3 깨지기 쉬운 테스트brittle test permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.4.4 극단적 사례 3: 깨지기 쉬운 테스트(&lt;em&gt;brittle test&lt;/em&gt;)&lt;/h2&gt;
&lt;p&gt;실행이 빠르고 회귀를 잡을 가능성이 높지만, ‘오탐’이 많은 테스트도 있다. 이런 테스트를 깨지기 쉬운 테스트라고 한다. 리팩토링을 견디지 못하고, 해당 기능이 고장났는지 여부와 관계없이 ‘빨간막대’로 바뀐다.&lt;/p&gt;
&lt;p&gt;이런 테스트를 생각하면 된다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;UserRepository&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    last_query&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get_by_id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; user_id&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get_query&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;last_query


&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_get_by_id_executes_correct_sql_code&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    sut&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; UserRepository &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; UserRepository&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    user &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sut&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_by_id&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; sut&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;last_query &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;SELECT * FROM dbo.User WHERE user_id = 5&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;빠르게 실행될 수 있고 회귀를 잡을 수도 있겠지만, 리팩토링 내성이 없다. 코드를 잘못짜도 ‘오탐’, ORM으로 만들어지는 쿼리가 조금이라도 다르면 ‘오탐’, 등등. 내부 구현사항에 결합되었기 때문에 이런 결과가 나온다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 604px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/45bc3b761498eec1f1a910b87bdcd298/87254/007.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 84.58333333333331%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABYlAAAWJQFJUiTwAAACnUlEQVQ4y4WUa08aQRSG97/2S9s0frBptN61sKjLoqBlkYsgKkijDSZYW2W9ERugGNCqKKwNWGO9xGqBpZbb2+zUpStCfJOTmWRmnjlnzplDoUaVSoWYpHK5jHpS7pFHWVTtYi3s6uoKSzyPmdlZzPt8EI6O7u2ttSpQAijnkr6fnIDV69GlUqFPo0GPWo1emsbnUKghlEIDSVCrw0FArMEAZngYWr0e/SwLmmHw4+ys7jkqlUpjdy+OVCqFg8ME4vFDZLM5nJ+fo1/HokelRkt7B1o7u9DW1Y0++p+nwXAYpUIB0WgMhwkByaQAUcyDur39g5woQryzXC6HSrmCpCBgcGgIAzodWto78ep1GxlVAwMk7GWeJx6JirOlUql+yGcXF1jd3ATNsnjDDIIx6EnIEqi5tRVPm5pgNJsR3oqgVFMJ/5Nyl92T01P4/H74AwF4vF709GsIVK3V4kXzSzx59hzdKhXsU5MYHTORClAmiFLWkuTyejCIxRUe730L8C4uwu5yYchoRAdNo623FxotA+uEgwAlGxu3IX18XE3kPWAmm8XS+jqWNzbgnpuDwWTGpOcdAWtHR2Gyj8PqsIMeZGDgODimp2C0WrAVi9YHivk8gX1aW4PTPQOrc4oAPd556DiOAEc4jrynVEqSh5zNip3d3YdAGRrZ3iZv+HF19Z6NmC0w2Wxwuqcx4ZqG0+2qhn5zc1N9R0r5P2UvA6EQFngeH1ZWsOD3E68jsRg8c7N4azGDs1lIqBLwIJFonBR5LBQK+JZOY2d/H/FkEr8yGRKOVKOxrztYC2wg+CWMi8vLB1+Qeqx7SCoWi8hksuSixzoP1WhBbhC/83lEtqIQhCPs7e3j5/V1NQHKy+U5Ve/GRp1ECanX8iTgXz1ltKcmfw6RAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/45bc3b761498eec1f1a910b87bdcd298/8ac56/007.webp 240w,
/static/45bc3b761498eec1f1a910b87bdcd298/d3be9/007.webp 480w,
/static/45bc3b761498eec1f1a910b87bdcd298/059a8/007.webp 604w&quot;
              sizes=&quot;(max-width: 604px) 100vw, 604px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/45bc3b761498eec1f1a910b87bdcd298/8ff5a/007.png 240w,
/static/45bc3b761498eec1f1a910b87bdcd298/e85cb/007.png 480w,
/static/45bc3b761498eec1f1a910b87bdcd298/87254/007.png 604w&quot;
            sizes=&quot;(max-width: 604px) 100vw, 604px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/45bc3b761498eec1f1a910b87bdcd298/87254/007.png&quot;
            alt=&quot;깨지기 쉬운 테스트: 빠른 피드백 제공, 회귀 방지, 리팩터링 내성이 없음&quot;
            title=&quot;깨지기 쉬운 테스트: 빠른 피드백 제공, 회귀 방지, 리팩터링 내성이 없음&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;깨지기 쉬운 테스트: 빠른 피드백 제공, 회귀 방지, 리팩터링 내성이 없음&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;445-이상적인-테스트를-찾아서-결론&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#445-%EC%9D%B4%EC%83%81%EC%A0%81%EC%9D%B8-%ED%85%8C%EC%8A%A4%ED%8A%B8%EB%A5%BC-%EC%B0%BE%EC%95%84%EC%84%9C-%EA%B2%B0%EB%A1%A0&quot; aria-label=&quot;445 이상적인 테스트를 찾아서 결론 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.4.5 이상적인 테스트를 찾아서: 결론&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;모두 완벽한 테스트는 없다!&lt;/strong&gt; 상기 세 가지 특성은 상호 배타적이다. 그렇다면 어떻게 희생해야할지 살펴보자.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 665px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/db0c93fbc4a05738e073cdfd5c566420/5f4af/008.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 78.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAACmElEQVQ4y42U+0/aUBTH+WOXZXEmxiyZcdmMSkFoi/IYPoqFIlVxIG5afCAFVDTG+YtxEbaYqXvowrKVoFOjwHe5x+Bg6LKbfHvvSU8//d5zbmsCgGq1itpcW7NxeXnZENfn3TdMdyXt7O5CDYcxIstQVBUbm5sol8v/BTX97Syh6+jiOPT29YGz22G22fDCbMZkJNIEvddhpVKh4MP+PrqtVvAD/RCcTvADAyS2ZlDmlA2WXzNRr1tgLXijaeTMygvotljQY7XexIJAbuVg8J/u2L0Gh+FolLZosfN40tGJ9qcdNHM8jz5RxKDPR7knJ8fI5d8jl8tjby+HXD6PQuF7Y1PIYTxODzvcbtgcDlh4ntwxsS27h4ZgGMbtCbi4uKCZ6fr6+k9TfhgGNra3Ma1pMAs8OFEA73JS7Tq7uvC4vR0PWlpg63cgPB2lWt+75dOzMyTX1jCv60itr0ONRAjaK/B4buHwqK0ND1tbqZbKuAqfEsCwfxQHR0dNDSKHu7kc4rqORCaDuUQCi+k0orOzcEsSnnEcemw2OL0vCeYPjSGghiAF/JiZm2068ATMbm1hIZ3GUiaD0NQreH2jiGlxTMZiEDweDAcCBBGdTnglidajQQVjkxMolUp3A5mrpXQagfEJSEoQ4dgMglNTsLtcGJRleKUR2EQRossFeSxIIuDpaTPwXT6PeDKJxMoKtOVlzCd1LKbS1CDe44GkBKCoIXJW04hfxmtNu/P7N/06P4eezVJTlldXb7WQSkFWVQz7ZXLE6sfEmsJq+OnL55umVCuNQHYplkp0bFgtGYjNb3d28NMwsJJdI6Ck+MltOBrBx8PDBncNwPq/h1Es4luhQC+oTzKKBg6ODvH1+BhXV1dNdasH/gZyXUbXta+u4gAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/db0c93fbc4a05738e073cdfd5c566420/8ac56/008.webp 240w,
/static/db0c93fbc4a05738e073cdfd5c566420/d3be9/008.webp 480w,
/static/db0c93fbc4a05738e073cdfd5c566420/ced6d/008.webp 665w&quot;
              sizes=&quot;(max-width: 665px) 100vw, 665px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/db0c93fbc4a05738e073cdfd5c566420/8ff5a/008.png 240w,
/static/db0c93fbc4a05738e073cdfd5c566420/e85cb/008.png 480w,
/static/db0c93fbc4a05738e073cdfd5c566420/5f4af/008.png 665w&quot;
            sizes=&quot;(max-width: 665px) 100vw, 665px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/db0c93fbc4a05738e073cdfd5c566420/5f4af/008.png&quot;
            alt=&quot;있을 수가 없는 경우&quot;
            title=&quot;있을 수가 없는 경우&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;있을 수가 없는 경우&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;유지보수성은 e2e 테스트를 제외하고는 처음 세 가지 특성과 크게 관련없다.&lt;/p&gt;
&lt;p&gt;리팩토링 내성은 최대한 많이 갖는 것을 목표로 해야한다. 이것은 양보하기 어려운 요소기 때문이다. 따라서 테스트가 얼마나 버그를 잘 찾는지(회귀방지)와 얼마나 빠른지(빠른 피드백) 사이의 선택으로 절충안을 정하게 된다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 715px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/e57004ee844fd0e51d5abc873a9d24c0/d0c0e/009.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 63.74999999999999%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAABkklEQVQ4y4VT21LCMBDt/3+Jb+r44OXRUVREfBAoFKQCbaACTUmb9ArHSTRKgWJndna76Z6ePbsxUPFsNhvli6JAFEWIIo44jpFlWel8pwjGf4B5lsGy+jDNLgaDdzAW/ha7hICQKYjrwnEJZEUl4DYopQFq9Se823Ypn6YpTMtCu9uFEELljjLUhfZkjJPzUzy8vJQA4yTBxc01zq4uETBWDagLtJ8vFnhsNtC3h3v6tnpdvLbekP5oa2gm24y24zzPVWsaIEkSFa/X64NE9gB3p8eFKOVFHKMo/sAksLZN1ZQlEz+gCKPoIBPOOZaUIsvzvTNjtWIYjUZwyRSTiaPWoG/buGvU0bZ6ql1tSZKiyAul5e3zk9LP9314ngfXJVgx9t3yeDxGu91Bp2PC9ylGjoP7ZgPWcKjYapN6yv37cCaoNRswB32EYQifUiwWS3AuqqcsP2KMKRB5O7TJ94hzfM7nB+U4OpQgCNSfKaWKufayzfxHv91aYzdZWlwhfnV1HAdkOsVsNoPnfe7tq46/AKhk77KX3NmJAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/e57004ee844fd0e51d5abc873a9d24c0/8ac56/009.webp 240w,
/static/e57004ee844fd0e51d5abc873a9d24c0/d3be9/009.webp 480w,
/static/e57004ee844fd0e51d5abc873a9d24c0/cb533/009.webp 715w&quot;
              sizes=&quot;(max-width: 715px) 100vw, 715px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/e57004ee844fd0e51d5abc873a9d24c0/8ff5a/009.png 240w,
/static/e57004ee844fd0e51d5abc873a9d24c0/e85cb/009.png 480w,
/static/e57004ee844fd0e51d5abc873a9d24c0/d0c0e/009.png 715w&quot;
            sizes=&quot;(max-width: 715px) 100vw, 715px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/e57004ee844fd0e51d5abc873a9d24c0/d0c0e/009.png&quot;
            alt=&quot;리팩토링 내성을 가진 채로, 회귀방지와 빠른 피드백 사이를 절충한다&quot;
            title=&quot;리팩토링 내성을 가진 채로, 회귀방지와 빠른 피드백 사이를 절충한다&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;리팩토링 내성을 가진 채로, 회귀방지와 빠른 피드백 사이를 절충한다&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;리팩토링 내성은 포기하기 어렵다. 리팩토링 내성은 둘 중 하나를 선택해야한다. 내상이 있거나/없거나 이다. 그렇다면 가져갈 수 밖에 없다.&lt;/p&gt;
&lt;p&gt;회귀 방지와 빠른 피드백에 대한 지표는 조절이 가능하다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;🍅 tips&lt;/p&gt;
&lt;p&gt;테스트 스위트를 탄탄하게 하려면 테스트의 ‘오탐’을 제거하는 것이 최우선 과제다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;❓ CAP Theorem&lt;/p&gt;
&lt;p&gt;좋은 단위 테스트의 세 특성은 상호배타적이다. 이는 마치 DB의 CAP 이론과 유사하다.&lt;/p&gt;
&lt;p&gt;CAP 이론은 분산 데이터 저장소가 아래 세 보증 모두를 동시에 제공할 수 없음을 의미한다&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;일관성(Consistency): 모든 읽기가 가장 최근의 쓰기 또는 오류를 수신&lt;/li&gt;
&lt;li&gt;가용성(Availability): 모든 요청(시스템 내 전체 노드 중단 제외)이 응답을 수신&lt;/li&gt;
&lt;li&gt;분할 내성(Partition Toleration): 네트워크 분할(네트워크 노드 간 연결 끊어짐)에도 시스템이 계속 작동함&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;두 가지 비슷한 점이 있다&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;셋 중 둘을 선택해야한다.&lt;/li&gt;
&lt;li&gt;대규모 시스템이더라도 분할 내성을 포기할 수는 없다. 대규모 서비스는 분할 내성을 수행하지 않으면 그 많은 데이터를 가지고 있을 수가 없다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;그렇다면 일관성과 가용성 둘 중 하나를 절충해야한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;실시간성이 필요하면 일관성을 선택&lt;/li&gt;
&lt;li&gt;죽지않는 서비스여야 한다면 가용성을 선택&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;45-대중적인-테스트-자동화-개념-살펴보기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#45-%EB%8C%80%EC%A4%91%EC%A0%81%EC%9D%B8-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%9E%90%EB%8F%99%ED%99%94-%EA%B0%9C%EB%85%90-%EC%82%B4%ED%8E%B4%EB%B3%B4%EA%B8%B0&quot; aria-label=&quot;45 대중적인 테스트 자동화 개념 살펴보기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.5 대중적인 테스트 자동화 개념 살펴보기&lt;/h1&gt;
&lt;p&gt;앞에서 살펴본 좋은 테스트의 특성은 기본적으로 깔고가야 하는 것이다. 기존에 알려진 테스트 자동화 개념은 하기 네 특성으로 거슬러 올라갈 수 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;테스트 피라미드&lt;/li&gt;
&lt;li&gt;블랙박스 테스트&lt;/li&gt;
&lt;li&gt;화이트박스 테스트&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;451-테스트-피라미드-분해&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#451-%ED%85%8C%EC%8A%A4%ED%8A%B8-%ED%94%BC%EB%9D%BC%EB%AF%B8%EB%93%9C-%EB%B6%84%ED%95%B4&quot; aria-label=&quot;451 테스트 피라미드 분해 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.5.1 테스트 피라미드 분해&lt;/h2&gt;
&lt;p&gt;테스트 피라미드는, 테스트 스위트에서 아래 테스트 유형 간의 일정한 비율을 일컫는 개념이다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;단위 테스트&lt;/li&gt;
&lt;li&gt;통합 테스트&lt;/li&gt;
&lt;li&gt;e2e 테스트&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 637px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/1e307ab85c4aaee6423c3bafcaa3a098/13a9a/010.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 85.83333333333334%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABYlAAAWJQFJUiTwAAACEklEQVQ4y3VUW3PSQBTOX/ZFxxnFSrkMQVvstGXseGkf1VYiIC0Jl3Cpz7bT6YMlDIQSarEP8YEEkvA5uzVpsiE7c+bsuey339mzuxyYsVwuPR01Z3P9c24VoBt0HAeDoRoC9ufo+l8sFgsvzq1iR4DI0CYT7H38gMnNTcDvB5zNZrAsKxrQn3wkCIin0xDKpUiGpjmHbdthQJbdr14PW/k8ctvb2Mrv4kpRQizvAc0wQ/bADcPAu/19vNndwc7eW6rfHxzQxWzJxOdu4jWFZdeQW4itryPJZ5HIZKiOJRJottte3sMZGpQAYUmEY8Fup1Pwm5tIZXk8jb3Ao8dP8GztJdKvX1H/n7u7QL6u61CUPs7OznE91u4B/SV8PvqKtWQSmY0NpHgez+NxpLJZahP/oSAEAMmVMYwZft9OQSC4QCOuerS8bC5H2RBh5wS81+97Z2mYZrDL/pKb3VMUKscoiSKK1SpKooSyKPlsEYVKBfLpj1CX3So5539AGQxQqddR63QgtdtUvtdqKEsS9bs+Eid2fzj0boRlMfeQOOudLqqyDLHV8uSwWMKnQgFfvhUDfpLX6HYxn8/pGYbu4c+LCxRFESfNJo4bDU+IfSLLK/0k//zyMgxIjGtNw0jTqPbLaOzKeGWMaMLS/zBoU+guC4tq/9zVtmVH5rCv7OEtM5oMVVXp96WqIzjMwmXEH/oPnOLcPFUtgNgAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/1e307ab85c4aaee6423c3bafcaa3a098/8ac56/010.webp 240w,
/static/1e307ab85c4aaee6423c3bafcaa3a098/d3be9/010.webp 480w,
/static/1e307ab85c4aaee6423c3bafcaa3a098/63990/010.webp 637w&quot;
              sizes=&quot;(max-width: 637px) 100vw, 637px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/1e307ab85c4aaee6423c3bafcaa3a098/8ff5a/010.png 240w,
/static/1e307ab85c4aaee6423c3bafcaa3a098/e85cb/010.png 480w,
/static/1e307ab85c4aaee6423c3bafcaa3a098/13a9a/010.png 637w&quot;
            sizes=&quot;(max-width: 637px) 100vw, 637px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/1e307ab85c4aaee6423c3bafcaa3a098/13a9a/010.png&quot;
            alt=&quot;Behold, the mighty test pyramid!&quot;
            title=&quot;Behold, the mighty test pyramid!&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;Behold, the mighty test pyramid!&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;피라미드의 특징은 아래와 같다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;각 층의 너비: 테스트 스위트에서 해당 테스트가 얼마나 보편적인지 나타낸다. 넓을 수록 갯수가 많음을 말한다&lt;/li&gt;
&lt;li&gt;층의 높이: 최종 사용자의 동작을 얼마나 유사하게 흉내내는지를 말한다. e2e 테스트가 가장 위에 있고, 최종 사용자와 유사하게 행동하는지를 나타내는 척도다.&lt;/li&gt;
&lt;li&gt;피라미드 내 테스트 유형에 따라 빠른 피드백↔회귀 방지 사이에서 선택한다. 상단 테스트는 회귀 방지에 유리하다. 하단은 실행속도를 강조한다.&lt;/li&gt;
&lt;li&gt;테스트 갯수는 보통 피라미드 형태를 유지한다. e2e는 최소 필수값만, 단위 테스트는 가장 많이.&lt;/li&gt;
&lt;li&gt;다만 어느 계층도 리팩토링 내성을 포기하지 않는다. 단위 테스트에서도 그래야한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 689px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/28797c9b7a256ed1ae01e0693f9cc1f2/0f79a/011.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 80%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAABtklEQVQ4y51Ty3KCQBDk/z8mpySXnHJLYlViNIopRRCUp/IQFnnaqVlFAdGkMlVbsLMzPT3bswKu2H6/b3y7zrpM+A0wSRLMpTlkWYGqLcHi+CboTcAqSVEWeP/oYzqTkKbp/wDrSYZt4f7pCRNpdlHsT4Dt+1ssNdw9PuB9OGwAdoEK14Cq/7IswViMkEWIGENRFBcxdWCBNmW5b1StB8TxrgESH0VpM63W1TskkCzLkKZZg0WW5VyYqshFy+v1BgtVg6EbWK10WJYNy3HQG/Qxlee8ZUquFgHPFBlvgz5M2+bgjDFEUcSLC+SQpDlEcQJx8o0wjCBrKp57L/gUx8iPjIhtkhyYDcQxnnuvmMymcGwHqqbxOfU8/9AyVa2qk+V5Dk3XsQ1D+EGA3W6HYLvlwOQjNnRORS5abkt/UrcoEPgB+qMvLFQVw/EYumHgczRCEGwp8DQFB2HLsyhdalEAMXV9nz+/tetyhhvX5d1UAO0REm49egLssrq/nSO0D6g6CUMXTHdFfvrSNEQR4zGkqut6fOCvMjwLksEwTJimBcdZc59pmpAV5bT3PQ/LlX7a1wF/ANLY4Et4eZNuAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/28797c9b7a256ed1ae01e0693f9cc1f2/8ac56/011.webp 240w,
/static/28797c9b7a256ed1ae01e0693f9cc1f2/d3be9/011.webp 480w,
/static/28797c9b7a256ed1ae01e0693f9cc1f2/2e76f/011.webp 689w&quot;
              sizes=&quot;(max-width: 689px) 100vw, 689px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/28797c9b7a256ed1ae01e0693f9cc1f2/8ff5a/011.png 240w,
/static/28797c9b7a256ed1ae01e0693f9cc1f2/e85cb/011.png 480w,
/static/28797c9b7a256ed1ae01e0693f9cc1f2/0f79a/011.png 689w&quot;
            sizes=&quot;(max-width: 689px) 100vw, 689px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/28797c9b7a256ed1ae01e0693f9cc1f2/0f79a/011.png&quot;
            alt=&quot;피라미드 테스트는 빠른 피드백, 회귀 방지 사이에서 선택한다&quot;
            title=&quot;피라미드 테스트는 빠른 피드백, 회귀 방지 사이에서 선택한다&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;피라미드 테스트는 빠른 피드백, 회귀 방지 사이에서 선택한다&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;테스트 피라미드에도 예외가 있다. 비즈니스 규칙, 복잡도가 거의 없는 CRUD 작업이면 테스트 ‘피라미드’는 단위테스트, 통합테스트만 존재하고 e2e 테스트가 없는 직사각형처럼 될 수도 있다.&lt;/p&gt;
&lt;p&gt;단위 테스트는 알고리즘이나 비즈니스 복잡도가 없는 환경에서는 유용하지 않으므로 간단한 테스트까지 내려간다. 하지만 통합 테스트는 아무리 단순하더라도 다른 하위의 시스템과 ‘통합’하여 도는지 확인하는 것이 중요하다. 결국 단위 테스트는 더 적어지고, 통합 테스트가 더 많아질 수 있다&lt;sup id=&quot;fnref-3&quot;&gt;&lt;a href=&quot;#fn-3&quot; class=&quot;footnote-ref&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;p&gt;테스트 피라미드의 또 다른 예외는 프로젝트 외부 의존성(예시: DB) 하나만 연결하는 API다. 이런 경우는 e2e 케이스를 더 많이 두는 것이 이런 애플리케이션에 적합한 옵션일 수 있다. UI도 없으니 유지비도 크지 않다. 이런 환경은 e2e 테스트와 통합테스트가 테스트의 진입점 정도밖에 차이가 없다.&lt;/p&gt;
&lt;h2 id=&quot;452-블랙박스-테스트와-화이트박스-테스트-간의-선택&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#452-%EB%B8%94%EB%9E%99%EB%B0%95%EC%8A%A4-%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%99%80-%ED%99%94%EC%9D%B4%ED%8A%B8%EB%B0%95%EC%8A%A4-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EA%B0%84%EC%9D%98-%EC%84%A0%ED%83%9D&quot; aria-label=&quot;452 블랙박스 테스트와 화이트박스 테스트 간의 선택 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.5.2 블랙박스 테스트와 화이트박스 테스트 간의 선택&lt;/h2&gt;
&lt;p&gt;또 다른 잘 알려진 테스트는 블랙박스 테스트와 화이트박스 테스트가 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;블랙박스 테스트
&lt;ul&gt;
&lt;li&gt;시스템 구조를 몰라도 시스템 기능을 검사할 수 있는 소프트웨어 테스트 방법&lt;/li&gt;
&lt;li&gt;명세, 요구사항 중심으로 구축한다(“무엇을” 해야하는지 중심으로)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;화이트박스 테스트
&lt;ul&gt;
&lt;li&gt;애플리케이션 내부 작업을 검증하는 테스트 방식&lt;/li&gt;
&lt;li&gt;소스코드 중심으로 파생된다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;두 방법 모두 장단점이 있다. 화이트박스 테스트가 더 철저한 편이다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;소스코드를 집중분석하면, 외부명세(요구사항)에만 의존할 때 놓칠 수 있는 부분을 잡을 수 있다. 그렇지만 구현에 결합되어 있기 때문에 깨지기 쉽다. 다시말해 ‘오탐’을 많이 내고 리팩토링 내성 지표가 모자라다.&lt;/li&gt;
&lt;li&gt;비즈니스 담당자에게 의미있는 동작으로 유추할 수 없다&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;블랙박스 테스트는 정반대의 장단점을 가진다. 아래는 표로 정리한 사항이다.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;＼&lt;/th&gt;
&lt;th&gt;회귀 방지&lt;/th&gt;
&lt;th&gt;리팩토링 내성&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;화이트박스 테스트&lt;/td&gt;
&lt;td&gt;좋음&lt;/td&gt;
&lt;td&gt;나쁨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;블랙박스 테스트&lt;/td&gt;
&lt;td&gt;나쁨&lt;/td&gt;
&lt;td&gt;좋음&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;그렇지만 리팩토링 내성은 타협할 수 없다. 기본적으로 블랙박스 테스트를 작성하되, 알고리즘 복잡도가 높은 유틸리티 코드를 다루거나 테스트를 분석할 때는 화이트박스 테스트 접근을 수행하라.&lt;/p&gt;
&lt;h1 id=&quot;summary&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#summary&quot; aria-label=&quot;summary permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Summary&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;좋은 단위 테스트에는 단위 테스트, 통합 테스트, e2e 테스트 등 자동화된 테스트를 분석하는 데 사용할 수 있는 네 가지 기본 특성이 있다.
&lt;ol&gt;
&lt;li&gt;회귀 방지&lt;/li&gt;
&lt;li&gt;리팩토링 내성&lt;/li&gt;
&lt;li&gt;빠른 피드백&lt;/li&gt;
&lt;li&gt;유지 보수성&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;회귀 방지: 테스트가 얼마나 버그(회귀)의 존재를 잘 나타내는지에 대한 척도&lt;/li&gt;
&lt;li&gt;리팩토링 내성: 테스트가 거짓 양성(‘오탐’)을 내지 않고 애플리케이션 코드 리팩토링을 유지할 수 있는 정도&lt;/li&gt;
&lt;li&gt;거짓 양성 → 오탐을 의미한다
&lt;ul&gt;
&lt;li&gt;오탐에 익숙해지면… 테스트를 의미없는 것으로 본다(문제 대응의지력 하락, 테스트 비신뢰)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;거짓 양성은 테스트 대상 시스템과 테스트 코드가 강하게 결합되어있음을 의미한다. 결합도를 낮추려면 SUT의 “단계”가 아니라 “결과”를 검증하라&lt;/li&gt;
&lt;li&gt;회귀 방지와 리팩토링 내성은 테스트 정확도에 기여한다. 테스트는…
&lt;ul&gt;
&lt;li&gt;가능한 한(리팩토링 내성)&lt;/li&gt;
&lt;li&gt;적은 소음(‘거짓 양성’)으로&lt;/li&gt;
&lt;li&gt;강한 신호(버그 탐지… 회귀 방지 영역)&lt;/li&gt;
&lt;li&gt;…를 발생시킨다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;거짓 양성은 프로젝트가 성장할 수록 점점 더 중요해진다&lt;/li&gt;
&lt;li&gt;빠른 피드백은 테스트가 얼마나 빨리 실행되는지에 대한 척도다&lt;/li&gt;
&lt;li&gt;유지 보수성은 두 가지 요소로 구성된다
&lt;ul&gt;
&lt;li&gt;테스트 이해 난이도: 테스트가 작으면 읽기 쉬움&lt;/li&gt;
&lt;li&gt;테스트 실행 난이도: 테스트가 엮인 의존성(프로세스 외부 의존성)이 적으면 쉽게 운영할 수 있음&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;테스트의 가치 추정치는 상기 네 가지 특성에서 얻은 점수의 곱이다. 모두 중요하다! (하나라도 &lt;code class=&quot;language-text&quot;&gt;0&lt;/code&gt;이 되면 가치없어짐)&lt;/li&gt;
&lt;li&gt;회귀 방지, 리팩토링 내성, 빠른 피드백은 상호 배타적(&lt;em&gt;mutually exclusive&lt;/em&gt;)이다
&lt;ul&gt;
&lt;li&gt;리팩토링 내성은 양보할 수 없는 가치다&lt;/li&gt;
&lt;li&gt;회귀 방지와 빠른 피드백 사이에서 절충안을 찾는다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;테스트 피라미드는 단위 테스트, 통합 테스트, e2e 테스트의 적정 비율을 의미한다
&lt;ul&gt;
&lt;li&gt;단위 테스트 &gt; 통합 테스트 &gt; e2e 테스트 순으로 갯수가 많다&lt;/li&gt;
&lt;li&gt;e2e 테스트는 회귀 방지를 선호한다&lt;/li&gt;
&lt;li&gt;단위 테스트는 빠른 피드백을 선호한다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;테스트를 작성할 때는 블랙박스 테스트 방법을 사용한다. 테스트 분석 시에는 화이트박스 테스트 방법을 사용한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;출처: &lt;a href=&quot;https://twitter.com/bikutoru/status/981977290430189569&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://twitter.com/bikutoru/status/981977290430189569&lt;/a&gt;&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-2&quot;&gt;버그 없는 시스템은 없다. 최소한 이 의견에 동의한다. True Negative 영역 어딘가에 존재할 ‘수도 있다’. &lt;a href=&quot;https://johngrib.github.io/wiki/Lubarsky-s-Law-of-Cybernetic-Entomology/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;관련 내용에 대한 원본 링크&lt;/a&gt;&lt;a href=&quot;#fnref-2&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-3&quot;&gt;코스믹 파이썬에서 시사하는 &lt;a href=&quot;https://www.cosmicpython.com/book/chapter_05_high_gear_low_gear.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;high gear, low gear&lt;/a&gt;가 연관있을지 살펴보자.&lt;a href=&quot;#fnref-3&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[단위 테스트 (3)]]></title><description><![CDATA[단위 테스트 를 읽고 이해한 내용을 작성합니다. 챕터 3, 단위 테스트 구조에 대한 내용입니다.]]></description><link>https://blog.s3ich4n.me/books/unit-testing/2023-07-01-pt01-ch03</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/unit-testing/2023-07-01-pt01-ch03</guid><pubDate>Sat, 01 Jul 2023 00:44:02 GMT</pubDate><content:encoded>&lt;p&gt;이 내용은 “단위 테스트” 를 읽고 작성한 내용입니다. 블로그 게시글과, 작성한 코드를 함께 보시면 더욱 좋습니다.&lt;/p&gt;
&lt;p&gt;3장은 해당 코드를 살펴봐주세요. &lt;a href=&quot;https://github.com/s3ich4n/unit-testing-101/tree/main/pt1/ch03&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;코드 링크&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Chapter 3. 단위 테스트 구조&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;커맨드로 테스트를 직접 실행하기 위해선 현재 디렉토리로 이동한다.
&lt;code class=&quot;language-text&quot;&gt;cd pt1/ch03&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h1 id=&quot;들어가며&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0&quot; aria-label=&quot;들어가며 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;들어가며&lt;/h1&gt;
&lt;p&gt;단위 테스트의 구조 살펴보기&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Arrange&lt;/li&gt;
&lt;li&gt;Act&lt;/li&gt;
&lt;li&gt;Assert&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;단위테스트 명명법 살펴보기&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;관행 타파 방안&lt;/li&gt;
&lt;li&gt;더 나은 방안 제시&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;단위테스트 근소화에 도움되는 라이브러리의 특징 살펴보기&lt;/p&gt;
&lt;h1 id=&quot;31-단위-테스트-구성하는-방법&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#31-%EB%8B%A8%EC%9C%84-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EA%B5%AC%EC%84%B1%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95&quot; aria-label=&quot;31 단위 테스트 구성하는 방법 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.1 단위 테스트 구성하는 방법&lt;/h1&gt;
&lt;h2 id=&quot;311-arrange-act-assert-패턴-사용&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#311-arrange-act-assert-%ED%8C%A8%ED%84%B4-%EC%82%AC%EC%9A%A9&quot; aria-label=&quot;311 arrange act assert 패턴 사용 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.1.1 Arrange-Act-Assert 패턴 사용&lt;/h2&gt;
&lt;p&gt;준비(&lt;em&gt;Arrange&lt;/em&gt;), 실행(&lt;em&gt;Act&lt;/em&gt;), 검증(&lt;em&gt;Assert&lt;/em&gt;)의 세 가지 패턴을 사용하여 작성하는 것을 의미한다. 다음 클래스를 테스트한다고 생각해보자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Calculator&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;first&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; double&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; second&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; double&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; double&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; first &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; second&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;그렇다면 테스트코드는 아래와 같이 이루어질 것이다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_sum_of_two_numbers&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# Arrange&lt;/span&gt;
    first &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;
    second &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;
    calc &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Calculator&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Act&lt;/span&gt;
    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; calc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;first&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; second&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Assert&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;30&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; result&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;해당 패턴은 균일한 구조를 가지므로 일관성이 있다. 이것이 큰 장점이다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Arrange: SUT 과 해당 의존성을 원하는 상태로 만든다&lt;/li&gt;
&lt;li&gt;Act: SUT에서 메소드를 호출하고 준비된 의존성을 전달한다. 출력값이 있으면 이를 캡처한다&lt;/li&gt;
&lt;li&gt;Assert: 결과를 검증한다. SUT와 협력자의 최종 상태, SUT가 협력자에 호출한 메소드 등으로 표시될 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;Given-When-Then 패턴?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Given: Arrange section과 유사&lt;/li&gt;
&lt;li&gt;When: Act section과 유사&lt;/li&gt;
&lt;li&gt;Then: Assert section과 유사&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;두 패턴에 차이는 없으나, 비기술자들과 공유하는 테스트에 좀 더 적합하다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;처음 테스트를 작성할 때, 이런 식으로 윤곽을 잡으면 좋다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;특정 동작이 무엇을 해야하는지에 대한 목표를 생각하며 시작한다 → assert 문으로 시작하는 사고를 해보자&lt;/li&gt;
&lt;li&gt;뭘 해야할지 설계되어있으면 Arrange 문부터 구상해보자&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;312-여러-개의-aaa-sections-피하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#312-%EC%97%AC%EB%9F%AC-%EA%B0%9C%EC%9D%98-aaa-sections-%ED%94%BC%ED%95%98%EA%B8%B0&quot; aria-label=&quot;312 여러 개의 aaa sections 피하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.1.2 여러 개의 AAA sections 피하기&lt;/h2&gt;
&lt;p&gt;여러 동작단위를 테스트하지 말고 하나씩 하라. 하나 이상을 하면 통합 테스트다(2장 참고). 여러 동작단위가 있는 코드는 여러 단일 코드가 존재하는 코드로 리팩토링하라&lt;/p&gt;
&lt;p&gt;실행이 하나면 아래 이점이 생긴다&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;테스트를 단위 테스트의 범주에 있게 한다&lt;/li&gt;
&lt;li&gt;쉽고 빠르고 이해하기 쉽다&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;통합 테스트에선 여러 section이 있을 수 있지만 이를 빠르게 하려면 단일 테스트를 여러 개 모으는 방법이 있다.&lt;/p&gt;
&lt;h2 id=&quot;313-테스트-내-if-문-피하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#313-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EB%82%B4-if-%EB%AC%B8-%ED%94%BC%ED%95%98%EA%B8%B0&quot; aria-label=&quot;313 테스트 내 if 문 피하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.1.3 테스트 내 &lt;code class=&quot;language-text&quot;&gt;if&lt;/code&gt; 문 피하기&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;if&lt;/code&gt;문이 있는 테스트도 안티패턴이다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;if문은 테스트가 한 번에 너무 많은 것을 검증한다는 표시다 → 여러 테스트로 나누어야 한다&lt;/li&gt;
&lt;li&gt;이런 테스트는 차라리 여러 테스트로 나누는 것이 좋다(통합 테스트 포함)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;314-각-section은-얼마나-커야하나&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#314-%EA%B0%81-section%EC%9D%80-%EC%96%BC%EB%A7%88%EB%82%98-%EC%BB%A4%EC%95%BC%ED%95%98%EB%82%98&quot; aria-label=&quot;314 각 section은 얼마나 커야하나 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.1.4 각 section은 얼마나 커야하나?&lt;/h2&gt;
&lt;h3 id=&quot;arrange가-크면&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#arrange%EA%B0%80-%ED%81%AC%EB%A9%B4&quot; aria-label=&quot;arrange가 크면 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Arrange가 크면?&lt;/h3&gt;
&lt;p&gt;별도의 private 메소드, 팩토리 클래스로 도출하는 편이 좋다. 이를 위해 Object mother 패턴과 Test Data Builder패턴을 고려할 수 있다.&lt;/p&gt;
&lt;h3 id=&quot;act-section이-한-줄-이상인-경우를-경계하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#act-section%EC%9D%B4-%ED%95%9C-%EC%A4%84-%EC%9D%B4%EC%83%81%EC%9D%B8-%EA%B2%BD%EC%9A%B0%EB%A5%BC-%EA%B2%BD%EA%B3%84%ED%95%98%EA%B8%B0&quot; aria-label=&quot;act section이 한 줄 이상인 경우를 경계하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Act section이 한 줄 이상인 경우를 경계하기&lt;/h3&gt;
&lt;p&gt;Act section은 보통 한 줄이다. 이 이상이면 SUT의 public API를 의심해야 한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;good case: 깔끔하게 떨어짐&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_purchase_succeeds_when_enough_inventory&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# Arrange&lt;/span&gt;
    store &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Store&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Shampoo&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    customer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Customer&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Act&lt;/span&gt;
    success &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; customer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;purchase&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;store&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Product&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Shampoo&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Assert&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; success &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; store&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;item&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;count&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;bad case
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;캡슐화를 깨면서까지 테스트하면 안 된다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;단일 작업을 수행하는 데 여러 메소드를 호출해야 한다는 점&lt;/p&gt;
&lt;p&gt;→ 불변 위반(&lt;em&gt;invariant violation&lt;/em&gt;), 캡슐화가 깨짐.&lt;/p&gt;
&lt;p&gt;캡슐화를 깨지 않도록 코드를 작성할 것!&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_purchase_succeeds_when_enough_inventory&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# Arrange&lt;/span&gt;
    store &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Store&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Shampoo&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    customer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Customer&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Act&lt;/span&gt;
    is_available &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; store&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;has_enough_inventory&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Shampoo&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    success &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; customer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;purchase&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;store&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Product&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Shampoo&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Assert&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; is_available &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; success &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; store&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;item&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;count&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;315-assert-section에는-얼마나-많은-assert가-있어야-하나&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#315-assert-section%EC%97%90%EB%8A%94-%EC%96%BC%EB%A7%88%EB%82%98-%EB%A7%8E%EC%9D%80-assert%EA%B0%80-%EC%9E%88%EC%96%B4%EC%95%BC-%ED%95%98%EB%82%98&quot; aria-label=&quot;315 assert section에는 얼마나 많은 assert가 있어야 하나 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.1.5 Assert section에는 얼마나 많은 &lt;code class=&quot;language-text&quot;&gt;assert&lt;/code&gt;가 있어야 하나?&lt;/h2&gt;
&lt;p&gt;단위 테스트의 단위는 “동작”의 단위다. 동작은 여러 결과를 낼 수 있으므로, 그 결과를 하나의 테스트에서 검증하는 것은 문제없다.&lt;/p&gt;
&lt;p&gt;다만 너무 많은 assert 구문은 문제가 된다. 만약 이렇다면, 추상화가 제대로 안 되어있는지 생각해볼 수 있다.&lt;/p&gt;
&lt;p&gt;이를 해결하기 위해 동등 멤버(&lt;em&gt;equality member&lt;/em&gt;)를 정의하는 것이 좋다. (파이썬이라면 &lt;code class=&quot;language-text&quot;&gt;__eq__()&lt;/code&gt; 매직 메소드를 객체별로 구현하는 뜻)&lt;/p&gt;
&lt;h2 id=&quot;316-종료-단계는&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#316-%EC%A2%85%EB%A3%8C-%EB%8B%A8%EA%B3%84%EB%8A%94&quot; aria-label=&quot;316 종료 단계는 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.1.6 종료 단계는?&lt;/h2&gt;
&lt;p&gt;보통 그런 teardown은 별도 메소드로 표현하는 것이 좋다.&lt;/p&gt;
&lt;p&gt;다만 단위 테스트에서는 teardown을 보통 필요로 하지 않는다.&lt;/p&gt;
&lt;h2 id=&quot;317-테스트-대상-시스템-구별하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#317-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EB%8C%80%EC%83%81-%EC%8B%9C%EC%8A%A4%ED%85%9C-%EA%B5%AC%EB%B3%84%ED%95%98%EA%B8%B0&quot; aria-label=&quot;317 테스트 대상 시스템 구별하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.1.7 테스트 대상 시스템 구별하기&lt;/h2&gt;
&lt;p&gt;SUT는 테스트에서 중요하다. 애플리케이션에서 호출하려는 지점에 대한 엔트리포인트이기 때문이다. “동작”은 여러 클래스에서 걸칠 수 있지만, 엔트리포인트는 단 하나일 수 밖에 없다.&lt;/p&gt;
&lt;p&gt;즉, SUT를 의존성과 구분하는 것이 좋다. SUT가 많으면 테스트 대상을 찾는데 시간을 너무 많이 들일 필요가 없다. 정 헷갈리면 Arrange 할 때, 이름을 그냥 &lt;code class=&quot;language-text&quot;&gt;sut&lt;/code&gt; 로 붙여버리면 된다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_sum_of_two_numbers&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# Arrange&lt;/span&gt;
    first &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;
    second &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;
    sut &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Calculator&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;      &lt;span class=&quot;token comment&quot;&gt;# 이런 식으로!&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Act&lt;/span&gt;
    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sut&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;first&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; second&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Assert&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;30&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; result&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;318-arrange-act-assert-주석-떼어내기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#318-arrange-act-assert-%EC%A3%BC%EC%84%9D-%EB%96%BC%EC%96%B4%EB%82%B4%EA%B8%B0&quot; aria-label=&quot;318 arrange act assert 주석 떼어내기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.1.8 Arrange-Act-Assert 주석 떼어내기&lt;/h2&gt;
&lt;p&gt;테스트의 어떤 부분이 Arrange-Act-Assert 인지 구별을 쉽게 하는 것은 중요하다.&lt;/p&gt;
&lt;p&gt;이해하기 쉬운 테스트라면 굳이 주석을 달지 말고 개행으로 처리하라.
통합 테스트 등의 복잡한 테스트라면 Arrange-Act-Assert 주석을 달아주는 편이 좋다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# 이해하기 쉬운 퀘스트면 개행으로만 구별!&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_sum_of_two_numbers&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    first &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;
    second &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;
    sut &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Calculator&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sut&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;first&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; second&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;30&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; result&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id=&quot;32-xunit-테스트-프레임워크-살펴보기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#32-xunit-%ED%85%8C%EC%8A%A4%ED%8A%B8-%ED%94%84%EB%A0%88%EC%9E%84%EC%9B%8C%ED%81%AC-%EC%82%B4%ED%8E%B4%EB%B3%B4%EA%B8%B0&quot; aria-label=&quot;32 xunit 테스트 프레임워크 살펴보기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.2 xUnit 테스트 프레임워크 살펴보기&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;setUp()&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;tearDown()&lt;/code&gt; 구성이 있고 테스트코드를 꾸리는게 xUnit 테스트 형식이라고 한다. 파이썬의 빌트인 테스팅 프레임워크 &lt;code class=&quot;language-text&quot;&gt;unittest&lt;/code&gt; 가 해당 구조를 따른다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;pytest&lt;/code&gt; 는 fixture 기반으로 테스트의 &lt;code class=&quot;language-text&quot;&gt;setUp&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;tearDown&lt;/code&gt;을 구성할 수 있다.
&lt;ul&gt;
&lt;li&gt;예를 들면 이런 식으로…&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fixture&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;fixture123&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# yield 상단 구문은 setUp으로 구성가능&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;test data&quot;&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# yield 하단 구문은 tearDown으로 구성가능&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_fixture&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;fixture123&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;test data&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; fixture123&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;fixture의 반복을 피하기 위해 &lt;code class=&quot;language-text&quot;&gt;conftest.py&lt;/code&gt; 파일을 구조화할 수도 있고, fixture의 scope 또한 지정해줄 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;33-테스트-간-테스트-픽스처-사용&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#33-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EA%B0%84-%ED%85%8C%EC%8A%A4%ED%8A%B8-%ED%94%BD%EC%8A%A4%EC%B2%98-%EC%82%AC%EC%9A%A9&quot; aria-label=&quot;33 테스트 간 테스트 픽스처 사용 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.3 테스트 간 테스트 픽스처 사용&lt;/h1&gt;
&lt;p&gt;테스트코드도 코드 재사용을 수행할 수 있다. 그를 위한 도구 중 하나가 픽스처이다.&lt;/p&gt;
&lt;p&gt;이 책에서 픽스처는 &lt;strong&gt;테스트 실행 대상 객체&lt;/strong&gt;를 의미한다. 테스트 전에 원하는 고정적 상태를 유지하는 역할을 한다.&lt;/p&gt;
&lt;p&gt;픽스처를 재사용하는 첫 번째 방법은 아래와 같다. (아래 방안으로는 사용하지 말자)&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;TestCustomer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    store &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Store&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Shampoo&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    sut &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Customer&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_purchase_succeeds_when_enough_inventory&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        success &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sut&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;purchase&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;store&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Product&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Shampoo&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; success &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;store&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;item&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;count

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_purchase_fails_when_not_enough_money&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        success &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sut&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;purchase&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;store&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Product&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Shampoo&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; success &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;store&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;item&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;count&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;테스트는 아래 명령으로 구동한다:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;pytest test\test_03_high_coupling.py&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;test&lt;/span&gt; session starts &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;
platform win32 -- Python &lt;span class=&quot;token number&quot;&gt;3.10&lt;/span&gt;.11, pytest-7.4.0, pluggy-1.2.0
rootdir: C:&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;unit_testing&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;pt1&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;ch03
plugins: cov-4.1.0, mock-3.11.1
collected &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; items                                                                                                                    

test&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;test_03_high_coupling.py .F                                                                                              &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; FAILURES &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; 
______________________________________ TestCustomer.test_purchase_fails_when_not_enough_money ______________________________________ 

self &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;test_03_high_coupling.TestCustomer object at 0x000001DB3F6A11E&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;0&lt;/span&gt;&gt;&lt;/span&gt;

    def test_purchase_fails_when_not_enough_money&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;:
        success &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; self.sut.purchase&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self.store, Product&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Shampoo&quot;&lt;/span&gt;, &lt;span class=&quot;token number&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;))&lt;/span&gt;

        assert success is False
&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;       assert &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; self.store.item.count
E       AssertionError: assert &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;
E        +  where &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Product&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;merch&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Shampoo&apos;&lt;/span&gt;, &lt;span class=&quot;token assign-left variable&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;.count
E        +    where Product&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;merch&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Shampoo&apos;&lt;/span&gt;, &lt;span class=&quot;token assign-left variable&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;test_03_high_coupling.Store object at 0x000001DB3F6A0F4&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;0&lt;/span&gt;&gt;&lt;/span&gt;.item
E        +      where &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;test_03_high_coupling.Store object at 0x000001DB3F6A0F4&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;0&lt;/span&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;test_03_high_coupling.TestCustomer object at 0x000001DB3F6A11E&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;0&lt;/span&gt;&gt;&lt;/span&gt;.store

test&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;test_03_high_coupling.py:59: AssertionError
&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; short &lt;span class=&quot;token builtin class-name&quot;&gt;test&lt;/span&gt; summary info &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; 
FAILED test/test_03_high_coupling.py::TestCustomer::test_purchase_fails_when_not_enough_money - AssertionError: assert &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;       
&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; failed, &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; passed &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.08s &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;다른 테스트 케이스에 간섭되어 문제가 발생했다!&lt;/p&gt;
&lt;p&gt;이런 류의 로직은 두 가지 단점이 있다!&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;테스트 간 결합도가 높아짐&lt;/li&gt;
&lt;li&gt;테스트 가독성이 떨어짐&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;331-테스트-간의-높은-결합도는-안티패턴이다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#331-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EA%B0%84%EC%9D%98-%EB%86%92%EC%9D%80-%EA%B2%B0%ED%95%A9%EB%8F%84%EB%8A%94-%EC%95%88%ED%8B%B0%ED%8C%A8%ED%84%B4%EC%9D%B4%EB%8B%A4&quot; aria-label=&quot;331 테스트 간의 높은 결합도는 안티패턴이다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.3.1 테스트 간의 높은 결합도는 안티패턴이다&lt;/h2&gt;
&lt;p&gt;테스트 간 결합도가 높으면, 다른 테스트에 원치않는 실패를 야기한다. 테스트는 서로 격리되어야 한다는 지침을 어기기 때문이다.&lt;/p&gt;
&lt;p&gt;테스트에 공유상태를 두는걸 끊어내야함&lt;/p&gt;
&lt;h2 id=&quot;332-테스트-가독성을-떨어뜨리는-생성자-사용&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#332-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EA%B0%80%EB%8F%85%EC%84%B1%EC%9D%84-%EB%96%A8%EC%96%B4%EB%9C%A8%EB%A6%AC%EB%8A%94-%EC%83%9D%EC%84%B1%EC%9E%90-%EC%82%AC%EC%9A%A9&quot; aria-label=&quot;332 테스트 가독성을 떨어뜨리는 생성자 사용 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.3.2 테스트 가독성을 떨어뜨리는 생성자 사용&lt;/h2&gt;
&lt;p&gt;준비코드를 생성자로 추출하면 테스트 가독성을 떨어뜨린다. 테스트 메소드가 무엇을 해야하는지 이해하려면 다른 클래스의 부분도 봐야한다.&lt;/p&gt;
&lt;h2 id=&quot;333-더-나은-테스트-픽스처-재사용법&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#333-%EB%8D%94-%EB%82%98%EC%9D%80-%ED%85%8C%EC%8A%A4%ED%8A%B8-%ED%94%BD%EC%8A%A4%EC%B2%98-%EC%9E%AC%EC%82%AC%EC%9A%A9%EB%B2%95&quot; aria-label=&quot;333 더 나은 테스트 픽스처 재사용법 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.3.3 더 나은 테스트 픽스처 재사용법&lt;/h2&gt;
&lt;p&gt;생성자를 쓰는 것은 최선의 방법이라긴 힘들다. 두 번째 방법은 private 팩토리 메소드를 생성하는 것이다.&lt;/p&gt;
&lt;p&gt;pytest라면 scope을 좁게 둔 fixture를 테스트별로 주면 좋을 것 같다. 개별 테스트 별로 격리가 된다는 점에서 팩토리 메소드를 두는 것도 나쁘지 않은데, 픽스처로 해결하기 뭣한 부분들(예를 들어 여럿 걸친 conftest에 동시다발저긍로 쓰이는)에서 잘 분리하면 되지 않을까.&lt;/p&gt;
&lt;p&gt;대강 이런 코드를 생각해봤다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fixture&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    scope&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;function&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    name&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;data&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;create_store_with_inventory&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot; Scope을 function으로 두어, 수행하는 테스트 케이스별로 돌 수 있도록...
    &quot;&quot;&quot;&lt;/span&gt;
    store &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Store&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Shampoo&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    sut &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Customer&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;store&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; store&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;sut&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; sut&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;TestCustomer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    store &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Store&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Shampoo&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    sut &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Customer&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_purchase_succeeds_when_enough_inventory&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        store &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; data&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;store&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        sut &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; data&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;sut&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        success &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sut&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;purchase&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;store&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Product&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Shampoo&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; success &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; store&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;item&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;count

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_purchase_fails_when_not_enough_money&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        store &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; data&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;store&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        sut &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; data&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;sut&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        success &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sut&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;purchase&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;store&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Product&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Shampoo&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; success &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; store&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;item&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;count&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;테스트는 아래 명령으로 구동한다:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;pytest test\test_04_using_fixture.py&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;test&lt;/span&gt; session starts &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;
platform win32 -- Python &lt;span class=&quot;token number&quot;&gt;3.10&lt;/span&gt;.11, pytest-7.4.0, pluggy-1.2.0 -- C:&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;REDACTED&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;python.exe
cachedir: .pytest_cache
rootdir: C:&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;pt1&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;ch03
plugins: cov-4.1.0, mock-3.11.1
collected &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; items                                                                                                                       

test/test_04_using_fixture.py::TestCustomer::test_purchase_succeeds_when_enough_inventory PASSED                                 &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt;%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; 
test/test_04_using_fixture.py::TestCustomer::test_purchase_fails_when_not_enough_money PASSED                                    &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; passed &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.02s &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이러면 각 테스트코드 별로 맥락 유지, 결합 제거, 가독성 향상의 이점을 가진다.&lt;/p&gt;
&lt;p&gt;테스트 픽스처 재사용 규칙에는 예외가 있다. 모든 테스트에 사용되는 픽스처는 클래스 생성자로 빼는 편이 더 합리적이다.&lt;/p&gt;
&lt;p&gt;그런건 scope을 다르게 두면 된다고 생각한다. (&lt;a href=&quot;https://docs.pytest.org/en/7.3.x/how-to/fixtures.html#scope-sharing-fixtures-across-classes-modules-packages-or-session&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;관련 링크&lt;/a&gt;)&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fixture&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;scope&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;session&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;smtp_connection&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# the returned fixture value will be shared for&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# all tests requesting it&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;상기와 같이 &lt;code class=&quot;language-text&quot;&gt;scope=&quot;session&quot;&lt;/code&gt; 으로 두면 모든 테스트에 대해 (정확히는 자신이 속한 모듈부터 모든 하위까지) 적용가능하다.&lt;/p&gt;
&lt;h1 id=&quot;34-단위-테스트-명명법&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#34-%EB%8B%A8%EC%9C%84-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EB%AA%85%EB%AA%85%EB%B2%95&quot; aria-label=&quot;34 단위 테스트 명명법 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.4 단위 테스트 명명법&lt;/h1&gt;
&lt;p&gt;단위 테스트에 표현력이 있는 이름을 붙이는 것 또한 중요하다. 이름을 보고 뭐하는 테스트인지, 어떤 시스템 검증인지 한번에 이해할 수 있기 때문이다.&lt;/p&gt;
&lt;p&gt;저자는 일반적으로 쓰이는 명명법 관습을 비판한다. 아래를 보자:&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;[테스트 대상 메소드]_[시나리오]_[예상결과]&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;테스트 대상 메소드: 테스트 중인 메소드 명&lt;/li&gt;
&lt;li&gt;시나리오: 메소드 테스트 조건&lt;/li&gt;
&lt;li&gt;예상 결과: 현재 시나리오에서 테스트 대상 메소드에게 기대하는 것&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이는 테스트코드의 동작 대신 구현 세부사항에 집중하도록 하므로 도움되지 않는다고 한다. 또한 괜히 복잡하게 이름을 작성하는 것은 테스트 파악에 도움되지 않는다고 비판한다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;test_sum_of_two_numbers&lt;/code&gt; 와 같은 이름을 상기 명명법으로 바꾸면, &lt;code class=&quot;language-text&quot;&gt;test_sum_twonumbers_returns_sum&lt;/code&gt; 으로 두어야한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;테스트 대상 메소드: &lt;code class=&quot;language-text&quot;&gt;sum&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;시나리오: 두 개의 숫자&lt;/li&gt;
&lt;li&gt;예상결과: 두 수의 합&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;쓸데없이 복잡하게 두기보단 쉬운 말로 풀어야, 도메인 전문가나 프로그래머 모두에게 도움된다. 현실적인 도움이 되도록 쉽게 작성하자.&lt;/p&gt;
&lt;h2 id=&quot;341-단위-테스트-명명-지침&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#341-%EB%8B%A8%EC%9C%84-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EB%AA%85%EB%AA%85-%EC%A7%80%EC%B9%A8&quot; aria-label=&quot;341 단위 테스트 명명 지침 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.4.1 단위 테스트 명명 지침&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;엄격한 명명정책보다 쉬운 이름으로. 복잡한 동작은 코드로 설명되도록.&lt;/li&gt;
&lt;li&gt;비개발자에게 비즈니스 로직을 설명할 수 있도록 이름을 명명하기.&lt;/li&gt;
&lt;li&gt;단어는 &lt;code class=&quot;language-text&quot;&gt;_&lt;/code&gt; 로 구별하기.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;342-지침에-따른-테스트이름-변경&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#342-%EC%A7%80%EC%B9%A8%EC%97%90-%EB%94%B0%EB%A5%B8-%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%9D%B4%EB%A6%84-%EB%B3%80%EA%B2%BD&quot; aria-label=&quot;342 지침에 따른 테스트이름 변경 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.4.2 지침에 따른 테스트이름 변경&lt;/h2&gt;
&lt;p&gt;이름 개선에 대한 예시를 작성해보자&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; datetime &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    datetime&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    timedelta&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Delivery&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    date_time&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; datetime

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;is_delivery_valid&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;date_time &lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;date_time &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; timedelta&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;days&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1.99&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;TestDelivery&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_isdeliveryvalid_invaliddate_returnsfalse&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        sut&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Delivery &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Delivery&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        past_date&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; datetime &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; datetime&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;now&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; timedelta&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;days&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        sut&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;date_time &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; past_date

        is_valid &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sut&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;is_delivery_valid&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; is_valid &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;테스트는 아래 명령으로 구동한다:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;pytest test\test_05_complex_name.py&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;test&lt;/span&gt; session starts &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;
platform win32 -- Python &lt;span class=&quot;token number&quot;&gt;3.10&lt;/span&gt;.11, pytest-7.4.0, pluggy-1.2.0 -- C:&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;python.exe
cachedir: .pytest_cache
rootdir: C:&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;unit_testing&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;pt1&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;ch03
plugins: cov-4.1.0, mock-3.11.1
collected &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; item

test/test_05_complex_name.py::TestDelivery::test_isdeliveryvalid_invaliddate_returnsfalse PASSED                                 &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; passed &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.01s &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;테스트케이스의 이름을 고쳐보자… 이 정도를 첫 시도라고 할 수 있다!&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;delivery_with_invalid_date_should_be_considered_invalid()&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;이름이 누구에게든 이해하기 쉽도록 바뀌었다&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;SUT의 메소드 이름은 더이상 테스트 이름에 속하지 않는다&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;테스트케이스 이름에 SUT의 메소드 이름을 넣지 마시오&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;SUT의 메소드 이름이 바뀔지도 모른다&lt;/li&gt;
&lt;li&gt;동작 대신 코드를 목표로 하면 해당 코드의 구현 세부사항과 테스트 간의 결합도가 높아진다 → 테스트 유지보수성이 떨어짐 (5장서 살펴봄)&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;p&gt;테스트케이스로 다시 돌아가보자. 이 테스트케이스의 “무효한 날짜”는 언제인가? 과거의 날짜다. 이는 테스트가 과거의 날짜면 실패함을 시사하도록 바꾸어야 한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;delivery_with_past_date_should_be_considered_invalid()&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;좀더 쉬운영어로 갈아보자!&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;delivery_with_past_date_should_be_invalid()&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;em&gt;should be&lt;/em&gt; 구문은 안티패턴이다(!). 하나의 테스트는 동작 단위에 대한 단순하고 원자적 사실이기 때문이다. 사실을 기술할 땐 소망, 욕구가 없다. 그렇다면 아래와 같이 바뀐다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;delivery_with_past_date_is_invalid()&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;기초적인 영문법은 지키자(!)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;delivery_with_a_past_date_is_invalid()&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이 테스트 케이스는, 테스트 대상의 애플리케이션 동작의 관점 중 하나를 설명한다. “배송가능” 여부는 현재 이후의 날짜여야 한다는 점이다.&lt;/p&gt;
&lt;h1 id=&quot;35-매개변수화된-테스트-리팩토링하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#35-%EB%A7%A4%EA%B0%9C%EB%B3%80%EC%88%98%ED%99%94%EB%90%9C-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EB%A6%AC%ED%8C%A9%ED%86%A0%EB%A7%81%ED%95%98%EA%B8%B0&quot; aria-label=&quot;35 매개변수화된 테스트 리팩토링하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.5 매개변수화된 테스트 리팩토링하기&lt;/h1&gt;
&lt;p&gt;테스트 하나로는 동작을 완벽히 설명하기 힘들다. 각 구성요소는 자체 테스트로 캡처해야한다. 그런데, 상기 구문과 같은 로직을 검증하려면 복수개의 테스트코드가 많이 생겨야한다. 이 때 매개변수화된(&lt;em&gt;parametrized&lt;/em&gt;) 테스트를 사용하여 반복을 줄일 수 있다. &lt;code class=&quot;language-text&quot;&gt;pytest&lt;/code&gt; 에서는 어떻게 쓸 수 있나 살펴보자.&lt;/p&gt;
&lt;p&gt;먼저, 상기 애플리케이션의 날짜 관련 동작은 여러가지 테스트 케이스를 포함하고 있다. 지난 배송일 확인 이외에도 오늘, 내일, 그 이후의 날짜에 대해서도 확인하는 테스트가 필요하다. 이는 아래와 같을 것이다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;delivery_for_today_is_invalid()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;delivery_for_tomorrow_in_invalid()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;the_soonest_delivery_date_is_two_days_from_now()&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이걸 일일이 만들면 길어진다. 그렇다면, 하나의 공통된 이름으로 묶고, 여러 파라미터를 한번에 넣고 테스트한다면 한결 나을 것이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;TestDelivery&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mark&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;parametrize&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&quot;from_now, expected&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_can_detect_an_invalid_delivery_date&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; from_now&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; expected&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        sut&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Delivery &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Delivery&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        past_date&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; datetime &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; datetime&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;now&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; timedelta&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;days&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;from_now&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        sut&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;date_time &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; past_date

        is_valid &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sut&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;is_delivery_valid&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; is_valid &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; expected&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이런 식으로 parametrize를 수행해서, 여러 테스트에 대해 케이스 별로 수행해볼 수 있다.&lt;/p&gt;
&lt;p&gt;그리고, 매개변수화된 데이터를 별도로 뺄 수는 없을까? 너저분하게 코드가 나열되어있는 것은 보기 좀 그렇다.&lt;/p&gt;
&lt;p&gt;그럴 땐 테스트 데이터를 별도로 마련하고…&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;testdata &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;…이를 parametrize에 전달한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mark&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;parametrize&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;from_now, expected&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; testdata&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_can_detect_an_invalid_delivery_date2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; from_now&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; expected&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    sut&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Delivery &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Delivery&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    past_date&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; datetime &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; datetime&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;now&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; timedelta&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;days&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;from_now&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    sut&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;date_time &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; past_date

    is_valid &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sut&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;is_delivery_valid&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; is_valid &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; expected&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;상기 테스트들은 아래 명령으로 구동한다:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;pytest test\test_06-1_parameterized_test.py&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;test&lt;/span&gt; session starts &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;
platform win32 -- Python &lt;span class=&quot;token number&quot;&gt;3.10&lt;/span&gt;.11, pytest-7.4.0, pluggy-1.2.0 -- C:&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;REDACTED&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;python.exe
cachedir: .pytest_cache
rootdir: C:&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;pt1&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;ch03
plugins: cov-4.1.0, mock-3.11.1
collected &lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt; items

test/test_06-1_parameterized_test.py::TestDelivery::test_can_detect_an_invalid_delivery_date&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;-1-False&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; PASSED   &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;12&lt;/span&gt;%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; 
test/test_06-1_parameterized_test.py::TestDelivery::test_can_detect_an_invalid_delivery_date&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;-False&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; PASSED    &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;25&lt;/span&gt;%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
test/test_06-1_parameterized_test.py::TestDelivery::test_can_detect_an_invalid_delivery_date&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;-False&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; PASSED    &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;37&lt;/span&gt;%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; 
test/test_06-1_parameterized_test.py::TestDelivery::test_can_detect_an_invalid_delivery_date&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;-True&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; PASSED     &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt;%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; 
test/test_06-1_parameterized_test.py::TestDelivery::test_can_detect_an_invalid_delivery_date2&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;-1-False&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; PASSED  &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;62&lt;/span&gt;%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; 
test/test_06-1_parameterized_test.py::TestDelivery::test_can_detect_an_invalid_delivery_date2&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;-False&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; PASSED   &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;75&lt;/span&gt;%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
test/test_06-1_parameterized_test.py::TestDelivery::test_can_detect_an_invalid_delivery_date2&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;-False&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; PASSED   &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;87&lt;/span&gt;%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; 
test/test_06-1_parameterized_test.py::TestDelivery::test_can_detect_an_invalid_delivery_date2&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;-True&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; PASSED    &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; 

&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt; passed &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.09s &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;주의-pytest의-parametrized-사용법에-대해&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A3%BC%EC%9D%98-pytest%EC%9D%98-parametrized-%EC%82%AC%EC%9A%A9%EB%B2%95%EC%97%90-%EB%8C%80%ED%95%B4&quot; aria-label=&quot;주의 pytest의 parametrized 사용법에 대해 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;주의! pytest의 parametrized 사용법에 대해…&lt;/h3&gt;
&lt;p&gt;다만, &lt;code class=&quot;language-text&quot;&gt;pytest&lt;/code&gt;의 parametrized 기능을 두줄로 사용하면 &lt;code class=&quot;language-text&quot;&gt;from_now&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;expected&lt;/code&gt;로 나열가능한 모든 경우를 다 사용한다. ($4!$만큼의 테스트 케이스를 수행!)&lt;/p&gt;
&lt;p&gt;아래 코드는 아래와 같은 테스트 케이스의 에러가 난다!&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;TestDelivery&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mark&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;parametrize&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;from_now&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mark&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;parametrize&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;expected&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_can_detect_an_invalid_delivery_date&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; from_now&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; expected&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        sut&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Delivery &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Delivery&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        past_date&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; datetime &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; datetime&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;now&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; timedelta&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;days&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;from_now&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        sut&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;date_time &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; past_date

        is_valid &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sut&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;is_delivery_valid&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; is_valid &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; expected&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;상기 테스트들은 아래 명령으로 구동한다:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;pytest test\test_06-2_parameterized_test_with_error.py&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;test&lt;/span&gt; session starts &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;
platform win32 -- Python &lt;span class=&quot;token number&quot;&gt;3.10&lt;/span&gt;.11, pytest-7.4.0, pluggy-1.2.0
rootdir: C:&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;unit_testing&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;pt1&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;ch03
plugins: cov-4.1.0, mock-3.11.1
collected &lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt; items                                                                                                     

test&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;test_06-2_parameterized_test_with_error.py &lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;.F&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;.F&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;.FFFF.                                                &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; FAILURES &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; 
__________________________ TestDelivery.test_can_detect_an_invalid_delivery_date&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;False0-2&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; ___________________________ 

self &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;test_06-2_parameterized_test_with_error.TestDelivery object at 0x000001A45A3A518&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;0&lt;/span&gt;&gt;&lt;/span&gt;, from_now &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
expected &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; False

&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;중략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;       assert is_valid &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; expected
E       assert True &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; False

test&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;test_06-2_parameterized_test_with_error.py:26: AssertionError
__________________________ TestDelivery.test_can_detect_an_invalid_delivery_date&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;False1-2&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; ___________________________ 
&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
self &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;test_06-2_parameterized_test_with_error.TestDelivery object at 0x000001A45A3A53C&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;0&lt;/span&gt;&gt;&lt;/span&gt;, from_now &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
expected &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; False

&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;중략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;       assert is_valid &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; expected
E       assert True &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; False

test&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;test_06-2_parameterized_test_with_error.py:26: AssertionError
__________________________ TestDelivery.test_can_detect_an_invalid_delivery_date&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;False2-2&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; ___________________________ 

self &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;test_06-2_parameterized_test_with_error.TestDelivery object at 0x000001A45A3A560&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;0&lt;/span&gt;&gt;&lt;/span&gt;, from_now &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
expected &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; False

&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;중략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;       assert is_valid &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; expected
E       assert True &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; False

test&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;test_06-2_parameterized_test_with_error.py:26: AssertionError
___________________________ TestDelivery.test_can_detect_an_invalid_delivery_date&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;True--1&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; ___________________________ 

self &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;test_06-2_parameterized_test_with_error.TestDelivery object at 0x000001A45A3A569&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;0&lt;/span&gt;&gt;&lt;/span&gt;, from_now &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-1&lt;/span&gt;
expected &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; True

&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;중략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;       assert is_valid &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; expected
E       assert False &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; True

test&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;test_06-2_parameterized_test_with_error.py:26: AssertionError
___________________________ TestDelivery.test_can_detect_an_invalid_delivery_date&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;True-0&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; ____________________________ 

self &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;test_06-2_parameterized_test_with_error.TestDelivery object at 0x000001A45A3A572&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;0&lt;/span&gt;&gt;&lt;/span&gt;, from_now &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
expected &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; True

&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;중략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;       assert is_valid &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; expected
E       assert False &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; True

test&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;test_06-2_parameterized_test_with_error.py:26: AssertionError
___________________________ TestDelivery.test_can_detect_an_invalid_delivery_date&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;True-1&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; ____________________________ 

self &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;test_06-2_parameterized_test_with_error.TestDelivery object at 0x000001A45A3A57B&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;0&lt;/span&gt;&gt;&lt;/span&gt;, from_now &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
expected &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; True

&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;중략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;       assert is_valid &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; expected
E       assert False &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; True

test&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;test_06-2_parameterized_test_with_error.py:26: AssertionError
&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; short &lt;span class=&quot;token builtin class-name&quot;&gt;test&lt;/span&gt; summary info &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;
FAILED test/test_06-2_parameterized_test_with_error.py::TestDelivery::test_can_detect_an_invalid_delivery_date&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;False0-2&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; - assert True &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; False
FAILED test/test_06-2_parameterized_test_with_error.py::TestDelivery::test_can_detect_an_invalid_delivery_date&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;False1-2&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; - assert True &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; False
FAILED test/test_06-2_parameterized_test_with_error.py::TestDelivery::test_can_detect_an_invalid_delivery_date&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;False2-2&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; - assert True &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; False
FAILED test/test_06-2_parameterized_test_with_error.py::TestDelivery::test_can_detect_an_invalid_delivery_date&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;True--1&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; - assert False &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; True
FAILED test/test_06-2_parameterized_test_with_error.py::TestDelivery::test_can_detect_an_invalid_delivery_date&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;True-0&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; - assert False &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; True
FAILED test/test_06-2_parameterized_test_with_error.py::TestDelivery::test_can_detect_an_invalid_delivery_date&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;True-1&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; - assert False &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; True
&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt; failed, &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; passed &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;.26s &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id=&quot;36-검증문-라이브러리를-사용한-테스트-가독성-향상&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#36-%EA%B2%80%EC%A6%9D%EB%AC%B8-%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%9C-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EA%B0%80%EB%8F%85%EC%84%B1-%ED%96%A5%EC%83%81&quot; aria-label=&quot;36 검증문 라이브러리를 사용한 테스트 가독성 향상 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.6 검증문 라이브러리를 사용한 테스트 가독성 향상&lt;/h1&gt;
&lt;p&gt;저자는 테스트 가독성 향상을 위해 &lt;a href=&quot;https://github.com/fluentassertions/fluentassertions&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Fluent Assertions&lt;/a&gt; 라는 라이브러리를 추천한다.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/csparpa/fluentcheck&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;파이썬에도 있긴 하지만&lt;/a&gt; 잘 모르겠다.&lt;/p&gt;
&lt;h1 id=&quot;summary&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#summary&quot; aria-label=&quot;summary permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Summary&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;모든 단위 테스트는 AAA 패턴을 따라야 한다. 테스트 내에 Arrange, Act, Assert section이 여러 줄이라면 여러 동작 단위를 한 번에 검증한다는 표시다. 이 경우 여러 테스트로 나누는 것이 좋다.&lt;/li&gt;
&lt;li&gt;Act section이 여러 줄이면 SUT의 API에 잠정적인 문제를 의심해야 한다
&lt;ul&gt;
&lt;li&gt;클라이언트에서도 이런 작업을 항상 같이 수행해야하고, 잠재적으로 코드에 로직버그가 발생할 수 있다. 이는 불변 위반(&lt;em&gt;invariant violation&lt;/em&gt;)이다. SUT의 캡슐화가 제대로 되어있는지 살펴보아야 한다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;SUT의 이름은 &lt;code class=&quot;language-text&quot;&gt;sut&lt;/code&gt; 로 두고 테스트에서 구별하자. 각 section 별로 &lt;code class=&quot;language-text&quot;&gt;Arrange&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;Act&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;Assert&lt;/code&gt; 형식의 주석을 달거나 빈 줄을 추가하여 논리적으로 읽힐 수 있게 구별하자&lt;/li&gt;
&lt;li&gt;테스트 픽스처 초기화코드는, 팩토리 메소드 형식으로 사용하자. 테스트 간 결합도를 낮게 유지하기 위함이다&lt;/li&gt;
&lt;li&gt;테스트 케이스의 이름은 사내 구성원 모두가 이해할 수 있도록 쉽게쓰자&lt;/li&gt;
&lt;li&gt;매개변수화된(&lt;em&gt;parametrized&lt;/em&gt;) 테스트 코드가 필요하다면 사용하자&lt;/li&gt;
&lt;li&gt;검증문 라이브러리를 쓰면 테스트 가독성 향상에 도움이 될 수 있다&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[단위 테스트 (2)]]></title><description><![CDATA[단위 테스트 를 읽고 이해한 내용을 작성합니다. 챕터 2, 단위 테스트란 무엇인가에 대한 내용입니다.]]></description><link>https://blog.s3ich4n.me/books/unit-testing/2023-06-30-pt01-ch02</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/unit-testing/2023-06-30-pt01-ch02</guid><pubDate>Fri, 30 Jun 2023 20:36:32 GMT</pubDate><content:encoded>&lt;p&gt;이 내용은 “단위 테스트” 를 읽고 작성한 내용입니다. 블로그 게시글과, 작성한 코드를 함께 보시면 더욱 좋습니다.&lt;/p&gt;
&lt;p&gt;2장은 해당 코드를 살펴봐주세요. &lt;a href=&quot;https://github.com/s3ich4n/unit-testing-101/tree/main/pt1/ch02&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;코드 링크&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Chapter 2. 단위 테스트란 무엇인가&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;커맨드로 테스트를 직접 실행하기 위해선 현재 디렉토리로 이동한다.
&lt;code class=&quot;language-text&quot;&gt;cd pt1/ch02&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;앞으로 꾸준히 나올 단어에 대해:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;테스트 대상 시스템(SUT, System under Test. 이하 SUT): 코드베이스, 즉 테스트 대상을 의미&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h1 id=&quot;들어가며&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0&quot; aria-label=&quot;들어가며 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;들어가며&lt;/h1&gt;
&lt;p&gt;단위 테스트를 바라보는 관점은 생각 보다 중요하다. 접근 방법에 따라 고전파(&lt;em&gt;classical school&lt;/em&gt;)과 런던파(&lt;em&gt;london school&lt;/em&gt;)로 나뉜다(이걸 얘기하고자 하는 건 아니다. 이렇게 단도직입적으로 풀 문제도 아니다. 좀 더 살펴보면서 차이점을 비교해보자!).&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;🍅 tips&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;단위 테스트의 고전파와 런던파&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;고전파&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;단위 테스트와 테스트 주도 개발에 원론적으로 접근하는 방식으로 인해 고전(classic)이라고 부른다&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;런던파?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;코드 격리에 대한 부분을 mocking으로 해결하고자 한다. 이런 기조가 런던의 프로그래밍 커뮤니티에서 시작된 탓에 런던파라고 부른다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;21-단위-테스트에-대한-정의&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#21-%EB%8B%A8%EC%9C%84-%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%97%90-%EB%8C%80%ED%95%9C-%EC%A0%95%EC%9D%98&quot; aria-label=&quot;21 단위 테스트에 대한 정의 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.1 ‘단위 테스트’에 대한 정의&lt;/h1&gt;
&lt;p&gt;단위 테스트의 중요한 세 가지 속성은 아래와 같다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;작은 코드 조각(혹은 단위)을 검증한다&lt;/li&gt;
&lt;li&gt;빠르게 수행한다&lt;/li&gt;
&lt;li&gt;격리된 방식으로 처리하는 자동화된 테스트이다&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;앞서 살펴본 두가지는 논란의 여지가 없다. 작은 코드조각을 검증한다는 것은 말할 것도 없다. 빠르게 구동한다는 것은, 테스트 스위트의 실행시간이 충분하면 테스트는 충분히 빠르다로 이해할 수 있기 때문이다.&lt;/p&gt;
&lt;p&gt;‘격리’를 어떻게 해석하는지에 따라 두 분파별로 관점이 달라진다( &lt;a href=&quot;#23-%EA%B3%A0%EC%A0%84%ED%8C%8C%EC%99%80-%EB%9F%B0%EB%8D%98%ED%8C%8C%EC%9D%98-%EB%B9%84%EA%B5%90&quot;&gt;2.3&lt;/a&gt; 에서 설명)&lt;/p&gt;
&lt;h2 id=&quot;211-격리-문제에-대한-런던파의-접근&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#211-%EA%B2%A9%EB%A6%AC-%EB%AC%B8%EC%A0%9C%EC%97%90-%EB%8C%80%ED%95%9C-%EB%9F%B0%EB%8D%98%ED%8C%8C%EC%9D%98-%EC%A0%91%EA%B7%BC&quot; aria-label=&quot;211 격리 문제에 대한 런던파의 접근 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.1.1 격리 문제에 대한 런던파의 접근&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;테스트 대상 시스템을 협력자(&lt;em&gt;collaborator&lt;/em&gt;)로부터 분리하는 것을 의미한다&lt;/li&gt;
&lt;li&gt;하나의 클래스가 다른 클래스, 여러 클래스에 의존한다면 그 모든 의존성을 테스트 대역(&lt;em&gt;Test double&lt;/em&gt;, 이하 테스트 더블)로 대체할 수 있어야 한다.&lt;/li&gt;
&lt;li&gt;동작을 외부 영항과 분리해서 테스트 대상의 클래스에 집중한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;장점?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;테스트가 실패하면, 어느 부분에 문제가 있는지 파악하기 쉽다.&lt;/li&gt;
&lt;li&gt;객체 그래프(&lt;em&gt;object graph&lt;/em&gt;, 같은 문제를 해결하는 클래스의 통신망)를 분할할 수 있다
&lt;ul&gt;
&lt;li&gt;클래스의 의존성, 심지어는 순환의존성 등을 빠르게 파악하고 나눌 수 있다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;의존성을 가진 코드베이스를 테스트하려면 실제 제품에 해당하는 의존성 외에 테스트 목적의 의존성들로 구성해서 대체한다
&lt;ul&gt;
&lt;li&gt;직접 참조하는 의존성을 테스트 목적의 의존성으로 대체&lt;/li&gt;
&lt;li&gt;해당 의존성들이 테스트 목적의 의존성을 참조&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;고전파의-접근방식&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B3%A0%EC%A0%84%ED%8C%8C%EC%9D%98-%EC%A0%91%EA%B7%BC%EB%B0%A9%EC%8B%9D&quot; aria-label=&quot;고전파의 접근방식 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;고전파의 접근방식?&lt;/h3&gt;
&lt;p&gt;고전파의 접근방식으로 테스트를 짜면 아래와 같다. 여기서는 &lt;code class=&quot;language-text&quot;&gt;Store&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;Customer&lt;/code&gt; 에 대한 내용은 생략했다. 상세한 내용은 &lt;code class=&quot;language-text&quot;&gt;test/&lt;/code&gt; 디렉토리 내의 파일을 참고하길 바란다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# test\test_01_classical_way.py 의 일부분&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_purchase_succeeds_when_enough_inventory&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# Arrange&lt;/span&gt;
    store &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Store&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Shampoo&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    customer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Customer&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Act&lt;/span&gt;
    success &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; customer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;purchase&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;store&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Product&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Shampoo&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Assert&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; success &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; store&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;item&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;count


&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_purchase_fails_when_not_enough_money&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# Arrange&lt;/span&gt;
    store &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Store&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Shampoo&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    customer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Customer&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Act&lt;/span&gt;
    success &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; customer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;purchase&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;store&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Product&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Shampoo&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Assert&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; success &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; store&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;item&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;count&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;테스트는 아래 명령으로 구동한다:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;pytest test\test_01_classical_way.py -v&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;=============================================== test session starts ===============================================
platform win32 &lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt; Python 3&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;10&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;11&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pytest-7&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;4&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;0&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pluggy-1&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;2&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;0 &lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt; C:\REDACTED\python&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;exe
cachedir: &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pytest_cache
rootdir: C:\unit_testing\pt1\ch02
plugins: cov-4&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;1&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;0
collected 2 items

test/test_01_classical_way&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;py::test_purchase_succeeds_when_enough_inventory PASSED                           &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; 50%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; 
test/test_01_classical_way&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;py::test_purchase_fails_when_not_enough_money PASSED                              &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;100%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; 

================================================ 2 passed in 0&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;04s ================================================&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Arrange-Act-Assert 접근 방식은 5장에서 다시 살펴볼 예정이다. 쉽게 말해 아래 과정을 포함한다고 보면 된다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;어떤 테스트를 할지 준비(&lt;em&gt;Arrange&lt;/em&gt;)한다. SUT와 하나의 협력자를 준비한다.
&lt;ul&gt;
&lt;li&gt;여기서는 &lt;code class=&quot;language-text&quot;&gt;Customer&lt;/code&gt;(SUT), &lt;code class=&quot;language-text&quot;&gt;Store&lt;/code&gt;(협력자) 일 것이다.&lt;/li&gt;
&lt;li&gt;협력자가 필요한 이유는 아래와 같다
&lt;ul&gt;
&lt;li&gt;SUT를 사용하려면 &lt;code class=&quot;language-text&quot;&gt;Store&lt;/code&gt; 인스턴스를 아규먼트로 쓰기 때문&lt;/li&gt;
&lt;li&gt;검증단계에서 &lt;code class=&quot;language-text&quot;&gt;Customer.purchase()&lt;/code&gt; 의 호출결과로 상점 제품 수량이 감소할 가능성이 있기 때문&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;테스트를 수행한다(&lt;em&gt;Act&lt;/em&gt;)&lt;/li&gt;
&lt;li&gt;적절한 결과를 가정한다(&lt;em&gt;Assert&lt;/em&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;🍅 tips&lt;/p&gt;
&lt;p&gt;테스트 대상 메소드(MUT, Method under test)?&lt;/p&gt;
&lt;p&gt;테스트 대상 메소드(MUT)는 테스트에서 호출한 SUT의 메소드를 의미한다.
MUT는 흔히 메소드를, SUT는 클래스 전체를 가리킨다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;이어서 고전파의 스타일대로 짠 코드를 설명한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;테스트는 협력자(&lt;code class=&quot;language-text&quot;&gt;Store&lt;/code&gt; 클래스)를 대체하지 않는다. 운영용 인스턴스를 사용한다.
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Customer&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;Store&lt;/code&gt; 둘 다 검증한다.&lt;/li&gt;
&lt;li&gt;하지만, &lt;code class=&quot;language-text&quot;&gt;Customer&lt;/code&gt;가 정상작동 해도 &lt;code class=&quot;language-text&quot;&gt;Store&lt;/code&gt; 안에 버그가 있으면 테스트는 실패한다 → 테스트가 서로 격리되어있지 않다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;런던파의-접근방식&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%9F%B0%EB%8D%98%ED%8C%8C%EC%9D%98-%EC%A0%91%EA%B7%BC%EB%B0%A9%EC%8B%9D&quot; aria-label=&quot;런던파의 접근방식 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;런던파의 접근방식?&lt;/h3&gt;
&lt;p&gt;런던파의 접근방식을 따라가보자. 동일한 테스트에서 &lt;code class=&quot;language-text&quot;&gt;Store&lt;/code&gt; 인스턴스를 테스트 더블(구체적으로는 목으로)로 교체한다. (상세한 내용은 5장으로)&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;목(Mock)&lt;/p&gt;
&lt;p&gt;SUT와 협력자 간의 상호작용을 검사할 수 있는 특별한 테스트 더블이다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;목은 테스트 더블의 부분집합이다. 테스트 더블에는 많은 접근방법이 있다. 다시말해 아래와 같다&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;테스트 더블은 실행과 관련없이 모든 종류의 가짜 의존성을 설명하는 포괄적인 용어다&lt;/li&gt;
&lt;li&gt;목은 그러한 의존성의 한 종류다&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;런던파의 접근방식으로 테스트를 짜면 아래와 같다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# test\test_02_london_school_way.py 의 일부분&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_purchase_succeeds_when_enough_inventory&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mocker&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# Arrange&lt;/span&gt;
    mock_store &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; mocker&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;MagicMock&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;spec&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;Store&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    mock_product &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; mocker&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;MagicMock&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;spec&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    mock_store&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;has_enough_inventory&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;return_value &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;
    customer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Customer&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Act&lt;/span&gt;
    success &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; customer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;purchase&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mock_store&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; mock_product&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Assert&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; success &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;
    mock_store&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sell&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;assert_called_once_with&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mock_product&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_purchase_fails_when_not_enough_money&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mocker&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# Arrange&lt;/span&gt;
    mock_store &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; mocker&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;MagicMock&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;spec&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;Store&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    mock_product &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; mocker&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;MagicMock&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;spec&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    mock_store&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;has_enough_inventory&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;return_value &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;
    customer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Customer&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Act&lt;/span&gt;
    success &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; customer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;purchase&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mock_store&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; mock_product&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Assert&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; success &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;
    mock_store&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sell&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;assert_not_called&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;테스트는 아래 명령으로 구동한다:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;pytest test\test_01_london_school_way.py -v&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;======================================================= test session starts ========================================================
platform win32 &lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt; Python 3&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;10&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;11&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pytest-7&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;4&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;0&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pluggy-1&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;2&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;0 &lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt; C:\REDACTED\python&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;exe
cachedir: &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pytest_cache
rootdir: C:\unit_testing\pt1\ch02
plugins: cov-4&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;1&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;0&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; mock-3&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;11&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;1
collected 2 items

test/test_01_london_school_way&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;py::test_purchase_succeeds_when_enough_inventory PASSED                                        &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; 50%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
test/test_01_london_school_way&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;py::test_purchase_fails_when_not_enough_money PASSED                                           &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;100%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

======================================================== 2 passed in 0&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;02s =========================================================&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;어떤 식으로 다른지 살펴보자:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;구현이 일부 변경되었다. 직접 상태를 수정하는 구현방식이 아니라 몇가지 더 추가되었다!
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;has_enough_inventory&lt;/code&gt; 메소드 호출에 어떻게 응답할지 목에 직접 정의한다&lt;/li&gt;
&lt;li&gt;이 경우, &lt;code class=&quot;language-text&quot;&gt;test_purchase_succeeds_when_enough_inventory&lt;/code&gt; 테스트에서는 &lt;code class=&quot;language-text&quot;&gt;Store&lt;/code&gt;의 실제 상태와 관련없이 &lt;code class=&quot;language-text&quot;&gt;True&lt;/code&gt;를 리턴하도록 가정한다&lt;/li&gt;
&lt;li&gt;(추가설명은 8장에) 협력자에서 격리된 테스트 대상 시스템에는 인터페이스가 필요하다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Customer&lt;/code&gt; 객체가 호출하였는지 확인하기 위해, &lt;code class=&quot;language-text&quot;&gt;Store&lt;/code&gt; 내의 특정 메소드가 호출되었는지(&lt;code class=&quot;language-text&quot;&gt;assert_called_once_with&lt;/code&gt;) 확인한다
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;test_purchase_succeeds_when_enough_inventory&lt;/code&gt; 테스트에서는 &lt;strong&gt;한 번만 호출했는지&lt;/strong&gt; 살펴본다&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;test_purchase_fails_when_not_enough_money&lt;/code&gt; 테스트에서는 &lt;strong&gt;한 번도 호출되지 않았음&lt;/strong&gt; 을 살펴본다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;212-격리-문제에-대한-고전파의-접근&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#212-%EA%B2%A9%EB%A6%AC-%EB%AC%B8%EC%A0%9C%EC%97%90-%EB%8C%80%ED%95%9C-%EA%B3%A0%EC%A0%84%ED%8C%8C%EC%9D%98-%EC%A0%91%EA%B7%BC&quot; aria-label=&quot;212 격리 문제에 대한 고전파의 접근 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.1.2 격리 문제에 대한 고전파의 접근&lt;/h2&gt;
&lt;p&gt;런던 스타일은 테스트 더블(여기서는 목)으로 테스트 대상 조각을 분리해서 격리 요구사항에 다가간다. 이 관점은 각 분파의 코드 조각(단위)에 대한 견해를 보여주기도 한다.&lt;/p&gt;
&lt;p&gt;단위 테스트의 속성을 다시 살펴보자:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;작은 코드 조각(혹은 단위)을 검증한다&lt;/li&gt;
&lt;li&gt;빠르게 수행한다&lt;/li&gt;
&lt;li&gt;격리된 방식으로 처리하는 자동화된 테스트이다&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;그렇다면,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;코드가 얼마나 &lt;em&gt;작아야&lt;/em&gt; 되는가?
&lt;ul&gt;
&lt;li&gt;각각의 모든 클래스를 격리해야 한다면 SUT 코드는 단일 클래스 이거나 해당 클래스 내의 메소드여야 한다(격리 문제에 접근하는 방식 때문에 이보다 더 클 수는 없음)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;최대한 ‘한 번에 한 클래스만’ 지침을 따라야 한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;격리 특성을 해석하는 또 하나의 방법을 고전파의 방식으로 살펴보자:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;테스트는 서로 격리시켜서 실행해야 하는 것은 아니다. 그 대신 단위 테스트는 서로 격리해서 실행해야 한다.&lt;/li&gt;
&lt;li&gt;그렇다면 테스트 실행순서가 어떻든 간에(&lt;em&gt;parallel, sequentially, etc.&lt;/em&gt;) 적합한 방식으로 실행할 수 있으며, 서로의 결과에 영향을 미치지 않는다.&lt;/li&gt;
&lt;li&gt;여러 클래스가 모두 메모리에 올라가있고 공유 상태에 다다르지 않는 한, 여러 클래스를 한번에 테스트 해도 된다. 이를 통해 테스트가 서로 소통하고 실행 컨텍스트에 영향을 줄 수 있다.&lt;/li&gt;
&lt;li&gt;공유 상태: DB, 파일 시스템, 프로세스 외부 의존성 등을 의미&lt;/li&gt;
&lt;li&gt;공유 상태의 예시?
&lt;ul&gt;
&lt;li&gt;E.g., 테스트 준비 단계에서 DB 내에 고객 생성을 할 수도 있고, 테스트 실행 전에 다른 테스트의 준비단계에서 고객을 삭제하는 경우
&lt;ul&gt;
&lt;li&gt;테스트를 병렬실행하면 다른 테스트에 의해 간섭받아 실패하는 케이스가 나오기도 한다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;공유 의존성, 비공개 의존성, 프로세스 외부 의존성?&lt;/p&gt;
&lt;p&gt;공유 의존성&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;테스트 간에 서로 공유되고 서로의 결과에 영향을 미칠 수 있는 수단을 제공하는 의존성&lt;/li&gt;
&lt;li&gt;E.g., 정적 가변 필드(&lt;em&gt;static mutable field&lt;/em&gt;), 데이터베이스&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;비공개 의존성&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;공유하지 않는 의존성&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;프로세스 외부 의존성&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;애플리케이션 실행 프로세스 외부에서 실행되는 의존성&lt;/li&gt;
&lt;li&gt;아직 메모리에 없는 데이터에 대한 프록시&lt;/li&gt;
&lt;li&gt;프로세스 외부 의존성은 “대부분” 공유 의존성에 해당된다.&lt;/li&gt;
&lt;li&gt;E.g., 데이터베이스(프로세스 외부 의존성 이자 공유 의존성)
&lt;ul&gt;
&lt;li&gt;도커 컨테이너로 DB를 실행시키면 테스트가 더 이상 동일 인스턴스로 작동하지 않는다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;격리 문제에 대한 견해는 테스트 더블 사용(목 포함) 그 이상의 견해가 뒤따른다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 784px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/76cdb87ba40bfaf2cdaaeff0c048af60/4971b/001.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 69.16666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAABqElEQVQ4y4VTW07CUBC9K/HLuAFjNIT4aWKMcS0mxk1oxD0YXYMSdqB+SqwfUGiBvii0tIXSlmNm4BZSXpNM5j7mnjnzuAJbZDabsZ1Op8jSjNeTyYTPsyzLlfZz5VcQucPCSgdak6RpivePKl5e3+A4fWyXOajAHnHdAS6urnFweIRqrcZ7tdVGs6miqbbQ1jR0uz0mRESEaVp8qek6VLWFXs+ApukwDJMB4zjG7d09Lq9v8FOvI4oiBEGAMAwRhhHG4zGXQoqgC8/zch2NRhgOh/B9P68jpe37o/wR+Vi2Ddu2QYT6fZctlURsa4isITFstducHgUiocCmZcFitRnQcRwuh1h2aa6e58N1Xba0//z6xkmpjOOzEh4rzzlDChQE4RoZIRnJ9Di6aXE0EgI8LZ8z6MNThc/CKOISkBLwKoYozh2xazSa6C8AO50OfhUFivLH53E8RZKkMAwDut7JayvfrzGcFeZRNiVJEl5n2brfRsBVWxQaDVLZqKLf6n4t5dUGSTBKk2pFc1f02chw11+moZWpEfiuTPYCLhs14F9UrO0mwH9+HjEKlmpDMQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/76cdb87ba40bfaf2cdaaeff0c048af60/8ac56/001.webp 240w,
/static/76cdb87ba40bfaf2cdaaeff0c048af60/d3be9/001.webp 480w,
/static/76cdb87ba40bfaf2cdaaeff0c048af60/2a3bb/001.webp 784w&quot;
              sizes=&quot;(max-width: 784px) 100vw, 784px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/76cdb87ba40bfaf2cdaaeff0c048af60/8ff5a/001.png 240w,
/static/76cdb87ba40bfaf2cdaaeff0c048af60/e85cb/001.png 480w,
/static/76cdb87ba40bfaf2cdaaeff0c048af60/4971b/001.png 784w&quot;
            sizes=&quot;(max-width: 784px) 100vw, 784px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/76cdb87ba40bfaf2cdaaeff0c048af60/4971b/001.png&quot;
            alt=&quot;단위 테스트를 서로 격리하는 것은 테스트 대상 클래스에서만 격리하는 것을 의미한다. 비공개 의존성은 그대로 두어도 된다&quot;
            title=&quot;단위 테스트를 서로 격리하는 것은 테스트 대상 클래스에서만 격리하는 것을 의미한다. 비공개 의존성은 그대로 두어도 된다&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;단위 테스트를 서로 격리하는 것은 테스트 대상 클래스에서만 격리하는 것을 의미한다. 비공개 의존성은 그대로 두어도 된다&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;공유 의존성은 단위 테스트 간에 공유한다(&lt;em&gt;테스트 대상 클래스가 아님&lt;/em&gt;)
&lt;ul&gt;
&lt;li&gt;싱글턴 의존성은 각 테스트에서 새 인스턴스를 만들 수만 있으면 됨&lt;/li&gt;
&lt;li&gt;제품 코드에는 단 하나의 인스턴스만 있지만, 테스트에서는 달리 쓰인다&lt;/li&gt;
&lt;li&gt;E.g., 설정 클래스를 사용한다고 했을 때?
&lt;ul&gt;
&lt;li&gt;실제 코드에서는 단 하나의 인스턴스를 사용한다&lt;/li&gt;
&lt;li&gt;테스트 코드 상에서는 그럴 필요는 없다&lt;/li&gt;
&lt;li&gt;그러나 새 파일 시스템이나 DB를 만들 수는 없으며, 테스트 간 공유되거나 테스트 더블로 대체되어야 한다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;공유 의존성, 휘발성 의존성에 대해&lt;/p&gt;
&lt;p&gt;휘발성 의존성은 다음 속성 중 하나를 나타내는 의존성이다.
1.
- 개발자 머신에 기본 설치된 환경 외에 런타임 환경의 설정, 구성을 요구함
- 추가설정이 필요하며, 시스템에 기본적으로 없음
- E.g., DB 혹은 API 서비스
2.
- 비결정적 동작(&lt;em&gt;non-deterministic behavior&lt;/em&gt;)을 포함함 (때에 따라 다른 결과가 나오기 때문)
- E.g., 난수 생성기, “현재” 날짜 및 시간을 리턴하는 클래스&lt;/p&gt;
&lt;p&gt;휘발성 의존성은 공유 의존성과 겹치는 부분이 있다. 아래 사항들의 의존성을 예시로 살펴보자:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;테스트 대상&lt;/th&gt;
&lt;th&gt;공유 의존성?&lt;/th&gt;
&lt;th&gt;휘발성 의존성?&lt;/th&gt;
&lt;th&gt;비고&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;데이터베이스&lt;/td&gt;
&lt;td&gt;O&lt;/td&gt;
&lt;td&gt;O&lt;/td&gt;
&lt;td&gt;.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;파일 시스템&lt;/td&gt;
&lt;td&gt;O&lt;/td&gt;
&lt;td&gt;X&lt;/td&gt;
&lt;td&gt;모든 개발자 머신에 설치되고, 대부분 결정적으로 작동함&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;난수 생성기&lt;/td&gt;
&lt;td&gt;X&lt;/td&gt;
&lt;td&gt;O&lt;/td&gt;
&lt;td&gt;각 테스트에 별도의 인스턴스를 제공할 수 있음&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/blockquote&gt;
&lt;p&gt;공유 의존성을 대체하는 다른 이유: 테스트 실행속도 향상&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;공유 의존성은 실행 프로세스 밖에 있음, 테스트 수행 시간이 길어짐&lt;/li&gt;
&lt;li&gt;테스트 코드의 속성 2번째―빨리 실행되어야 함을 충족해야함&lt;/li&gt;
&lt;li&gt;이런 것들이 필요한 테스트는 통합 테스트 영역에서 수행되어야 함&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;22-단위-테스트의-런던파와-고전파&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#22-%EB%8B%A8%EC%9C%84-%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%9D%98-%EB%9F%B0%EB%8D%98%ED%8C%8C%EC%99%80-%EA%B3%A0%EC%A0%84%ED%8C%8C&quot; aria-label=&quot;22 단위 테스트의 런던파와 고전파 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.2 단위 테스트의 런던파와 고전파&lt;/h1&gt;
&lt;p&gt;두 분파는 격리 특성의 견해 차이로 인해 나누어졌다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;런던파: 테스트 대상 시스템에서 협력자를 격리하는 방향을 채택&lt;/li&gt;
&lt;li&gt;고전파: 단위 테스트 끼리 격리하는 방향을 채택&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;종합하자면, 아래 세 가지 주요 주제에 대해 의견 차이가 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;격리 요구사항&lt;/li&gt;
&lt;li&gt;테스트 대상 코드조각(단위)의 구성요소&lt;/li&gt;
&lt;li&gt;의존성 처리&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;표로 정리해보자:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;＼&lt;/th&gt;
&lt;th&gt;격리 주체&lt;/th&gt;
&lt;th&gt;단위의 크기&lt;/th&gt;
&lt;th&gt;테스트 더블 사용대상&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;런던파&lt;/td&gt;
&lt;td&gt;단위&lt;/td&gt;
&lt;td&gt;단일 클래스&lt;/td&gt;
&lt;td&gt;불변 의존성 외의 모든 의존성&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;고전파&lt;/td&gt;
&lt;td&gt;단위 테스트&lt;/td&gt;
&lt;td&gt;단일 클래스 또는 클래스 세트&lt;/td&gt;
&lt;td&gt;공유 의존성&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&quot;221-고전파와-런던파가-의존성을-다루는-방법&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#221-%EA%B3%A0%EC%A0%84%ED%8C%8C%EC%99%80-%EB%9F%B0%EB%8D%98%ED%8C%8C%EA%B0%80-%EC%9D%98%EC%A1%B4%EC%84%B1%EC%9D%84-%EB%8B%A4%EB%A3%A8%EB%8A%94-%EB%B0%A9%EB%B2%95&quot; aria-label=&quot;221 고전파와 런던파가 의존성을 다루는 방법 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.2.1 고전파와 런던파가 의존성을 다루는 방법&lt;/h2&gt;
&lt;p&gt;테스트 더블은 어디서든 쓰지만, 런던파는 테스트에서 일부 의존성을 그대로 쓸 수 있도록 하고있다. 불변객체(&lt;em&gt;immutable objects&lt;/em&gt;)는 굳이 바꾸지 않아도 된다. 런던 스타일의 코드로 살펴보자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# test\test_02_london_school_way.py 의 일부분&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_purchase_succeeds_when_enough_inventory&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mocker&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# Arrange&lt;/span&gt;
    mock_store &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; mocker&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;MagicMock&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;spec&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;Store&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    mock_product &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; mocker&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;MagicMock&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;spec&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Shampoo&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    mock_store&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;has_enough_inventory&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;return_value &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;
    customer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Customer&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Act&lt;/span&gt;
    success &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; customer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;purchase&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mock_store&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; mock_product&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# Assert&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; success &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;
    mock_store&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sell&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;assert_called_once_with&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mock_product&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Customer&lt;/code&gt;의 두 가지 의존성 중, &lt;code class=&quot;language-text&quot;&gt;Store&lt;/code&gt;만 시간에 따라 변할 수 있는 내부 상태를 포함하고 있고, &lt;code class=&quot;language-text&quot;&gt;Product&lt;/code&gt; 객체는 이뮤터블(여기서는 &lt;code class=&quot;language-text&quot;&gt;namedtuple&lt;/code&gt;)이다. 그래서 여기서는 Store 인스턴스만 바꿔주고, &lt;code class=&quot;language-text&quot;&gt;Product&lt;/code&gt;값은 VO(&lt;em&gt;Value objects&lt;/em&gt;)로써 그대로 사용한 것이다.&lt;/p&gt;
&lt;p&gt;아래 그림은 의존성에 대한 종류를 나타내고, 동시에 단위테스트의 두 분파가 의존성을 어떤식으로 처리하는지 보여준다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;비공개 의존성은 변경 가능하거나 불변이다. 불변은 VO라고 부른다&lt;/li&gt;
&lt;li&gt;E.g.,
&lt;ul&gt;
&lt;li&gt;DB: 공유의존성. 내부 상태(테스트 더블로 대체되지 않은 값)는 모든 테스트에서 공유함&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Store&lt;/code&gt; 인스턴스: 변경 가능한 비공개 의존성&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Product&lt;/code&gt; 인스턴스: 불변인 비공개 의존성(VO의 예시)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;모든 공유 의존성은 변경 가능하지만, 변경 가능한 의존성을 공유하려면 여러 테스트에서 재사용 되어야 함&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 804px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/bda00491822610ad7a3b356800dad4d3/27b7a/002.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 68.75%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAACO0lEQVQ4y4VUS2sTURSef+JGEfEf6N660U1d6EIp+ADrE2pdCipaBKuuBLXVjVjbLqwUAk1pUtNUlGhhHKePWEkzeZDGCZOZySSZx80n5yYzzcSABw733nPv+e73nXtmBABotVroNT/mj4wxNJtNPnddl6/75Qp+YHv7N0TxB9LpX1CUXHCY3E+Wfsq4c/ce4sufQvt9AcvlMra20hy4VNr9hx3ZzZFR7DtwECcHT8Ewzb5KhF7anudxAMdx4TEWrMnuPxzD/kOHMXThIpq23T7PWIipEL6hBdu2YZomB6E58xh0XYdVs/i4klxFabetwO6Adtdd6EYnkEajwb1Ws3gs9X0NwyO3MDb+BLpuBMkvXr/Bpes3EE8k2ucta4+hD0jy6vU6qlUd2WyWxx48HseRYwM4cfoMJHmdx/LFIgbPnsPRgeO4NnobhmFAN4y9GvpG7eAzJCf7mvqG81eu4tHTZwFrOvd8YhJDl4cRWYiGX5lYdQOQbEqguG07nL2maWC0dhzs5HJQ1UqghkzJ56EUCjxX2NzYRCy2jNXPX5DPFwIG5N0tQ8DRlQReTr1DJB7nl5FR+0zPz+PV+ymsSRKETCYDUZQgr29gJ6sE1KltHMcJwBzXxVx0AZOzM/i4uBh8NRVNw9u5D5iYmUYylQrXsLf7eS96XrBHjxFZWkKuWGzvd1SIsoxYMok/qtp+ZZLFOg3aC0rSCJTWVIaKWuG1oznFaE+v6rxH6bWF//0UfCCST04APlg/+wt/nxR0aE7UiQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/bda00491822610ad7a3b356800dad4d3/8ac56/002.webp 240w,
/static/bda00491822610ad7a3b356800dad4d3/d3be9/002.webp 480w,
/static/bda00491822610ad7a3b356800dad4d3/95e88/002.webp 804w&quot;
              sizes=&quot;(max-width: 804px) 100vw, 804px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/bda00491822610ad7a3b356800dad4d3/8ff5a/002.png 240w,
/static/bda00491822610ad7a3b356800dad4d3/e85cb/002.png 480w,
/static/bda00491822610ad7a3b356800dad4d3/27b7a/002.png 804w&quot;
            sizes=&quot;(max-width: 804px) 100vw, 804px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/bda00491822610ad7a3b356800dad4d3/27b7a/002.png&quot;
            alt=&quot;의존성 계층의 도식&quot;
            title=&quot;의존성 계층의 도식&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;의존성 계층의 도식&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;고전파에서는 공유 의존성을 테스트 더블로 대체한다&lt;/li&gt;
&lt;li&gt;런던파에서는 변경 가능한 비공개 의존성도 테스트 더블로 교체할 수 있다&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;협력자(Collaborator)와 의존성&lt;/p&gt;
&lt;p&gt;협력자&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;공유하거나 변경 가능한 의존성이다&lt;/li&gt;
&lt;li&gt;E.g.,
&lt;ul&gt;
&lt;li&gt;데이터베이스 접근 권한을 제공하는 클래스&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Store&lt;/code&gt; 객체&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;모든 프로세스 외부 의존성이 공유 의존성의 범주에 속하지 않는다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;공유 의존성은 거의 항상 프로세스 외부에 있다. 그 반대는 그렇지 않다.&lt;/li&gt;
&lt;li&gt;프로세스 외부 의존성을 공유하려면 단위 테스트가 서로 통신할 수 있는 수단이 있어야한다.&lt;/li&gt;
&lt;li&gt;의존성 내부를 수정하면 통신이 이루어진다.&lt;/li&gt;
&lt;li&gt;프로세스 외부의 불변 의존성은 그런 수단이 없다.&lt;/li&gt;
&lt;li&gt;테스트는 내부의 어떤 것도 수정할 수없다. 서로의 실행 컨텍스트에 영향을 줄 수 없다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 860px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/d74e9f79767f7ccb8392a7b7e5ee2276/914ae/003.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 55.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB50lEQVQoz22S70/aQBjH+c+X7NWyqdt0zqLYIryZ2XzBlpGACRO3RKy6mYDQ9moB18pvCxuIbYHv8lxzjZg9yZPn7rnc5773vYv5vg/P87BYLEAxn8+jpJ7ruuh2ewiCgK9TT6TnhXsfHjwQJwhmiDmOA01nfOF/MRqO4Ny2+AFPw7YdNJpNMGbycX8wQEyo8v1QQavTwcnFBYqlEsqahtlsxvuT6T06/R5uu2303btIsagiYkI+bTw5P8eGImNtexuvd3awGo/jQyYDVregWQxlo4aKoaFsaDAaFtzhkO97bENMXMWs17EiSdhMJiGl0zxpLO/vo1AqoXbNoFlmlATWLTOyIgKKx/icz+NNIhGB3ikKr18KBXxTVfysVnDFdJT1UCUdQPPhn9EyUPhAV9uQZWwqCp6/WsGzFy+xKknIFosoqCp+nKn4ms8hk83isHjEgRWmo3c3iICRhxSZXA5vEwm839vjYFK4vrvLFRLwV/WKKyJ1VAXQfaSQA4UHNcawFo9jK5WClErxSvDkx084UlVUTYN7J7wkqFG3ol+wpFBMvp+ech8p12WZv3L64ADXN81QEakzQ5UEHU8mSzAOfNpo2jYOj4/5I51dXuJ+OuX9v+Mx7HYLDfs32v0ePN9fggmF/wD6shcG3VqC8AAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/d74e9f79767f7ccb8392a7b7e5ee2276/8ac56/003.webp 240w,
/static/d74e9f79767f7ccb8392a7b7e5ee2276/d3be9/003.webp 480w,
/static/d74e9f79767f7ccb8392a7b7e5ee2276/31b17/003.webp 860w&quot;
              sizes=&quot;(max-width: 860px) 100vw, 860px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/d74e9f79767f7ccb8392a7b7e5ee2276/8ff5a/003.png 240w,
/static/d74e9f79767f7ccb8392a7b7e5ee2276/e85cb/003.png 480w,
/static/d74e9f79767f7ccb8392a7b7e5ee2276/914ae/003.png 860w&quot;
            sizes=&quot;(max-width: 860px) 100vw, 860px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/d74e9f79767f7ccb8392a7b7e5ee2276/914ae/003.png&quot;
            alt=&quot;공유 의존성과 프로세스 외부 의존성 간의 관계&quot;
            title=&quot;공유 의존성과 프로세스 외부 의존성 간의 관계&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;공유 의존성과 프로세스 외부 의존성 간의 관계&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;상기 사항에 대한 예시를 살펴보자.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;E.g., 조직에서 판매하는 모든 제품에 대한 카탈로그를 반환하는 API
&lt;ul&gt;
&lt;li&gt;API는 카탈로그를 변경하는 기능을 노출하지 않는 한 공유 의존성이 아님&lt;/li&gt;
&lt;li&gt;테스트가 반환하는 데이터에 영향을 미칠 수 없기 때문 (의존성은 휘발성이고 애플리케이션 경계를 벗어나긴 하지만)&lt;/li&gt;
&lt;li&gt;이런 의존성을 테스트의 범주에 넣을 필요는 없음&lt;/li&gt;
&lt;li&gt;대부분 테스트 속도를 올리기 위해서는 테스트 더블로 교체해야함&lt;/li&gt;
&lt;li&gt;하지만 프로세스 외부 의존성이 충분히 빠르고 연결이 안정적이면 테스트에서 그대로 써도 됨&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;23-고전파와-런던파의-비교&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#23-%EA%B3%A0%EC%A0%84%ED%8C%8C%EC%99%80-%EB%9F%B0%EB%8D%98%ED%8C%8C%EC%9D%98-%EB%B9%84%EA%B5%90&quot; aria-label=&quot;23 고전파와 런던파의 비교 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.3 고전파와 런던파의 비교&lt;/h1&gt;
&lt;p&gt;고전파와 런던파의 차이는 단위테스트에서의 격리 문제를 처리하는 방안으로 갈린다. 이는 테스트 단위 처리와 의존성 취급에 대한 방법이라 말할 수 있다.&lt;/p&gt;
&lt;p&gt;저자는 목을 사용하는 테스트는 고전적 테스트보다 불안정한 경향이 있다 라는 표현을 사용했다. (5장에서 다시 볼 것) 런던파의 장점을 살펴보자.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;입자성(&lt;em&gt;granularity&lt;/em&gt;)이 좋다. 테스트가 세밀해서 한 번에 한 클래스만 확인한다&lt;/li&gt;
&lt;li&gt;서로 연결된 클래스의 그래프가 커져도 테스트하기 쉽다. 모든 협력자를 테스트 더블로 처리하기 때문.&lt;/li&gt;
&lt;li&gt;테스트가 실패하면 어떤 기능이 실패했는지 확실히 알 수 있다.
&lt;ul&gt;
&lt;li&gt;의존성이 거의 대부분 분리되어있기 때문&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;저자는 상기 세 장점이 가지는 맹점을 비판한다.&lt;/p&gt;
&lt;h2 id=&quot;231-한-번에-한-클래스만-테스트&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#231-%ED%95%9C-%EB%B2%88%EC%97%90-%ED%95%9C-%ED%81%B4%EB%9E%98%EC%8A%A4%EB%A7%8C-%ED%85%8C%EC%8A%A4%ED%8A%B8&quot; aria-label=&quot;231 한 번에 한 클래스만 테스트 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.3.1 한 번에 한 클래스만 테스트&lt;/h2&gt;
&lt;p&gt;런던파는 클래스를 단위로 간주하고, 이로 인해 클래스를 테스트에서 검증할 최소한의 단위로 취급한다.&lt;/p&gt;
&lt;p&gt;다만 이러한 관점은 코드의 입자성에 집중하게 되어, 문제 영역에 의미가 있는 것을 검증하는 것을 멀리할 수도 있다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;🍅 tips&lt;/p&gt;
&lt;p&gt;테스트는 코드의 단위를 검증하는 것이 아니라, 동작의 단위(문제영역)를 검증해야 한다.&lt;/p&gt;
&lt;p&gt;비즈니스 담당자가 유용하다고 인식할 수 있는 것을 검증해야 한다.&lt;/p&gt;
&lt;p&gt;동작의 단위는 아주 작은 메소드가 될 수도 있고, 한 클래스에만 있을 수도 있고, 심지어는 여러 클래스에 걸쳐있을 수도 있다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;따라서 식별할 수 있는 동작의 주제를 살피고, 내부적인 세부 구현과 어떻게 구별짓는지 살펴본다(5장에서).&lt;/p&gt;
&lt;h2 id=&quot;232-상호-연결된-클래스의-큰-그래프를-단위-테스트&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#232-%EC%83%81%ED%98%B8-%EC%97%B0%EA%B2%B0%EB%90%9C-%ED%81%B4%EB%9E%98%EC%8A%A4%EC%9D%98-%ED%81%B0-%EA%B7%B8%EB%9E%98%ED%94%84%EB%A5%BC-%EB%8B%A8%EC%9C%84-%ED%85%8C%EC%8A%A4%ED%8A%B8&quot; aria-label=&quot;232 상호 연결된 클래스의 큰 그래프를 단위 테스트 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.3.2 상호 연결된 클래스의 큰 그래프를 단위 테스트&lt;/h2&gt;
&lt;p&gt;런던파는 실제 협력자 대신 목을 사용하고, 의존성 그래프가 복잡할 때 테스트 더블을 써서 전체 복잡한 객체 그래프에 대해 잘 대체하고 테스트할 수 있다고 한다.&lt;/p&gt;
&lt;p&gt;다만 저자는 클래스 그래프가 커진 것을 설계 문제의 결과로 판단한다. 클래스 그래프를 작게 가지도록 하는 것을 주문한다.&lt;/p&gt;
&lt;p&gt;따라서 코드 조각을 테스트 더블 없이 면밀하게 설계할 수 있도록 기본적인 코드 설계를 풀어보는 과정을 살펴본다(2부에서).&lt;/p&gt;
&lt;h2 id=&quot;233-버그-위치-정확히-찾아내기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#233-%EB%B2%84%EA%B7%B8-%EC%9C%84%EC%B9%98-%EC%A0%95%ED%99%95%ED%9E%88-%EC%B0%BE%EC%95%84%EB%82%B4%EA%B8%B0&quot; aria-label=&quot;233 버그 위치 정확히 찾아내기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.3.3 버그 위치 정확히 찾아내기&lt;/h2&gt;
&lt;p&gt;런던파 철학을 따르는 테스트 위의 시스템에 버그가 생기면, SUT에 버그가 포함된 테스트만 실패한다. 고전적인 방식을 통해, 테스트할 때는 원하지 않았던 파급효과까지 테스트 할 수 있음을 시사한다.&lt;/p&gt;
&lt;p&gt;다만 저자는 다른 관점으로 본다. 테스트를 정기적으로 수행하여 마지막으로 바꾼 코드 변화가 어떤 테스트 실패를 초래하였는지 볼 수 있다고 한다.&lt;/p&gt;
&lt;p&gt;그리고 테스트 스위트 전체에 걸쳐 계단식으로 실패하는 것 또한 주목할 만한 지표로 판단한다. 고장낸 코드 조각(코드베이스의 본 로직)이 큰 가치가 있는 코드임을 알 수 있다. 이는 시스템이 그 코드에 의존한다는 것을 의미한다.&lt;/p&gt;
&lt;h2 id=&quot;234-고전파와-런던파-사이의-다른-차이점&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#234-%EA%B3%A0%EC%A0%84%ED%8C%8C%EC%99%80-%EB%9F%B0%EB%8D%98%ED%8C%8C-%EC%82%AC%EC%9D%B4%EC%9D%98-%EB%8B%A4%EB%A5%B8-%EC%B0%A8%EC%9D%B4%EC%A0%90&quot; aria-label=&quot;234 고전파와 런던파 사이의 다른 차이점 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.3.4 고전파와 런던파 사이의 다른 차이점&lt;/h2&gt;
&lt;p&gt;고전파와 런던파 사이에는 아래 차이점이 더 존재한다&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;TDD를 통한 시스템 설계방식
&lt;ul&gt;
&lt;li&gt;추가기능에 대한 명세를 테스트로 작성(필히 실패함)&lt;/li&gt;
&lt;li&gt;테스트가 통과하는 코드를 작성&lt;/li&gt;
&lt;li&gt;리팩토링&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;과도한 명세(&lt;em&gt;over-specification&lt;/em&gt;) 문제&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;🍅 tips&lt;/p&gt;
&lt;p&gt;TDD(&lt;em&gt;Test-driven Development&lt;/em&gt;)란?&lt;/p&gt;
&lt;p&gt;테스트에 의존하여 프로젝트 개발을 추진하는 소프트웨어 개발 프로세스. 아래 세 단계로 구성되며, 각 테스트케이스마다 이를 반복한다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;추가할 기능과 작동에 대한 테스트 코드 작성 → 테스트 구동 시 빨간막대 생성&lt;/li&gt;
&lt;li&gt;테스트를 통과하는 코드베이스를 작성 → 테스트 구동 시 초록막대로 변함&lt;/li&gt;
&lt;li&gt;코드 리팩토링 → 테스트 구동 시 초록막대를 유지하도록 리팩토링&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;TDD 관점차이 - 런던파
&lt;ul&gt;
&lt;li&gt;하향식 TDD&lt;/li&gt;
&lt;li&gt;Mock을 사용해 예상 결과를 달성하고자 시스템이 통신해야하는 협력자를 지정&lt;/li&gt;
&lt;li&gt;모든 클래스를 구현할 때 까지 클래스 그래프를 다짐&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;TDD 관점차이 - 고전파
&lt;ul&gt;
&lt;li&gt;상향식 TDD&lt;/li&gt;
&lt;li&gt;도메인 모델을 시작으로 엔드유저가 소프트웨어를 사용할 수 있을 때 까지 계층을 그 위에 더 둔다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;over-specification 차이? → 테스트가 SUT의 구현 세부사항에 결합되는 것을 의미
&lt;ul&gt;
&lt;li&gt;런던파는 고전파보다 테스트가 구현에 더 자주 결합된다&lt;/li&gt;
&lt;li&gt;목 사용 남용이 주로 지적된다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;24-두-분파의-통합-테스트&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#24-%EB%91%90-%EB%B6%84%ED%8C%8C%EC%9D%98-%ED%86%B5%ED%95%A9-%ED%85%8C%EC%8A%A4%ED%8A%B8&quot; aria-label=&quot;24 두 분파의 통합 테스트 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.4 두 분파의 통합 테스트&lt;/h1&gt;
&lt;p&gt;런던파는 실제 협력자 객체를 사용하는 모든 테스트를 통합 테스트로 간주한다.&lt;/p&gt;
&lt;p&gt;저자는 본 책에서 단위 테스트와 통합 테스트의 고전적 정의를 사용한다. 고전파의 관점에서 단위 테스트는 아래와 같다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;단일 동작 범위를 검증한다&lt;/li&gt;
&lt;li&gt;빠르게 테스트한다&lt;/li&gt;
&lt;li&gt;다른 테스트와 별도로 처리한다&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;통합 테스트는 이런 기준 중 하나를 충족하지 않는 테스트다&lt;/p&gt;
&lt;p&gt;E.g., DB 접근 테스트 → 다른 테스트와 분리하여 실행할 수 없다&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;특정 테스트에서 DB 상태 변경을 시키면? 병렬 수행 시 동일 DB에 의존하는 모든 테스트 결과가 달라질 것이다&lt;/li&gt;
&lt;li&gt;이런 테스트는 수나적으로 실행해서 공유 의존성과 함께 작동하려고 기다릴 수 있다&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;E.g., 프로세스 외부 의존성이 있는 테스트 → 테스트가 느려진다&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;DB 호출은 수백 밀리초가 걸릴 수 있다&lt;/li&gt;
&lt;li&gt;테스트 스위트가 커지면 커질 수록 체감된다!&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;E.g., 둘 이상의 동작 범위를 검증할 때의 테스트 → 통합 테스트로 간주된다&lt;/p&gt;
&lt;p&gt;E.g., 다른 모듈 이상을 둘 이상 검증할 때의 테스트 → 통합 테스트로 간주된다&lt;/p&gt;
&lt;p&gt;종합하면, 통합 테스트는 소프트웨어 품질향상에 기여하는 주요 요소 중 하나다. (3부에서 다시 살펴볼 예정)&lt;/p&gt;
&lt;h2 id=&quot;241-통합-테스트의-일부인-엔드투엔드-테스트&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#241-%ED%86%B5%ED%95%A9-%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%9D%98-%EC%9D%BC%EB%B6%80%EC%9D%B8-%EC%97%94%EB%93%9C%ED%88%AC%EC%97%94%EB%93%9C-%ED%85%8C%EC%8A%A4%ED%8A%B8&quot; aria-label=&quot;241 통합 테스트의 일부인 엔드투엔드 테스트 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.4.1 통합 테스트의 일부인 엔드투엔드 테스트&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;엔드 투 엔드 테스트(end-to-end test, aka. e2e test)는 통합 테스트의 일부이다&lt;/li&gt;
&lt;li&gt;코드가 프로세스 외부 종속성과 함께 어떻게 작동하는지 검증한다&lt;/li&gt;
&lt;li&gt;의존성을 더 많이 포함되는 특징이 있다(거의 대다수, 전부의 의존성)&lt;/li&gt;
&lt;li&gt;가장 비용이 많이 들기 때문에, 모든 단위 테스트와 통합 테스트 통과 후 수행하는 것이 좋다&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;summary&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#summary&quot; aria-label=&quot;summary permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Summary&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;단위 테스트의 정의는 아래와 같다
&lt;ul&gt;
&lt;li&gt;단일 동작 단위를 검증한다&lt;/li&gt;
&lt;li&gt;빠르게 수행한다&lt;/li&gt;
&lt;li&gt;다른 테스트와 별도로 처리한다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;단위 테스트는 격리 문제를 주로 논의한다. 이 논쟁으로 인해 고전파와 런던파의 두 분파로 나뉘어졌다. 상호 두 분파는 무엇이 단위 테스트인지, 테스트 대상 시스템의 의존성 처리 방식을 어떻게 정의하느냐에 대한 관점이 다르다.
&lt;ul&gt;
&lt;li&gt;런던파는 테스트 대상 단위를 서로 분리해야 한다고 한다. 테스트 대상 단위는 코드의 단위, 보통 단일 클래스다. 불변 의존성을 제외한 모든 의존성을 테스트 더블로 대체하길 바란다.&lt;/li&gt;
&lt;li&gt;고전파는 단위 테스트를 서로 분리해야 한다고 한다. 테스트 대상 단위는 동작 단위다. 공유 의존성만 테스트 더블로 대체하길 바란다. 공유 의존성은 테스트가 서로 실행 흐름에 영향을 미치는 수단을 제공하는 의존성을 의미한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;런던파는 아래 이점을 제공한다
&lt;ul&gt;
&lt;li&gt;더 나은 입자성&lt;/li&gt;
&lt;li&gt;상호 연결된 큰 그래프에 대한 테스트 용이성&lt;/li&gt;
&lt;li&gt;테스트 실패 후 버그를 쉽게 찾을 수 있는 편의성&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;(저자 왈) 다만 런던파는 맹점을 가진다
&lt;ul&gt;
&lt;li&gt;테스트 대상 클래스에 대한 관점: 테스트 코드 단위가 아닌 테스트 동작을 검증해야&lt;/li&gt;
&lt;li&gt;코드 조각을 테스트 할 수 없는 맹점: 코드 설계를 다시 검증해야… 테스트 더블을 통한 테스트는 이를 숨길 뿐&lt;/li&gt;
&lt;li&gt;테스트 실패 결과의 맹점: 지속적으로 테스트 하면 해결됨. 그렇다면 마지막에 수정한 코드가 버그의 원인임&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;런던파 테스트의 가장 큰 맹점 → 과잉명세(&lt;em&gt;over-specification&lt;/em&gt;). SUT 세부 구현에 결합된 테스트&lt;/li&gt;
&lt;li&gt;통합 테스트는 상기 단위 테스트의 요소 셋 중 하나 이상을 만족하지 못하는 테스트를 의미&lt;/li&gt;
&lt;li&gt;엔드 투 엔드 테스트는 애플리케이션과 함께 작동하는 프로세스 외부 의존성의 거의 대부분(혹은 전부)에 접근함&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[단위 테스트 (1)]]></title><description><![CDATA[단위 테스트 를 읽고 이해한 내용을 작성합니다. 챕터 1, 단위 테스트의 목표에 대한 내용입니다.]]></description><link>https://blog.s3ich4n.me/books/unit-testing/2023-06-28-pt01-ch01</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/unit-testing/2023-06-28-pt01-ch01</guid><pubDate>Wed, 28 Jun 2023 02:31:14 GMT</pubDate><content:encoded>&lt;p&gt;이 내용은 “단위 테스트” 를 읽고 작성한 내용입니다. 블로그 게시글과, 작성한 코드를 함께 보시면 더욱 좋습니다.&lt;/p&gt;
&lt;p&gt;1장은 해당 코드를 살펴봐주세요. &lt;a href=&quot;https://github.com/s3ich4n/unit-testing-101/tree/main/pt1/ch01&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;코드 링크&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Chapter 1. 단위 테스트의 목표&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;커맨드로 테스트를 직접 실행하기 위해선 현재 디렉토리로 이동한다.
&lt;code class=&quot;language-text&quot;&gt;cd pt1/ch01&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h1 id=&quot;들어가며&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0&quot; aria-label=&quot;들어가며 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;들어가며&lt;/h1&gt;
&lt;p&gt;단위 테스트(&lt;em&gt;Unit testing&lt;/em&gt;)를 배우는 것은 테스트 프레임워크, 목 라이브러리(&lt;em&gt;Mockery library&lt;/em&gt;) 등을 쓰는 것 이상의 개념이다. 테스트도 시간을 투자하는 것이니 이득을 봐야겠죠? 그렇다면 드는 시간을 최소화하고 이득을 많이 보는 방향을 생각해야함.&lt;/p&gt;
&lt;p&gt;그걸 이루려고 노력하는 오픈소스를 보는 것이 크게 도움된다. 어떤게 있는가 찾아보자. &lt;a href=&quot;https://github.com/tiangolo/fastapi/tree/master/tests&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;여기서부터&lt;/a&gt; 하나씩 찬찬히 보는 것도 좋을 것이다. 가장 좋은건 필요에 따라 하나씩 보는거고…&lt;/p&gt;
&lt;p&gt;이 책에서는 어떤 단위테스트 기술이 좋고, 비용편익을 살펴본다. 안티패턴을 피하는방법도 살펴본다.&lt;/p&gt;
&lt;h1 id=&quot;11-단위-테스트-현황&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#11-%EB%8B%A8%EC%9C%84-%ED%85%8C%EC%8A%A4%ED%8A%B8-%ED%98%84%ED%99%A9&quot; aria-label=&quot;11 단위 테스트 현황 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.1 단위 테스트 현황&lt;/h1&gt;
&lt;p&gt;엔터프라이즈 앱의 프로덕션 코드와 테스트 코드 비율은 많으면 1:1, 1:3, 많으면 1:10까지도 간다고 한다.&lt;/p&gt;
&lt;p&gt;좋은 테스트코드를 고려하는 것은 어떤 단위 테스트를 수행하는 것으로 최대 이득을 끌어내는지를 살펴보는 것이다.&lt;/p&gt;
&lt;p&gt;이 책에서는 “좋은 테스트”를 짜는 것을 종합적으로 논의한다. 짜니 못한 테스트코드는 분명 지양해야 하기 때문이다. 그와 동시에 노력 대비 최대의 이익을 끌어내는 테스트를 살펴볼 것이다.&lt;/p&gt;
&lt;h1 id=&quot;12-단위-테스트의-목표&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#12-%EB%8B%A8%EC%9C%84-%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%9D%98-%EB%AA%A9%ED%91%9C&quot; aria-label=&quot;12 단위 테스트의 목표 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.2 단위 테스트의 목표&lt;/h1&gt;
&lt;p&gt;코드 베이스에 대해 테스트를 짜면 더 나은 설계로 이어진다. 하지만 이는 테스트 코드의 사이드이펙트 중 하나고, 주 목표는 소프트웨어가 &lt;strong&gt;지속가능한 성장&lt;/strong&gt;을 가능하게 하는 것이다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;🍅 tips&lt;/p&gt;
&lt;p&gt;단위 테스트와 코드 설계의 관계&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;코드를 단위 테스트하는 것은 충분히 좋은 방법이고 강결합(&lt;em&gt;tight coupling&lt;/em&gt;) 된 코드에서 저품질이 나타나는 것은 잡을 수 있다!&lt;/li&gt;
&lt;li&gt;하지만 쉽게 단위테스트할 수 있는 코드가 “좋은 품질”의 코드를 의미하지는 않는다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;테스트 코드를 추가하면 할 수록 소프트웨어 엔트로피&lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt; 증가의 속도를 완화시킨다. 코드베이스의 변경은 엔트로피를 증가시킨다. 엔트로피가 겉잡을 수 없이 상승한다면 코드베이스마저 믿을 수 없게 된다.&lt;/p&gt;
&lt;p&gt;테스트는 이런 경향을 뒤집을 수 있다. 회귀(&lt;em&gt;regression&lt;/em&gt;)에 대한 보험이라 할 수 있다. 다만 이런 이점을 얻기 위해서는 지속적으로, 확장할 수 있는 테스트를 작성해야한다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;회귀(&lt;em&gt;regression&lt;/em&gt;)?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;특정 사건(코드수정 등) 후 코드가 의도대로 작동하지 않는 경우를 의미한다&lt;/li&gt;
&lt;li&gt;소프트웨어 버그라고 생각하면 된다&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;121-좋은-테스트와-좋지-않은-테스트를-가르는-요인&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#121-%EC%A2%8B%EC%9D%80-%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%99%80-%EC%A2%8B%EC%A7%80-%EC%95%8A%EC%9D%80-%ED%85%8C%EC%8A%A4%ED%8A%B8%EB%A5%BC-%EA%B0%80%EB%A5%B4%EB%8A%94-%EC%9A%94%EC%9D%B8&quot; aria-label=&quot;121 좋은 테스트와 좋지 않은 테스트를 가르는 요인 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.2.1 좋은 테스트와 좋지 않은 테스트를 가르는 요인&lt;/h2&gt;
&lt;p&gt;모든 테스트 코드를 짤 필요는 없다. 일부 테스트는 아주 중요하고 소프트웨어 품질에 기여를 한다. 그 밖의 테스트코드는 그렇지 않다. 잘못된 경고가 발생하고, 회귀 오류를 알아내는 데 도움되지 않는다. 유지보수가 어렵고 느리다. 테스트를 위한 테스트를 하게 된다.&lt;/p&gt;
&lt;p&gt;즉, 테스트의 가치와 유지 비용 요소를 생각해야 한다. 비용 요소는 다양한 활동에 필요한 시간에 따라 결정된다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;기반 코드 테스트 시 테스트도 함께 리팩토링하라&lt;/li&gt;
&lt;li&gt;각 코드 변경 시 테스트를 실행하라&lt;/li&gt;
&lt;li&gt;테스트가 잘못된 경고를 발생시키면 처리하라&lt;/li&gt;
&lt;li&gt;기반 코드가 어떻게 도는지 이해하려 할 때는 테스트를 읽는데 시간을 들이라&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;잘못된 테스트코드는 오히려 독이 된다. 항상 가치있는 테스트를 고민하자. &lt;strong&gt;좋은 테스트&lt;/strong&gt;에 집중하자! (4장에서 이어짐)&lt;/p&gt;
&lt;h1 id=&quot;13-테스트-스위트-품질-측정을-위한-커버리지-지표&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#13-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%8A%A4%EC%9C%84%ED%8A%B8-%ED%92%88%EC%A7%88-%EC%B8%A1%EC%A0%95%EC%9D%84-%EC%9C%84%ED%95%9C-%EC%BB%A4%EB%B2%84%EB%A6%AC%EC%A7%80-%EC%A7%80%ED%91%9C&quot; aria-label=&quot;13 테스트 스위트 품질 측정을 위한 커버리지 지표 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.3 테스트 스위트 품질 측정을 위한 커버리지 지표&lt;/h1&gt;
&lt;p&gt;테스트 스위트 품질 측정엔 크게 두가지 커버리지 지표가 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;코드 커버리지(code coverage)&lt;/li&gt;
&lt;li&gt;분기 커버리지(branch coverage)&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;커버리지 지표?
테스트 스위트가 소스코드를 얼마나 실행하는지에 대한 백분율&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;커버리지 지표는 테스트가 충분한지에 대한 피드백을 제공하지만, 이 것이  100%에 가깝다고 해서 양질의 테스트 스위트를 보장하는 것은 아니다.&lt;/p&gt;
&lt;h2 id=&quot;131-코드-커버리지에-대한-이해&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#131-%EC%BD%94%EB%93%9C-%EC%BB%A4%EB%B2%84%EB%A6%AC%EC%A7%80%EC%97%90-%EB%8C%80%ED%95%9C-%EC%9D%B4%ED%95%B4&quot; aria-label=&quot;131 코드 커버리지에 대한 이해 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.3.1 코드 커버리지에 대한 이해&lt;/h2&gt;
&lt;p&gt;코드 커버리지는 하나 이상의 테스트로 실행된 코드 라인 수와 제품 코드 베이스의 전체 라인 수의 비율이다. 아래 수식으로 산출된다.&lt;/p&gt;
&lt;p&gt;$코드 커버리지(테스트 커버리지) = \dfrac{제품 코드 라인 수}{전체 라인 수} * 100$&lt;/p&gt;
&lt;p&gt;요컨대 이런 코드가 있다고 치자:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;is_string_long&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;input_val&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;input_val&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_is_string_long&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; is_string_long&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;abc&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;테스트는 아래 명령으로 구동한다:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;pytest test\test_01.py --cov &lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;test\test_01&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;py &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;                                                                                                    &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;100%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt; coverage: platform win32&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; python 3&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;10&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;11-final-0 &lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;
Name              Stmts   Miss  Cover
&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;
test\test_01&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;py       6      1    83%
&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;
TOTAL                 6      1    83%


==================================================== 1 passed in 0&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;05s ====================================================&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이러면 커버리지가 &lt;code class=&quot;language-text&quot;&gt;83%&lt;/code&gt; 나온다. 코드를 이렇게 바꾸면? 커버리지를 &lt;code class=&quot;language-text&quot;&gt;100%&lt;/code&gt;로 달성시킬 수 있다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;is_string_long&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;input_val&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;input_val&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_is_string_long&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; is_string_long&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;abc&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;테스트는 아래 명령으로 구동한다:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;pytest test\test_02.py --cov &lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;test\test_02&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;py &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;                                                                                                    &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;100%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; 

&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt; coverage: platform win32&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; python 3&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;10&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;11-final-0 &lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;
Name              Stmts   Miss  Cover
&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;
test\test_02&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;py       4      0   100%
&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;
TOTAL                 4      0   100%


==================================================== 1 passed in 0&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;08s ====================================================&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;근데 이게 테스트 스위트를 개선한 건 아니다(저자는 이를 커버리지 수치로 ‘장난친다’ 라고 표현했다). 코드가 작으면 커버리지 지표가 좋아지기 때문이다. 그리고 이렇다고 해도 테스트 스위트의 가치나, 코드베이스의 유지보수성이 변경되진 않는다.&lt;/p&gt;
&lt;h2 id=&quot;132-분기-커버리지-지표에-대한-이해&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#132-%EB%B6%84%EA%B8%B0-%EC%BB%A4%EB%B2%84%EB%A6%AC%EC%A7%80-%EC%A7%80%ED%91%9C%EC%97%90-%EB%8C%80%ED%95%9C-%EC%9D%B4%ED%95%B4&quot; aria-label=&quot;132 분기 커버리지 지표에 대한 이해 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.3.2 분기 커버리지 지표에 대한 이해&lt;/h2&gt;
&lt;p&gt;다른 지표는 분기 커버리지(branch coverage)이다. 이 지표는 &lt;code class=&quot;language-text&quot;&gt;if&lt;/code&gt; 문이나 &lt;code class=&quot;language-text&quot;&gt;switch&lt;/code&gt; 문같은 제어구조에 중점을 둔다. 테스트 스위트 내 하나 이상의 테스트가 통과하는 제어구조의 수를 나타낸다.&lt;/p&gt;
&lt;p&gt;$분기 커버리지 = \dfrac{통과 분기}{전체 분기 수}$&lt;/p&gt;
&lt;p&gt;분기 커버리지 지표를 계산하려면 코드베이스에서 모든 가능한 분기를 합산하고 그 중 테스트가 얼마나 실행되는지를 확인한다. 분기 개수만 다루며, 해당 분기를 구현하는데 얼마나 코드가 필요한지 고려하진 않는다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;is_string_long&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;input_val&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;
    if/else 구문이 기재되어있어야 아래의 Branch를 카운트한다.
    &quot;&quot;&quot;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;input_val&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_is_string_long&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; is_string_long&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;abc&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;테스트는 해당 명령으로 구동한다: &lt;code class=&quot;language-text&quot;&gt;pytest test\test_03_1.py --cov --cov-branch&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;unit-testing-py3&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;10&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;PS&lt;/span&gt; C:\unit_testing\pt1\ch01&gt; pytest test\test_03_1&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;py &lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;cov &lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;cov-branch
=================================================== test session starts =================================================== 
platform win32 &lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt; Python 3&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;10&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;11&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pytest-7&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;4&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;0&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pluggy-1&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;2&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;0
rootdir: C:\unit_testing\pt1\ch01
plugins: cov-4&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;1&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;0
collected 1 item                                                                                                            

test\test_03_1&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;py &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;                                                                                                    &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;100%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; 

&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt; coverage: platform win32&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; python 3&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;10&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;11-final-0 &lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;
Name              Stmts   Miss Branch BrPart  Cover
&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;
test\test_03&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;py       6      1      2      1    75%
&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;
TOTAL                 6      1      2      1    75%


==================================================== 1 passed in 0&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;07s ====================================================&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;133-커버리지-지표에-관한-문제점&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#133-%EC%BB%A4%EB%B2%84%EB%A6%AC%EC%A7%80-%EC%A7%80%ED%91%9C%EC%97%90-%EA%B4%80%ED%95%9C-%EB%AC%B8%EC%A0%9C%EC%A0%90&quot; aria-label=&quot;133 커버리지 지표에 관한 문제점 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.3.3 커버리지 지표에 관한 문제점&lt;/h2&gt;
&lt;p&gt;분기 커버리지로 코드 커버리지보다 나은 결과를 얻을 수 있지만, 테스트 스위트의 품질을 결정할 때 어떠한 커버리지 지표든 정답일 수는 없다. 이유는 다음과 같다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;테스트 대상 시스템의 모든 가능한 결과를 검증한다고 보장하는 것은 아니다.&lt;/li&gt;
&lt;li&gt;외부 라이브러리의 코드 경로를 고려할 수 있는 커버리지 지표는 없다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;가능한-모든-결과를-보장할-수-없음&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B0%80%EB%8A%A5%ED%95%9C-%EB%AA%A8%EB%93%A0-%EA%B2%B0%EA%B3%BC%EB%A5%BC-%EB%B3%B4%EC%9E%A5%ED%95%A0-%EC%88%98-%EC%97%86%EC%9D%8C&quot; aria-label=&quot;가능한 모든 결과를 보장할 수 없음 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;가능한 모든 결과를 보장할 수 없음&lt;/h3&gt;
&lt;p&gt;단위 테스트는 적절한 검증이 있어야 한다. 테스트 대상 시스템이 낸 결과가 정확히 예상 가능한 결과인지 확인해야 한다. 게다가 결과가 여러개일 수도 있다. 즉 &lt;strong&gt;모든 측정지표를 검증&lt;/strong&gt;해야 한다.&lt;/p&gt;
&lt;p&gt;그런데 테스트 케이스 하나만(&lt;code class=&quot;language-text&quot;&gt;False&lt;/code&gt; 조건만) 테스트 하니, 일부 실행만 보장한다. 이런 테스트는 검증을 안한다고 봐도 무방하다. 그러므로 쓸모가 없다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# 일부 코드 생략&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_is_string_long&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; is_string_long&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;abc&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; is_string_long&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;abcdef&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;테스트는 해당 명령으로 구동한다: &lt;code class=&quot;language-text&quot;&gt;pytest test\test_03_2.py --cov --cov-branch&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;==================================================== 1 passed in 0&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;07s ==================================================== 
&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;unit-testing-py3&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;10&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;PS&lt;/span&gt; C:\unit_testing\pt1\ch01&gt; pytest test\test_03_2&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;py &lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;cov &lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;cov-branch
=================================================== test session starts ===================================================
platform win32 &lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt; Python 3&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;10&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;11&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pytest-7&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;4&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;0&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pluggy-1&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;2&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;0
rootdir: C:\unit_testing\pt1\ch01
plugins: cov-4&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;1&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;0
collected 1 item                                                                                                            

test\test_03_2&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;py &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;                                                                                                  &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;100%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt; coverage: platform win32&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; python 3&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;10&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;11-final-0 &lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;
Name                Stmts   Miss Branch BrPart  Cover
&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;
test\test_03_2&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;py       7      0      2      0   100%
&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;
TOTAL                   7      0      2      0   100%


==================================================== 1 passed in 0&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;06s ==================================================== &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이런 식의 접근으로 커버리지 수치를 높이는 것은 크게 의미없는 짓이다.&lt;/p&gt;
&lt;h3 id=&quot;외부-라이브러리의-경로를-고려할-수-없음&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%99%B8%EB%B6%80-%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%EC%9D%98-%EA%B2%BD%EB%A1%9C%EB%A5%BC-%EA%B3%A0%EB%A0%A4%ED%95%A0-%EC%88%98-%EC%97%86%EC%9D%8C&quot; aria-label=&quot;외부 라이브러리의 경로를 고려할 수 없음 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;외부 라이브러리의 경로를 고려할 수 없음&lt;/h3&gt;
&lt;p&gt;테스트 대상 시스템이 메소드 호출 시, 라이브러리의 모든 경로를 쫓아갈 수 없다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; pytest


&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;parse&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;input_val&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;input_val&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_parse&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; parse&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;5&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;raises&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ValueError&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        parse&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;bbb&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;raises&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ValueError&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        parse&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;0b11010010&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;테스트는 해당 명령으로 구동한다: &lt;code class=&quot;language-text&quot;&gt;pytest test\test_04.py --cov&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;========================================================== test session starts ===========================================================
platform win32 &lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt; Python 3&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;10&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;11&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pytest-7&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;4&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;0&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; pluggy-1&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;2&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;0
rootdir: C:\unit_testing\pt1\ch01
plugins: cov-4&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;1&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;0
collected 1 item

test\test_04&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;py &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;                                                                                                                   &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;100%&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt; coverage: platform win32&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; python 3&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;10&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;11-final-0 &lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;
Name              Stmts   Miss  Cover
&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;
test\test_04&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;py       9      0   100%
&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;
TOTAL                 9      0   100%


=========================================================== 1 passed in 0&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;04s ============================================================&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;성공이야 했다지만, 과연 &lt;code class=&quot;language-text&quot;&gt;int()&lt;/code&gt; Built-in 메소드의 &lt;em&gt;모든&lt;/em&gt; 경우(&lt;em&gt;edge case&lt;/em&gt;)를 테스트 한 것일까? 그렇지 않다. 이는 “모든” 결과를 검증하지 못했다&lt;sup id=&quot;fnref-2&quot;&gt;&lt;a href=&quot;#fn-2&quot; class=&quot;footnote-ref&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;. (E.g., &lt;code class=&quot;language-text&quot;&gt;int()&lt;/code&gt;의 &lt;code class=&quot;language-text&quot;&gt;n&lt;/code&gt;진법으로 변환 후 의도한 값이 나오는 기능 검증)&lt;/p&gt;
&lt;p&gt;지금 받아본 이 지표로는 단위 테스트가 좋은지 나쁜지 판단하기 어렵다. 다시말해, 커버리지 지표로 테스트가 철저한지, 테스트가 충분한지는 판단하기 어렵다.&lt;/p&gt;
&lt;h2 id=&quot;134-특정-커버리지-숫자를-목표로-하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#134-%ED%8A%B9%EC%A0%95-%EC%BB%A4%EB%B2%84%EB%A6%AC%EC%A7%80-%EC%88%AB%EC%9E%90%EB%A5%BC-%EB%AA%A9%ED%91%9C%EB%A1%9C-%ED%95%98%EA%B8%B0&quot; aria-label=&quot;134 특정 커버리지 숫자를 목표로 하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.3.4 특정 커버리지 숫자를 목표로 하기&lt;/h2&gt;
&lt;p&gt;테스트 커버리지는 지표로 보아야 하지, 목표로 바라보면 안 된다.&lt;/p&gt;
&lt;p&gt;저자는 병원의 환자를 예시로 비유했다. 환자의 체온을 건강의 지표로 보기 때문에, 이를 낮추기 위해 에어컨을 빵빵하게 트는게 과연 ‘효율적’ 인지로 역설한다. 이런 식의 접근은 의미없기 때문이다.&lt;/p&gt;
&lt;p&gt;중요한 시스템의 핵심부분을 잘 검증하는 테스트 코드가 중요하지, 커버리지 수치를 가지고 판단하는 것은 의미없다. 즉, 좋은 지표이자 나쁜 지표다.&lt;/p&gt;
&lt;p&gt;(하지만 나는 이를 적절한 베이스캠프라고 생각한다. 품질 테스트 스위트로 가는 첫 걸음을 떼기위한 “만족할 만한” 수치라고 본다.)&lt;/p&gt;
&lt;h1 id=&quot;14-무엇이-성공적인-테스트-스위트를-만드는가&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#14-%EB%AC%B4%EC%97%87%EC%9D%B4-%EC%84%B1%EA%B3%B5%EC%A0%81%EC%9D%B8-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%8A%A4%EC%9C%84%ED%8A%B8%EB%A5%BC-%EB%A7%8C%EB%93%9C%EB%8A%94%EA%B0%80&quot; aria-label=&quot;14 무엇이 성공적인 테스트 스위트를 만드는가 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.4 무엇이 성공적인 테스트 스위트를 만드는가?&lt;/h1&gt;
&lt;p&gt;하나씩 따로 평가하는 것이 낫지만, 그렇다고 해서 모든 테스트를 평가할 필요는 없다. 그리고 테스트 스위트가 얼마나 좋은지 자동으로 확인할 수는 없고, 리뷰를 수행해야 한다.&lt;/p&gt;
&lt;p&gt;어떻게 테스트 스위트를 성공할 수 있는지 살펴보자. 성공적인 테스트 스위트는 아래 특성을 가진다: (4장에서 이어짐)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;개발 주기에 통합되어있다&lt;/li&gt;
&lt;li&gt;코드베이스에서 가장 중요한 부분 &lt;strong&gt;“만”&lt;/strong&gt; 을 대상으로 한다&lt;/li&gt;
&lt;li&gt;최소한의 유지비로 최대한의 가치를 끌어낸다&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;141-개발-주기에-통합되어있음&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#141-%EA%B0%9C%EB%B0%9C-%EC%A3%BC%EA%B8%B0%EC%97%90-%ED%86%B5%ED%95%A9%EB%90%98%EC%96%B4%EC%9E%88%EC%9D%8C&quot; aria-label=&quot;141 개발 주기에 통합되어있음 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.4.1 개발 주기에 통합되어있음&lt;/h2&gt;
&lt;p&gt;자동화된 테스트를 하는 방법은 끊임없이 하는 것 뿐이다. 모든 테스트는 개발 주기에 통합되어야 한다.&lt;/p&gt;
&lt;h2 id=&quot;142-코드베이스에서-가장-중요한-부분만을-대상으로-함&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#142-%EC%BD%94%EB%93%9C%EB%B2%A0%EC%9D%B4%EC%8A%A4%EC%97%90%EC%84%9C-%EA%B0%80%EC%9E%A5-%EC%A4%91%EC%9A%94%ED%95%9C-%EB%B6%80%EB%B6%84%EB%A7%8C%EC%9D%84-%EB%8C%80%EC%83%81%EC%9C%BC%EB%A1%9C-%ED%95%A8&quot; aria-label=&quot;142 코드베이스에서 가장 중요한 부분만을 대상으로 함 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.4.2 코드베이스에서 가장 중요한 부분만을 대상으로 함&lt;/h2&gt;
&lt;p&gt;결국 테스트 코드를 짜는 것도 비용이므로, 최소 유지비로 최대 가치를 달성하도록 하는 것이 중요하다. 시스템의 가장 중요한 부분에 단위 테스트를 철저히 하고, 다른 부분은 간략하게, 간접적으로 검증하는 것이 좋다.&lt;/p&gt;
&lt;p&gt;일반적으로 애플리케이션에서는 도메인 모델이 가장 중요하다. 여기에 속한 비즈니스 로직을 1순위로 검증하는 것이 옳다. 모든 테스트의 가치는 다르기 때문이다.&lt;/p&gt;
&lt;p&gt;다른 부분은 세 가지 범주로 나눌 수 있다&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;인프라 코드&lt;/li&gt;
&lt;li&gt;DB, 서드파티 시스템 등과 같은 외부서비스 및 종속성&lt;/li&gt;
&lt;li&gt;모든 것을 하나로 묶는 코드&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이 중 일부는 단위 테스트를 철저히 해야할 수 있다. 예를들어 인프라 코드에 주요 로직이 존재할 수 있다. 이 경우는 테스트를 많이하는 것이 좋다. 일반적으로는 도메인 모델에 집중하는 것이 좋다.&lt;/p&gt;
&lt;p&gt;통합 테스트와 같은 일부 테스트는 도메인 모델 너머의 시스템 전반을 테스트할 수 있다. 그렇지만 도메인 모델을 중점으로 생각해야 한다.&lt;/p&gt;
&lt;p&gt;이 지침을 따르려면 도메인 모델을 코드베이스 중 중요한 부분/중요하지 않은 부분 으로 나누어야 한다. 도메인 모델을 다른 애플리케이션 문제와 분리해야 단위 테스트에 대한 노력을 도메인 모델에 집중할 수 있다.&lt;/p&gt;
&lt;h2 id=&quot;143-최소-유지비로-최대-가치를-끌어냄&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#143-%EC%B5%9C%EC%86%8C-%EC%9C%A0%EC%A7%80%EB%B9%84%EB%A1%9C-%EC%B5%9C%EB%8C%80-%EA%B0%80%EC%B9%98%EB%A5%BC-%EB%81%8C%EC%96%B4%EB%83%84&quot; aria-label=&quot;143 최소 유지비로 최대 가치를 끌어냄 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.4.3 최소 유지비로 최대 가치를 끌어냄&lt;/h2&gt;
&lt;p&gt;가치가 유지비를 상회하는 테스트만을 테스트 스위트에 유지해야 한다. 이는 아래와 같다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;가치있는 테스트(가치가 낮은 테스트 포함) 식별하기&lt;/li&gt;
&lt;li&gt;가치있는 테스트 작성하기&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이를 위해서는 가치 높은 테스트를 식별하는 기준틀(&lt;em&gt;frame of reference&lt;/em&gt;)이 있어야 하고, 그것을 위해서는 코드 설계기술이 있어야 한다.&lt;/p&gt;
&lt;p&gt;저자는 좋은 곡을 구별하는 것과 작곡을 하는 정도의 차이로 빗대었다. 음악 듣는 것보다 작곡은 훨씬 어렵다. 단위테스트도 마찬가지다. 맨땅에 테스트 없이 기반 코드를 설계해야 하기 때문이다. 그런 의미에서 이 책은 코드 설계를 같이 배운다고 할 수 있다.&lt;/p&gt;
&lt;h1 id=&quot;15-이-책을-통해-배우는-것들&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#15-%EC%9D%B4-%EC%B1%85%EC%9D%84-%ED%86%B5%ED%95%B4-%EB%B0%B0%EC%9A%B0%EB%8A%94-%EA%B2%83%EB%93%A4&quot; aria-label=&quot;15 이 책을 통해 배우는 것들 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.5 이 책을 통해 배우는 것들&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;테스트 코드를 설명하기 위한 기준틀 설명 → 리팩토링 대상 및 제거코드 파악 완료&lt;/li&gt;
&lt;li&gt;기존 테스트 기술과 실천법 및 better case에 대해 살펴봄&lt;/li&gt;
&lt;li&gt;제품코드와 관련 스위트를 리팩토링하는 방법&lt;/li&gt;
&lt;li&gt;단위 테스트의 다양한 스타일 적용법&lt;/li&gt;
&lt;li&gt;통합 테스트로 시스템 전체 동작 검증&lt;/li&gt;
&lt;li&gt;단위 테스트의 안티패턴 식별법, 예방법&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;summary&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#summary&quot; aria-label=&quot;summary permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Summary&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;코드는 가면 갈 수록 나빠진다. 코드베이스가 바뀌면 소프트웨어 엔트로피가 올라간다. 테스트로 이런 경향을 뒤집을 수 있다.&lt;/li&gt;
&lt;li&gt;단위 테스트 작성은 중요하다. 좋은 단위 테스트를 짜는 것은 더 중요하다.&lt;/li&gt;
&lt;li&gt;단위 테스트는 소프트웨어 프로젝트를 지속적으로 성장시키는 방법이다. 좋은 단위 테스트는 버그를 막을 수 있다. 요구사항을 만족하는 코드이므로 이를 바탕으로 얼마든지 코드 리팩토링 및 신기능 추가가 가능하다.&lt;/li&gt;
&lt;li&gt;중요한 테스트를 우선하여 유지하라.&lt;/li&gt;
&lt;li&gt;단위 테스트 코드는 두 가지를 시사한다
&lt;ul&gt;
&lt;li&gt;단위 테스트를 할 수 없는 코드는 품질이 좋지 않다&lt;/li&gt;
&lt;li&gt;단위 테스트를 할 수 있다고 해서 품질을 보장하지는 않는다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;커버리지 지표 또한 두 가지를 시사한다
&lt;ul&gt;
&lt;li&gt;커버리지가 낮은 것은 문제의 징후&lt;/li&gt;
&lt;li&gt;커버리지가 높다고 해서 테스트 스위트의 품질이 좋은 것을 보장하지 않음&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;분기 커버리지로 테스트 스위트의 완전성에 대한 인사이트를 얻을 수 있지만, 테스트 스위트가 충분하다고 할 수는 없다
&lt;ul&gt;
&lt;li&gt;검증문이 있는지 신경쓰지 않는다&lt;/li&gt;
&lt;li&gt;라이브러리의 모든 경우를 검증하는 것은 아니다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;커버리지 수치를 목표로 잡아선 안 된다&lt;/li&gt;
&lt;li&gt;성공적인 테스트 스위트는 다음 특성을 나타낸다
&lt;ul&gt;
&lt;li&gt;개발 주기에 통합되어있다&lt;/li&gt;
&lt;li&gt;코드베이스에서 가장 중요한 부분 &lt;strong&gt;“만”&lt;/strong&gt; 을 대상으로 한다&lt;/li&gt;
&lt;li&gt;최소한의 유지비로 최대한의 가치를 끌어낸다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;단위 테스트의 목표를 달성하기 위한 유일한 방법은 아래와 같다
&lt;ul&gt;
&lt;li&gt;좋은 테스트, 좋지 않은 테스트를 구별한다&lt;/li&gt;
&lt;li&gt;테스트를 리팩토링한다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;열역학 제 2법칙의 그 엔트로피에서 따왔다. 소프트웨어 엔트로피는 소프트웨어 시스템 내의 무질서도를 의미한다고 보면 될 것이다&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-2&quot;&gt;&lt;a href=&quot;https://docs.python.org/3/library/functions.html#int&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://docs.python.org/3/library/functions.html#int&lt;/a&gt;&lt;a href=&quot;#fnref-2&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[파이썬으로 살펴보는 아키텍처 패턴 (12)]]></title><description><![CDATA[파이썬으로 살펴보는 아키텍처 패턴을 읽고 이해한 내용을 작성합니다. 챕터 11, 이벤트 기반 아키텍처: 이벤트를 사용한 마이크로서비스 통합에 대한 내용입니다.]]></description><link>https://blog.s3ich4n.me/books/cosmic-python/2023-05-18-pt02-ch12</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/cosmic-python/2023-05-18-pt02-ch12</guid><pubDate>Thu, 18 May 2023 17:44:06 GMT</pubDate><content:encoded>&lt;p&gt;이 내용은 “파이썬으로 살펴보는 아키텍처 패턴” 을 읽고 작성한 내용입니다. 블로그 게시글과, 작성한 코드를 함께 보시면 더욱 좋습니다.&lt;/p&gt;
&lt;p&gt;12장은 해당 코드를 살펴봐주세요. &lt;a href=&quot;https://github.com/s3ich4n/cosmicpython-study/tree/main/pt2/ch12&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;코드 링크&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;12장-command-query-responsibility-segregation-cqrs&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#12%EC%9E%A5-command-query-responsibility-segregation-cqrs&quot; aria-label=&quot;12장 command query responsibility segregation cqrs permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;12장 Command-Query Responsibility Segregation (CQRS)&lt;/h1&gt;
&lt;p&gt;읽기-쓰기 가 다른 작업이라는 것은 누구나 알고있다. 그런 고로 이에 대한 책임을 분리할 필요가 있다. 굳이 이런 짓을 왜 하는지 살펴보자!&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.cosmicpython.com/book/images/apwp_1201.png&quot; alt=&quot;읽기와 쓰기 분리&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;121-쓰기-위해-존재하는-도메인-모델&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#121-%EC%93%B0%EA%B8%B0-%EC%9C%84%ED%95%B4-%EC%A1%B4%EC%9E%AC%ED%95%98%EB%8A%94-%EB%8F%84%EB%A9%94%EC%9D%B8-%EB%AA%A8%EB%8D%B8&quot; aria-label=&quot;121 쓰기 위해 존재하는 도메인 모델 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;12.1 쓰기 위해 존재하는 도메인 모델&lt;/h1&gt;
&lt;p&gt;도메인 규칙을 강화하는 소프트웨어를 만드는 방법에 대해 여태 학습해왔다. 이런 규칙이나 제약은 앱마다 다르고 시스템마다 다르다.&lt;/p&gt;
&lt;p&gt;책에서는  ‘현재 사용가능한 재고보다 더 많은 재고를 할당할 수 없다 (&lt;code class=&quot;language-text&quot;&gt;can_allocate()&lt;/code&gt;)’ 같은 명시적 제약을 만들거나, 각 주문 라인은 한 배치에 해당된다 같은 암시적 제약(&lt;code class=&quot;language-text&quot;&gt;allocate&lt;/code&gt; 메소드의 행위 자체를 통해)을 걸었다.&lt;/p&gt;
&lt;p&gt;이런걸 제대로 하려면 연산의 일관성(&lt;strong&gt;UoW 패턴&lt;/strong&gt;)을 보장하며, 각 연산 자체는 객체 단위에서 수행하도록 해야했다(&lt;strong&gt;애그리게이트 패턴&lt;/strong&gt;).&lt;/p&gt;
&lt;p&gt;그리고, 작업 덩어리 사이에서 변경된 내용을 통신하기 위해 도메인 이벤트 패턴을 도입하였다. 이를 통해 ‘재고 손상/분실 시, 배치의 사용가능수량을 조절하고 필요하다면 주문을 재할당하시오’ 같은 규칙을 정할 수 있었다(&lt;code class=&quot;language-text&quot;&gt;change_batch_quantity&lt;/code&gt; 로직과, 메시지 버스(&lt;code class=&quot;language-text&quot;&gt;MessageBus&lt;/code&gt;) 상의 &lt;code class=&quot;language-text&quot;&gt;commands.ChangeBatchQuantity&lt;/code&gt; 커맨드 같은 것을 의미함).&lt;/p&gt;
&lt;p&gt;이런 복잡도는 시스템 상태를 변경할 때 규칙적용을 강화하기 위해 존재한다. 즉 데이터를 유연하게 쓰기 위한 도구를 만든 것이다.&lt;/p&gt;
&lt;p&gt;그렇다면 읽기는?&lt;/p&gt;
&lt;h1 id=&quot;122-가구를-구매하지-않는-사용자&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#122-%EA%B0%80%EA%B5%AC%EB%A5%BC-%EA%B5%AC%EB%A7%A4%ED%95%98%EC%A7%80-%EC%95%8A%EB%8A%94-%EC%82%AC%EC%9A%A9%EC%9E%90&quot; aria-label=&quot;122 가구를 구매하지 않는 사용자 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;12.2 가구를 구매하지 않는 사용자&lt;/h1&gt;
&lt;p&gt;저자가 개발중인 시스템(책에선 &lt;a href=&quot;https://www4.next.co.uk/made&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;메이드닷컴&lt;/a&gt;이라 나옴)에는 할당 서비스도 있을 것이다. &lt;strong&gt;시간당 100건&lt;/strong&gt; 넘는 주문도 처리한다. 그렇지만 재고를 할당해주는 시스템이 존재한다.&lt;/p&gt;
&lt;p&gt;하지만 같은 날에 제품 뷰에 대한 건수는 &lt;strong&gt;초당 100건&lt;/strong&gt;에 달할 수 있다. 재고가 있나 보거나, 배송이 얼마나 오래걸리는지 걸리기 위해 누군가 상품 목록 페이지나 상품페이지에서 하염없이 F5만 때리고 있을지도 모른다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;도메인&lt;/strong&gt;은 똑같다. 재고 배치, 배치의 도착일, 사용 가능한 수량에 대해 관심이 있다. 하지만 접근 패턴은 매우 다르다. 요컨대 고객은 쿼리가 몇 초 지난 상태인지 알 수 없다. 그렇지만 할당 서비스가 일관성이 없는건 고객 주문이 꼬여지는 것을 의미한다. 이런 차이를 십분 활용하여 읽기에 대해선 최종적으론 일관성있게(&lt;em&gt;eventually consistent&lt;/em&gt;) 유지하여 성능을 향상시킬 수 있다.&lt;/p&gt;
&lt;h2 id=&quot;1221-읽기-일관성을-정말로-달성할-수-있을까&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1221-%EC%9D%BD%EA%B8%B0-%EC%9D%BC%EA%B4%80%EC%84%B1%EC%9D%84-%EC%A0%95%EB%A7%90%EB%A1%9C-%EB%8B%AC%EC%84%B1%ED%95%A0-%EC%88%98-%EC%9E%88%EC%9D%84%EA%B9%8C&quot; aria-label=&quot;1221 읽기 일관성을 정말로 달성할 수 있을까 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;12.2.1 읽기 일관성을 &lt;em&gt;정말로&lt;/em&gt; 달성할 수 있을까?&lt;/h2&gt;
&lt;p&gt;일관성과 성능을 맞교환하는 사실은 받아들이기 어렵다. 당연히 갖춰야한다. RDBMS에 저장된 값이 다르다를 상상할 수 있을까?&lt;/p&gt;
&lt;p&gt;그런데 읽기 데이터에 대한 생각을 조금만 바꿔보면 &lt;strong&gt;읽어온 데이터는 그 시점에만 최신&lt;/strong&gt;이다. 그리고 &lt;strong&gt;분산 시스템은 완전한 일관성을 갖출 수 없다.&lt;/strong&gt; 시스템의 현재 상태를 계속해서 검사해야한다. 관점을 바꾸기 위한 예를 들어보자.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;A라는 고객이 ‘가’ 라는 상품이 “재고있음” 이란 것을 보고 잠깐 자리를 비운 새 B라는 고객이 먼저 구매해버렸다고 하자. A라는 고객이 &lt;em&gt;다시&lt;/em&gt; 요청하면, 재고가 없어서 (1) 주문을 취소하거나 (2) 더 많은 재고를 요청하여 A 고객이 주문한 상품의 배송을 늦춘다.&lt;/li&gt;
&lt;li&gt;어찌어찌해서 완전한 일관성을 보장하는 웹앱이 생겼다고 하자. A라는 고객이 제품 구매를 하였으나, 배송중 제품이 박살나버렸다. 이러면 결국 (1) 환불처리를 하거나 (2) 더 많은 재고를 요청하여 A 고객이 주문한 상품의 배송을 늦춘다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이렇듯 현실은 소프트웨어 시스템과 일관성이 없으므로, 비즈니스 프로세스는 이런 경우를 처리할 수 있어야 한다. 다시말해 일관성이 없는 데이터는 근본적으로 피할 수 없으므로 읽기 측면에서 성능과 일관성을 어느정도 바꾸어도 좋다.&lt;/p&gt;
&lt;h2 id=&quot;1222-읽기와-쓰기-비교&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1222-%EC%9D%BD%EA%B8%B0%EC%99%80-%EC%93%B0%EA%B8%B0-%EB%B9%84%EA%B5%90&quot; aria-label=&quot;1222 읽기와 쓰기 비교 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;12.2.2 읽기와 쓰기 비교&lt;/h2&gt;
&lt;p&gt;이런즉 시스템은 ‘읽기’와 ‘쓰기’ 두 시스템으로 분할이 가능하다.&lt;/p&gt;
&lt;p&gt;쓰기쪽에서 채택한 도메인 아키텍처 패턴은 읽기에 큰 도움이 되지 않는다. 그래서 배워야함ㅋㅋ&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;읽기&lt;/th&gt;
&lt;th&gt;쓰기&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;동작&lt;/td&gt;
&lt;td&gt;간단한 읽기&lt;/td&gt;
&lt;td&gt;복잡한 비즈니스 로직&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;캐시 가능성&lt;/td&gt;
&lt;td&gt;높음&lt;/td&gt;
&lt;td&gt;캐시 불가능&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;일관성&lt;/td&gt;
&lt;td&gt;오래된 값 제공 가능&lt;/td&gt;
&lt;td&gt;트랜잭션 일관성이 있어야 함&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&quot;123-post리디렉션get과-cqs&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#123-post%EB%A6%AC%EB%94%94%EB%A0%89%EC%85%98get%EA%B3%BC-cqs&quot; aria-label=&quot;123 post리디렉션get과 cqs permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;12.3 POST/리디렉션/GET과 CQS&lt;/h1&gt;
&lt;p&gt;웹 개발을 하는 사람에겐 POST/리디렉션/GET패턴이 익숙할 것이다&lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;. 이 기법에서 웹 엔드포인트는 &lt;code class=&quot;language-text&quot;&gt;POST&lt;/code&gt; 콜을 받고 처리결과를 보여주기 위해 리디렉션으로 응답한다. 책의 예시를 말해보자면 &lt;code class=&quot;language-text&quot;&gt;POST /batches&lt;/code&gt; 를 해서 배치를 만들면 &lt;code class=&quot;language-text&quot;&gt;GET /batches/123&lt;/code&gt; 으로 리디렉션해서 새 배치를 보여준다거나… 하는 것이다. 요는 연산의 쓰기와 읽기 단계를 분리하여 문제를 해결했다는 점이다.&lt;/p&gt;
&lt;p&gt;이 기법은 명령-쿼리 분리(Command-Query Separation, CQS) 의 예시이다. CQS에서는 한가지 간단한 규칙을 따른다. 함수는 상태변경 혹은 질의응답 둘 중 하나만 해야한다. 둘 다 해서는 안된다. 이러면 소프트웨어 추론이 쉬워진다. 전등을 껐다켰다 하지 않아도 전등이 켜져있나? 라는 질문에 답할 수 있어야 한다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;📒 &lt;strong&gt;NOTE&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;API 생성시에도 Location 헤더가 새로운 자원의 URI를 포함하면 201 Created 혹은 202 Accepted를 반환함으로써 같은 설계기법을 사용한다.&lt;/p&gt;
&lt;p&gt;여기서는 사용하는 상태코드의 값이 아니라 논리적으로 읽기-쓰기를 분리했다는 점을 캐치하자.&lt;/p&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;p&gt;기존코드의 CQS 위반부분을 먼저 해결하자. 오래 전에 주문을 받아 서비스 계층을 호출하여 재고를 할당하는 &lt;code class=&quot;language-text&quot;&gt;allocate&lt;/code&gt; 이란 엔드포인트를 바꾸자. 기존에는 호출 시 200 OK와 배치 ID를 반환했는데, 이러한 읽기-쓰기가 혼재된 부분을 해소해보자. 우선 테스트코드부터…&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mark&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;asyncio&lt;/span&gt;
&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mark&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;integration&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_happy_path_returns_202_and_batch_is_allocated&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        async_engine&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        client&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        clear&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    orderid &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; random_orderid&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; othersku &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; random_sku&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; random_sku&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;other&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    data &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; OrderLine&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;orderid&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;orderid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; qty&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    res &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;post&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/allocate&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; json&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;asdict&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; res&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;status_code &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; status&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;HTTP_202_ACCEPTED            &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;

    res &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;/allocations/&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;orderid&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; res&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;json&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;sku&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;reference&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; earlybatch&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 2)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;202 Accepted&lt;/code&gt; 응답으로 오는지?&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;GET /allocations/{order_id}&lt;/code&gt; 로 호출했을 때 제대로 오는지?&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;본 로직은 이에 대응하여 어떻게 바뀌어지는지 보자&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@app&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;post&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;/allocate&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    status_code&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;status&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;HTTP_202_ACCEPTED&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;              &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@inject&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;allocate_endpoint&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@app&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;/allocations/{order_id}&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@inject&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;allocations_view_endpoint&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;order_id&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;    &lt;span class=&quot;token comment&quot;&gt;# 2)&lt;/span&gt;
    uow &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SqlAlchemyUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;db&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; views&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocations&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;order_id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;          &lt;span class=&quot;token comment&quot;&gt;# 3)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;not&lt;/span&gt; result&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; HTTPException&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            status_code&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;status&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;HTTP_404_NOT_FOUND&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; result&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;기존 정상리턴 코드는 &lt;code class=&quot;language-text&quot;&gt;202 Accepted&lt;/code&gt; 로 바꿔준다&lt;/li&gt;
&lt;li&gt;신규 API인 &lt;code class=&quot;language-text&quot;&gt;GET /allocations/{order_id}&lt;/code&gt; 에 대해 엔드포인트를 만들어주자&lt;/li&gt;
&lt;li&gt;“읽기 전용” 이라는 의미에서 &lt;code class=&quot;language-text&quot;&gt;views.py&lt;/code&gt; 로 파일명을 두자&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;124-잠깐만-있어보세요&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#124-%EC%9E%A0%EA%B9%90%EB%A7%8C-%EC%9E%88%EC%96%B4%EB%B3%B4%EC%84%B8%EC%9A%94&quot; aria-label=&quot;124 잠깐만 있어보세요 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;12.4 잠깐만 있어보세요&lt;/h1&gt;
&lt;p&gt;repository 객체에서 값 목록을 리턴하는 메소드를 후딱 짜보자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; sqlalchemy&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sql &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; text

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;allocations&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;orderid&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SqlAlchemyUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        results &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;execute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            text&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;
                SELECT ol.sku, b.reference
                FROM allocations AS a
                JOIN batches as b ON a.batch_id = b.id
                JOIN order_lines AS ol ON a.orderline_id = ol.id
                WHERE ol.orderid = :orderid
                &quot;&quot;&quot;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token builtin&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;orderid&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;orderid&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; results&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mappings&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;예제에서는 놀랍게도 쌩 쿼리(&lt;em&gt;raw query&lt;/em&gt;)를 넣어놨다.&lt;/p&gt;
&lt;p&gt;왜 이랬는지 보고, 실무에서는 보다 나은 트릭들을 써서 어떻게 하는지 보자&lt;/p&gt;
&lt;p&gt;일단 뷰는 이런식으로 &lt;code class=&quot;language-text&quot;&gt;views.py&lt;/code&gt; 에 계속 보관하자&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;🍅 tips!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;CQRS를 안하더라도 상태를 변경하는 커맨드와 이벤트 핸들러에서 읽기 전용 뷰를 분리하는게 좋다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;125-cqrs-뷰-테스트하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#125-cqrs-%EB%B7%B0-%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EA%B8%B0&quot; aria-label=&quot;125 cqrs 뷰 테스트하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;12.5 CQRS 뷰 테스트하기&lt;/h1&gt;
&lt;p&gt;뷰를 어떻게 가져가더라도 통합 테스트는 필요하다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mark&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;asyncio&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_allocations_view&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sqlite_session_factory&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    uow &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SqlAlchemyUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sqlite_session_factory&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; messagebus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;commands&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;CreateBatch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;sku1batch&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sku1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; messagebus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;commands&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;CreateBatch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;sku2batch&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sku2&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; today&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; messagebus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;commands&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;order1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sku1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; messagebus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;commands&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;order1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sku2&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# 제대로 데이터를 얻는지 보기 위해 여러 배치와 주문을 추가&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; messagebus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;commands&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;CreateBatch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;sku1batch-l8r&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sku1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; today&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; messagebus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;commands&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;otherorder&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sku1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; messagebus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;commands&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;otherorder&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sku2&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; views&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocations&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;order1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;reference&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sku1batch&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sku&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sku1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;reference&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sku2batch&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sku&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sku2&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id=&quot;126-대안-1-기존-저장소-사용하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#126-%EB%8C%80%EC%95%88-1-%EA%B8%B0%EC%A1%B4-%EC%A0%80%EC%9E%A5%EC%86%8C-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0&quot; aria-label=&quot;126 대안 1 기존 저장소 사용하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;12.6 대안 1: 기존 저장소 사용하기&lt;/h1&gt;
&lt;p&gt;헬퍼 메소드를 &lt;code class=&quot;language-text&quot;&gt;products&lt;/code&gt; 저장소에 추가하면?&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; pt2&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ch12&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;src&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocation&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;service_layer &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; unit_of_work
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; sqlalchemy&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sql &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; text

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;allocations&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        orderid&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SqlAlchemyUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        products &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;products&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;for_order&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;orderid&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;orderid&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;    &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;
        batches &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;b &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; p &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; products &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; b &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; p&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;batches&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;    &lt;span class=&quot;token comment&quot;&gt;# 2)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;sku&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;batchref&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;reference&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; b &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; batches
            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; orderid &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;orderids                          &lt;span class=&quot;token comment&quot;&gt;# 3)&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;저장소는 &lt;code class=&quot;language-text&quot;&gt;Product&lt;/code&gt; 객체를 반환하며 주어진 주문에서 sku에 해당하는 모든 상품을 찾아야한다. 저장소에 &lt;code class=&quot;language-text&quot;&gt;.for_order()&lt;/code&gt; 라는 헬퍼 메소드를 만든다&lt;/li&gt;
&lt;li&gt;이 시점에서는 상품이 있지만 실제로 원하는 값은 배치에 대한 참조다. 그러므로 모든 배치를 가져온다&lt;/li&gt;
&lt;li&gt;원하는 주문에 대한 배치만을 찾기 위해 &lt;strong&gt;다시&lt;/strong&gt; 배치를 걸러낸다. 이 과정은 다시 &lt;code class=&quot;language-text&quot;&gt;Batch&lt;/code&gt; 객체가 자신이 어떤 주문에 할당됐는지 알려준다는 사실에 의존한다&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이 값은 &lt;code class=&quot;language-text&quot;&gt;Batch&lt;/code&gt; 객체에 &lt;code class=&quot;language-text&quot;&gt;.orderid&lt;/code&gt; 라는 프로퍼티를 구현하여 처리한다&lt;/p&gt;
&lt;p&gt;이 방식은 기존 추상화를 재사용하는 장점이 있지만, 새 헬퍼 메소드를 저장소, 도메인 모델 클래스 둘 다에 추가하고 파이썬 수준에서 루프를 돌려야한다. DB를 쓰면 걍 쿼리로 하면 될 것인데 말이지.&lt;/p&gt;
&lt;h1 id=&quot;127-읽기-연산에-최적화되지-않은-도메인-모델&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#127-%EC%9D%BD%EA%B8%B0-%EC%97%B0%EC%82%B0%EC%97%90-%EC%B5%9C%EC%A0%81%ED%99%94%EB%90%98%EC%A7%80-%EC%95%8A%EC%9D%80-%EB%8F%84%EB%A9%94%EC%9D%B8-%EB%AA%A8%EB%8D%B8&quot; aria-label=&quot;127 읽기 연산에 최적화되지 않은 도메인 모델 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;12.7 읽기 연산에 최적화되지 않은 도메인 모델&lt;/h1&gt;
&lt;p&gt;가만보면 도메인 모델을 만드는데 든 노력은 주로 쓰기연산을 위한 것임을 알 수 있다. 그러니까 읽기를 위해서는 기존 추상화에 덧붙이고 파이썬 레벨에서 루프를 돌렸다.&lt;/p&gt;
&lt;p&gt;그렇지만 이는 CQRS위해 골통을 짜맨 결과다. 도메인 모델은 앞서보았듯 데이터 모델이 아니다. 워크플로우, 상태 변경을 둘러싼 규칙, 메시지 교환 등 비즈니스의 규칙을 캐치하기 위한 요소였다. 이는 시스템이 외부 이벤트와 입력에 대해 어떻게 처리하는지에 대한 내용이다. &lt;strong&gt;이 요소중 대부분은 읽기 전용 연산과는 관계가 없다.&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;🍅 tips!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;CQRS가 필요하다고 말하는 것은 도메인 모델 패턴이 필요하다고 하는 것과 연관있다. 단순 CRUD앱은 읽기/쓰기가 밀접하게 연관되어있기 때문에 도메인 모델이나 CQRS가 필요없지만, 도메인이 복잡해지면 도메인 모델과 CQRS 모두가 더 많이 필요해진다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;p&gt;접근 편의를 위해 도메인 클래스는 상태를 변경하는 메소드를 여럿 제공하지만, 읽기 전용 연산에서는 이런게 모두 필요하지 않다.&lt;/p&gt;
&lt;p&gt;게다가 도메인 모델의 복잡도가 더 커질 수록 모델을 구성하는 방법에 대한 선택의 폭이 넓어진다. 따라서 읽기 연산에 도메인 모델을 사용하는 것이 더 어려워진다.&lt;/p&gt;
&lt;h1 id=&quot;128-대안-2-orm-쓰기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#128-%EB%8C%80%EC%95%88-2-orm-%EC%93%B0%EA%B8%B0&quot; aria-label=&quot;128 대안 2 orm 쓰기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;12.8 대안 2: ORM 쓰기&lt;/h1&gt;
&lt;p&gt;테스트코드가 살짝 바뀐다&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mark&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;asyncio&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_allocations_view&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sqlite_session_factory&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    uow &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SqlAlchemyUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sqlite_session_factory&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; messagebus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;commands&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;CreateBatch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;sku1batch&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sku1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; messagebus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;commands&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;CreateBatch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;sku2batch&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sku2&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; today&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; messagebus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;commands&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;order1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sku1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; messagebus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;commands&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;order1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sku2&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# 제대로 데이터를 얻는지 보기 위해 여러 배치와 주문을 추가&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; messagebus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;commands&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;CreateBatch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;sku1batch-l8r&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sku1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; today&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; messagebus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;commands&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;otherorder&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sku1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; messagebus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;commands&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;otherorder&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sku2&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    view_result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; views&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocations&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;order1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;     &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;
    expected &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;batchref&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sku1batch&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sku&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sku1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;batchref&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sku2batch&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sku&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sku2&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;                                                        &lt;span class=&quot;token comment&quot;&gt;# 2)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; data &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; expected&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; data &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; view_result                           &lt;span class=&quot;token comment&quot;&gt;# 3)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;쿼리하면 다른 배치, 주문 내용도 다 나와버린다&lt;/li&gt;
&lt;li&gt;내가 생각하는게 있는지 전체 배치와 주문 중에서 살펴봐야한다&lt;/li&gt;
&lt;li&gt;따로 빼서 보면 된다&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;그렇다면 ORM을 써서 쿼리해버리면?&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;allocations&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;orderid&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SqlAlchemyUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        batches &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;execute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                select&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Batch&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;join&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;OrderLine&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;OrderLine&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;orderid &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; orderid&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;scalars&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;batchref&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;reference&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;sku&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; b &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; batches
        &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;비동기 쿼리는 SQLAlchemy 2.0 스타일의 ORM 쿼리를 짜야한다!
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.sqlalchemy.org/en/14/orm/extensions/asyncio.html#synopsis-orm&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;참고용 공식문서&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;이를 알게 된 &lt;a href=&quot;https://stackoverflow.com/questions/68360687/sqlalchemy-asyncio-orm-how-to-query-the-database&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;스택오버플로우 게시글&lt;/a&gt; → &lt;a href=&quot;https://docs.sqlalchemy.org/en/14/orm/extensions/asyncio.html#synopsis-orm&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;공식문서의 출처&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;SQLAlchemy 문서를 보고 쿼리를 짜는건 크게 문제가 없으나, 성능상의 이슈가 있다.&lt;/p&gt;
&lt;h1 id=&quot;129-select-n1-과-다른-고려사항&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#129-select-n1-%EA%B3%BC-%EB%8B%A4%EB%A5%B8-%EA%B3%A0%EB%A0%A4%EC%82%AC%ED%95%AD&quot; aria-label=&quot;129 select n1 과 다른 고려사항 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;12.9 SELECT N+1 과 다른 고려사항&lt;/h1&gt;
&lt;p&gt;SELECT N+1&lt;sup id=&quot;fnref-2&quot;&gt;&lt;a href=&quot;#fn-2&quot; class=&quot;footnote-ref&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;은 성능이슈가 생긴다. 객체 리스트를 가져올 때 ORM은 보통 필요한 모든 객체의 ID를 가져오는 쿼리를 먼저 수행한다. 그 후 각 객체의 어트리뷰트를 얻기 위한 개별 쿼리를 한다. 특히 객체에 외래키 관계가 많으면 더 자주 발생한다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;📒 &lt;strong&gt;NOTE&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;SQLAlchemy에서는 이를 피하기 위해 eager loading을 상황에 맞게 수행할 수 있다.
1.4 뿐 아니라 2.0에서도 문서를 꼭 읽어보자.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.sqlalchemy.org/en/14/orm/loading_relationships.html#joined-eager-loading&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;- SQLAlchemy 1.4에서의 관련 설명&lt;/a&gt;
&lt;a href=&quot;https://docs.sqlalchemy.org/en/20/orm/queryguide/relationships.html#joined-eager-loading&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;- SQLAlchemy 2.0에서의 관련 설명&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;p&gt;SELECT N+1 문제 외에도, 상태를 영속화하는 방법과 현재 상태 로드 방법을 분리해야하는 이유가 있다. 정규화된 테이블은 쓰기 연산이 데이터 오염을 발생시키는 것을 막는 방법이다. 그렇지만 읽어올 때 JOIN연산을 하면 읽기 연산이 느려질 수 있다.&lt;/p&gt;
&lt;p&gt;이를 위해 정규화되지 않는 뷰를 추가하거나, 읽기 전용 복사본을 만들거나, 캐시 계층을 추가할 수 있다.&lt;/p&gt;
&lt;h1 id=&quot;1210-코드를-확-틀어보자&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1210-%EC%BD%94%EB%93%9C%EB%A5%BC-%ED%99%95-%ED%8B%80%EC%96%B4%EB%B3%B4%EC%9E%90&quot; aria-label=&quot;1210 코드를 확 틀어보자 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;12.10 코드를 확 틀어보자&lt;sup id=&quot;fnref-3&quot;&gt;&lt;a href=&quot;#fn-3&quot; class=&quot;footnote-ref&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;&lt;/h1&gt;
&lt;p&gt;12.4절에서 살펴본 코드를 정규화하지 않은 별도 뷰 모델에 값을 넣어버리고 그걸 바로 갖고오게 하자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;allocations&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;orderid&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SqlAlchemyUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        results &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;execute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            text&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;                              &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;
                &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot;
                SELECT sku, batchref
                FROM allocations_view
                WHERE orderid = :orderid
                &quot;&quot;&quot;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token builtin&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;orderid&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;orderid&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; results&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mappings&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

allocations_view &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Table&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;                      &lt;span class=&quot;token comment&quot;&gt;# 2)&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&apos;allocations_view&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    metadata&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    Column&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;orderid&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; String&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    Column&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;sku&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; String&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    Column&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;batchref&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; String&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;전용 뷰에서 값을 가져오도록 하자&lt;/li&gt;
&lt;li&gt;외래키 없이 그냥 바로 갖고올 수 있다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;읽기에 최적화된, 데이터의 정규화되지 않은 복사본을 만드는 방법도 나쁘지 않다. 인덱스를 사용해 처리할 수 있는 일의 한계가 생긴다면 이런 복사본을 만드는 방법이 있다. (저자 왈)사실 잘 튜닝한 인덱스라도 조인을 위해 CPU 사용량이 많다. 그런걸 놓고 보면 &lt;code class=&quot;language-text&quot;&gt;SELECT * FROM table WHERE key =: value&lt;/code&gt; 가 가장 빠르긴 하다.&lt;/p&gt;
&lt;p&gt;이런 접근방식은 규모확장에도 장점을 가진다. RDBMS에 데이터를 쓸 때는 변경할 컬럼에 락을 걸어 일관성에 문제가 생기지 않도록 한다. 여러 클라이언트가 동시에 값을 변경하면 추적하기 힘든 race condition이 생긴다. 그렇지만 데이터를 읽을 때(&lt;em&gt;reading&lt;/em&gt;)는 동시연산에 대한 제한이 없으므로 읽기 전용 저장소는 수평규모 확장이 가능하다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;🍅 tips!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;읽기용 복사본이 일관성이 없을 수도 있어서, 사용할 수 있는 복사본 수에는 한계가 있다. 복잡한 데이터 저장소가 있는 시스템의 규모를 확장하는데 어려움이 있다면 더 간단한 읽기 모델을 만들 수 없는지 살펴보아야 한다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;p&gt;그렇긴 하지만 이 읽기 모델을 최신상태로 유지하는 것도 어렵다. 데이터베이스 뷰(meterialized 하거나 그렇지 않거나)나 트리거가 일반적 해법이다. 하지만 이런 해법은 DB에 따라 한계가 정해진다. 아래에서는 DB 기능 대신 아키텍처 재활용을 살펴보도록 한다.&lt;/p&gt;
&lt;h2 id=&quot;12101-이벤트-핸들러를-사용한-읽기-모델-테이블-업데이트&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#12101-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%ED%95%B8%EB%93%A4%EB%9F%AC%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%9C-%EC%9D%BD%EA%B8%B0-%EB%AA%A8%EB%8D%B8-%ED%85%8C%EC%9D%B4%EB%B8%94-%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8&quot; aria-label=&quot;12101 이벤트 핸들러를 사용한 읽기 모델 테이블 업데이트 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;12.10.1 이벤트 핸들러를 사용한 읽기 모델 테이블 업데이트&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Allocated&lt;/code&gt; 이벤트에 대해 두번째 핸들러를 넣는다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Deallocated&lt;/code&gt; 이벤트도 마찬가지다.&lt;/p&gt;
&lt;p&gt;읽기 모델의 시퀀스 다이어그램을 살펴보자&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.cosmicpython.com/book/images/apwp_1202.png&quot; alt=&quot;읽기 모델의 시퀀스 다이어그램&quot;&gt;&lt;/p&gt;
&lt;p&gt;POST/쓰기 연산의 두 트랜잭션을 볼 수 있다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;쓰기 모델 업데이트&lt;/li&gt;
&lt;li&gt;읽기 모델 업데이트&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;GET/읽기 연산은 이 읽기 모델을 사용한다.&lt;/p&gt;
&lt;h1 id=&quot;1211-읽기-모델-구현을-변경하기-쉽다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1211-%EC%9D%BD%EA%B8%B0-%EB%AA%A8%EB%8D%B8-%EA%B5%AC%ED%98%84%EC%9D%84-%EB%B3%80%EA%B2%BD%ED%95%98%EA%B8%B0-%EC%89%BD%EB%8B%A4&quot; aria-label=&quot;1211 읽기 모델 구현을 변경하기 쉽다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;12.11 읽기 모델 구현을 변경하기 쉽다&lt;/h1&gt;
&lt;p&gt;저장소 엔진을 바꿔버리면 어떻게 되는지 살펴보자.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Redis 읽기 모델을 업데이트&lt;/li&gt;
&lt;li&gt;관련 헬퍼메소드 작업&lt;/li&gt;
&lt;li&gt;Redis에 맞게 view를 변경&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Post/Redirect/Get&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 내용&lt;/a&gt;을 의미한다. 예를 들어서 유저가 POST로 보낸 값을 새로고침함하여 POST 요청을 &lt;strong&gt;또 보내는&lt;/strong&gt; 문제에 대한 대처법으로도 사용된다.&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-2&quot;&gt;쿼리 1번으로 N건을 가져왔으나, 관련 컬럼을 얻기 위해 쿼리를 N번 더 하는(!) 문제를 의미한다. 필히 알아둬야 할 내용이다. (&lt;a href=&quot;https://zetawiki.com/wiki/N%2B1_%EC%BF%BC%EB%A6%AC_%EB%AC%B8%EC%A0%9C&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;N+1 쿼리문제 관련 링크&lt;/a&gt;)(&lt;a href=&quot;https://secure.phabricator.com/book/phabcontrib/article/n_plus_one/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;교재상의 참고링크&lt;/a&gt;)&lt;a href=&quot;#fnref-2&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-3&quot;&gt;&lt;em&gt;Time to Completely Jump the Shark&lt;/em&gt;이 원제인데, jumping the shark은 잘 안풀려서 무리수를 뒀다 이런 뜻이라… (&lt;a href=&quot;https://www.urbandictionary.com/define.php?term=jump-the-shark&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;링크를 보고 알아서 판단하시와요&lt;/a&gt;)&lt;a href=&quot;#fnref-3&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[파이썬으로 살펴보는 아키텍처 패턴 (11)]]></title><description><![CDATA[파이썬으로 살펴보는 아키텍처 패턴을 읽고 이해한 내용을 작성합니다. 챕터 11, 이벤트 기반 아키텍처: 이벤트를 사용한 마이크로서비스 통합에 대한 내용입니다.]]></description><link>https://blog.s3ich4n.me/books/cosmic-python/2023-05-18-pt02-ch10</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/cosmic-python/2023-05-18-pt02-ch10</guid><pubDate>Thu, 18 May 2023 03:41:09 GMT</pubDate><content:encoded>&lt;p&gt;이 내용은 “파이썬으로 살펴보는 아키텍처 패턴” 을 읽고 작성한 내용입니다. 블로그 게시글과, 작성한 코드를 함께 보시면 더욱 좋습니다.&lt;/p&gt;
&lt;p&gt;11장은 해당 코드를 살펴봐주세요. &lt;a href=&quot;https://github.com/s3ich4n/cosmicpython-study/tree/main/pt2/ch11&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;코드 링크&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;11장-이벤트-기반-아키텍처-이벤트를-사용한-마이크로서비스-통합&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#11%EC%9E%A5-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EA%B8%B0%EB%B0%98-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98-%EC%9D%B4%EB%B2%A4%ED%8A%B8%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%9C-%EB%A7%88%EC%9D%B4%ED%81%AC%EB%A1%9C%EC%84%9C%EB%B9%84%EC%8A%A4-%ED%86%B5%ED%95%A9&quot; aria-label=&quot;11장 이벤트 기반 아키텍처 이벤트를 사용한 마이크로서비스 통합 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;11장 이벤트 기반 아키텍처: 이벤트를 사용한 마이크로서비스 통합&lt;/h1&gt;
&lt;p&gt;제목 길다ㅋㅋ&lt;/p&gt;
&lt;p&gt;이전 장에서는 실제로 ‘배치 수량이 변경됨’ 이라는 이벤트를 어떻게 받을 수 있는지, 재할당에 대해 외부 세계에 어떻게 통지할 수 있는지에 대해서는 논하지 않았다.&lt;/p&gt;
&lt;p&gt;현재까지 만든건 웹 API가 있는 마이크로서비스 한 개다. 다른 시스템과 이야기하는 다른 방법을 생각해보자. 선적이 지연되거나, 수량이 변경되거나 하는건 시스템이 어떻게 알 수 있을까? 시스템이 창고 시스템에게 주문이 할당되었고 다른 고객에게 운송되어야 한다고 어떻게 이야기할 수 있을까?&lt;/p&gt;
&lt;p&gt;이번 장에서는 이벤트 비유를 확장하여 시스템으로 들어오거나 시스템에서 나가는 메시지까지 포용하는 방안을 살펴본다. 여지껏 애플리케이션의 핵심은 메시지 처리기가 되도록 바꾸었다. 이제는 외부로도 이를 처리할 수 있도록 작업해보자.&lt;/p&gt;
&lt;p&gt;외부 이벤트가 들어오는 것은 외부 메시지 버스(이 책에서는 Redis의 pub/sub 대기열을 예제로 사용한다)를 통해 subscribe 하고, 출력은 이벤트 형태로 외부 메시지 버스에 publish 한다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.cosmicpython.com/book/images/apwp_1101.png&quot; alt=&quot;이제 애플리케이션은 메시지 처리기가 되었다&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;111-분산된-진흙-공-명사로-생각하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#111-%EB%B6%84%EC%82%B0%EB%90%9C-%EC%A7%84%ED%9D%99-%EA%B3%B5-%EB%AA%85%EC%82%AC%EB%A1%9C-%EC%83%9D%EA%B0%81%ED%95%98%EA%B8%B0&quot; aria-label=&quot;111 분산된 진흙 공 명사로 생각하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;11.1 분산된 진흙 공, 명사로 생각하기&lt;/h1&gt;
&lt;p&gt;책의 저자는 마이크로서비스 아키텍처(이하 MSA)를 구축하는 사람과 자주 이야기하며 기존 앱을 마이그레이션하는 논의를 자주 한다고 한다. 이 때 본능적으로 하는 일은 시스템을 명사화 하는 것이다.&lt;/p&gt;
&lt;p&gt;현재까지의 시스템에 도입된 명사들을 생각해보자. 재고 배치, 주문, 상품, 고객 등이 있다. 이를 그림과 같이 나누었다. (참고: ‘할당’이라는 동작 대신, ‘배치’라는 명사를 기준으로 이름이 붙어졌음)&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.cosmicpython.com/book/images/apwp_1102.png&quot; alt=&quot;명사 기반 서비스의 컨텍스트 다이어그램&quot;&gt;&lt;/p&gt;
&lt;p&gt;이 시스템의 ‘물건’ 마다 연관된 서비스가 있고, 그 서비스는 HTTP API를 노출한다.&lt;/p&gt;
&lt;p&gt;아래 command flow 1을 통해 정상경로(&lt;em&gt;happy path&lt;/em&gt;) 를 진행해보자.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;사용자가 웹 사이트에 방문하여 재고가 있는 상품을 선택한다&lt;/li&gt;
&lt;li&gt;상품을 장바구니에 담고 재고를 예약한다&lt;/li&gt;
&lt;li&gt;주문이 완료되면 예약을 확정하고 창고에 출고를 지시한다&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;3&lt;/code&gt;번째 주문일 경우 고객 레코드를 변경하여 일반 고객을 VIP로 승격시킨다&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://www.cosmicpython.com/book/images/apwp_1103.png&quot; alt=&quot;커맨드 플로우 1&quot;&gt;&lt;/p&gt;
&lt;p&gt;각 단계를 이런 커맨드로 생각해볼 수 있겠다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ReserveStock&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ConfirmReservation&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;DispatchGoods&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;MakeCustomerVIP&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이런 스타일의 아키텍처에서는 DB 테이블 단위로 마이크로서비스를 만들고, HTTP API를 빈약한(비즈니스 로직이 없는) 모델에 대한 CRUD 인터페이스로 취급하며, 서비스 중심의 설계를 처음 하는 사람들이 취하는 방식이다.&lt;/p&gt;
&lt;p&gt;간단하면 잘 돌겠지만, 금방 복잡해진다(!!!). 왜냐면 실패 케이스에 대한 고려가 없기 때문이다. 이런 케이스에 대해 살펴보자:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;재고가 도착했는데 배송 중 물에의해 손상된 경우가 있다. 이걸 팔 수는 없으니 폐기하고 다시 재고요청을 해야한다&lt;/li&gt;
&lt;li&gt;이 경우에는 재고 모델을 업데이트 해야할 수도 있고, 그로인해 고객의 주문을 재할당 해야할 수도 있다&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이런 기능들을 어디에 넣어야할까? 대충 봤을 땐(!) 창고 시스템이 하면 될 것 같다. 아래와 같은 command flow 2가 나올 것이다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.cosmicpython.com/book/images/apwp_1104.png&quot; alt=&quot;커맨드 플로우 2: 창고 시스템이 이런 처리를 담당하는 경우&quot;&gt;&lt;/p&gt;
&lt;p&gt;잘 돌아간다. 그렇지만 의존성 그래프가 지저분해진다. 왜인지 보자:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;재고를 할당하려면 ‘주문 서비스’가 ‘배치 시스템’을 제어해야 한다&lt;/li&gt;
&lt;li&gt;‘배치 시스템’은 다시 ‘창고 시스템’을 제어한다&lt;/li&gt;
&lt;li&gt;창고에 생긴 문제를 해결하려면 ‘창고 시스템’은 ‘배치 시스템’을 제어하고, ‘배치 시스템’은 주문을 제어한다&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이 경우 시스템이 제공해야 하는 다른 워크플로우의 숫자만큼 곱한다. 이래선 빠르게 결과를 만들어내는 것만 못한 시스템이 나온다..!&lt;/p&gt;
&lt;h1 id=&quot;112-분산-시스템에서-오류-처리하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#112-%EB%B6%84%EC%82%B0-%EC%8B%9C%EC%8A%A4%ED%85%9C%EC%97%90%EC%84%9C-%EC%98%A4%EB%A5%98-%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0&quot; aria-label=&quot;112 분산 시스템에서 오류 처리하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;11.2 분산 시스템에서 오류 처리하기&lt;/h1&gt;
&lt;p&gt;‘모든 것은 망가진다(&lt;em&gt;Things break&lt;/em&gt;)‘는 소프트웨어 엔지니어링에서 일반적인 규칙이다. 어떤 요청이 실패하면 시스템에 어떤 일이 발생하는지 살펴보자.&lt;/p&gt;
&lt;p&gt;예를 들어, 사용자가 &lt;code class=&quot;language-text&quot;&gt;MISBEGOTTEN-RUG&lt;/code&gt; 에 대해 3개를 주문받고 네트워크 오류가 발생했다 가정하자:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.cosmicpython.com/book/images/apwp_1105.png&quot; alt=&quot;오류가 발생한 명령 흐름&quot;&gt;&lt;/p&gt;
&lt;p&gt;이에 대한 두 가지 처리방법이 있다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;주문은 넣지만 할당을 하지 않거나 할당을 보장할 수 없으므로, 최종적으로 주문을 거부한다. 이 실패를 위로 전달한다 → 주문 서비스의 신뢰성에 영향을 끼칠것이다!
&lt;ul&gt;
&lt;li&gt;두 가지를 함께 바꿔야 하는 경우를 결합되었다(&lt;em&gt;coupled&lt;/em&gt;) 라고 한다&lt;/li&gt;
&lt;li&gt;이런 식의 연쇄적 실패는 시간적 결합(&lt;em&gt;temporal coupling&lt;/em&gt;) 이라고 부른다&lt;/li&gt;
&lt;li&gt;시스템의 모든 부분이 동시에 제대로 작동할 때만 정상적으로 작동하는 경우를 시간적 결합이라고 한다&lt;/li&gt;
&lt;li&gt;시스템이 커지면 시스템 부품 중 일부의 성능이 나빠질 확률이 기하급수적으로 높아진다(&lt;em&gt;exponentially incresing probability&lt;/em&gt;)&lt;/li&gt;
&lt;li&gt;아래 동시생산 절을 살펴보자&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;11.3절에서 이에 대한 대안을 작성할 것이다&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;1121-동시생산connascence&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1121-%EB%8F%99%EC%8B%9C%EC%83%9D%EC%82%B0connascence&quot; aria-label=&quot;1121 동시생산connascence permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;11.2.1 동시생산(&lt;em&gt;Connascence&lt;/em&gt;)?&lt;/h2&gt;
&lt;p&gt;본 책에서는 결합(&lt;em&gt;coupling&lt;/em&gt;) 이란 말을 사용하나, 시스템 상 현재 예제와 같은 관계를 동시생산(&lt;em&gt;connascence&lt;/em&gt;)&lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt; 라고도 일컫는다. 이는 다른 유형의 결합을 묘사할 때 사용하는 용어다.&lt;/p&gt;
&lt;p&gt;동시생산은 나쁘지 않다. 그렇지만 어떤 동시생산 케이스는 다른 케이스보다 더 강하다. 보통은 두 클래스가 밀접하게 연관되어(&lt;em&gt;closely related&lt;/em&gt;)있으면 강한 동시생산을 지역적으로만 한정시키고 그렇지 않으면 약한 생산으로 떼어놓고자 한다.&lt;/p&gt;
&lt;p&gt;위에서 살펴본 커맨드 플로우 2 예시에서는 &lt;a href=&quot;https://connascence.io/execution.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;실행의 동시생산&lt;/a&gt;(&lt;em&gt;connascence of execution&lt;/em&gt;)을 살펴볼 수 있다. 연산이 성공하려면 여러 구성요소의 &lt;strong&gt;정확한&lt;/strong&gt; 작업 순서를 알고 있어야 한다.&lt;/p&gt;
&lt;p&gt;여기서는 오류가 발생하는 경우에서는 &lt;a href=&quot;https://connascence.io/timing.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;타이밍의 동시생산&lt;/a&gt;(&lt;em&gt;connascence of timing&lt;/em&gt;)을 살펴볼 수 있다. 한 가지 일이 &lt;strong&gt;일어난 직후 바로 다음&lt;/strong&gt; 일이 일어나야 한다.&lt;/p&gt;
&lt;p&gt;&lt;del&gt;RPC 이야기는 이해못해서 기재하지 않음&lt;/del&gt; 이름의 동시생산(&lt;em&gt;connascence of name&lt;/em&gt;)에 대해 언급한다.&lt;/p&gt;
&lt;p&gt;소프트웨어가 다른 소프트웨어와 통신하지 않는 경우를 제외하고는 &lt;strong&gt;결합을 완전히 피할 수 없다. 다만 부적절한 결합만큼은 피해야 한다.&lt;/strong&gt; 동시생산은 서로 다른 아키텍처 스타일에 내재된 결합의 강도와 유형을 이해하기 위한 멘탈 모델(&lt;em&gt;mental model&lt;/em&gt;)을 제공한다.&lt;/p&gt;
&lt;h1 id=&quot;113-대안-비동기-메시징을-사용한-시간적-결합&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#113-%EB%8C%80%EC%95%88-%EB%B9%84%EB%8F%99%EA%B8%B0-%EB%A9%94%EC%8B%9C%EC%A7%95%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%9C-%EC%8B%9C%EA%B0%84%EC%A0%81-%EA%B2%B0%ED%95%A9&quot; aria-label=&quot;113 대안 비동기 메시징을 사용한 시간적 결합 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;11.3 대안: 비동기 메시징을 사용한 시간적 결합&lt;/h1&gt;
&lt;p&gt;적절한 결합을 얻기 위해선 명사가 아니라 동사로 생각해야 한다는 점을 살펴봤다. 도메인 모델은 비즈니스 프로세스를 모델링하기 위함이다. 도메인 모델은 어떤 물건에 대한 정적인 데이터 모델이 아닌 동사에 관한 모델이다.&lt;/p&gt;
&lt;p&gt;따라서 주문에 대한 시스템과 배치에 대한 시스템을 생각하는 것이 아니라, 주문 행위(&lt;em&gt;ordering&lt;/em&gt;) 에 대한 시스템과 할당행위(&lt;em&gt;allocating&lt;/em&gt;)에 대한 시스템을 생각한다.&lt;/p&gt;
&lt;p&gt;이런 식으로 사물을 구별하면 어떤 시스템이 어떤 일을 하는지에 대해 생각하기 쉽다. 주문 행위에 대해 생각해보면, &lt;strong&gt;주문을 넣었을 때 주문이 들어간다는 무조건 되어야 한다&lt;/strong&gt;. 다른 모든 일은 언젠가 발생한다는 것만 보장할 수 있다면 &lt;strong&gt;나중에&lt;/strong&gt; 발생할 수 있다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;📒 &lt;strong&gt;NOTE&lt;/strong&gt; 📒&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;애그리게이트와 커맨드 설계 시 수행했던 책임 분리가 바로 이것이다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;p&gt;마이크로서비스 또한 &lt;strong&gt;일관성 경계&lt;/strong&gt;(&lt;em&gt;consistency boundaries&lt;/em&gt;)여야 한다. 두 서비스에는 최종 일관성을 받아들일 수 있고, 이는 동기화된 호출에 의존하지 않아도 된다는 뜻이다. 각 서비스는 외부 세게에서 커맨드를 받고 결과를 저장하기 위해 이벤트를 발생시킨다. 이런 이벤트를 수신하는 다른 서비스는 워크플로우의 다음 단계를 트리거링한다.&lt;/p&gt;
&lt;p&gt;이런 식으로 &lt;em&gt;쉽게 복잡해지기 쉬운 구조&lt;/em&gt;&lt;sup id=&quot;fnref-2&quot;&gt;&lt;a href=&quot;#fn-2&quot; class=&quot;footnote-ref&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;를 방지하기 위해 시간적으로 결합된(&lt;em&gt;temporally coupled&lt;/em&gt;) 메시지가 업스트림 시스템으로부터 외부 메시지로 도착하길 바란다. 시스템은 이벤트를 리슨하는 다운스트림 시스템을 위해 &lt;code class=&quot;language-text&quot;&gt;Allocated&lt;/code&gt; 이벤트를 publish한다.&lt;/p&gt;
&lt;p&gt;왜 이런 구조가 더 나은지에 대한 근거는 아래와 같다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;각 부분이 서로 독립적으로 실패할 수 있다. 잘못된 동작이 발생했을 때 처리하기 더 쉽다. 어떤 시스템이 안되더라도 여전히 처리할 수 있기는 하다&lt;/li&gt;
&lt;li&gt;시스템 사이의 결합 강도를 감소시킬 수 있다. 처리 연산순서를 바꾸거나 새 단계를 추가하더라도 이를 지역적으로 처리할 수 있다&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;114-redis의-pubsub-channel을-통합에-사용하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#114-redis%EC%9D%98-pubsub-channel%EC%9D%84-%ED%86%B5%ED%95%A9%EC%97%90-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0&quot; aria-label=&quot;114 redis의 pubsub channel을 통합에 사용하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;11.4 Redis의 Pub/Sub Channel을 통합에 사용하기&lt;/h1&gt;
&lt;p&gt;그렇다면 이를 할 수 있는 메시지 버스가 필요하다. 이는 이벤트를 안팎으로 처리할 수 있는 인프라를 의미한다. 흔히들 &lt;strong&gt;메시지 브로커&lt;/strong&gt;(&lt;em&gt;message broker&lt;/em&gt;) 라고 부른다. 메시지 브로커의 역할은 publisher로부터 메시지를 받아서 subscriber에게 전달&lt;sup id=&quot;fnref-3&quot;&gt;&lt;a href=&quot;#fn-3&quot; class=&quot;footnote-ref&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;(&lt;em&gt;deliver&lt;/em&gt;)하는 것이다.&lt;/p&gt;
&lt;p&gt;made.com(진짜 영국의 가구서비스임)에서는 &lt;a href=&quot;https://www.eventstore.com/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Event Store&lt;/a&gt; 라는 서비스를 쓴다. &lt;a href=&quot;https://kafka.apache.org/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Kafka&lt;/a&gt;나 &lt;a href=&quot;https://www.rabbitmq.com/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;RabbitMQ&lt;/a&gt;도 좋은 대안이다. 책에서는 &lt;a href=&quot;https://redis.io/docs/manual/pubsub/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Redis pub/sub channel&lt;/a&gt;를 사용할 것이다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;📒 &lt;strong&gt;NOTE&lt;/strong&gt; 📒&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;메시징 플랫폼을 선택하는 주요 방안으로는 주로 메시지 순서, 실패 처리, 멱등성(&lt;em&gt;idempotency&lt;/em&gt;) 등이 있다. 이는 14.8절에서 다시 살펴보자!&lt;/p&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;p&gt;그렇다면 새로운 흐름에 대한 시퀀스 다이어그램을 살펴보자. Redis는 전체 프로세스를 시작하는 &lt;code class=&quot;language-text&quot;&gt;BatchQuantityChanged&lt;/code&gt; 를 제공하고, 마지막에는 &lt;code class=&quot;language-text&quot;&gt;Allocated&lt;/code&gt; 이벤트를 Redis에 publish 한다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.cosmicpython.com/book/images/apwp_1106.png&quot; alt=&quot;재할당 흐름의 시퀀스 다이어그램&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;115-엔드투엔드-테스트를-사용하여-모든-기능-시범운영하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#115-%EC%97%94%EB%93%9C%ED%88%AC%EC%97%94%EB%93%9C-%ED%85%8C%EC%8A%A4%ED%8A%B8%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EC%97%AC-%EB%AA%A8%EB%93%A0-%EA%B8%B0%EB%8A%A5-%EC%8B%9C%EB%B2%94%EC%9A%B4%EC%98%81%ED%95%98%EA%B8%B0&quot; aria-label=&quot;115 엔드투엔드 테스트를 사용하여 모든 기능 시범운영하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;11.5 엔드투엔드 테스트를 사용하여 모든 기능 시범운영하기&lt;/h1&gt;
&lt;p&gt;어떤 식으로 수행하는지 살펴보자. API를 사용하여 배치를 만들고, 인바운드-아웃바운드 메시지를 테스트할 것이다&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;여기서 잠깐!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;나는 현재 DB 커넥션도 Dependency Injector를 통해 구현했는데, Redis도 마찬가지일 것이다. &lt;a href=&quot;https://python-dependency-injector.ets-labs.org/examples/fastapi-redis.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이런 예시&lt;/a&gt;를 프로젝트에 맞게 구현할 것이다. 아래 방안을 작성하고자 한다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Redis 커넥션에 대해 깔끔하게 처리하는 방안 모색&lt;/li&gt;
&lt;li&gt;그렇게 처리하면서 동시에 pub/sub을 쓸 수 있는지도 모색&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;p&gt;이 로직을 테스트하기 위해선 아래 테스트코드가 필요하다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mark&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;asyncio&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_change_batch_quantity_leading_to_reallocation&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# 두 배치와 할당을 수행하여 한 쪽에 할당하는 주문으로 시작한다.&lt;/span&gt;
    orderid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; random_orderid&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; random_sku&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    earlier_batch&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; later_batch &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; random_batchref&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;old&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; random_batchref&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;newer&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; post_to_add_batch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; earlier_batch&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; qty&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; eta&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;2023-01-01&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; post_to_add_batch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; later_batch&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; qty&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; eta&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;2023-01-02&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; post_to_allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;client&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; orderid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;json&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;batchref&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; earlier_batch

    subscription &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; redis_client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;subscribe_to&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;line_allocated&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; redis_client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;publish_message&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;                                &lt;span class=&quot;token comment&quot;&gt;# 2)&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;change_batch_quantity&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;batchref&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; earlier_batch&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;qty&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    messages &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; async_timeout&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;timeout&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;                               &lt;span class=&quot;token comment&quot;&gt;# 3)&lt;/span&gt;
        message &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; subscription&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_message&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;timeout&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; message&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            messages&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;append&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;message&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;messages&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;messages&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
    data &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; json&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;loads&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;messages&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;data&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; data&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;order_id&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; orderid
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; data&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;batchref&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; later_batch&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;line_allocated&lt;/code&gt; 라는 채널을 listen 한다.&lt;/li&gt;
&lt;li&gt;외부 서비스가 &lt;code class=&quot;language-text&quot;&gt;change_batch_quantity&lt;/code&gt; 라는 채널에 아래 dict 값을 가진 이벤트를 전송함을 의미한다.&lt;/li&gt;
&lt;li&gt;책에서는 &lt;code class=&quot;language-text&quot;&gt;tenacity&lt;/code&gt; 를 사용해서 3번 정도를 더 수신하도록 기다린다&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;1151-redis는-메시지-버스를-감싸는-다른-얇은-어댑터&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1151-redis%EB%8A%94-%EB%A9%94%EC%8B%9C%EC%A7%80-%EB%B2%84%EC%8A%A4%EB%A5%BC-%EA%B0%90%EC%8B%B8%EB%8A%94-%EB%8B%A4%EB%A5%B8-%EC%96%87%EC%9D%80-%EC%96%B4%EB%8C%91%ED%84%B0&quot; aria-label=&quot;1151 redis는 메시지 버스를 감싸는 다른 얇은 어댑터 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;11.5.1 Redis는 메시지 버스를 감싸는 다른 얇은 어댑터&lt;/h2&gt;
&lt;p&gt;Redis pub/sub 리스너, 혹은 이벤트 소비자(&lt;em&gt;event consumer&lt;/em&gt;)는 외부 서비스로부터 메시지를 받고 변환하여 이를 이벤트로 만든다.&lt;/p&gt;
&lt;p&gt;아래는 Redis메시지 리스너의 간단한 버전이다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    orm&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;start_mappers&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    pubsub &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; r&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pubsub&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ignore_subscribe_messages&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; pubsub&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;subscribe&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;change_batch_quantity&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; m &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; pubsub&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;listen&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; handle_change_batch_quantity&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;m&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;handle_change_batch_quantity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;m&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    logging&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;debug&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;handling %s&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; m&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    data &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; json&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;loads&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;m&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;data&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;                      &lt;span class=&quot;token comment&quot;&gt;# 2)&lt;/span&gt;
    cmd &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; commands&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ChangeBatchQuantity&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ref&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;batchref&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; qty&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;qty&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; messagebus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;cmd&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SqlAlchemyUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; __name__ &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;__main__&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;run&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;main&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;이 어댑터를 구동하며 &lt;code class=&quot;language-text&quot;&gt;change_batch_quantity&lt;/code&gt; 채널을 subscribe 한다&lt;/li&gt;
&lt;li&gt;엔트리포인트에서는 JSON 역직렬화 후 커맨드로 변환하여 서비스 계층으로 메시지를 전달한다. API가 하는일과 동일하다!&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;그렇다면 Redis 이미지 publisher 또한 살펴보자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;publish&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;channel&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; event&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Event&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;       &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;
    logging&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;debug&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;publishing: channel=%s, event=%s&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; channel&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; event&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; r&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;publish&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;channel&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; json&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dumps&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;asdict&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;여기선 하드코딩한 채널을 사용한다. 이벤트 클래스/이름과 적절한 채널을 매핑하는 정보를 저장할 수도 있다. 이러면 메시지 유형 중 일부에 대해 다른 채널을 사용할 수도 있다&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;1152-외부로-나가는-새-이벤트&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1152-%EC%99%B8%EB%B6%80%EB%A1%9C-%EB%82%98%EA%B0%80%EB%8A%94-%EC%83%88-%EC%9D%B4%EB%B2%A4%ED%8A%B8&quot; aria-label=&quot;1152 외부로 나가는 새 이벤트 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;11.5.2 외부로 나가는 새 이벤트&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Allocated&lt;/code&gt; 라는 이벤트를 살펴보자&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@dataclass&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Allocated&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Event&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    orderid&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;
    sku&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;
    qty&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;
    batchref&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이 이벤트로는 주문 라인 상세정보, 어떤 배치에 주문라인이 할당되었는지 등 할당에 대해 알아야 할 필요가 있는 모든 내용을 저장한다.&lt;/p&gt;
&lt;p&gt;이를 모델의 &lt;code class=&quot;language-text&quot;&gt;allocate()&lt;/code&gt; 메소드에 추가한다. 이를 위한 테스트를 함께 추가하자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_product_allocate_should_emit_an_event&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    batch &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Batch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;batch1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;SMALL-FORK&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; eta&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;today&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    product &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Product&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sku&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;SMALL-FORK&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; batches&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;batch&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    allocation &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; product&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;OrderLine&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;order1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;SMALL-FORK&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    expected_event &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Allocated&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        orderid&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;order1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        sku&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;SMALL-FORK&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        qty&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        batchref&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;batch&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;reference&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; product&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;messages&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; expected_event
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; allocation &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;batch1&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이런 류의 테스트가 있어야겠고, &lt;code class=&quot;language-text&quot;&gt;Product&lt;/code&gt; 애그리게이트에는 이벤트 emit하는 로직이 있어야 할 것이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Product&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            sku&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            batches&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; List&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;Batch&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            version_number&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;allocate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            line&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; OrderLine&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
            self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;version_number &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
            self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;messages&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;append&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;              &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;
                events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Allocated&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                    orderid&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;orderid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                    sku&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                    qty&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;qty&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                    batchref&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;batch&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;reference&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; batch&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;reference
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;이런 식으로 &lt;code class=&quot;language-text&quot;&gt;Allocated&lt;/code&gt; 이벤트를 담아야한다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;그 후에는 메시지 버스에도 관련 핸들러를 추가해주고, 이벤트 발행할 때는 레디스 wrapper가 제공하는 헬퍼함수를 쓰자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MessageBus&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    EVENT_HANDLERS &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Allocated&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;handlers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;publish_allocate_event&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;    &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;
        events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;OutOfStock&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;handlers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send_out_of_stock_notification&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# type: Dict[Type[events.Event], List[Callable]]&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;publish_allocate_event&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        event&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Allocated&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        channel&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; redis&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AsyncRedis&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; channel&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;publish&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;line_allocated&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; event&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;              &lt;span class=&quot;token comment&quot;&gt;# 2)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;이런 식으로 핸들러를 추가하고&lt;/li&gt;
&lt;li&gt;wrapper함수는 이렇게 감싸준다&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;레디스 커넥션 처리는 Dependency Injector로 이렇게 했다&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Container&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;containers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;DeclarativeContainer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    __self__ &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; providers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Self&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    config &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; providers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Configuration&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    config&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;from_pydantic&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Settings&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    wiring_config &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; containers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;WiringConfiguration&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;    &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;
        packages&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&quot;pt2.ch11.src.allocation.entrypoints&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    redis_pool &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; providers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Resource&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;                   &lt;span class=&quot;token comment&quot;&gt;# 2)&lt;/span&gt;
        redis&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;init_redis_pool&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        redis_uri&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;config&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;broker&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;REDIS_URI&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    redis &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; providers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Factory&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;                         &lt;span class=&quot;token comment&quot;&gt;# 3)&lt;/span&gt;
        redis&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AsyncRedis&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        session&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;redis_pool&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;하기 팩토리를 사용할 Wiring 대상인 “패키지”의 경로를 기재했다. 아래 소스를 함께 살펴본다&lt;/li&gt;
&lt;li&gt;리소스를 이렇게 만들어줄 수 있다. 이 리소스는 하기 팩토리에 사용된다&lt;/li&gt;
&lt;li&gt;팩토리를 통해 &lt;code class=&quot;language-text&quot;&gt;AsyncRedis&lt;/code&gt; 라는 클래스의 의존성을 주입한다&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AsyncRedis&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            session&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; redis&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Redis&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_session &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; session         &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;publish&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;                  &lt;span class=&quot;token comment&quot;&gt;# 2)&lt;/span&gt;
            self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            channel&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            event&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Event&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;publish&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;channel&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; json&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dumps&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;asdict&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; fastapi &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Depends                                             &lt;span class=&quot;token comment&quot;&gt;# 3)&lt;/span&gt;

&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@app&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;post&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;/allocate&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    status_code&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;status&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;HTTP_201_CREATED&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@inject&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;allocate_endpoint&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        order_line&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; OrderLineRequest&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        channel&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; redis&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AsyncRedis &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Depends&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Provide&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;Container&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;redis&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 3)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
        batchref &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; messagebus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
            channel&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;channel&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@inject&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;signup_user&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        channel&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; redis&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AsyncRedis &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Provide&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;Container&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;cache&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;           &lt;span class=&quot;token comment&quot;&gt;# 4)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; jsonify&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;status&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; cache&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ping&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;상기 세션값은 이런식으로 넣는다&lt;/li&gt;
&lt;li&gt;Wiring을 수행한 측에서는 &lt;code class=&quot;language-text&quot;&gt;redis.publish(channel, event)&lt;/code&gt; 형식으로 사용하면 된다. 이 때 Wiring을 위해 아래 3, 4와 같은 구문을 사용한다&lt;/li&gt;
&lt;li&gt;FastAPI에서는 &lt;code class=&quot;language-text&quot;&gt;from fastapi import Depends&lt;/code&gt; 를 해주고 의존성 주입을 한다&lt;/li&gt;
&lt;li&gt;Flask라면 이런 식으로 의존성 주입을 한다&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;116-내부-이벤트와-외부-이벤트-비교&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#116-%EB%82%B4%EB%B6%80-%EC%9D%B4%EB%B2%A4%ED%8A%B8%EC%99%80-%EC%99%B8%EB%B6%80-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EB%B9%84%EA%B5%90&quot; aria-label=&quot;116 내부 이벤트와 외부 이벤트 비교 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;11.6 내부 이벤트와 외부 이벤트 비교&lt;/h2&gt;
&lt;p&gt;내부 외부 이벤트의 구분이 명확할 필요가 있다. 일부 이벤트는 밖에서 들어오지만, 일부 이벤트는 승격되며 외부에 이벤트를 publish 할 수도 있다. 하지만 모든 이벤트가 외부에 이벤트를 emit하지는 않는다. &lt;a href=&quot;https://io.made.com/blog/2018-04-28-eventsourcing-101.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이벤트 소싱&lt;/a&gt;에 대해서는 저자가 작성한 글을 함께 읽어보자.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;TIP&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;외부로 나가는 이벤트는 검증을 적용하는 것이 중요한 부분에 속한다. Appendix E 도 함께 살펴보자.&lt;/p&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;117-마치며&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#117-%EB%A7%88%EC%B9%98%EB%A9%B0&quot; aria-label=&quot;117 마치며 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;11.7 마치며&lt;/h2&gt;
&lt;p&gt;이벤트는 외부에서 들어올 수도, 외부로 emit할 수도 있다. &lt;code class=&quot;language-text&quot;&gt;publish&lt;/code&gt; 핸들러는 이벤트를 Redis 메시지 채널의 메시지로 변환한다. 이런즉 이벤트를 사용해 외부 세계와 이야기를 나누는 식의 시간적인 결합을 이용하자. 그렇다면 애플리케이션 통합 시 상당한 유연성을 얻을 수 있다. 하지만 흐름이 명시적이지 않고 디버깅이나 변경이 어려워질 수도 있다. 이 말을 누가했냐고? &lt;a href=&quot;https://martinfowler.com/articles/201701-event-driven.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;마틴 파울러가 했다&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;이벤트 기반 마이크로서비스 통합의 트레이드오프를 살펴보자:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;장점&lt;/th&gt;
&lt;th&gt;단점&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;분산된 큰 진흙 공을 피할 수 있다&lt;/td&gt;
&lt;td&gt;전체 정보 흐름을 알아보기 어렵다&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;서비스가 서로 결합되지 않는다. 개별 서비스 변경 및 새 서비스 추가가 쉽다&lt;/td&gt;
&lt;td&gt;일관성은 처리할 필요가 있는 새로운 개념이다&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;(이걸 해결하기 위해 SAGA 패턴이나 이벤트 소싱, CQRS가 있다고 하는데, 더 공부해보자)&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;메시지 신뢰성과 at-least-once(최소 한 번) versus at-most-once(최대 한 번)을 서로 생각해봐야 한다&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;&lt;a href=&quot;https://connascence.io/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Connascence&lt;/a&gt;은 Meilir Page-Jones가 주장한 개념이다.&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-2&quot;&gt;원문에선 Distributed Ball of Mud antipattern 이라고 했다. 이런 설계가 안티패턴임을 시사하는 비꼬기 같은데 이걸 어케 번역함ㅋㅋ&lt;a href=&quot;#fnref-2&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-3&quot;&gt;책에선 ‘배달’ 이란 용어를 쓰는데, 난 이게 더 익숙해서 이렇게 풀거다. 아니면 딜리버라고 바로 말하거나, 영단어를 바로 쓰거나…&lt;a href=&quot;#fnref-3&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[파이썬으로 살펴보는 아키텍처 패턴 (10)]]></title><description><![CDATA[파이썬으로 살펴보는 아키텍처 패턴을 읽고 이해한 내용을 작성합니다. 챕터 10, 커맨드와 커맨드 핸들러에 대한 내용입니다.]]></description><link>https://blog.s3ich4n.me/books/cosmic-python/2023-05-07-pt02-ch10</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/cosmic-python/2023-05-07-pt02-ch10</guid><pubDate>Sun, 07 May 2023 18:41:36 GMT</pubDate><content:encoded>&lt;p&gt;이 내용은 “파이썬으로 살펴보는 아키텍처 패턴” 을 읽고 작성한 내용입니다. 블로그 게시글과, 작성한 코드를 함께 보시면 더욱 좋습니다.&lt;/p&gt;
&lt;p&gt;10장은 해당 코드를 살펴봐주세요. &lt;a href=&quot;https://github.com/s3ich4n/cosmicpython-study/tree/main/pt2/ch10&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;코드 링크&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;10장-커맨드와-커맨드-핸들러&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#10%EC%9E%A5-%EC%BB%A4%EB%A7%A8%EB%93%9C%EC%99%80-%EC%BB%A4%EB%A7%A8%EB%93%9C-%ED%95%B8%EB%93%A4%EB%9F%AC&quot; aria-label=&quot;10장 커맨드와 커맨드 핸들러 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;10장 커맨드와 커맨드 핸들러&lt;/h1&gt;
&lt;p&gt;이전 장에서는 시스템 입력을 표현하기 위해 이벤트를 사용하는 방법을 익혔고, 애플리케이션을 메시지 처리 기계로 바꿨다.&lt;/p&gt;
&lt;p&gt;이를 위해 모든 유스케이스 함수를 이벤트 핸들러로 바꿨다. API는 새 배치 생성 호출을 받으면 &lt;code class=&quot;language-text&quot;&gt;BatchCreated&lt;/code&gt; 이벤트를 만들어서 내부 이벤트처럼 처리한다. 그런데 배치가 생성되지도 않았는데 API를 호출한다? 뭔가 이상하다(라고 하네요?)&lt;/p&gt;
&lt;p&gt;이벤트와 같은 메시지 버스를 다루지만 약간 다른 규칙으로 처리하는 커맨드를 도입하여 이런 사항을 수정한다.&lt;/p&gt;
&lt;h1 id=&quot;101-커맨드와-이벤트&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#101-%EC%BB%A4%EB%A7%A8%EB%93%9C%EC%99%80-%EC%9D%B4%EB%B2%A4%ED%8A%B8&quot; aria-label=&quot;101 커맨드와 이벤트 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;10.1 커맨드와 이벤트&lt;/h1&gt;
&lt;p&gt;이벤트와 마찬가지로 커맨드(&lt;em&gt;command&lt;/em&gt;)도 메시지의 일종이다. 시스템의 한 부분에서 다른 부분으로 전달되는 명령이 커맨드다. 커맨드도 아무 메소드 없는 데이터 구조로 표현하고 이벤트처럼 처리하는데 &lt;strong&gt;그 둘의 차이가 정말 중요하다!&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;커맨드는 한 액터&lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;로부터 다른 구체적인 액터에게 전달된다. 보내는 액터는 받는 액터가 커맨드를 받고 작업을 해주기를 바란다. API 핸들러에 폼을 전달하는 행동은 커맨드를 전달하는 행동과 같다. 그래서 커맨드 이름은 명령형 동사구(&lt;em&gt;imperative mood verb&lt;/em&gt;)다. 예를 들면 아래와 같다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Allocate stock&lt;/li&gt;
&lt;li&gt;Delay shipment&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;커맨드는 의도(&lt;em&gt;intent&lt;/em&gt;)를 잡아낸다. 커맨드는 시스템이 어떤 일을 수행하길 바라는 의도를 드러낸다. 그 결과로 커맨드를 보내는 액터는 커맨드 리시버(&lt;em&gt;reciever&lt;/em&gt;)가 커맨드 처리에 실패했을 때 오류를 돌려받길 바란다.&lt;/p&gt;
&lt;p&gt;이벤트(&lt;em&gt;event&lt;/em&gt;)는 액터가 관심있는 모든 리스너에게 보내는 메시지다. &lt;code class=&quot;language-text&quot;&gt;BatchQuantityChanged&lt;/code&gt; 라는 이벤트를 publish 해도 보내는 쪽(&lt;em&gt;sender&lt;/em&gt;)은 누가 이걸 받는지 모른다. 아래 표는 커맨드와 이벤트의 차이다.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;이벤트&lt;/th&gt;
&lt;th&gt;커맨드&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;이름&lt;/td&gt;
&lt;td&gt;과거형&lt;/td&gt;
&lt;td&gt;명령형&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;오류 처리&lt;/td&gt;
&lt;td&gt;(송신하는 쪽과) 독립적으로 실패함&lt;/td&gt;
&lt;td&gt;(송신하는 쪽에 오류를 돌려주며) 시끄럽게 실패함&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;누구에게&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;보내나?&lt;/td&gt;
&lt;td&gt;모든 리스너&lt;/td&gt;
&lt;td&gt;정해진 수신자&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;현재 어떤 커맨드가 있는지 살펴보자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; dataclasses &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; dataclass

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Command&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;pass&lt;/span&gt;

&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@dataclass&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Allocate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Command&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;               &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;
    order_id&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;
    sku&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;
    qty&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;

&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@dataclass&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;CreateBatch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Command&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;            &lt;span class=&quot;token comment&quot;&gt;# 2)&lt;/span&gt;
    ref&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;
    sku&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;
    qty&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;
    eta&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;

&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@dataclass&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ChangeBatchQuantity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Command&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;    &lt;span class=&quot;token comment&quot;&gt;# 3)&lt;/span&gt;
    ref&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;
    qty&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;AllocationRequired&lt;/code&gt; 이벤트를 대신한다&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;BatchCreated&lt;/code&gt; 이벤트를 대신한다&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;BatchQuantityChanged&lt;/code&gt; 이벤트를 대신한다&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;102-예외-처리-방식의-차이점&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#102-%EC%98%88%EC%99%B8-%EC%B2%98%EB%A6%AC-%EB%B0%A9%EC%8B%9D%EC%9D%98-%EC%B0%A8%EC%9D%B4%EC%A0%90&quot; aria-label=&quot;102 예외 처리 방식의 차이점 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;10.2 예외 처리 방식의 차이점&lt;/h1&gt;
&lt;p&gt;이름, 동사를 바꾸는건 뭐 IDE한테 맡기면 그만이지만 로직을 어떻게 바꿔야하는지(메시지 버스 변경 등)을 살펴보자&lt;/p&gt;
&lt;p&gt;커맨드, 이벤트를 통으로 처리하는 값을 메시지(&lt;code class=&quot;language-text&quot;&gt;Message&lt;/code&gt;)라 정의하고 이를 &lt;code class=&quot;language-text&quot;&gt;Union&lt;/code&gt; 으로 처리하자!&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;Message &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Union&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;commands&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Command&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Event&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;                           &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;handle&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        message&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Message&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;                                                 &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    results &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; deque&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    queue&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; deque&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;Message&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; deque&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;message&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; queue&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        message &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; queue&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;popleft&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;isinstance&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;message&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Event&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; handle_event&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;message&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; queue&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;                       &lt;span class=&quot;token comment&quot;&gt;# 2)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;isinstance&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;message&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; commands&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Command&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; handle_command&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;message&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; queue&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;            &lt;span class=&quot;token comment&quot;&gt;# 3)&lt;/span&gt;
            results&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;append&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;result&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; Exception&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&apos;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;message&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt; was not a Command or Event&apos;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; results&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;메시지라는 값을 만들고, 커맨드/이벤트에 대해 받을 수 있게 해놨다&lt;/li&gt;
&lt;li&gt;이벤트 핸들러에 대해 별도로 분리했다. 진입점도 분리되어있다.&lt;/li&gt;
&lt;li&gt;커맨드 핸들러에 대해 별도로 분리했다. 진입점도 분리되어있다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이벤트 처리 방안은 아래와 같다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;handle_event&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        event&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Event&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        queue&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; deque&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;Message&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; handler &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; MessageBus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;EVENT_HANDLERS&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            logger&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;debug&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&apos;Handling event &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt; with &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;handler&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; handler&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            queue&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;extend&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;collect_new_events&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; Exception &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; ex&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            logger&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;exception&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&apos;Exception handling &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;... detail: &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;ex&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;continue&lt;/span&gt;                                        &lt;span class=&quot;token comment&quot;&gt;# 2)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;한 이벤트를 여러 핸들러가 처리하도록 위임할 수 있는 디스패처로 이벤트가 처리된다&lt;/li&gt;
&lt;li&gt;오류가 생각하면 로그를 남기지만, 오류가 메시지 처리를 방해하지는 못하게 한다&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;커맨드 처리 방안은 아래와 같다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;handle_command&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        command&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; commands&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Command&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        queue&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; deque&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;Message&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    logger&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;debug&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&apos;Handling command &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;command&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        handler &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; MessageBus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;COMMAND_HANDLERS&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;command&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;
        result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; handler&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;command&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        queue&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;extend&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;collect_new_events&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; result                                          &lt;span class=&quot;token comment&quot;&gt;# 3)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; Exception &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; ex&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        logger&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;exception&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&apos;Exception handling &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;command&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;... detail: &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;ex&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt;                                                  &lt;span class=&quot;token comment&quot;&gt;# 2)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;커맨드 디스패처는 커맨드 하나에 핸들러 하나만을 허용한다(헷갈린다면 10.1 에서 내린 정의를 살펴보자!)&lt;/li&gt;
&lt;li&gt;오류가 발생하면 propagate 한다&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;return result&lt;/code&gt; 구문은 임시방편이다(!) 9.2.3절에서 언급한 내용이다. 이 방법은 API가 사용하기 위한 배치 참조를 돌려주기 위한 값이다. 12장에서 수정할 것이다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;메시지 버스를 살펴보자. 두 딕셔너리로 분리한 클래스로 관리한다&lt;sup id=&quot;fnref-2&quot;&gt;&lt;a href=&quot;#fn-2&quot; class=&quot;footnote-ref&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;. 앞서 살펴보았듯 각 이벤트에는 여러 핸들러가 있을 수 있다. 하지만 각 커맨드에는 핸들러가 하나밖에 없다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MessageBus&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    EVENT_HANDLERS &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;                                                 &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;
        events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;OutOfStock&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;handlers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send_out_of_stock_notification&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# type: Dict[Type[events.Event], List[Callable]]&lt;/span&gt;
    COMMAND_HANDLERS &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;                                               &lt;span class=&quot;token comment&quot;&gt;# 2)&lt;/span&gt;
        commands&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Allocate&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; handlers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocate&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        commands&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Deallocate&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; handlers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;deallocate&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        commands&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;CreateBatch&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; handlers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add_batch&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        commands&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ChangeBatchQuantity&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; handlers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;change_batch_quantity&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# type: Dict[Type[commands.Command], Callable]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;이벤트 핸들러의 특징을 살펴보자&lt;/li&gt;
&lt;li&gt;커맨드 핸들러의 특징도 마찬가지다&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;103-논의-이벤트-커맨드-오류-처리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#103-%EB%85%BC%EC%9D%98-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EC%BB%A4%EB%A7%A8%EB%93%9C-%EC%98%A4%EB%A5%98-%EC%B2%98%EB%A6%AC&quot; aria-label=&quot;103 논의 이벤트 커맨드 오류 처리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;10.3 논의: 이벤트, 커맨드, 오류 처리&lt;/h1&gt;
&lt;p&gt;저자는 여기까지 왔을 때의 불편함이나 개선사항을 아래와 같이 말한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;만약 이벤트 처리에 실패하면 어떻게 처리할 것인가?&lt;/li&gt;
&lt;li&gt;시스템이 일관성있는 상태를 유지한다고 어떻게 확신할 수 있나?&lt;/li&gt;
&lt;li&gt;현 구조에서는 메시지 유실이 염려된다. 만일 &lt;code class=&quot;language-text&quot;&gt;MessageBus.handle&lt;/code&gt; 에서 이벤트를 절반만 처리하다가 OOM으로 프로세스가 죽으면 메시지가 사라질것이다. 이 경우는 어떻게 해결해야 할까?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;최악의 경우를 생각해보자. 이벤트 처리에 실패하고 시스템이 일관성을 잃었다. 이로 인해 어떤 오류가 생겼나 살펴보자. 연산 중 일부만 완료된 경우 시스템이 일관성 없는 상태가 될 수 있다.&lt;/p&gt;
&lt;p&gt;요컨대 &lt;code class=&quot;language-text&quot;&gt;DESIRABLE_BEANBAG&lt;/code&gt; &lt;sup id=&quot;fnref-3&quot;&gt;&lt;a href=&quot;#fn-3&quot; class=&quot;footnote-ref&quot;&gt;3&lt;/a&gt;&lt;/sup&gt; 3개를 고객 주문에 할당했지만, 왠진 모르겠으나 현재 재고 감소에 실패했다고 치자. 겉보기엔 재고 세 개가 모두 할당되고 사용 가능한 상태가 되어버린다. 이러면 일관성이 무너진 것이다. 재고 파악을 옳게 못하다가 다른 고객에게 oversell 해버리면?&lt;/p&gt;
&lt;p&gt;다행히도 &lt;code class=&quot;language-text&quot;&gt;Allocate&lt;/code&gt; 서비스에서는 조치를 취해놨다. 애그리게이트를 일관성 경계로 동작하게 해놨고, 애그리게이트에 대한 업데이트 성공/실패를 atomic하게 처리하기 위해 UoW를 설계했다.&lt;/p&gt;
&lt;p&gt;예를 들자면, 주문에 재고를 할당할 때의 consistency boundary는 &lt;code class=&quot;language-text&quot;&gt;Product&lt;/code&gt; 애그리게이트다. 여기서 과할당을 방지할 수 있다. 특정 주문 라인이 제품에 할당하거나, 그렇지 않으면 아예 할당하지 않는다&lt;sup id=&quot;fnref-4&quot;&gt;&lt;a href=&quot;#fn-4&quot; class=&quot;footnote-ref&quot;&gt;4&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;p&gt;그리고 프로젝트 정의에 따르면, 두 애그리게이트는 즉각적으로 일관성을 가질 필요가 없다. 어떤 이벤트를 처리하다 실패해서 애그리게이트 하나만 업데이트 된다고 해도, 시스템은 일관성을 갖춘다. 시스템의 제약 조건을 위반하면 안 된다.&lt;/p&gt;
&lt;p&gt;이런 예제를 통해 메시지를 커맨드와 이벤트로 분리하는 이유에 대해 다시금 생각할 수 있게 되었다. 사용자가 시스템이 어떤 일을 하길 원한다면 이 요청을 &lt;strong&gt;커맨드&lt;/strong&gt;로 표현한다. 커맨드는 한 &lt;strong&gt;애그리게이트&lt;/strong&gt;를 변경해야 하고, 전체적으로 성공하거나 모두 실패해야한다. 시스템이 수행하는 다른 재고처리나 후속조치는 &lt;strong&gt;이벤트&lt;/strong&gt;로 발생시킨다. 커맨드가 성공하기 위해 이벤트 핸들러가 성공할 필요는 없다.&lt;/p&gt;
&lt;p&gt;커맨드가 성공하기 위해 이벤트가 성공하지 않아도 되는 이유를 아래의 다른 예시로 살펴보자.&lt;/p&gt;
&lt;h2 id=&quot;1031-예제-명품을-파는-전자상거래-사이트-설계&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1031-%EC%98%88%EC%A0%9C-%EB%AA%85%ED%92%88%EC%9D%84-%ED%8C%8C%EB%8A%94-%EC%A0%84%EC%9E%90%EC%83%81%EA%B1%B0%EB%9E%98-%EC%82%AC%EC%9D%B4%ED%8A%B8-%EC%84%A4%EA%B3%84&quot; aria-label=&quot;1031 예제 명품을 파는 전자상거래 사이트 설계 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;10.3.1 예제: 명품을 파는 전자상거래 사이트 설계&lt;/h2&gt;
&lt;p&gt;어느 사이트에서 많이 팔아주시는 VIP 고객님을 선정하는 기준을 아래와 같이 정리하고 처리하기로 했다 치자.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;주문 이력이 2개있는&lt;/li&gt;
&lt;li&gt;고객이 3번째 주문을 할 때&lt;/li&gt;
&lt;li&gt;이 고객을 VIP로 선정한다&lt;/li&gt;
&lt;li&gt;처음 VIP로 변경된 고객에게는&lt;/li&gt;
&lt;li&gt;축하 메일을 보낸다&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이걸 애그리게이트 단위로 풀어내면 된다는 뜻이다. 이 애그리게이트를 &lt;code class=&quot;language-text&quot;&gt;History&lt;/code&gt; 라고 하고 예시를 살펴보자. 이 애그리게이트는 주문을 기록하고, 규칙을 만족할 때 도메인 이벤트를 발생시킨다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;History&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            customer_id&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;orders&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Set&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;HistoryEntry&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;customer_id &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; customer_id

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;record_order&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            order_id&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            order_amount&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;
        entry &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; HistoryEntry&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;order_id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; order_amount&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; entry &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;orders&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;

        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;orders&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;entry&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;orders&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;append&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                CustomerBecameVIP&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;customer_id&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;create_order_from_basket&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        cmd&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; CreateOrder&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;    &lt;span class=&quot;token comment&quot;&gt;# 2)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        order &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Order&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;from_basket&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;cmd&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;customer_id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; cmd&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;basket_items&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;orders&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;order&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;commit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# raises OrderCreated&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;update_customer_history&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        event&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; OrderCreated&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;    &lt;span class=&quot;token comment&quot;&gt;# 3)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        history &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;order_history&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;customer_id&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        history&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;record_order&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;order_id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; event&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;order_amount&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;commit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# raises CustomerBecameVIP&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;congratulate_vip_customer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        event&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; CustomerBecameVIP&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;    &lt;span class=&quot;token comment&quot;&gt;# 4)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        customer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;customers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;customer_id&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        email&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            customer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;email_address&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&apos;Congratulations &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;customer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;first_name&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;!&apos;&lt;/span&gt;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;History&lt;/code&gt; 애그리게이트는 고객이 VIP가 되는 규칙을 체크한다. 애그리게이트는 이런 식으로 규칙을 처리하는 좋은 장소임을 캐치하자&lt;/li&gt;
&lt;li&gt;첫 핸들러는 고객 주문을 생성하고 &lt;code class=&quot;language-text&quot;&gt;OrderCreated&lt;/code&gt; 라는 도메인 이벤트를 발생시킨다&lt;/li&gt;
&lt;li&gt;두 번째 핸들러는 만들어진 주문을 기록하기 위해 &lt;code class=&quot;language-text&quot;&gt;History&lt;/code&gt; 를 업데이트한다&lt;/li&gt;
&lt;li&gt;고객에게 VIP가 되었음을 알리는 메일을 전송한다&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;가만보면 이벤트 기반 시스템에서는 오류를 어떻게 처리하는지 볼 수 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;애그리게이트는 상태를 DB에 &lt;strong&gt;영속화한 이후&lt;/strong&gt; 이벤트를 발생시킨다&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;영속화 이전&lt;/strong&gt;에 이벤트 발생 및 변화를 커밋하는건? 그 후에 “동시에” 모든 변화를 커밋하면? 이러면 모든 작업이 완료됐다 할 수 있을텐데 이게 더 낫지 않나?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;하지만 만일 메일 서버가 과부화라면? 모든 작업이 동시에 끝나야되면 ‘메일 전송’ 작업이 다른 작업의 발목이 될 수도 있다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;History&lt;/code&gt; 애그리게이트에 버그가 있다면? 고객을 VIP로 인식하지 못했다고 해서 고객의 결제처리를 하면 안되는건가?&lt;/p&gt;
&lt;p&gt;이런 관심사를 분리하면 실패할 수 있는 요소들이 서로 격리되어 실패하게 할 수 있다. 이 코드에서 성공해야 하는 부분은 주문 생성 커맨드 핸들러 뿐이다. 이 것만이 고객이 신경쓰는 부분이고, 비즈니스 관계자들이 중요하게 생각하는 부분이다.&lt;/p&gt;
&lt;p&gt;트랜잭션 경계를 비즈니스 프로세스 시작과 종료에 맞추어 의도적으로 조정한 것인지 살펴보자. 코드에서 쓰는 이름은 비즈니스 관계자들이 쓰는 언어와 일치하며, 핸들러는 자연어로 작성한 판별 기준과 일치한다. 이름과 구조가 일치하면 시스템이 커지고 복잡해질 때, 시스템을 추론하는 과정에서 상당히 도움된다.&lt;/p&gt;
&lt;h1 id=&quot;104-동기적으로-오류-복구하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#104-%EB%8F%99%EA%B8%B0%EC%A0%81%EC%9C%BC%EB%A1%9C-%EC%98%A4%EB%A5%98-%EB%B3%B5%EA%B5%AC%ED%95%98%EA%B8%B0&quot; aria-label=&quot;104 동기적으로 오류 복구하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;10.4 동기적으로 오류 복구하기&lt;/h1&gt;
&lt;p&gt;위에서 살펴본 바와 같이, 이벤트는 이벤트를 발생시킨 커맨드와 독립적으로 실패해도 좋다. 불필요하게 오류가 발생한 경우 오류를 복구시킬 수 있다고 확신하려면 어떻게 해야할까?&lt;/p&gt;
&lt;p&gt;가장 먼저 해야할 것은 오류가 언제 일어났는지를 파악하는 것이다. 그것 때문에 오류 발생시점의 로그를 찍는 것이었다. &lt;code class=&quot;language-text&quot;&gt;handle_event()&lt;/code&gt; 로직을 다시 살펴보자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;handle_event&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        event&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Event&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        queue&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; deque&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;Message&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; handler &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; MessageBus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;EVENT_HANDLERS&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            logger&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;debug&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&apos;Handling event &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt; with &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;handler&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; handler&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            queue&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;extend&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;collect_new_events&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; Exception &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; ex&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            logger&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;exception&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&apos;Exception handling &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;... detail: &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;ex&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;continue&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;시스템에서 메시지 처리할 때 처음 하는 일은 로그를 찍는 것이다. 위의 &lt;code class=&quot;language-text&quot;&gt;History&lt;/code&gt; 예시를 통해서 다시 참고해보자. &lt;code class=&quot;language-text&quot;&gt;CustomerBecameVIP&lt;/code&gt; 라는 유스케이스의 경우 로그는 아래와 같다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Handling event CustomerBecameVIP(customer_id=12345) with handler &amp;lt;function congratulate_vip_customer at 0x10ebc9a60&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;dataclasses&lt;/code&gt; 를 써서 저런 식으로 데이터를 요약해서 볼 수 있다. 객체를 다시 만들기 위해 이 출력을 복사해 파이썬 shell에 복붙도 할 수 있다.&lt;/p&gt;
&lt;p&gt;오류가 발생하면 로그에 저장된 데이터를 사용해 문제를 유닛테스트로 재현하거나 시스템에서 메시지를 다시 실행할 수 있다.&lt;/p&gt;
&lt;p&gt;이벤트를 다시 처리하기 전에 버그를 수정해야 한다면 수동 재실행이 잘 작동한다. 하지만 시스템은 어쨌거나 백그라운드에서 &lt;strong&gt;일시적인 실패가 일정 수준은 항상 존재&lt;/strong&gt;할 것이다. 이런 실패에는 네트워크의 일시적 문제, DB의 데드락, 배치로 인해 발생하는 일시적 서비스 중단 등이 그것이다.&lt;/p&gt;
&lt;p&gt;이런 경우에는 재시도를 하여 깔끔하게 복구할 수 있다. ‘깔끔하게’ 라는 뜻은 ‘한 번 만에 안 되면 기하급수적으로 증가하는 백오프 기간(&lt;em&gt;exponentially increasing back-off period&lt;/em&gt;) 후에 재시도 한다’를 의미한다.&lt;/p&gt;
&lt;p&gt;동기적으로 재시도하는 코드의 예시를 보자:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; tenacity &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    Retrying&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    RetryError&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    stop_after_attempt&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    wait_exponential&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#(1)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;handle_event&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    event&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Event&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    queue&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; List&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;Message&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; handler &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; EVENT_HANDLERS&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; attempt &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; Retrying&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;#(2)&lt;/span&gt;
                stop&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;stop_after_attempt&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                wait&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;wait_exponential&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;

                &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; attempt&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                    logger&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;debug&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;handling event %s with handler %s&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; event&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; handler&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                    handler&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                    queue&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;extend&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;collect_new_events&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; RetryError &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; retry_failure&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            logger&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;error&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;token string&quot;&gt;&quot;Failed to handle event %s times, giving up!&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                retry_failure&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;last_attempt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;attempt_number
            &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;continue&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/jd/tenacity&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Tenacity&lt;/a&gt;는 파이썬에서 재시도와 관련한 패턴을 구현한 라이브러리다&lt;/li&gt;
&lt;li&gt;여기서는 메시지버스가 &lt;code class=&quot;language-text&quot;&gt;3&lt;/code&gt;번을 기하급수적으로 증가하는 백오프 기간을 두고 재시도한다&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;실패할 수도 있는 연산을 재시도하는 것은 시스템의 회복 탄력성(&lt;em&gt;resilience&lt;/em&gt;)을 향상시키는 최선의 방안일 것이다. 최소한 이렇게라도 해야 작업이 반쯤 끝난 상태로 남지 않게 한다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;‼️ &lt;strong&gt;CAUTION&lt;/strong&gt; ‼️&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;tenacity&lt;/code&gt; 를 쓰는 것과 별개로, 어느 시점에서는 메시지를 처리하려는 시도를 &lt;em&gt;포기&lt;/em&gt; 해야한다.
분산 메시지를 사용해서 &lt;em&gt;반드시&lt;/em&gt; 신뢰할 수 있는 시스템을 만드는 것은 매우 힘든 일이다. 그 부분은 에필로그에서 다시 볼 것이다&lt;/p&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;p&gt;여기서는 &lt;code class=&quot;language-text&quot;&gt;tenacity&lt;/code&gt;를 사용한 비동기 코드의 작업방안에 대해 살펴본다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id=&quot;105-마치며&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#105-%EB%A7%88%EC%B9%98%EB%A9%B0&quot; aria-label=&quot;105 마치며 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;10.5 마치며&lt;/h1&gt;
&lt;p&gt;커맨드, 이벤트 개념을 알아봤다. 시스템이 응답할 수 있는 요청에 이름을 붙이고 자체적인 데이터 구조를 제공하여 명시하는 일에 대해 알게 되었다. 이번 장에서 살펴본 이벤트, 커맨드, 메시지 버스를 통한 처리를 커맨드 핸들러(&lt;em&gt;command handler&lt;/em&gt;) 라고 부르기도 한다.&lt;/p&gt;
&lt;p&gt;아래 표는 커맨드, 이벤트 분리를 적용하기 전 살펴봐야 할 트레이드오프다:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;장점&lt;/th&gt;
&lt;th&gt;단점&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;커맨드와 이벤트를 다른 방식으로 처리하면, 어떤 부분이 반드시 성공해야 하는지, 나중에 정리해도 되는지를 구별하는데 도움이 된다&lt;/td&gt;
&lt;td&gt;커맨드와 이벤트의 의미적 차이가 사람마다 다를 수 있다. 둘 사이의 차이를 구성원 모두가 동의하는 데 시간을 써야할 수도 있다&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;CreateBatch 는 BatchCreated 보다는 의도가 훨씬 명시적이다&lt;/td&gt;
&lt;td&gt;실패를 명확히 구별한다. 프로그램이 깨질 수 있다는 사실을 알고, 실패를 더 작고 격리가능한 단위로 나누기로 결정한다. 이를 통해 시스템 추론이 더 어려워지고 모니터링의 중요성이 대두된다&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;11장에서는 이벤트를 통합 패턴으로 쓰는 법에 대해 알아보자.&lt;/p&gt;
&lt;hr&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;&lt;em&gt;actor&lt;/em&gt; 라고 써져있다. 그런데 DDD에서 쓰는 그 Actor 같기도 해서, 음차해서 쓰는 편이 나을 것으로 판단했다.&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-2&quot;&gt;13장에서 개조할 클래스 형식의 메시지 버스에 대한 일부분이다. 13장 코드를 미리 살펴보면 아예 핸들용 클래스로 따로 떨어져있고, 시스템 구동 시의 부트스트랩에서 의존성을 모두 깔끔하게 처리한다. 지금 한큐에 이해하긴 힘들고, 한번에 느리게 하기보단 차라리 못생긴 모습을 들고가서 추후에 바꾸려고 한다. 이런 방안이야말로 어쨌거나 더 빠르게 문제를 해결하는 방법이니까…&lt;a href=&quot;#fnref-2&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-3&quot;&gt;대충 이런 상품이 있다고 생각해주세요&lt;a href=&quot;#fnref-3&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-4&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Product.allocate()&lt;/code&gt; 은 내부적으로 &lt;code class=&quot;language-text&quot;&gt;Batch.can_allocate()&lt;/code&gt; 로직을 거치기 때문&lt;a href=&quot;#fnref-4&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[파이썬으로 살펴보는 아키텍처 패턴 (9)]]></title><description><![CDATA[파이썬으로 살펴보는 아키텍처 패턴을 읽고 이해한 내용을 작성합니다. 챕터 9, 메시지 버스 톺아보기에 대한 내용입니다.]]></description><link>https://blog.s3ich4n.me/books/cosmic-python/2023-05-06-pt02-ch09</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/cosmic-python/2023-05-06-pt02-ch09</guid><pubDate>Sat, 06 May 2023 04:24:59 GMT</pubDate><content:encoded>&lt;p&gt;이 내용은 “파이썬으로 살펴보는 아키텍처 패턴” 을 읽고 작성한 내용입니다. 블로그 게시글과, 작성한 코드를 함께 보시면 더욱 좋습니다.&lt;/p&gt;
&lt;p&gt;9장은 해당 코드를 살펴봐주세요. &lt;a href=&quot;https://github.com/s3ich4n/cosmicpython-study/tree/main/pt2/ch09&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;코드 링크&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;9장-메시지-버스-톺아보기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#9%EC%9E%A5-%EB%A9%94%EC%8B%9C%EC%A7%80-%EB%B2%84%EC%8A%A4-%ED%86%BA%EC%95%84%EB%B3%B4%EA%B8%B0&quot; aria-label=&quot;9장 메시지 버스 톺아보기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;9장 메시지 버스 톺아보기&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;왜 제목이 이렇냐? Going to town (on sth)가 원래 &lt;a href=&quot;https://dictionary.cambridge.org/dictionary/english/go-to-town-on&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이런 뜻&lt;/a&gt;이더라고…&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;우리말에 좀 딱 맞아 보이는게 저 표현이긴 한데, 글쎄… 처음 쓸 때나 키치했지 지금은 영….&lt;/p&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;p&gt;이벤트를 보다 근본적인 요소로 사용해보자.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.cosmicpython.com/book/images/apwp_0901.png&quot; alt=&quot;기존 레이어를 가진 구조에서&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.cosmicpython.com/book/images/apwp_0902.png&quot; alt=&quot;메시지 버스가 메인이 되는 구조로 변경할 것이다!&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;91-새-아키텍처가-필요한-새로운-요구사항&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#91-%EC%83%88-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98%EA%B0%80-%ED%95%84%EC%9A%94%ED%95%9C-%EC%83%88%EB%A1%9C%EC%9A%B4-%EC%9A%94%EA%B5%AC%EC%82%AC%ED%95%AD&quot; aria-label=&quot;91 새 아키텍처가 필요한 새로운 요구사항 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;9.1 새 아키텍처가 필요한 새로운 요구사항&lt;/h1&gt;
&lt;p&gt;Rich Hickey란 사람은 오랫동안 실행되며 실세계의 처리 과정을 관리하는 &lt;strong&gt;상황에 따른 소프트웨어&lt;/strong&gt;에 대해 이야기했다. 이런 예시로는 창고 관리 시스템, 물류 스케줄러, 급여 시스템 등이 있다.&lt;/p&gt;
&lt;p&gt;이런 소프트웨어는 실세계에서의 예기치 못한 상황으로 인해 작성하기 어렵다. 예를들어 아래와 같은 케이스가 있을 것이다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;재고조사를 하는 동안 몇몇 제품이 손상되었음을 확인했다&lt;/li&gt;
&lt;li&gt;몇몇 물품 배송 시 필요한 문서가 빠져서 몇 주간 세관에 머물러야 했다. 이후 안전검사에 실패하여 폐기처리 되었다&lt;/li&gt;
&lt;li&gt;원재료의 공급 부족으로 인해 특정 배치에 대한 생산이 불가능하게 되었다&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이러한 유형의 상황을 통해 시스템에 있는 배치 수량을 변경해야 한다는 사실을 배웠다. 이벤트 스토밍을 통해 이런 사항을 모델링하면 아래와 같은 그림이 나온다:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.cosmicpython.com/book/images/apwp_0903.png&quot; alt=&quot;배치 수량 변경 시 할당 해제 후 재할당을 해야하는 경우&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;BatchQuantityChanged&lt;/code&gt; 라는 이벤트 발생 시 배치의 수량을 바꿔야 한다. 이와 함께 &lt;strong&gt;비즈니스 규칙&lt;/strong&gt;을 적용해야 한다는 뜻이다. 변경 후 수량이 이미 할당된 수량보다 적어지면, 이런 주문을 배치에서 할당 해제(&lt;em&gt;deallocate&lt;/em&gt;) 해야한다. 이후 각각 새로 할당해야한다. 이를 &lt;code class=&quot;language-text&quot;&gt;AllocationRequired&lt;/code&gt; 라는 이벤트로 표현한다.&lt;/p&gt;
&lt;p&gt;이런 것을 구현할 때 내부 메시지 버스와 이벤트가 도움이 된다! 배치 수량을 조정하고 과도한 주문 라인을 할당 해제하는 &lt;code class=&quot;language-text&quot;&gt;change_batch_quantity&lt;/code&gt; 라는 서비스를 정의하고, 할당 해제가 일어날 때마다 &lt;code class=&quot;language-text&quot;&gt;AllocationRequired&lt;/code&gt; 이벤트를 발생시켜 기존 &lt;code class=&quot;language-text&quot;&gt;allocate&lt;/code&gt; 서비스에 별도의 트랜잭션으로 전달한다. 여기서도 메시지 버스를 사용하면 SRP를 강제할 수 있고, 트랜잭션과 데이터 통합에 관련된 선택을 할 수 있다.&lt;/p&gt;
&lt;h2 id=&quot;911-구조-변경을-상상해보기-모든-것이-이벤트-핸들러다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#911-%EA%B5%AC%EC%A1%B0-%EB%B3%80%EA%B2%BD%EC%9D%84-%EC%83%81%EC%83%81%ED%95%B4%EB%B3%B4%EA%B8%B0-%EB%AA%A8%EB%93%A0-%EA%B2%83%EC%9D%B4-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%ED%95%B8%EB%93%A4%EB%9F%AC%EB%8B%A4&quot; aria-label=&quot;911 구조 변경을 상상해보기 모든 것이 이벤트 핸들러다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;9.1.1 구조 변경을 상상해보기: 모든 것이 이벤트 핸들러다&lt;/h2&gt;
&lt;p&gt;그렇다면 어떤 식으로 수정될지 다시 한 번 살펴보자. 시스템에는 두 가지 종류의 흐름이 있다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;서비스 계층 함수에 의해 처리되는 API 콜&lt;/li&gt;
&lt;li&gt;이벤트
&lt;ol&gt;
&lt;li&gt;내부 이벤트: 서비스 계층 함수의 사이드 이펙트로 발생 가능&lt;/li&gt;
&lt;li&gt;그 이벤트에 대한 핸들러: 서비스 계층 함수를 호출 가능&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;그렇다면, 모든 것이 이벤트 핸들러라면? API 호출을 이벤트 캐치용으로 생각하면, 서비스 게층함수도 이벤트라고 생각할 수 있다(!) 그러면 내부/외부 를 분리할 필요가 없다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;services.allocate()&lt;/code&gt; 는 &lt;code class=&quot;language-text&quot;&gt;AllocationRequired&lt;/code&gt; 이벤트의 핸들러이거나 &lt;code class=&quot;language-text&quot;&gt;Allocate&lt;/code&gt; 이벤트를 출력으로 내보낼 수도 있다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;services.add_batch()&lt;/code&gt; 도 &lt;code class=&quot;language-text&quot;&gt;BatchCreated&lt;/code&gt; 이벤트의 핸들러일 수도 있다&lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;그리고 새로운 요구사항도 같은 패턴에 부합한다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;BatchQuantityChanged&lt;/code&gt; 이벤트는 &lt;code class=&quot;language-text&quot;&gt;change_batch_quantity()&lt;/code&gt; 핸들러를 호출할 수 있다&lt;/li&gt;
&lt;li&gt;새로운 &lt;code class=&quot;language-text&quot;&gt;AllocationRequired&lt;/code&gt; 이벤트가 &lt;code class=&quot;language-text&quot;&gt;services.allocate()&lt;/code&gt; 를 호출하게 할 수 있다. 따라서 API에서 새 할당요청이 들어오는 것과 내부에서 할당 해제에 의해 발생하는 재할당은 개념상 구분되지 않는다(!)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이 정도로 코드가 바뀌는건 매우 공격적이다! 그렇다면 점진적인 방법(&lt;em&gt;Preparatory Refactoring&lt;/em&gt;)을 찾아보자&lt;sup id=&quot;fnref-2&quot;&gt;&lt;a href=&quot;#fn-2&quot; class=&quot;footnote-ref&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;. 이 방법은 “변경하기 쉽게 코드를 준비한다. 그 후 쉬워진 변경을 실제로 수행한다” 정도로 정리할 수 있다. 책에서는 아래와 같은 방안을 제시한다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;서비스 계층을 이벤트 핸들러로 리팩토링. 이벤트가 시스템에 대한 입력을 설명하는 방식이라는 개념에 익숙해질 수 있음. &lt;code class=&quot;language-text&quot;&gt;services.allocate()&lt;/code&gt; 는 &lt;code class=&quot;language-text&quot;&gt;AllocationRequired&lt;/code&gt; 이벤트의 핸들러행&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;BatchQuantityChanged&lt;/code&gt; 이벤트를 시스템에 추가하고 &lt;code class=&quot;language-text&quot;&gt;Allocated&lt;/code&gt; 이벤트가 발생하는지 검사하는 e2e 테스트를 만들 것임&lt;/li&gt;
&lt;li&gt;구현은 아래와 같이…
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;BatchQuantityChanged&lt;/code&gt; 에 대한 새로운 핸들러를 만듬&lt;/li&gt;
&lt;li&gt;이 핸들러 구현은 &lt;code class=&quot;language-text&quot;&gt;AllocationRequired&lt;/code&gt; 이벤트를 발생&lt;/li&gt;
&lt;li&gt;API에서 사용하는 할당 핸들러와 같은 핸들러가 이 &lt;code class=&quot;language-text&quot;&gt;AllocationRequired&lt;/code&gt; 이벤트를 처리함&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이 과정에서 메시지 버스와 UoW를 약간 변경해서 새 이벤트를 메시지 버스에 넣는 책임을 버스 자체로 옮길 것임&lt;/p&gt;
&lt;h1 id=&quot;92-서비스-함수를-메시지-핸들러로-리팩토링하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#92-%EC%84%9C%EB%B9%84%EC%8A%A4-%ED%95%A8%EC%88%98%EB%A5%BC-%EB%A9%94%EC%8B%9C%EC%A7%80-%ED%95%B8%EB%93%A4%EB%9F%AC%EB%A1%9C-%EB%A6%AC%ED%8C%A9%ED%86%A0%EB%A7%81%ED%95%98%EA%B8%B0&quot; aria-label=&quot;92 서비스 함수를 메시지 핸들러로 리팩토링하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;9.2 서비스 함수를 메시지 핸들러로 리팩토링하기&lt;/h1&gt;
&lt;p&gt;이벤트부터 정의하자!&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@dataclass&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;BatchCreated&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Event&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    ref&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;
    sku&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;
    qty&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;
    eta&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Optional&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;date&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;

&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@dataclass&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AllocationRequired&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Event&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    orderid&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;
    sku&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;
    qty&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;그리고 &lt;code class=&quot;language-text&quot;&gt;service.py&lt;/code&gt; 를 &lt;code class=&quot;language-text&quot;&gt;handler.py&lt;/code&gt; 로 개명 후 기존 메시지 핸들러인 &lt;code class=&quot;language-text&quot;&gt;send_out_of_stock_notification&lt;/code&gt; 을 추가한다. 핵심은 모든 핸들러가 동일한 입력(UoW와 이벤트)를 갖도록 바꾸는 것이 핵심이다.&lt;/p&gt;
&lt;p&gt;이러면서 서비스계층의 API를 더 구조화하고 일관성있게 다듬을 수 있다. 원래는 원시타입 값이 여기저기 흩어져 있었지만, 이젠 잘 정의된 객체를 사용한다.&lt;/p&gt;
&lt;h2 id=&quot;도메인-객체에서-기본-타입에-대한-집착을-거쳐-인터페이스로-이벤트를-사용하기-까지&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8F%84%EB%A9%94%EC%9D%B8-%EA%B0%9D%EC%B2%B4%EC%97%90%EC%84%9C-%EA%B8%B0%EB%B3%B8-%ED%83%80%EC%9E%85%EC%97%90-%EB%8C%80%ED%95%9C-%EC%A7%91%EC%B0%A9%EC%9D%84-%EA%B1%B0%EC%B3%90-%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4%EB%A1%9C-%EC%9D%B4%EB%B2%A4%ED%8A%B8%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0-%EA%B9%8C%EC%A7%80&quot; aria-label=&quot;도메인 객체에서 기본 타입에 대한 집착을 거쳐 인터페이스로 이벤트를 사용하기 까지 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;도메인 객체에서 기본 타입에 대한 집착을 거쳐 인터페이스로 이벤트를 사용하기 까지&lt;/h2&gt;
&lt;p&gt;5.5절에서 서비스 계층 API가 도메인 객체에 대해 정의되었다가 갑자기 기본 타입을 썼던 것을 기억하고 있다. 근데 이젠 또 이벤트를 쓴다. 왤케 왔다갔다 하는 것이지?&lt;/p&gt;
&lt;p&gt;OO 사이클에서 사람들은 기본 타입에 대한 집착(&lt;em&gt;primitive obsession&lt;/em&gt;)을 안티패턴으로 간주한다. 공개 API에서 기본타입을 피하고 커스텀 값 클래스로 기본타입 값을 감싸기를 이야기한다.&lt;/p&gt;
&lt;p&gt;파이썬 세계에서는 많은 사람들이 경험상 이에 대해 상당히 회의적이다. 무심코 적용하면 불필요한 복잡성을 초래할 수 있기 때문이다. 그래서 여기서 함수 파라미터를 도메인 객체서 기본 타입으로 바꿨다는 것 자체만으론 복잡도가 추가되는 건 아니다.&lt;/p&gt;
&lt;p&gt;그런 관점에서 파라미터를 도메인 객체가 아니라 기본 타입으로 바꾸면 그 연결을 끊을 수 있다. 도메인에 엮이지도 않고, 모델을 바꿔도 서비스 계층은 API를 바꾸지 않고 예전과 같이 그대로 제공할 수 있다. 반대로 API가 바뀌더라도 모델은 그대로 남겨둘 수 있다.&lt;/p&gt;
&lt;p&gt;그렇다면 이벤트를 도입하는건 맨 처음 염려대로 가는건가? 하지만 핵심 도메인 모델은 여전히 다른 계층과 관계없이 바뀔 수 있다. 이벤트 도입은 외부 세계와 이벤트 클래스를 연결할 뿐이다. 이벤트도 도메인의 일부일 뿐이지만 이벤트는 도메인에 대해 &lt;strong&gt;훨씬 덜 자주 바뀔 것이다&lt;/strong&gt;라고 예측하면 어느정도 타당하다 할 수 있다.&lt;/p&gt;
&lt;p&gt;이벤트를 도입하면 어떤 이득이 있는지 살펴보자:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;애플리케이션의 유스케이스 호출 시 기본타입의 조합을 기억할 필요가 없다 → 애플리케이션 입력을 표현하는 단일 이벤트 클래스를 쓴다&lt;/li&gt;
&lt;li&gt;입력값 검증에 써먹기 아주 좋은 장소다! 아래엔 본인 생각의 단상을 좀 써보겠다:
&lt;ul&gt;
&lt;li&gt;그럼 pydantic으로 된걸 dataclass나 아니면 아예 attrs로 갈아타서 싹 갈아엎는게 나을려나?&lt;/li&gt;
&lt;li&gt;sqlalchemy하고 긴밀하게 쓸 수 있는 게 뭔지부터 살펴보는게 좋을 것 같다. 그러면서 동시에 sqlalchemy 2.0 하고는 뭐가 어울리는지도 확실히 해두자&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;921-메시지-버스는-이제-이벤트를-uow로부터-수집한다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#921-%EB%A9%94%EC%8B%9C%EC%A7%80-%EB%B2%84%EC%8A%A4%EB%8A%94-%EC%9D%B4%EC%A0%9C-%EC%9D%B4%EB%B2%A4%ED%8A%B8%EB%A5%BC-uow%EB%A1%9C%EB%B6%80%ED%84%B0-%EC%88%98%EC%A7%91%ED%95%9C%EB%8B%A4&quot; aria-label=&quot;921 메시지 버스는 이제 이벤트를 uow로부터 수집한다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;9.2.1 메시지 버스는 이제 이벤트를 UoW로부터 수집한다&lt;/h2&gt;
&lt;p&gt;이벤트 핸들러는 이제 UoW가 필요하다. 추가로 애플리케이션에서 메시지 버스는 더 중심 위치를 차지하게 되었다. 메시지 버스가 명시적으로 새 이벤트를 수집하고 처리하도록 하는 것이 더 타당하다. 현재는 UoW와 메시지 버스 사이의 순환적 의존성이 있는데, 이를 단방향으로 떼내자!&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;handle&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        event&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Event&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;           &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    queue &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; deque&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;                                &lt;span class=&quot;token comment&quot;&gt;# 2)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; queue&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        event &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; queue&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pop&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;                            &lt;span class=&quot;token comment&quot;&gt;# 3)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; handler &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; HANDLERS&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;           &lt;span class=&quot;token comment&quot;&gt;# 3)&lt;/span&gt;
            task &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;create_task&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;handler&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; task                                  &lt;span class=&quot;token comment&quot;&gt;# 4)&lt;/span&gt;
            queue&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;extend&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;collect_new_events&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;      &lt;span class=&quot;token comment&quot;&gt;# 5)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;메시지 버스 시작 시 UoW를 받음&lt;/li&gt;
&lt;li&gt;첫 이벤트를 처리할 때 큐를 시작한다&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;큐.pop()&lt;/code&gt; 후 적절한 핸들러에 값을 던진다. &lt;code class=&quot;language-text&quot;&gt;HANDLERS&lt;/code&gt; 딕셔너리는 안바뀌었으니, 알아서 태스크 생성하고 돌 것이다&lt;/li&gt;
&lt;li&gt;메시지 버스는 UoW를 각 핸들러에 전달한다&lt;/li&gt;
&lt;li&gt;핸들러가 끝나면 이벤트 수집 후 이 이벤트를 큐에 추가한다. (&lt;a href=&quot;https://docs.python.org/3/tutorial/datastructures.html#more-on-lists&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;.extend()가 뭐냐&lt;/a&gt;?)&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;맨 앞의 값 꺼내오는데 &lt;code class=&quot;language-text&quot;&gt;[deque](https://docs.python.org/3/library/collections.html#deque-objects)&lt;/code&gt;쓰면 O(1) 만에 나오지 않나? 싶기도 하고, thread-safe 하대서 &lt;code class=&quot;language-text&quot;&gt;deque&lt;/code&gt;로 바꿔써보기로 했다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;그리고 &lt;code class=&quot;language-text&quot;&gt;unit_of_work.py&lt;/code&gt; 에 있는 &lt;code class=&quot;language-text&quot;&gt;publish_events()&lt;/code&gt; 를 &lt;code class=&quot;language-text&quot;&gt;collect_new_events()&lt;/code&gt; 로 바꾼다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;collect_new_events&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; product &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;products&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;seen&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; product&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;events&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt; product&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;popleft&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;커밋이 일어나면 &lt;code class=&quot;language-text&quot;&gt;publish_event&lt;/code&gt; 를 호출하지 않고 이 메시지 버스는 이벤트 대기열을 추적한다&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;deque&lt;/code&gt;니까 popleft로 주면 됨!&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;922-모든-테스트는-이벤트-기반으로-다시-쓸-수-있다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#922-%EB%AA%A8%EB%93%A0-%ED%85%8C%EC%8A%A4%ED%8A%B8%EB%8A%94-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EA%B8%B0%EB%B0%98%EC%9C%BC%EB%A1%9C-%EB%8B%A4%EC%8B%9C-%EC%93%B8-%EC%88%98-%EC%9E%88%EB%8B%A4&quot; aria-label=&quot;922 모든 테스트는 이벤트 기반으로 다시 쓸 수 있다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;9.2.2 모든 테스트는 이벤트 기반으로 다시 쓸 수 있다&lt;/h2&gt;
&lt;p&gt;예시를 살펴보자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;TestAddBatch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mark&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;asyncio&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_add_batch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        uow &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; FakeUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; messagebus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;BatchCreated&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;b1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;CRUNCHY-ARMCHAIR&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; eta&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            uow&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;products&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;CRUNCHY-ARMCHAIR&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;committed

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;TestAllocate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mark&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;asyncio&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_returns_allocation&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        uow &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; FakeUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; messagebus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;BatchCreated&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;batch1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;COMPLICATED-LAMP&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            uow&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        results &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; messagebus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AllocationRequired&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;o1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;COMPLICATED-LAMP&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            uow&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; results&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;popleft&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;batch1&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이런 식으로… 그런데 살펴볼 사항이 몇개 있다!&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;테스트를 핸들로 단위별로 클래스로 감싼다&lt;/li&gt;
&lt;li&gt;서비스를 직접 부르는 것이 아니라, 메시지 버스에 이벤트를 전달하여 핸들러를 사용하도록 한다. 테스트 코드를 작성하며 이 스펙에 익숙해질 수 있다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;923-보기-싫은-임시-땜빵-결과를-반환해야-하는-메시지-버스&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#923-%EB%B3%B4%EA%B8%B0-%EC%8B%AB%EC%9D%80-%EC%9E%84%EC%8B%9C-%EB%95%9C%EB%B9%B5-%EA%B2%B0%EA%B3%BC%EB%A5%BC-%EB%B0%98%ED%99%98%ED%95%B4%EC%95%BC-%ED%95%98%EB%8A%94-%EB%A9%94%EC%8B%9C%EC%A7%80-%EB%B2%84%EC%8A%A4&quot; aria-label=&quot;923 보기 싫은 임시 땜빵 결과를 반환해야 하는 메시지 버스 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;9.2.3 보기 싫은 임시 땜빵: 결과를 반환해야 하는 메시지 버스&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;handle&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        event&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Event&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    results &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; deque&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    queue &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; deque&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; queue&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        event &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; queue&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;popleft&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; handler &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; HANDLERS&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            task &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;create_task&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;handler&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            results&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;append&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; task&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            queue&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;extend&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;collect_new_events&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; results&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이렇게 핸들에 결과가 나오는 이유는 읽기/쓰기 책임이 혼재되어서 그렇다. 12장에서 CQRS를 다루며 다시 살펴보자.&lt;/p&gt;
&lt;h2 id=&quot;924-이벤트로-작동하도록-api-바꾸기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#924-%EC%9D%B4%EB%B2%A4%ED%8A%B8%EB%A1%9C-%EC%9E%91%EB%8F%99%ED%95%98%EB%8F%84%EB%A1%9D-api-%EB%B0%94%EA%BE%B8%EA%B8%B0&quot; aria-label=&quot;924 이벤트로 작동하도록 api 바꾸기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;9.2.4 이벤트로 작동하도록 API 바꾸기&lt;/h2&gt;
&lt;p&gt;서비스를 직접호출하지 않고 이벤트를 인스턴스 후 메시지 버스에 전달하는 방법으로 고친다&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@app&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;post&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;/allocate&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    status_code&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;status&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;HTTP_201_CREATED&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@inject&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;allocate_endpoint&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        order_line&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; OrderLineRequest&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        event &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AllocationRequired&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;      &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;
            orderid&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;order_line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;orderid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            sku&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;order_line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            qty&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;order_line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;qty&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        batchref &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; messagebus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;     &lt;span class=&quot;token comment&quot;&gt;# 2)&lt;/span&gt;
            event&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SqlAlchemyUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;db&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;session_factory&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        batchref &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; batchref&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;popleft&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;OutOfStock&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; handlers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;InvalidSku&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; HTTPException&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            detail&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            status_code&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;status&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;HTTP_400_BAD_REQUEST&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; e

    &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;batchref&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; batchref&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;           &lt;span class=&quot;token comment&quot;&gt;# 3)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;이벤트를 인스턴스화 했다&lt;/li&gt;
&lt;li&gt;메시지 버스에 이벤트를 전달했다&lt;/li&gt;
&lt;li&gt;결과값을 리턴했다&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;여기까지 하면서 애플리케이션을 이벤트 기반으로 수정완료했다!&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;서비스 계층 함수를 모두 이벤트 핸들러로 변경했다&lt;/li&gt;
&lt;li&gt;따라서 서비스 계층 함수 호출과 도메인 모델에서 발생한 내부 이벤트를 처리하기 위한 함수 호출이 동일해졌다&lt;/li&gt;
&lt;li&gt;이벤트는 시스템 입력을 잡아내는 데이터구조로 사용한다. 동시에 내부 작업 덩어리를 전달하기 위한 데이터 구조로도 사용한다&lt;/li&gt;
&lt;li&gt;이것으로 전체 앱은 메시지 처리기 혹은 이벤트 처리기가 되었다. 둘의 차이점은 10장에서 설명한다&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;93-새로운-요구사항-구현하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#93-%EC%83%88%EB%A1%9C%EC%9A%B4-%EC%9A%94%EA%B5%AC%EC%82%AC%ED%95%AD-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0&quot; aria-label=&quot;93 새로운 요구사항 구현하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;9.3 새로운 요구사항 구현하기&lt;/h1&gt;
&lt;p&gt;리팩토링이 끝났으니, 코드가 ‘변경하기 쉽게’ 되었는지 살펴보자. 아래 그림에 맞는 요구사항을 구현해볼 것이다. &lt;code class=&quot;language-text&quot;&gt;BatchQuantityChanged&lt;/code&gt; 라는 신규 이벤트를 만든다. 이를 받아 핸들러에 넘기고, 이 핸들러는 다시 어떤 &lt;code class=&quot;language-text&quot;&gt;AllocationRequired&lt;/code&gt; 라는 이벤트를 발생시킨다. 이는 다시 기존 핸들러에 넘겨져서 재할당을 일으킬 수 있다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.cosmicpython.com/book/images/apwp_0904.png&quot; alt=&quot;어 근데..??? 트랜잭션이 2개 아닌가…?&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;사물을 두 단위의 UoW에 걸쳐 나누면 DB 트랜잭션이 두개 생긴다. 데이터 정합성 문제가 발생한다. 이는 첫 번째 트랜잭션은 끝났지만 두 번째 트랜잭션이 끝나지 않아서 생기는 문제다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;이런 사항에 대해 어떻게 처리할지는 14장에서 살펴본다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;931-새로운-이벤트&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#931-%EC%83%88%EB%A1%9C%EC%9A%B4-%EC%9D%B4%EB%B2%A4%ED%8A%B8&quot; aria-label=&quot;931 새로운 이벤트 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;9.3.1 새로운 이벤트&lt;/h2&gt;
&lt;p&gt;배치 수량의 변경을 알려주는 이벤트는 단순하다. 추가해보자!&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@dataclass&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;BatchQuantityChanged&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Event&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    ref&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;
    qty&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id=&quot;94-새-핸들러-시범운영하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#94-%EC%83%88-%ED%95%B8%EB%93%A4%EB%9F%AC-%EC%8B%9C%EB%B2%94%EC%9A%B4%EC%98%81%ED%95%98%EA%B8%B0&quot; aria-label=&quot;94 새 핸들러 시범운영하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;9.4 새 핸들러 시범운영하기&lt;/h1&gt;
&lt;p&gt;4장에서 배운 교훈을 따르면, ‘high gear’ 를 사용해 일하면서 유닛 테스트를 가장 최상위 수준에서 짤 수 있다.&lt;/p&gt;
&lt;p&gt;이 코드도 마찬가지로 클래스 단위로 감싸자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;TestChangeBatchQuantity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mark&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;asyncio&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_changes_available_quantity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        uow &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; FakeUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; messagebus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;BatchCreated&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;batch1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ADORABLE-SETTEE&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; eta&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            uow&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;batch&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;products&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sku&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;ADORABLE-SETTEE&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;batches
        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; batch&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;available_quantity &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; messagebus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;BatchQuantityChanged&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;batch1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            uow&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; batch&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;available_quantity &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt;       &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;

    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mark&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;asyncio&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_reallocates_if_necessary&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        uow &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; FakeUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        event_history &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
            events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;BatchCreated&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;batch1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;INDIFFERENT-TABLE&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;BatchCreated&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;batch2&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;INDIFFERENT-TABLE&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; today&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AllocationRequired&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;order1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;INDIFFERENT-TABLE&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AllocationRequired&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;order2&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;INDIFFERENT-TABLE&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; e &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; event_history&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; messagebus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;batch1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; batch2&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;products&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sku&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;INDIFFERENT-TABLE&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;batches

        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; batch1&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;available_quantity &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; batch2&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;available_quantity &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; messagebus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;BatchQuantityChanged&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;batch1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;25&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;# order1 혹은 order2 가 할당 해제된다. 25-20이 수량이 된다.&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; batch1&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;available_quantity &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;      &lt;span class=&quot;token comment&quot;&gt;# 2)&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# 다음 배치에서 20을 재할당한다&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; batch2&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;available_quantity &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;30&lt;/span&gt;     &lt;span class=&quot;token comment&quot;&gt;# 2)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;간단한 경우는 수량만 변경하면 된다&lt;/li&gt;
&lt;li&gt;할당된 수량보다 더 작게 수량을 바꾸면 최소 주문 한 개를 할당 해제하고 새로운 배치에 이 주문할당해야 하는 것을 예측한 코드다 → 요구사항이 그렇다면, 테스트코드를 그렇게 짜고 구현하면 된다는 것을 보여주는 것으로 보인다&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;941-구현&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#941-%EA%B5%AC%ED%98%84&quot; aria-label=&quot;941 구현 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;9.4.1 구현&lt;/h2&gt;
&lt;p&gt;그럼 핸들러를 추가하고, 핸들러 관리 딕셔너리에도 추가해주면 될 것이다.&lt;/p&gt;
&lt;p&gt;코드를 살펴보자:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;change_batch_quantity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        event&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;BatchQuantityChanged&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        product &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;products&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_by_batchref&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;batchref&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ref&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; product&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;change_batch_quantity&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ref&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; event&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;qty&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;commit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Repository에 새 쿼리타입이 필요하니, 추가해보자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AbstractRepository&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Protocol&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;                &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get_by_batchref&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; batchref&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; NotImplementedError

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;TrackingRepository&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;                          &lt;span class=&quot;token comment&quot;&gt;# 2)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get_by_batchref&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; batchref&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        product &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_repo&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_by_batchref&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;batchref&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; product&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;seen&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;product&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; product

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SqlAlchemyRepository&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;AbstractRepository&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;    &lt;span class=&quot;token comment&quot;&gt;# 3)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get_by_batchref&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; batchref&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;execute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                    select&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;join&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Batch&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;orm&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;batches&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;c&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;reference &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; batchref&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;scalars&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;one_or_none&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Protocol&lt;/code&gt; 로 구현했다보니 필요한 원형만 기재한다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;TrackingRepository&lt;/code&gt; 로 한 번 감싸서 리포지토리 쿼리와 이벤트 관련 내용을 처리한다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;SqlAlchenyRepository&lt;/code&gt; 에는 실제 쿼리내용을 추가한다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;테스트코드에서 쓰는 &lt;code class=&quot;language-text&quot;&gt;FakeRepository&lt;/code&gt; 도 마찬가지로 갈아준다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;FakeRepository&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;repository&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractRepository&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get_by_batchref&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; batchref&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            p &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; p &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_products &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; b &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; p&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;batches
            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;reference &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; batchref&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;이 유스케이스를 쉽게 구현하기 위해 리포지토리에 쿼리를 추가했다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;쿼리가 단일 애그리게이트를 반환하면 문제없지만, 여러 저장소에 대해 복잡한 쿼리를 하면 다른 설계가 필요할 수 있다. 11장, 14장에서 그런 방안을 살펴볼 것이다.&lt;/p&gt;
&lt;p&gt;예를 들면 이런 쿼리가 될 수 있을 것이다…
&lt;code class=&quot;language-text&quot;&gt;get_most_popular_products&lt;/code&gt; , &lt;code class=&quot;language-text&quot;&gt;find_products_by_order_id&lt;/code&gt; 같은 것들…&lt;/p&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;942-도메인-모델의-새-메소드&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#942-%EB%8F%84%EB%A9%94%EC%9D%B8-%EB%AA%A8%EB%8D%B8%EC%9D%98-%EC%83%88-%EB%A9%94%EC%86%8C%EB%93%9C&quot; aria-label=&quot;942 도메인 모델의 새 메소드 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;9.4.2 도메인 모델의 새 메소드&lt;/h2&gt;
&lt;p&gt;모델에 새 메소드를 추가한다. 이 메소드는 수량을 바꾸자마자 인라인으로 할당을 해제하고 새 이벤트를 publish한다. 기존 &lt;code class=&quot;language-text&quot;&gt;allocate&lt;/code&gt; 함수를 수정하여 이벤트를 publish 하도록 바꾼다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Product&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;change_batch_quantity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; batch_ref&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; qty&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        batch &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_allocation&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;batch_ref&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        batch&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;purchased_quantity &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; qty
        &lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; batch&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;available_quantity &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            line &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; batch&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;deallocate_one&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;append&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AllocationRequired&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                    line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;orderid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                    line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                    line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;qty&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;새 핸들러를 이벤트와 연결함으로 마무리한다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;HANDLERS &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;BatchCreated&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;handlers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add_batch&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;OutOfStock&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;handlers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send_out_of_stock_notification&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AllocationRequired&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;handlers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocate&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;DeallocationRequired&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;handlers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;deallocate&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;BatchQuantityChanged&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;handlers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;change_batch_quantity&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# type: Dict[Type[events.Event], List[Callable]]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;추가완료!&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;95-선택-가짜-메시지-버스와-독립적으로-이벤트-핸들러-단위-테스트-하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#95-%EC%84%A0%ED%83%9D-%EA%B0%80%EC%A7%9C-%EB%A9%94%EC%8B%9C%EC%A7%80-%EB%B2%84%EC%8A%A4%EC%99%80-%EB%8F%85%EB%A6%BD%EC%A0%81%EC%9C%BC%EB%A1%9C-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%ED%95%B8%EB%93%A4%EB%9F%AC-%EB%8B%A8%EC%9C%84-%ED%85%8C%EC%8A%A4%ED%8A%B8-%ED%95%98%EA%B8%B0&quot; aria-label=&quot;95 선택 가짜 메시지 버스와 독립적으로 이벤트 핸들러 단위 테스트 하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;9.5 선택: 가짜 메시지 버스와 독립적으로 이벤트 핸들러 단위 테스트 하기&lt;/h1&gt;
&lt;p&gt;reallocation 워크플로우 테스트는 e2e 테스트라 할 수 있다. 메시지 버스를 쓰고 전체 워크 플로우를 테스트한다. 이 테스트는 실제 메시지 버스를 사용하며, &lt;code class=&quot;language-text&quot;&gt;BatchQuantityChanged&lt;/code&gt; 이벤트 핸들러가 할당 해제를 트리거하고, 자체 핸들러가 처리하는 새로운 &lt;code class=&quot;language-text&quot;&gt;AllocationRequired&lt;/code&gt; 이벤트를 발생(&lt;em&gt;emit)&lt;/em&gt;&lt;sup id=&quot;fnref-3&quot;&gt;&lt;a href=&quot;#fn-3&quot; class=&quot;footnote-ref&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;시키는 전체 플로우를 테스트한다.&lt;/p&gt;
&lt;p&gt;이벤트 체인이 복잡해짐에 따라 독립적으로 일부 핸들러를 테스트하고 싶을 때가 온다. 이 때는 ‘가짜’ 메시지 버스를 사용하면 이런 테스트를 할 수 있다.&lt;/p&gt;
&lt;p&gt;다름 예제에서 &lt;code class=&quot;language-text&quot;&gt;FakeUnitOfWork&lt;/code&gt; 의 &lt;code class=&quot;language-text&quot;&gt;publish_events()&lt;/code&gt; 메소드를 바꾸어서 실제 메시지 버스와 분리할 수 있다. 이 때는 메시지 버스에 넣는게 아니라 발생시킨 이벤트를 리스트(본 예제에서는 &lt;code class=&quot;language-text&quot;&gt;deque&lt;/code&gt;)에 저장한다.&lt;/p&gt;
&lt;p&gt;상세한 내용은 &lt;code class=&quot;language-text&quot;&gt;pt2/ch09&lt;/code&gt;의 코드를 참고하면 된다.&lt;/p&gt;
&lt;h1 id=&quot;96-마치며&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#96-%EB%A7%88%EC%B9%98%EB%A9%B0&quot; aria-label=&quot;96 마치며 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;9.6 마치며&lt;/h1&gt;
&lt;p&gt;시스템을 어떻게 바꿨는지 복습해보자.&lt;/p&gt;
&lt;h2 id=&quot;961-시스템을-어떻게-바꾸었나&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#961-%EC%8B%9C%EC%8A%A4%ED%85%9C%EC%9D%84-%EC%96%B4%EB%96%BB%EA%B2%8C-%EB%B0%94%EA%BE%B8%EC%97%88%EB%82%98&quot; aria-label=&quot;961 시스템을 어떻게 바꾸었나 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;9.6.1 시스템을 어떻게 바꾸었나?&lt;/h2&gt;
&lt;p&gt;이벤트는 시스템 안의 내부 메시지와 입력에 대한 데이터 구조를 정의하는 데이터 클래스다.&lt;/p&gt;
&lt;p&gt;이벤트는 종종 비즈니스 언어로 매우 잘 번역되기 때문에 DDD 관점에서 보면 매우 강력하다(이벤트 스토밍을 꼭 복습하자!).&lt;/p&gt;
&lt;p&gt;핸들러는 이벤트에 반응하는 방법이다. 핸들러는 모델을 호출하거나 외부 서비스를 호출할 수 있다. 원한다면 한 이벤트에 여러 핸들러를 정의할 수도 있다. 또 핸들러는 다른 이벤트를 만들 수도 있다. 이를 통해 핸들러가 수행하는 일의 크기를 세밀하게 조절하여 SRP를 유지할 수도 있다.&lt;/p&gt;
&lt;h2 id=&quot;962-왜-이렇게-바꾸었나&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#962-%EC%99%9C-%EC%9D%B4%EB%A0%87%EA%B2%8C-%EB%B0%94%EA%BE%B8%EC%97%88%EB%82%98&quot; aria-label=&quot;962 왜 이렇게 바꾸었나 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;9.6.2 왜 이렇게 바꾸었나?&lt;/h2&gt;
&lt;p&gt;애플리케이션의 크기가 커지는 속도 보다 복잡도가 증가하는 속도를 느리게 하기 위함이다.&lt;/p&gt;
&lt;p&gt;메시지 버스에 실으면 아키텍처는 복잡해지지만 필요 작업을 수행하기 위해 주요 개념 혹은 아키텍처 추가로 인한 코드 변경이 필요없다.&lt;/p&gt;
&lt;p&gt;수량변경, 할당해제, 새 트랜잭션 시작, 재할당, 외부통지까지 한 번에 다 들어갔지만 아키텍처적으로 봤을 때는 복잡도가 늘어난 것은 아니다. 새 이벤트나 새 핸들러를 추가하고 외부 어댑터(메일전송)까지 추가하더라도 이벤트 기반의 아키텍처의 어디에 속하는지 파악할 수 있다.&lt;/p&gt;
&lt;p&gt;전체 애플리케이션이 메시지 버스인 경우의 트레이드오프를 살펴보자!&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;장점&lt;/th&gt;
&lt;th&gt;단점&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;핸들러와 서비스가 동일 물건이라서 더 단순하다&lt;/td&gt;
&lt;td&gt;웹이라는 관점에서 메시지 버스를 보면 여전히 예측하기 어려운 처리방법이다&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;작업이 언제 끝나는지 예측할 수 없다&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;시스템 입력을 처리하기 좋은 데이터 구조가 있다&lt;/td&gt;
&lt;td&gt;모델 객체와 이벤트 사이에 필드와 구조 중복이 있고, 이에 대한 유지보수가 필요하다. 한쪽에 필드를 추가한다면 다른쪽에 속한 객체에 두 개 이상 필드를 추가해야 한다.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;그리고 &lt;code class=&quot;language-text&quot;&gt;BatchQuantityChanged&lt;/code&gt; 같은 이벤트를 이해하기 위해, 이벤트와 커맨드의 차이부터 살펴볼 것이다.&lt;/p&gt;
&lt;p&gt;10장에서 봅시다.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/questions/31270657/what-does-emit-mean-in-general-computer-science-terms&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://stackoverflow.com/questions/31270657/what-does-emit-mean-in-general-computer-science-terms&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;이런 이벤트 중 몇개는 커맨드같다? 맞다. 그런데 그건 12장에서 다시 살펴보는 걸로…&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-2&quot;&gt;&lt;a href=&quot;https://martinfowler.com/articles/preparatory-refactoring-example.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://martinfowler.com/articles/preparatory-refactoring-example.html&lt;/a&gt;&lt;a href=&quot;#fnref-2&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-3&quot;&gt;왜 &lt;em&gt;emit&lt;/em&gt; 이란 단어를 사용하는지는 해당 링크를 읽어보자. 다른 곳에서도 자주 쓰이는 듯 하니…&lt;a href=&quot;#fnref-3&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[파이썬으로 살펴보는 아키텍처 패턴 (8)]]></title><description><![CDATA[파이썬으로 살펴보는 아키텍처 패턴을 읽고 이해한 내용을 작성합니다. 챕터 8, 애그리게이트와 일관성 경계에 대한 내용입니다.]]></description><link>https://blog.s3ich4n.me/books/cosmic-python/2023-04-17-pt02-ch08</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/cosmic-python/2023-04-17-pt02-ch08</guid><pubDate>Mon, 17 Apr 2023 19:22:59 GMT</pubDate><content:encoded>&lt;p&gt;이 내용은 “파이썬으로 살펴보는 아키텍처 패턴” 을 읽고 작성한 내용입니다. 블로그 게시글과, 작성한 코드를 함께 보시면 더욱 좋습니다.&lt;/p&gt;
&lt;p&gt;8장은 해당 코드를 살펴봐주세요. &lt;a href=&quot;https://github.com/s3ich4n/cosmicpython-study/tree/main/pt2/ch08&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;코드 링크&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;8장-이벤트와-메시지-버스&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#8%EC%9E%A5-%EC%9D%B4%EB%B2%A4%ED%8A%B8%EC%99%80-%EB%A9%94%EC%8B%9C%EC%A7%80-%EB%B2%84%EC%8A%A4&quot; aria-label=&quot;8장 이벤트와 메시지 버스 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;8장 이벤트와 메시지 버스&lt;/h1&gt;
&lt;p&gt;걍 장고같은걸로 빠르게 서비스를 만들고 릴리즈할 수 있는 것 아니었나? 이게 진짜 이 정도로 가치있는 일인가?&lt;/p&gt;
&lt;p&gt;실세계에서는 코드베이스를 더럽히는게 능사가 아니다. 코드베이스를 건드는건 기름때(원문에선 &lt;em&gt;goop&lt;/em&gt;)와 같은 것이다.&lt;/p&gt;
&lt;p&gt;여기서는 “통지관련” 요구사항을 처리한다. 아래와 같은 요구사항을 말한다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;플로우
&lt;ul&gt;
&lt;li&gt;(구매팀에게) 주문 할당이 부족합니다 라고 &lt;strong&gt;통지&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;구매팀이 처리하면 이쪽에 다시 알람을 줄 것&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;이메일 통지 만으로도 충분&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;평범한 요소에 뭔가 끼워넣어야 할 때, 아키텍처가 어떻게 유지되는지 살펴봅시다!&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;간단하고 빠른 방법은? → 이러면 “진흙 공을” 어떻게 만드는지 (안티패턴!)&lt;/li&gt;
&lt;li&gt;도메인 이벤트(Domain event pattern)를 사용하면?
&lt;ol&gt;
&lt;li&gt;위의 부작용을 해결할 수 있나?&lt;/li&gt;
&lt;li&gt;이벤트에 따른 동작을 메시지 버스 패턴으로 수행하는 방안?&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;도메인 이벤트 사용방안
&lt;ol&gt;
&lt;li&gt;이벤트를 메시지 버스에 전달하는 방안&lt;/li&gt;
&lt;li&gt;도메인 이벤트와 메시지 버스를 연결하기 위한 uow 변경방안&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;모두 합치면 대충 이런 그림이 될 거다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;./media/apwp_0801.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;81-지저분해지지-않게-막기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#81-%EC%A7%80%EC%A0%80%EB%B6%84%ED%95%B4%EC%A7%80%EC%A7%80-%EC%95%8A%EA%B2%8C-%EB%A7%89%EA%B8%B0&quot; aria-label=&quot;81 지저분해지지 않게 막기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;8.1. 지저분해지지 않게 막기&lt;/h1&gt;
&lt;p&gt;재고가 없으면 구매팀에게 메일로 통지한다. 같은 요구사항은 핵심 도메인하고는 관련이없다.&lt;/p&gt;
&lt;p&gt;이런건 보통 웹 컨트롤러에 넣을 생각을 한다…&lt;/p&gt;
&lt;h2 id=&quot;811-웹-컨트롤러가-지저분해지는-일을-막자&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#811-%EC%9B%B9-%EC%BB%A8%ED%8A%B8%EB%A1%A4%EB%9F%AC%EA%B0%80-%EC%A7%80%EC%A0%80%EB%B6%84%ED%95%B4%EC%A7%80%EB%8A%94-%EC%9D%BC%EC%9D%84-%EB%A7%89%EC%9E%90&quot; aria-label=&quot;811 웹 컨트롤러가 지저분해지는 일을 막자 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;8.1.1 웹 컨트롤러가 지저분해지는 일을 막자&lt;/h2&gt;
&lt;p&gt;한 번만 변경할거면 이렇게 해도 되지만, 좋은 코드라고 하기는 힘들다.&lt;/p&gt;
&lt;p&gt;이런 모양새가 나올 수도 있다는 뜻&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@app&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;post&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;/allocate&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    status_code&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;status&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;HTTP_201_CREATED&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@inject&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;allocate_endpoint&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        order_line&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; OrderLineRequest&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        batchref &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; services&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            orderid&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;order_line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;orderid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            sku&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;order_line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            qty&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;order_line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;qty&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            uow&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SqlAlchemyUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;db&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;session_factory&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;OutOfStock&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; services&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;InvalidSku&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        send_mail&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&apos;out of stock&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token string&quot;&gt;&apos;stock_admin@made.com&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&apos;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;orderid&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt; - &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; HTTPException&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            detail&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            status_code&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;status&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;HTTP_400_BAD_REQUEST&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; e

    &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;batchref&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; batchref&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;컨트롤러에 이것저것 넣으면 금방 전체가 더러워진다…&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;메일 보내는걸 HTTP 계층이 하는 일은 아니다&lt;/li&gt;
&lt;li&gt;단위테스트도 하기 힘들다&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;812-모델이-지저분해지는-일을-막자&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#812-%EB%AA%A8%EB%8D%B8%EC%9D%B4-%EC%A7%80%EC%A0%80%EB%B6%84%ED%95%B4%EC%A7%80%EB%8A%94-%EC%9D%BC%EC%9D%84-%EB%A7%89%EC%9E%90&quot; aria-label=&quot;812 모델이 지저분해지는 일을 막자 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;8.1.2 모델이 지저분해지는 일을 막자&lt;/h2&gt;
&lt;p&gt;이러면 재고부족의 원인인 모델에 달아야되나?&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;allocate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            line&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; OrderLine&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            batch &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;b &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; b &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;sorted&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;batches&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;can_allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            batch&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;version_number &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; batch&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;reference
        &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; StopIteration&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            email&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send_mail&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;stock_admin@made.com&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&apos;out of stock for &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; OutOfStock&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;Out of stock for sku &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;저자는 이게 더 구리다고 한다. 모델에 인프라구조에 의존하는 모양이기 때문이다. 도메인 모델은 단지 실제 할당할 수 있는 것 보다 더 많은 상품을 할당할 수는 없다’ 라는 규칙에만 집중해야하기 때문이다. 도메인과 연관없지만 이런 식으로 필요한 기능이 &lt;strong&gt;아무데나&lt;/strong&gt; 붙는 것을 ‘코드의 기름때’와 같다고 말한다.&lt;/p&gt;
&lt;p&gt;도메인 모델은 재고가 부족한지만 알면 되고, 통지를 보내는 것은 다른 곳에서 하도록 해야한다. 이런 기능은 켜고끌 수도 있어야 하고, 도메인 모델의 규칙을 바꾸지 않고서도 이메일, 문자 등으로 통지를 보낼 수도 있어야 한다.&lt;/p&gt;
&lt;h2 id=&quot;813-또는-서비스-계층이-지저분해지는-일을-막자&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#813-%EB%98%90%EB%8A%94-%EC%84%9C%EB%B9%84%EC%8A%A4-%EA%B3%84%EC%B8%B5%EC%9D%B4-%EC%A7%80%EC%A0%80%EB%B6%84%ED%95%B4%EC%A7%80%EB%8A%94-%EC%9D%BC%EC%9D%84-%EB%A7%89%EC%9E%90&quot; aria-label=&quot;813 또는 서비스 계층이 지저분해지는 일을 막자 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;8.1.3 …또는 서비스 계층이 지저분해지는 일을 막자&lt;/h2&gt;
&lt;p&gt;‘재고할당 시도 중 할당에 실패하면 메일을 보내야한다’ 는 워크플로우 오케스트레이션이다. 이 동작은 목표를 달성하기 위해 시스템을 따라야하는 단계다.&lt;/p&gt;
&lt;p&gt;그럼 서비스계층에 넣나? 저자는 그것도 아니라고 한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;allocate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        orderid&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        sku&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        qty&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    line &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;OrderLine&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;orderid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; qty&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        product &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;products&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sku&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; product &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; InvalidSku&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&apos;Invalid sku &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            batchref &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; product&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;commit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; batchref
        &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;OutOfStock&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            email&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send_mail&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;stock_admin@made.com&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&apos;out of stock for &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;예외를 잡아내고 또 발생하면 왠지 모르게 마음이 불편하다. 않이 왜이렇게 어려운거여&lt;/p&gt;
&lt;h1 id=&quot;82-단일-책임-원칙&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#82-%EB%8B%A8%EC%9D%BC-%EC%B1%85%EC%9E%84-%EC%9B%90%EC%B9%99&quot; aria-label=&quot;82 단일 책임 원칙 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;8.2 단일 책임 원칙&lt;/h1&gt;
&lt;p&gt;상기 내용들은 단일 책임 원칙(Single Responsibility Principle)에 위배된다&lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;. 여기서 처리하는 유스케이스는 할당이다. 엔드포인트인 서비스나 도메인이름은 &lt;code class=&quot;language-text&quot;&gt;allocate&lt;/code&gt; 이다. &lt;code class=&quot;language-text&quot;&gt;allocate_and_send_mail_if_out_of_stock&lt;/code&gt; 이 아니다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;then&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;and&lt;/code&gt; 이란 단어를 &lt;strong&gt;쓰지 않고&lt;/strong&gt; 함수가 하는 일을 설명할 수 없다면 SRP를 위반하고 있을 가능성이 높다&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;SRP를 다른말로 하면 어떤 클래스를 수정해야 하는 이유가 단 하나만 존재해야한다 라고 설명할 수 있다. 따라서 이메일을 문자메시지로 변경할 때는 &lt;code class=&quot;language-text&quot;&gt;allocate()&lt;/code&gt; 를 바꿀 이유가 없다. 이메일을 문자메시지로 바꾸는데 &lt;code class=&quot;language-text&quot;&gt;allocate()&lt;/code&gt; 를 바꾼다는 말은 &lt;code class=&quot;language-text&quot;&gt;allocate()&lt;/code&gt; 가 상품할당 외에 다른 것도 한다는 뜻이다.&lt;/p&gt;
&lt;p&gt;이러려면 오케스트레이션을 여러 단계로 구분해서 각각의 관심사가 서로 얽히는 일이 없도록 해야 한다&lt;sup id=&quot;fnref-2&quot;&gt;&lt;a href=&quot;#fn-2&quot; class=&quot;footnote-ref&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;. 도메인은 도메인의 일만하고 그 외의 일은 다른 존재에게 부여해야 한다.&lt;/p&gt;
&lt;p&gt;세부구현으로부터 서비스계층을 분리한다. 서비스계층이 통지에 직접 의존하지 않고 추상화에 의존하도록 한다.&lt;/p&gt;
&lt;h1 id=&quot;83-메시지-버스에-타라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#83-%EB%A9%94%EC%8B%9C%EC%A7%80-%EB%B2%84%EC%8A%A4%EC%97%90-%ED%83%80%EB%9D%BC&quot; aria-label=&quot;83 메시지 버스에 타라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;8.3 메시지 버스에 타라!&lt;/h1&gt;
&lt;p&gt;여기서 나오는 패턴은 “도메인 이벤트” 와 “메시지 버스” 다. 이는 구현방법이 여러가지다. 책의 구현 방식을 따라가기 전, 어떤 구현방식이 있는지 살펴보자&lt;/p&gt;
&lt;h2 id=&quot;831-이벤트-기록-모델&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#831-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EA%B8%B0%EB%A1%9D-%EB%AA%A8%EB%8D%B8&quot; aria-label=&quot;831 이벤트 기록 모델 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;8.3.1 이벤트 기록 모델&lt;/h2&gt;
&lt;p&gt;모델은 이메일을 신경쓰지 않고 이벤트 기록을 담당한다. 이벤트는 발생한 일에 대한 사실을 뜻한다. 이벤트에 응답하지 않고 새 연산을 실행하기 위해 메시지 버스를 사용한다.&lt;/p&gt;
&lt;h2 id=&quot;832-이벤트는-간단한-데이터-클래스다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#832-%EC%9D%B4%EB%B2%A4%ED%8A%B8%EB%8A%94-%EA%B0%84%EB%8B%A8%ED%95%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%81%B4%EB%9E%98%EC%8A%A4%EB%8B%A4&quot; aria-label=&quot;832 이벤트는 간단한 데이터 클래스다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;8.3.2 이벤트는 간단한 데이터 클래스다&lt;/h2&gt;
&lt;p&gt;이벤트는 VO에 속한다. 이벤트는 순수 데이터 구조이므로 동작이 없다. 이벤트를 항상 도메인 언어로 이름붙여야 한다. 항상 이벤트를 도메인 모델의 일부로 간주하여야 한다.&lt;/p&gt;
&lt;p&gt;그런 고로 리팩토링을 수행한다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;domain/model.py&lt;/code&gt; , &lt;code class=&quot;language-text&quot;&gt;domain/events.py&lt;/code&gt; 로 분리시키자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; dataclasses &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; dataclass

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Event&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;pass&lt;/span&gt;

&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@dataclass&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OutOfStock&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Event&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 2)&lt;/span&gt;
    sku&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;이벤트 수가 늘어나면 공통 애트리뷰트를 담을 수 있는 부모 클래스가 유용하다. 타입힌팅도 적극도입할 수 있다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;dataclasses&lt;/code&gt; 는 이벤트의 경우에도 유용하다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;833-모델은-이벤트를-발생한다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#833-%EB%AA%A8%EB%8D%B8%EC%9D%80-%EC%9D%B4%EB%B2%A4%ED%8A%B8%EB%A5%BC-%EB%B0%9C%EC%83%9D%ED%95%9C%EB%8B%A4&quot; aria-label=&quot;833 모델은 이벤트를 발생한다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;8.3.3 모델은 이벤트를 발생한다&lt;/h2&gt;
&lt;p&gt;도메인 모델은 발생한 사실을 기록하기 위해 이벤트를 발생시킨다.&lt;/p&gt;
&lt;p&gt;외부에서 볼 땐 어떤식으로 보이는지 테스트코드를 짜서 스펙을 바꿔보자. &lt;code class=&quot;language-text&quot;&gt;Product&lt;/code&gt; 할당 요청 시 할당이 불가능하면 이벤트가 발생해야한다.&lt;/p&gt;
&lt;p&gt;이런 식으로 원하는 기능을 테스트코드로 틀을 잡고…&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_records_out_of_stock_event_if_cannot_allocate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    batch &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Batch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;batch1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;SMALL-FORK&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; eta&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;today&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    product &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Product&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sku&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;SMALL-FORK&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; batches&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;batch&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    product&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;OrderLine&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;order1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;SMALL-FORK&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    allocation &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; product&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;OrderLine&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;order2&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;SMALL-FORK&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; product&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;events&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;OutOfStock&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sku&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;SMALL-FORK&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; allocation &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이벤트를 담는 &lt;code class=&quot;language-text&quot;&gt;events&lt;/code&gt; 라는 리스트를 만들고, 여기에 append 하자. &lt;code class=&quot;language-text&quot;&gt;OutOfStock&lt;/code&gt; 예외는 사용하지 않는다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Product&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            sku&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            batches&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; List&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;Batch&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            version_number&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sku
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;batches &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; batches
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;version_number &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; version_number
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;events &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;    &lt;span class=&quot;token comment&quot;&gt;# type: List[events.Event]&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;allocate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            line&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; OrderLine&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; StopIteration&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;append&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;OutOfStock&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;# raise OutOfStock(f&quot;Out of stock for sku {line.sku}&quot;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;흐름 제어를 위해 예외를 사용한 것을 빼기 위한 시도에 주목!&lt;sup id=&quot;fnref-3&quot;&gt;&lt;a href=&quot;#fn-3&quot; class=&quot;footnote-ref&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;그리고 도메인 이벤트를 구현하고 있다면 도메인에서 동일한 개념을 표현하기 위해 예외발생을 피하는 것이 좋다. 추후 작업단위패턴에서 이벤트 처리 시 이벤트와 예외 동시사용의 문제점을 볼 수 있게 된다. (추론이 빡세짐)&lt;/p&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;834-메시지-버스는-이벤트를-핸들러에-매핑한다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#834-%EB%A9%94%EC%8B%9C%EC%A7%80-%EB%B2%84%EC%8A%A4%EB%8A%94-%EC%9D%B4%EB%B2%A4%ED%8A%B8%EB%A5%BC-%ED%95%B8%EB%93%A4%EB%9F%AC%EC%97%90-%EB%A7%A4%ED%95%91%ED%95%9C%EB%8B%A4&quot; aria-label=&quot;834 메시지 버스는 이벤트를 핸들러에 매핑한다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;8.3.4 메시지 버스는 이벤트를 핸들러에 매핑한다&lt;/h2&gt;
&lt;p&gt;메시지 버스는 “이 이벤트가 발생하면 다음 핸들러 함수를 호출하시오” 라고 말한다. 간단한 pub-sub 시스템이다. 핸들러는 수신된 이벤트를 subscribe 한다. 수신되는 이벤트는 버스에 시스템이 publish 한 것이다. 이 책에서는 딕셔너리로 메시지 버스를 구현한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; asyncio

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; allocation&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;adapters &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; email
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; allocation&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;domain &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; events

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;handle&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Event&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; handler &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; HANDLERS&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        task &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; asyncio&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;create_task&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;handler&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; task

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;send_out_of_stock_notification&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;OutOfStock&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; email&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send_mail&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;stock@made.com&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;Out of stock for &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

HANDLERS &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;OutOfStock&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;send_out_of_stock_notification&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# type: Dict[Type[events.Event], List[Callable]]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;동시성 개념은 아래 Repository들을 적극 참조하여 코드를 작성한 것이다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;Celery와 메시지 버스는 비슷한가?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Celery는 그 자체로 완결적인 작업을 비동기 작업 큐에 넣고 처리하는 것이다.
책에서 말하는 메시지 버스는 아주 다르다.&lt;/p&gt;
&lt;p&gt;작업을 메인 스레드 밖으로 빼야한다는 요구사항이 있더라도 여전히 이벤트 기반의 메타포를 쓸 수 있다. 이를 위해서는 외부 이벤트(&lt;em&gt;external event&lt;/em&gt;)를 쓰는 것이 권장된다. 중앙 집중 스토어에 이벤트를 영속화하는 방법을 구현하면, 다른 컨테이너나 마이크로서비스가 이 중앙 집중 이벤트 스토어를 subscribe 할 수 있다.
그 후에는 한 프로세스나 서비스 내에서 작업 단위별로 책임을 분산하기 위해 이벤트를 사용한다는 개념을 그대로 여러 프로세스에 걸친 이벤트에 적용할 수 있다. 이 때 각 프로세스는 같은 서비스 내 다른 컨테이너이거나 완전히 다른 마이크로서비스일 수도 있다.&lt;/p&gt;
&lt;p&gt;이런 접근방법에 따르면 작업을 분배하기 위한 API는 이벤트 클래스가 되거나 이벤트 클래스에 대한 JSON 표현이 될 수 있다. 이벤트 클래스나 JSON을 작업 분배용 API로 사용하면 작업을 위임할 대상을 폭넓게 고를 수 있다.
예를 들어 작업을 맡을 프로세스가 꼭 파이썬 서비스일 필요가 없다. 하지만 Celery 작업분배 API는 근본적으로 ‘함수 이름과 인수’ 로 이루어지며, 이는 좀 더 제한적이고 파이썬 안에서만 통하는 방식이다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;84-첫-번째-선택지&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#84-%EC%B2%AB-%EB%B2%88%EC%A7%B8-%EC%84%A0%ED%83%9D%EC%A7%80&quot; aria-label=&quot;84 첫 번째 선택지 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;8.4 첫 번째 선택지&lt;/h1&gt;
&lt;p&gt;서비스 계층이 모델에서 이벤트를 가져와 메시지 버스에 싣는 방안.&lt;/p&gt;
&lt;p&gt;도메인 모델이 이벤트를 발생시키고 메시지 버스는 이벤트가 발생하면 적절한 핸들러를 호출한다. 이 둘을 연결해야한다. 모델에서 이벤트를 찾고 메시지 버스에 실어주는 publishing 단계를 실행할 것을 넣어야 한다.&lt;/p&gt;
&lt;p&gt;첫 번째 방안은 서비스 계층에 코드를 약간 더 넣는 것이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;allocate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        orderid&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        sku&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        qty&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    line &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;OrderLine&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;orderid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; qty&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        product &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;products&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sku&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; product &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; InvalidSku&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&apos;Invalid sku &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;
            batchref &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; product&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;commit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; batchref
        &lt;span class=&quot;token keyword&quot;&gt;finally&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;
            messagebus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;product&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;events&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# 2)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;몬생긴 try/finally 는 그대로고 &lt;code class=&quot;language-text&quot;&gt;OutOfStock&lt;/code&gt; &lt;strong&gt;예외만&lt;/strong&gt; 뺐다.&lt;/li&gt;
&lt;li&gt;서비스 계층은 이메일 인프라에 직접 의존하지는 않고 모델에서 받은 이벤트를 직접 메시지 버스에 올리는 일만 담당한다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이 정도만 해도 바람직하지 않은 부분을 상당히 없앨 수는 있다!&lt;/p&gt;
&lt;p&gt;서비스 계층이 명시적으로 이벤트를 받아 통합한 다음 메시지 버스에 전달하는 여러 시스템을 가지게 된다.&lt;/p&gt;
&lt;h1 id=&quot;85-두-번째-선택지&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#85-%EB%91%90-%EB%B2%88%EC%A7%B8-%EC%84%A0%ED%83%9D%EC%A7%80&quot; aria-label=&quot;85 두 번째 선택지 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;8.5 두 번째 선택지&lt;/h1&gt;
&lt;p&gt;서비스 계층은 자신만의 이벤트를 발생한다&lt;/p&gt;
&lt;p&gt;서비스 계층이 도메인 모델에서 발생한 이벤트를 처리하기보다 직접 이벤트를 만들고 발생시키는 일을 책임지는 방안도 있다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;allocate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        orderid&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        sku&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        qty&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    line &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;OrderLine&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;orderid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; qty&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        product &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;products&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sku&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; product &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; InvalidSku&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&apos;Invalid sku &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        batchref &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; product&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;commit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; batchref &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            messagebus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;OutOfStock&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; batchref&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;할당에 실패해도 커밋은 한다. 이러면 코드가 더 단순해지고 코드 추론이 더 쉬워진다. ‘잘못되지 않으면 무조건 커밋된다’ 라는 전제가 있으니 코드를 안전하고 깔끔하게 유지할 수 있다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;프로젝트의 여러 요소 간 상충관계에 따라 더 나은 방안도 있을 수 있다. 세 번째 선택지는 저자의 생각에 가장 우아한 해법이다.&lt;/p&gt;
&lt;h1 id=&quot;86-세-번째-선택지&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#86-%EC%84%B8-%EB%B2%88%EC%A7%B8-%EC%84%A0%ED%83%9D%EC%A7%80&quot; aria-label=&quot;86 세 번째 선택지 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;8.6 세 번째 선택지&lt;/h1&gt;
&lt;p&gt;UoW가 메시지 버스에 이벤트를 publish&lt;/p&gt;
&lt;h2 id=&quot;861-원래-전채-본문&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#861-%EC%9B%90%EB%9E%98-%EC%A0%84%EC%B1%84-%EB%B3%B8%EB%AC%B8&quot; aria-label=&quot;861 원래 전채 본문 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;8.6.1 원래 전채 본문&lt;/h2&gt;
&lt;p&gt;UoW에는 이미 &lt;code class=&quot;language-text&quot;&gt;try/finally&lt;/code&gt; 구문이 있다. UoW는 저장소에 대한 접근을 제공하므로 어떤 애그리게이트가 작업을 수행하는지도 알고있다. 그러므로 UoW는 이벤트를 찾아서 메시지 버스에 전달하기 좋은 곳이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AbstractUnitOfWork&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;abc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ABC&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;commit&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_commit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;    &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;publish_events&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# 2)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;publish_events&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; product &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;products&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;seen&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# 3)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; product&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;events&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                event &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; product&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pop&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; messagebus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handle&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@abc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;abstractmethod&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;_commit&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;    &lt;span class=&quot;token comment&quot;&gt;# 1)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; NotImplementedError

    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@abc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;abstractmethod&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;rollback&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; NotImplementedError&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;커밋 메소드를 바꾼다. 하위 클래스가 제공하는 비공개 &lt;code class=&quot;language-text&quot;&gt;_commit()&lt;/code&gt; 을 호출한다&lt;/li&gt;
&lt;li&gt;커밋 후 저장소에 전달된 모든 객체를 살펴보고 그 중 이벤트를 메시지 버스에 전달한다&lt;/li&gt;
&lt;li&gt;2의 기능은 저장소가 새 어트리뷰트인 &lt;code class=&quot;language-text&quot;&gt;.seen&lt;/code&gt; 을 통해 로딩된 모든 애그리게이트를 추적하는 것에 의존한다. 이를 아래에서 자세히 살펴보자.&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;핸들러 중 어느 하나가 실패하는 경우에 대한 예외처리는 10장에서 다시 보자.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;이어서 코드를 보자:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AbstractRepository&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;abc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ABC&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;seen &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# type: Set[model.Product] (1)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; product&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# (2)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;product&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;seen&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;product&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;     &lt;span class=&quot;token comment&quot;&gt;# (3)&lt;/span&gt;
        product &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; product&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;seen&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;product&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; product

    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@abc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;abstractmethod&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;_add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; product&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# (2)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; NotImplementedError

    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@abc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;abstractmethod&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;_get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;    &lt;span class=&quot;token comment&quot;&gt;# (3)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; NotImplementedError

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SqlAlchemyRepository&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;AbstractRepository&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; AsyncSession&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token builtin&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__init__&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;session &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; session

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;_add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; product&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# (2)&lt;/span&gt;
        &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot; Batch 객체를 Persistent store에 저장한다.

        sqlalchemy의 add를 호출해서 그런가?

        &quot;&quot;&quot;&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;product&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;_get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# (3)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;execute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                    select&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;options&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;selectinload&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;batches&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;scalars&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;one_or_none&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;UoW 가 새 이벤트를 publish하려면 저장소에 요청하여 이번 세션에 어떤 Product 객체를 쓴 것인지 알아야 한다. 여기서는 &lt;code class=&quot;language-text&quot;&gt;.seen&lt;/code&gt; 이라는 &lt;code class=&quot;language-text&quot;&gt;Set&lt;/code&gt;을 통해 사용한 Product 객체를 저장한다. 구현을 위해 &lt;code class=&quot;language-text&quot;&gt;super().__init__&lt;/code&gt; 을 호출해야한다는 뜻이다&lt;/li&gt;
&lt;li&gt;부모의 &lt;code class=&quot;language-text&quot;&gt;add()&lt;/code&gt; 메소드는 &lt;code class=&quot;language-text&quot;&gt;.seen&lt;/code&gt; 에 객체를 저장한다. 하위 클래스는 &lt;code class=&quot;language-text&quot;&gt;_add()&lt;/code&gt; 를 구현해야 한다&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;get()&lt;/code&gt; 도 마찬가지로 &lt;code class=&quot;language-text&quot;&gt;_get()&lt;/code&gt; 에 동작을 위임한다. 하위 클래스는 &lt;code class=&quot;language-text&quot;&gt;_get()&lt;/code&gt; 을 구현하여 자신이 살펴본 객체를 저장해야 한다.&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;underscore(&lt;code class=&quot;language-text&quot;&gt;_&lt;/code&gt;)로 시작하는 메소드와 하위 클래스를 쓰는 것 말고도 여러 방안이 있다. 책에서 소개하는 두 방안은 아래와 같다&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;별도 클래스를 빼서 Wrapper 클래스로 구현하기&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://peps.python.org/pep-0544/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Protocol&lt;/a&gt; 을 써서 &lt;em&gt;Composition over Inheritance&lt;/em&gt; 를 구현하기&lt;sup id=&quot;fnref-4&quot;&gt;&lt;a href=&quot;#fn-4&quot; class=&quot;footnote-ref&quot;&gt;4&lt;/a&gt;&lt;/sup&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;p&gt;3번 방안으로 구현하면 알아서 살아있는 객체를 추적하고, 그로부터 발생한 이벤트를 처리하도록 하면 서비스 계층은 이벤트 처리와 전혀 무관하게 된다.&lt;/p&gt;
&lt;p&gt;그러면 서비스 계층을 테스트할 때 쓰던 가짜객체도 손봐줘야 할 것이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;FakeRepository&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;repository&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractRepository&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            products&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token builtin&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__init__&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_products &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;products&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;_add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; products&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_products&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;products&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;_get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;b &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; b &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_products &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;FakeUnitOfWork&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;products &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; FakeRepository&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;committed &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;_commit&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;committed &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;… 이런 식으로 &lt;code class=&quot;language-text&quot;&gt;super().__init__&lt;/code&gt; 및 &lt;code class=&quot;language-text&quot;&gt;_add()&lt;/code&gt; 사용, &lt;code class=&quot;language-text&quot;&gt;_get()&lt;/code&gt; 사용, &lt;code class=&quot;language-text&quot;&gt;_commit()&lt;/code&gt; 사용 등.&lt;/p&gt;
&lt;h3 id=&quot;862-연습문제&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#862-%EC%97%B0%EC%8A%B5%EB%AC%B8%EC%A0%9C&quot; aria-label=&quot;862 연습문제 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;8.6.2 연습문제&lt;/h3&gt;
&lt;p&gt;지금이야 코드도 짧고 예시에 가까운 것들이니 귀찮다 싶겠지만, 프로그램의 확장성을 공부한다는 차원에서 이 글도 보면 좋다.&lt;/p&gt;
&lt;p&gt;코드에는 &lt;code class=&quot;language-text&quot;&gt;Protocol&lt;/code&gt; 과 &lt;code class=&quot;language-text&quot;&gt;TrackingRepository&lt;/code&gt; 로 감싸는 두 접근법을 모두 취할 것이다.&lt;/p&gt;
&lt;p&gt;객체지향 관점에서 좋은 접근방안에 대해 소개한 글이 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://python-patterns.guide/gang-of-four/composition-over-inheritance/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;The Composition Over Inheritance Principle&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://realpython.com/inheritance-composition-python/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Inheritance and Composition: A Python OOP Guide&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;그렇다면 composition over inheritance 구현 방안은 어떻게 짤 수 있을까?&lt;/p&gt;
&lt;p&gt;이런 식으로 테스트용 UoW를 처리한다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;FakeUnitOfWork&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;products &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; repository&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;TrackingRepository&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;FakeRepository&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;committed &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;_commit&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;committed &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;_rollback&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;pass&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이런 식으로 감싼다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;TrackingRepository&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    seen &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Set&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; repo&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; AbstractRepository&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_repo &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; repo
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;seen &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# type: Set[model.Product]&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; product&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_repo&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;product&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;seen&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;product&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Sku&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        product &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_repo&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; product&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;seen&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;product&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; product

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; List&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_repo&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;그 다음 사용할 때는 이런 식으로 처리한다. 테스트를 돌려보면서 점검해보자!&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SqlAlchemyUnitOfWork&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;AbstractUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; session_factory&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;session_factory &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; session_factory

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__aenter__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;session&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; AsyncSession &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_session_factory&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;products &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; repository&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;TrackingRepository&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            repository&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SqlAlchemyRepository&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;session&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__enter__&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__aexit__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; exc_type&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; exc_val&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; exc_tb&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__aexit__&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;exc_type&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; exc_val&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; exc_tb&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;close&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id=&quot;87-마무리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#87-%EB%A7%88%EB%AC%B4%EB%A6%AC&quot; aria-label=&quot;87 마무리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;8.7 마무리&lt;/h1&gt;
&lt;h2 id=&quot;871-본문&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#871-%EB%B3%B8%EB%AC%B8&quot; aria-label=&quot;871 본문 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;8.7.1 본문&lt;/h2&gt;
&lt;p&gt;도메인 이벤트는 시스템에서 워크플로우를 다루는 또 다른 방안이다. X일 때 Y한다 라는 이벤트(아마 기억상 Policy 로 표현할 수 있는) 것을 코드로 풀어내는 방안이 이런 것이다 하는 것을 알게 되었다. 이벤트를 일급 시민인 요소로 다루면 코드를 보다 테스트하기 좋으면서도 관심사 분리에 도움되게 작성할 수 있다.&lt;/p&gt;
&lt;p&gt;이벤트에 대한 장단점을 알아보자!&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;장점&lt;/th&gt;
&lt;th&gt;단점&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;메시지 버스를 쓰면 어떤 요청에 대한 응답으로 여러 동작을 수행하는 경우에 대한 관심사 분리가 깔끔해진다&lt;/td&gt;
&lt;td&gt;UoW 내에서 알아서 처리되게 하는게 깔끔하긴 한데 명확하게 이해하기는 솔직히 어렵다. 비즈니스 로직에 따라서는 commit 의 명확한 시점 분리가 불분명하다&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;이벤트 핸들러는 ‘핵심’ 애플리케이션 로직과 완전히 분리될 수 있다. 추후 이벤트 핸들로 구현을 쉽게 변경할 수도 있다&lt;/td&gt;
&lt;td&gt;감춰진 이벤트 처리 코드가 동기적으로 실행된다. 비동기 처리를 하면 그거대로 더 골아파진다. (본인이 참조해서 작성한 코드에서는 asyncio 의 태스크 gather로 풀던데…)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;실 세계를 모델링하기 아주 좋은 방법이다. 이를 비즈니스 언어의 일부분으로 쓸 수 있다&lt;/td&gt;
&lt;td&gt;일반적으로는 이벤트 기반 워크플로우는 연속적으로 여러 핸들러로 분할된 후 시스템에서 요청을 어떻게 처리하는지 살펴볼 수 있는 단일지점이 없다. 이는 혼란을 야기할 수 있다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;더 나아가 이벤트 핸들러가 서로를 의존해서 무한루프가 생기면…?&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;애그리게이트 및 일관성 보장을 위한 bounded context가 필요함을 배웠다. 그렇다면 어떤 요청을 처리하기 위해 여러 애그리게이트를 변경해야 한다면 이벤트를 쓰면 될 것이다.&lt;/p&gt;
&lt;p&gt;트랜잭션으로 서로 격리된 두 요소가 있다면, 이벤트를 통해 최종 일관성(&lt;em&gt;eventually consistent&lt;/em&gt;)을 갖추도록 할 수 있다. 어떤 주문이 취소되면, 이 주문에 할당된 상품을 찾고 할당을 없애는 식으로…&lt;/p&gt;
&lt;h2 id=&quot;872-도메인-이벤트와-메시지-버스-돌아보기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#872-%EB%8F%84%EB%A9%94%EC%9D%B8-%EC%9D%B4%EB%B2%A4%ED%8A%B8%EC%99%80-%EB%A9%94%EC%8B%9C%EC%A7%80-%EB%B2%84%EC%8A%A4-%EB%8F%8C%EC%95%84%EB%B3%B4%EA%B8%B0&quot; aria-label=&quot;872 도메인 이벤트와 메시지 버스 돌아보기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;8.7.2 도메인 이벤트와 메시지 버스 돌아보기&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;이벤트는 단일 책임 원칙을 지키도록 돕는다
&lt;ol&gt;
&lt;li&gt;한 곳에 여러 관심사를 처리하는 것을 피하자!&lt;/li&gt;
&lt;li&gt;이벤트를 사용해서 메인 유스케이스와 서브 유스케이스를 분리시키자&lt;/li&gt;
&lt;li&gt;이벤트를 사용해 애그리게이트 끼리 통신하게 하자. 대해 잠기는 장기 실행 트랜잭션을 실행할 필요가 없도록 하자&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;메시지 버스는 메시지를 핸들러에게 연결한다
&lt;ol&gt;
&lt;li&gt;메시지 버스를 이벤트와 이벤트 consumer를 연결하는 딕셔너리로 생각할 수 있다&lt;/li&gt;
&lt;li&gt;메시지 버스는 이벤트의 의미를 전혀 모른다. 단순한 메시지 전달용 인프라일 뿐이다&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;첫 번째 구현방안: 서비스 계층이 이벤트를 발생시키고 메시지 버스에 전달
&lt;ol&gt;
&lt;li&gt;작업 단위 커밋 후 &lt;code class=&quot;language-text&quot;&gt;bus.handle(신규이벤트)&lt;/code&gt; 호출하기&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;두 번째 구현방안: 도메인 모델이 이벤트를 발생시키고, 서비스 계층이 메시지 버스에 이벤트를 전달
&lt;ol&gt;
&lt;li&gt;도메인 모델에서 이벤트 발생하게 하기&lt;/li&gt;
&lt;li&gt;모델이 &lt;code class=&quot;language-text&quot;&gt;commit&lt;/code&gt; 후 핸들러가 이벤트를 찾아서 이벤트 버스에 싣도록 하기&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;세 번째 구현방안: UoW가 애그리게이트에서 이벤트를 수집 후 메시지 버스에 전달
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;bus.handle(aggregate.events)&lt;/code&gt; 를 모든 핸들러에 추가하는건 귀찮으므로, 메모리에 적재한 객체들이 발새시킨 이벤트를 UoW 가 발생하도록 시스템을 간결하게 풀기&lt;/li&gt;
&lt;li&gt;하고나면 코드가 간단해짐. 다만 ORM에 의존적이긴 함&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;p&gt;&lt;a href=&quot;https://softwareengineering.stackexchange.com/questions/189222/are-exceptions-as-control-flow-considered-a-serious-antipattern-if-so-why&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;링크 1&lt;/a&gt;, &lt;a href=&quot;https://stackoverflow.com/questions/855759/what-is-the-intended-use-of-the-optional-else-clause-of-the-try-statement-in&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;링크 2&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://python-patterns.guide/gang-of-four/composition-over-inheritance/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;링크 1&lt;/a&gt;, &lt;a href=&quot;https://realpython.com/inheritance-composition-python/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;링크 2&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;SOLID 원칙의 &lt;code class=&quot;language-text&quot;&gt;S&lt;/code&gt;를 의미한다.&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-2&quot;&gt;명령형에서 이벤트 기반 흐름 제어로 바꾸면 오케스트레이션이 안무로 바뀌게된다고 말한다.&lt;a href=&quot;#fnref-2&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-3&quot;&gt;아래 두 링크를 보고, 파이썬이든 뭐든 &lt;code class=&quot;language-text&quot;&gt;try/catch&lt;/code&gt; 구문을 극혐하고 빼야한다라고 생각하는 근거를 읽어보자.&lt;a href=&quot;#fnref-3&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-4&quot;&gt;아래 두 아티클이 굉장히 도움될 것이다&lt;a href=&quot;#fnref-4&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[파이썬으로 살펴보는 아키텍처 패턴 (7)]]></title><description><![CDATA[파이썬으로 살펴보는 아키텍처 패턴을 읽고 이해한 내용을 작성합니다. 챕터 7, 애그리게이트와 일관성 경계에 대한 내용입니다.]]></description><link>https://blog.s3ich4n.me/books/cosmic-python/2023-04-17-pt01-ch07</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/cosmic-python/2023-04-17-pt01-ch07</guid><pubDate>Mon, 17 Apr 2023 19:22:59 GMT</pubDate><content:encoded>&lt;p&gt;이 내용은 “파이썬으로 살펴보는 아키텍처 패턴” 을 읽고 작성한 내용입니다. 블로그 게시글과, 작성한 코드를 함께 보시면 더욱 좋습니다.&lt;/p&gt;
&lt;p&gt;7장은 해당 코드를 살펴봐주세요. &lt;a href=&quot;https://github.com/s3ich4n/cosmicpython-study/tree/main/pt1/ch07&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;코드 링크&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;7장-애그리게이트와-일관성-경계&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#7%EC%9E%A5-%EC%95%A0%EA%B7%B8%EB%A6%AC%EA%B2%8C%EC%9D%B4%ED%8A%B8%EC%99%80-%EC%9D%BC%EA%B4%80%EC%84%B1-%EA%B2%BD%EA%B3%84&quot; aria-label=&quot;7장 애그리게이트와 일관성 경계 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;7장 애그리게이트와 일관성 경계&lt;/h1&gt;
&lt;p&gt;도메인 모델을 보면서 불변조건, 제약에 대해 다시 살펴보고 도메인 모델 객체가 개념적으로나 영속적 저장소 안에서나 내부적인 일관성을 유지하는 방법을 살펴본다&lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;p&gt;일관성 경계(consistency boundary)를 설명하며, 이를 통해 어떻게 유지보수 편의를 해치지 않으면서 고성능 소프트웨어를 만들 수 있게 도와주는지 살펴보자.&lt;/p&gt;
&lt;p&gt;애그리게이트가 추가되면 도메인을 이런식으로 표현할 수 있게 된다&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.cosmicpython.com/book/images/apwp_0701.png&quot; alt=&quot;https://www.cosmicpython.com/book/images/apwp_0701.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;71-모든-것을-스프레드시트에서-처리하지-않는-이유&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#71-%EB%AA%A8%EB%93%A0-%EA%B2%83%EC%9D%84-%EC%8A%A4%ED%94%84%EB%A0%88%EB%93%9C%EC%8B%9C%ED%8A%B8%EC%97%90%EC%84%9C-%EC%B2%98%EB%A6%AC%ED%95%98%EC%A7%80-%EC%95%8A%EB%8A%94-%EC%9D%B4%EC%9C%A0&quot; aria-label=&quot;71 모든 것을 스프레드시트에서 처리하지 않는 이유 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;7.1 모든 것을 스프레드시트에서 처리하지 않는 이유&lt;/h1&gt;
&lt;p&gt;도메인 모델의 요즘은 무엇일까? 이걸로 얻는 근본적인 이득이 뭘까?&lt;/p&gt;
&lt;p&gt;걍 스프레드시트로 다 하면 안되나? 어차피 사용자들은 하나로 다 되는거 엄청 좋아하는데.&lt;/p&gt;
&lt;p&gt;많은 수의 기업운영이 CSV over SMTP 수준의 아키텍처에서 걍 머물러있다. 역으로 말하면 딱 그정도의 회사들이 버글버글하단 이야기다. 일단 잘되고 좋은데 일관성이 없어서 확장이 안된다.&lt;/p&gt;
&lt;p&gt;예를 들어…&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;특정 필드는 누구만 볼 수 있도록 설정되어있는가?
&lt;ul&gt;
&lt;li&gt;누가 그 ‘누구’를 변경할 수 있는가?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;의자를 -350개 주문하거나 식탁을 10M개 주문할 수 있나?&lt;/li&gt;
&lt;li&gt;직원의 월급이 음수가 될 수 있나?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이런 건 일어나서도 안 된다. 도메인 로직은 이런 제약사항을 강제로 지키게 해서 시스템이 만족하는 불변조건을 유지하려는 목적으로 작성된다. 불변조건(*invariants)*은 어떤 연산을 끝낼 때 마다 항상 참이어야 하는 요소를 의미한다.&lt;/p&gt;
&lt;h1 id=&quot;72-불변조건-제약-일관성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#72-%EB%B6%88%EB%B3%80%EC%A1%B0%EA%B1%B4-%EC%A0%9C%EC%95%BD-%EC%9D%BC%EA%B4%80%EC%84%B1&quot; aria-label=&quot;72 불변조건 제약 일관성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;7.2 불변조건, 제약, 일관성&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;제약(constraint): 모델이 취할 수 있는 상태의 수를 제한&lt;/li&gt;
&lt;li&gt;불변조건(invariants): 항상 참이어야 하는 조건&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;E.g., 호텔 예약 시스템을 작성한다면 중복 예약을 허용하지 않는 &lt;em&gt;&lt;strong&gt;제약&lt;/strong&gt;&lt;/em&gt;이 있을 수 있다. 이 제약은 한 객실에 예약 한 개만 있을 수 있다는 &lt;em&gt;&lt;strong&gt;불변조건&lt;/strong&gt;&lt;/em&gt;을 지원한다.&lt;/p&gt;
&lt;p&gt;경우에 따라 규칙을 일시적으로 완화(&lt;em&gt;bend&lt;/em&gt;)해야할 수도 있다. VIP가 예약하면 VIP의 숙박 기간과 위치에 맞춰 주변의 방 예약을 섞어야 할 수도 있다.&lt;/p&gt;
&lt;p&gt;메모리상에서 예약을 섞는 동안 한 곳에 예약이 2개 이상 발생할 수도 있지만, 도메인 모델은 작업이 완료되면 불변성이 충족되는 최종 일관된 상태가 되도록 보장해야 한다. 모든 고객이 만족하는 방안을 못찾고 연산이 끝나면 안 되고 오류를 발생시켜야 한다.&lt;/p&gt;
&lt;p&gt;다시 예시로 돌아가보자. 이 요구사항부터 시작해보자.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;주문 라인은 한번에 한 배치에만 할당될 수 있다&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;이런 규칙은 불변조건을 만드는 비즈니스 규칙이다. 불변조건은 주문 라인이 &lt;code class=&quot;language-text&quot;&gt;0&lt;/code&gt;또는 &lt;code class=&quot;language-text&quot;&gt;1&lt;/code&gt;개의 배치에만 할당될 수 있고, &lt;code class=&quot;language-text&quot;&gt;2&lt;/code&gt; 개 이상의 배치에 할당될 수는 없다는 것이다. 코드가 실수로 같은 라인에 대해 &lt;code class=&quot;language-text&quot;&gt;Batch.allocate()&lt;/code&gt; 를 두 가지 다른 배치에 호출하는 일이 없도록 해야한다. 현재까지의 코드에선 그런 명시적인 코드는 없다.&lt;/p&gt;
&lt;h2 id=&quot;721-불변조건-동시성-락&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#721-%EB%B6%88%EB%B3%80%EC%A1%B0%EA%B1%B4-%EB%8F%99%EC%8B%9C%EC%84%B1-%EB%9D%BD&quot; aria-label=&quot;721 불변조건 동시성 락 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;7.2.1 불변조건, 동시성, 락&lt;/h2&gt;
&lt;p&gt;비즈니스 로직의 다른 요구사항을 살펴보자&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;주문 라인 수량보다 더 작은 배치에 라인을 할당할 수는 없다&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;여기서의 제약조건은 배치에 있는 재고보다 많은 재고를 라인에 할당할 수 없다는 것이다. 이로 인해 두 고객에게 제품을 재고보다 더 많이 파는 일은 발생할 수 없다. 이 제약을 불변조건으로 바구면 가용 재고 수량이 &lt;code class=&quot;language-text&quot;&gt;0&lt;/code&gt;이상이어야 한다는 조건이 된다&lt;sup id=&quot;fnref-2&quot;&gt;&lt;a href=&quot;#fn-2&quot; class=&quot;footnote-ref&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;.  시스템 상태를 업데이트 할 때마다 코드는 이런 불변조건을 어기지 않는지 확인해야 한다.&lt;/p&gt;
&lt;p&gt;동시성(&lt;em&gt;concurrency&lt;/em&gt;)를 도입하면 더 복잡해진다. 갑자기 재고를 여러 주문 라인에 동시에 할당할 수 있게 된다. 심지어 배치 변경과 동시에 주문라인을 할당할 수도 있다.&lt;/p&gt;
&lt;p&gt;보통은 DB 테이블에 lock을 걸어서 해결한다. 두 연산이 동시에 일어나는 것을 방지하기 위함이다.&lt;/p&gt;
&lt;p&gt;앱의 규모확장을 생각하면 모든 배치에 라인을 할당하는 모델은 규모를 키우기 어렵다는 사실을 깨닫는다(내 생각엔 이게 핵심 포인트다. 도메인을 알고 있다면/논의하다보면 이런 추론을 할 수 있어야 한다). 시간당 수만 건의 주문과 수십만 건의 주문 라인을 처리하려면 전체 테이블의 각 row에 lock을 거는 것 만으로는 안 된다. 이러면 데드락 상태에 빠질 수 있다.&lt;/p&gt;
&lt;h1 id=&quot;73-aggregate-이란&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#73-aggregate-%EC%9D%B4%EB%9E%80&quot; aria-label=&quot;73 aggregate 이란 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;7.3 Aggregate 이란?&lt;/h1&gt;
&lt;p&gt;주문 라인을 할당하고 싶을 때마다 DB에 lock을 걸 수 없다면 어떻게 해야할까? 시스템의 불변조건을 보호하면서 동시성을 최대한 살리고 싶다. 불변조건을 유지하려면 불가피하게 동시 쓰기를 막아야 한다. 여러 사용자가 &lt;code class=&quot;language-text&quot;&gt;DEADLY-SPOON&lt;/code&gt; 을 동시에 할당할 수 있다면 과할당이 이루어질 위험이 생긴다.&lt;/p&gt;
&lt;p&gt;반면, &lt;code class=&quot;language-text&quot;&gt;DEADLY-SPOON&lt;/code&gt; 과 &lt;code class=&quot;language-text&quot;&gt;FLIMSY-DESK&lt;/code&gt; 를 동시에 할당할 수 없는 이유는 없다. 두 제품에 동시에 적용되는 불변조건이 없기 때문이다. 즉 서로 다른 두 제품에 대한 할당 사이에 일관성이 있을 이유는 없다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;애그리게이트&lt;/strong&gt;(Aggregate) 패턴은 이런 긴장을 해소하기 위한 설계 패턴이다. 애그리게이트는 다른 도메인 객체를 &lt;strong&gt;포함&lt;/strong&gt;하며 이 객체 컬렉션 전체를 한꺼번에 다룰 수 있게 해주는 도메인 객체다.&lt;/p&gt;
&lt;p&gt;애그리게이트에 있는 객체를 변경하는 유일한 방법은 애그리게이트와 그 안의 객체 전체를 불러와서 애그리게이트 자체에 대해 메소드를 호출하는 것이다.&lt;/p&gt;
&lt;p&gt;모델이 점점 복잡해지고 엔티티와 VO가 늘어나면서 각각에 대한 참조가 얽히고설킨 그래프가 된다. 따라서 누가 어떤 객체를 변경할 수 있는지 추적하기 어려워진다. 특히 모델안에 &lt;strong&gt;컬렉션&lt;/strong&gt;이 있으면 어떤 엔티티를 선정해서 그 엔티티와 관련된 모든 객체를 변경할 수 있는 단일 진입점으로 삼으면 좋다&lt;sup id=&quot;fnref-3&quot;&gt;&lt;a href=&quot;#fn-3&quot; class=&quot;footnote-ref&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;. 이러면 시스템이 개념적으로 더 간단해지고 어떤 객체가 다른 객체의 일관성을 책임지게 하면 시스템에 대해 추론하기 쉬워진다.&lt;/p&gt;
&lt;p&gt;쇼핑몰 설계를 예로 들어보자. 장바구니(&lt;em&gt;cart&lt;/em&gt;)는 좋은 애그리게이트가 된다. 장바구니는 한 단위로 다뤄야 하는 상품들로 이루어진 &lt;strong&gt;컬렉션&lt;/strong&gt;이다. 중요한 점은 데이터 스토어에서 전체 장바구니를 단일 blob으로 읽어오고 싶다는 점이다. 동시에 장바구니 변경을 위해 요청을 두번 보내고 싶지도 않고 이상한 동시성 오류를 발생하게 하고싶지도 않다. 대신 장바구니에 대한 모든 변경을 단일 DB 트랜잭션으로 묶고싶다.&lt;/p&gt;
&lt;p&gt;하지만 여러 고객의 장바구니를 동시에 바꾸는 유스케이스는 없다. 여러 장바구니를 한 트랜잭션 안에서 바꾸고 싶진 않다. 따라서 각 장바구니는 자신만의 불변조건을 유지할 책임을 담당하는 한 &lt;strong&gt;동시성 경계&lt;/strong&gt;다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;애그리게이트는 데이터 변경이라는 목적을 위해 한 단위로 취급할 수 있는 연관된 객체의 묶음이다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Eric Evans, 도메인 주도 설계(위키북스, 2011)&lt;/p&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;p&gt;Evans에 따르면, 애그리게이트에는 원소에 대한 접근을 캡슐화한 루트 엔티티(장바구니) 가 있다. 원소마다 고유한 정체성이 있지만, 시스템의 나머지 부분은 장바구니를 나눌 수 없는 단일 객체처럼 참고해야 한다.&lt;/p&gt;
&lt;h1 id=&quot;74-애그리게이트-선택&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#74-%EC%95%A0%EA%B7%B8%EB%A6%AC%EA%B2%8C%EC%9D%B4%ED%8A%B8-%EC%84%A0%ED%83%9D&quot; aria-label=&quot;74 애그리게이트 선택 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;7.4 애그리게이트 선택&lt;/h1&gt;
&lt;p&gt;그렇다면 시스템에 어떤 애그리게이트를 써야할까? 내 생각엔 좋은 설계를 위해선 이걸 잘 정해야 한다고 본다. 애그리게이트는 모든 연산이 일관성 있는 상태에서 끝난다는 점을 보장하는 경계가 되기 때문이다. 이러한 사실은 소프트웨어에 대해 추론하고 이상한 경합지점을 방지할 수 있게 해준다. 서로 일관성이 있어야 하는 소수의 객체 주변에 경계를 설정하고자 한다. 성능을 위해선 경계가 더 작을 수록 좋다. 이런 경계에는 좋은 이름을 부여해주는 것 또한 필요하다.&lt;/p&gt;
&lt;p&gt;애그리게이트 내부에서 다뤄야 하는 객체는 &lt;code class=&quot;language-text&quot;&gt;Batch&lt;/code&gt; 이다. 이 컬렉션을 뭐라고 부르는게 좋을까? 어떻게 시스템의 모든 배치를 내부에서 일관성이 보장되는 다른 섬들로 나눌 수 있을까?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;shipment?
&lt;ul&gt;
&lt;li&gt;선적엔 여러 배치가 들어갈 수 있다&lt;/li&gt;
&lt;li&gt;모든 배치는 창고로 전달된다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;warehouse?
&lt;ul&gt;
&lt;li&gt;각 창고에는 여러 배치가 들어있다&lt;/li&gt;
&lt;li&gt;모든 재고수량을 동시에 파악할 수도 있다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;그런데 두 상품이 같은 창고에 있거나 같은 선적에 포함되어있어도 동시할당이 된다. 아까 위에서 이렇게 파악했다:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;DEADLY-SPOON&lt;/code&gt; 과 &lt;code class=&quot;language-text&quot;&gt;FLIMSY-DESK&lt;/code&gt; 를 동시에 할당할 수 없는 이유는 없다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;그런고로 상기 둘은 경계로 두긴 어렵다.&lt;/p&gt;
&lt;p&gt;주문 라인을 할당할 때는 주문 라인으로 같은 &lt;code class=&quot;language-text&quot;&gt;SKU&lt;/code&gt; 에 속하는 배치에만 관심이 있다. 글로벌한 SKU stock 같은 개념이 필요하다. &lt;code class=&quot;language-text&quot;&gt;GlobalSkuStock&lt;/code&gt; 으로 할까? 근데 저자는 저 이름이 너무 촌스러워서 &lt;code class=&quot;language-text&quot;&gt;Product&lt;/code&gt; 로 하기로 했다&lt;sup id=&quot;fnref-4&quot;&gt;&lt;a href=&quot;#fn-4&quot; class=&quot;footnote-ref&quot;&gt;4&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;p&gt;기존에는, 주문 라인을 할당하고 싶으면 모든 &lt;code class=&quot;language-text&quot;&gt;Batch&lt;/code&gt; 객체를 살펴보고 이들을 &lt;code class=&quot;language-text&quot;&gt;allocate()&lt;/code&gt; 도메인 서비스에 전달했다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.cosmicpython.com/book/images/apwp_0702.png&quot; alt=&quot;도메인 서비스를 사용해 모든 배치를 할당&quot;&gt;&lt;/p&gt;
&lt;p&gt;앞으로는 &lt;code class=&quot;language-text&quot;&gt;Product&lt;/code&gt; 객체한테 일임할 것이다. 이 객체는 주문 라인에서 특정 SKU를 표현한다. Product 객체는 &lt;strong&gt;자신이 담당하는 SKU&lt;/strong&gt;에 대한 &lt;strong&gt;모든 배치&lt;/strong&gt;를 담당한다. &lt;code class=&quot;language-text&quot;&gt;allocate()&lt;/code&gt; 메소드를 &lt;code class=&quot;language-text&quot;&gt;Product&lt;/code&gt;에 대해 호출하도록 열어둘 것이다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.cosmicpython.com/book/images/apwp_0703.png&quot; alt=&quot;Product 를 추가. 이 객체가 관리하는 배치를 할당해달라고 요청&quot;&gt;&lt;/p&gt;
&lt;p&gt;코드를 보자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Product&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; batches&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; List&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;Batch&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sku  &lt;span class=&quot;token comment&quot;&gt;#(1)&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;batches &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; batches  &lt;span class=&quot;token comment&quot;&gt;#(2)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;allocate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; line&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; OrderLine&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;#(3)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            batch &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;b &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; b &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;sorted&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;batches&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;can_allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            batch&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; batch&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;reference
        &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; StopIteration&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; OutOfStock&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;Out of stock for sku &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Product&lt;/code&gt;의 주요 식별자는 &lt;code class=&quot;language-text&quot;&gt;sku&lt;/code&gt; 다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Product&lt;/code&gt;클래스는 sku에 해당하는 &lt;code class=&quot;language-text&quot;&gt;batches&lt;/code&gt; 컬렉션 참조를 유지한다&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;allocate()&lt;/code&gt; 도메인 서비스를 이 애그리게이트가 제공한다.&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Product&lt;/code&gt; 는 통상 우리가 생각하는 &lt;code class=&quot;language-text&quot;&gt;Product&lt;/code&gt; 하고 좀 다르다… 가격도 없고 설명도 없고 크기도 없고…&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;하지만 현재 서비스에서는 그런 걸 고민할 필요가 없다. 이게 제한된 컨텍스트(이하 Bounded Context)의 강점이다. Bounded Context 상에서는 한 앱의 &lt;code class=&quot;language-text&quot;&gt;Product&lt;/code&gt; 개념이 다른 앱에서의 &lt;code class=&quot;language-text&quot;&gt;Product&lt;/code&gt; 와 완전히 다를 수 있다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;aggregates-bounded-contexts-and-microservices&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#aggregates-bounded-contexts-and-microservices&quot; aria-label=&quot;aggregates bounded contexts and microservices permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Aggregates, Bounded Contexts and Microservices&lt;/h2&gt;
&lt;h3 id=&quot;개념-소개-및-전개&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B0%9C%EB%85%90-%EC%86%8C%EA%B0%9C-%EB%B0%8F-%EC%A0%84%EA%B0%9C&quot; aria-label=&quot;개념 소개 및 전개 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;개념 소개 및 전개&lt;/h3&gt;
&lt;p&gt;이 개념은 근본적으로 전체 비즈니스를 한 모델에 넣으려는 시도에 대한 반응이었다. “고객” 이라는 컨텍스트를 가지고 이해해보자.&lt;/p&gt;
&lt;p&gt;“고객” 이란 단어도 각 분야별 사람들에겐 각자 다른 의미를 가진다(판매상에서의 고객, CS에서의 고객, 배송에서의 고객, 지원에서의 고객 등). 그러니 각 “고객”의 속성이나 의미는 분야(컨텍스트)가 달라지면 완전히 다른게 되어버림을 알 수 있다.&lt;/p&gt;
&lt;p&gt;이런식으로 모든 유스케이스를 잡아내는 단일 모델(클래스, DB 등)을 만드는 대신 여러 모델을 만들고 각 컨텍스트 간의 경계(Bounded Context)를 잘 잡은 후 여러 컨텍스트를 왔다갔다 할 때 명시적인 변환을 처리하자는 아이디어가 도출되었다.&lt;/p&gt;
&lt;p&gt;그러니 자연스럽게 마이크로서비스가 대두된다. 각 마이크로서비스가 각자 자유롭게 “고객” 개념을 가지고, 자신이 통합해야 하는 다른 마이크로서비스의 개념으로 변환해 가져오거나 내보낼 수 있다.&lt;/p&gt;
&lt;h3 id=&quot;대충-예시로-살펴보자&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8C%80%EC%B6%A9-%EC%98%88%EC%8B%9C%EB%A1%9C-%EC%82%B4%ED%8E%B4%EB%B3%B4%EC%9E%90&quot; aria-label=&quot;대충 예시로 살펴보자 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;(대충) 예시로 살펴보자&lt;/h3&gt;
&lt;p&gt;할당 서비스 에서는 &lt;code class=&quot;language-text&quot;&gt;Product(sku, batches)&lt;/code&gt; 가 있을 수 있을 것이고, 어떤 전자상거래의 &lt;code class=&quot;language-text&quot;&gt;Product&lt;/code&gt; 라면 &lt;code class=&quot;language-text&quot;&gt;Product(sku, description, price, image_url, dimensions, ...&lt;/code&gt;) 가 있을 수 있을 것이다. 내가 앞으로 작성해야 할 도메인 모델은 오직 내가 계산을 수행하기 위한 필요 데이터만을 포함해야 한다!&lt;/p&gt;
&lt;p&gt;마이크로서비스를 떠나서, 애그리게이터를 선택할 때는 어떤 제한된 컨텍스트 안에서 애그리게이트를 실행할지 선택해야 한다. 컨텍스트를 제약하면 애그리게이트의 숫자를 낮게 유지하고 그 크기를 관리하기 좋은 크기로 유지할 수 있다.&lt;/p&gt;
&lt;p&gt;나중에 아래 책들을 꼭 사서 보자…&lt;sup id=&quot;fnref-5&quot;&gt;&lt;a href=&quot;#fn-5&quot; class=&quot;footnote-ref&quot;&gt;5&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.yes24.com/Product/Goods/48577718&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;반 버논, &amp;#x3C;도메인 주도 설계 핵심&gt; (에이콘출판사, 2017)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;지금 이 책!&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.yes24.com/Product/Goods/25100510&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;반 버논, &amp;#x3C;도메인 주도 설계 구현&gt; (저자가 빨간 책이라 하는거) (에이콘출판사, 2016)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.yes24.com/Product/Goods/116613006&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;에릭 에반스, &amp;#x3C;도메인 주도 설계&gt; (저자가 파란 책이라 하는거) (위키북스, 2022)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;75-one-aggregate--one-repository&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#75-one-aggregate--one-repository&quot; aria-label=&quot;75 one aggregate  one repository permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;7.5 &lt;strong&gt;One Aggregate = One Repository&lt;/strong&gt;&lt;/h1&gt;
&lt;p&gt;애그리게이트가 될 엔티티를 정의하고 나면 외부 세게에서 접근할 수 있는 유일한 엔티티가 되어야 한다는 규칙을 적용해야 한다. 허용되는 모든 저장소는 오직 애그리게이트만을 반환해야 한다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;저장소가 애그리게이트만 반환해야 한다는 규칙은 애그리게이트가 &lt;strong&gt;도메인 모델에 접근하는 유일한 통로&lt;/strong&gt;라는 관례를 지키도록 하는 핵심 규칙이다. 이를 어기지 말자!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;시작해보자!&lt;/p&gt;
&lt;p&gt;그러면 기존에 있던 &lt;code class=&quot;language-text&quot;&gt;BatchRepository&lt;/code&gt; 는 &lt;code class=&quot;language-text&quot;&gt;ProductRepository&lt;/code&gt; 가 될 것이다. 천천히 코드를 갈아보자…&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;UoW와 저장소 객체를 살펴보자&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AbstractUnitOfWork&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;abc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ABC&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    products&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; repository&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractProductRepository
		&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AbstractProductRepository&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;abc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ABC&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@abc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;abstractmethod&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; reference&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; List&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Product&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; NotImplementedError

    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@abc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;abstractmethod&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; product&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Product&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; NotImplementedError&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ORM계층을 조절해서 올바른 배치를 가져오게 한 후 Product 객체와 연관시켜야 한다. &lt;code class=&quot;language-text&quot;&gt;Repository&lt;/code&gt; 패턴을 쓰면 이를 어떻게 연관시킬지 아직 신경쓰지 않아도 된다. &lt;code class=&quot;language-text&quot;&gt;FakeRepository&lt;/code&gt; 를 쓰고 새 모델을 서비스 계층으로 전달해서 &lt;code class=&quot;language-text&quot;&gt;Product&lt;/code&gt; 가 엔트리포인트인 경우 서비스 계층이 어떤 모습일지 코드로 볼 수 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;서비스 계층의 변화를 살펴보자
&lt;ul&gt;
&lt;li&gt;의외로 쉽게 갈아끼워진다! 서비스 계층에서 서비스”만”을 바라보도록 코드를 작성한 도움인 것 같다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add_batch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        ref&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        sku&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        qty&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        eta&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Optional&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;date&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractUnitOfWork
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        product &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;products&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sku&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; product &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            product &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Product&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sku&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; batches&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;products&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;product&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; product&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;batches&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Batch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ref&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; qty&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; eta&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;commit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;allocate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        orderid&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        sku&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        qty&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractUnitOfWork
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    line &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;OrderLine&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;orderid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; qty&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        product &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;products&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sku&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; product &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; InvalidSku&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&apos;Invalid sku &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        batchref &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; product&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;commit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; batchref

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;deallocate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        orderid&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        sku&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        qty&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    line &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;OrderLine&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;orderid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; qty&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        product &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;products&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; product &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; InvalidSku&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&apos;Invalid sku &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;deallocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; product&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;commit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id=&quot;76-성능은-어떨까&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#76-%EC%84%B1%EB%8A%A5%EC%9D%80-%EC%96%B4%EB%96%A8%EA%B9%8C&quot; aria-label=&quot;76 성능은 어떨까 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;7.6 성능은 어떨까?&lt;/h1&gt;
&lt;p&gt;저자가 성능좋은 소프트웨어를 원하기 때문에 애그리게이트로 모델링한다고 여러 번 말했다. 근데 배치 하나만 요청해도 &lt;strong&gt;모든&lt;/strong&gt; 배치를 읽어온다. 그럼 안 좋은거 아닌가? 라고 생각했는데 근거가 있다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;현재는 의도적으로 DB질의를 한 번만 하고 변경된 부분을 한 번만 영속화하여 데이터를 모델링하는 기법을 사용중이다. 이런 방식은 소프트웨어가 진화하면 할 수록 여러번 다양한 질의를 던지는 프로그램보다 시스템 성능이 나은 경향이 있다.&lt;/li&gt;
&lt;li&gt;데이터 구조를 최소한으로 쓰며 한 row 당 최소한의 문자열과 정수만 만든다. 이러면 수백개의 배치를 메모리로 가져올 수 있다.&lt;/li&gt;
&lt;li&gt;시간이 지나도 가져오는 데이터의 양은 제어를 벗어나지 않는다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;예를 들어 어느 시점에서는 상품마다 20개 정도의 배치가 있을 것이라 “예상” 한다. 배치를 다 사용하고나면 이 배치를 계산에서 배제할 수 있다.
4. 만일 상품 당 몇천 개의 배치가 있다 예상된다면 배치의 로드방식을 lazy-loading(지연 읽기)으로 처리한다. SQLAlchemy는 이미 데이터를 페이지 단위로 읽어온다. 이렇게 하면 적은 수의 row를 가져오는 DB요청이 더 많아진다. 이렇게 점진적으로 행을 가져오는 방식도 잘 작동한다.&lt;/p&gt;
&lt;p&gt;코드를 짜보자.&lt;/p&gt;
&lt;p&gt;그리고, 다른 모든 방법이 실패하면 다른 애그리게이트를 살펴본다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;어쩌면 배치를 지역/창고별로 나눠야할 수도 있다&lt;/li&gt;
&lt;li&gt;아니면 선적이라는 개념을 중심으로 데이터 접근전략을 재설계 해야할 수도 있다&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;애그리게이트 패턴은 일관성과 성능을 중심으로 여러 기술적 제약사항을 관리하는데 도움이 되도록 설계된 패턴이다. 올바른 애그리게이트가 &lt;strong&gt;하나만 있는 것은 아니다&lt;/strong&gt;. 설정한 경계가 성능을 떨어뜨린다면 &lt;strong&gt;언제든 설계를 다시&lt;/strong&gt; 할 준비를 하자. &lt;strong&gt;바꿔도 좋다. 언제든 바꿀 수 있다고 생각하고, 또 이게 편하다고 느껴야 한다.&lt;/strong&gt;&lt;/p&gt;
&lt;h1 id=&quot;77-버전-번호와-낙관적-동시성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#77-%EB%B2%84%EC%A0%84-%EB%B2%88%ED%98%B8%EC%99%80-%EB%82%99%EA%B4%80%EC%A0%81-%EB%8F%99%EC%8B%9C%EC%84%B1&quot; aria-label=&quot;77 버전 번호와 낙관적 동시성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;7.7 버전 번호와 낙관적 동시성&lt;/h1&gt;
&lt;p&gt;DB 수준에서 데이터 일관성을 강제할 수 있는 방법을 더 살펴보자&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;이번 절(&lt;em&gt;section&lt;/em&gt;)에서는 구현을 다룬다. 또한 Postgres-specific 코드다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;여러 접근방법 중 하나일 뿐이다.&lt;/p&gt;
&lt;p&gt;실전에서는 요구사항 별로 다르게 접근해야할 수도 있다.
&lt;em&gt;&lt;strong&gt;코드를 절대 프로덕션에 복붙하지 마시오.&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;p&gt;전체 &lt;code class=&quot;language-text&quot;&gt;batches&lt;/code&gt; 테이블에 락걸고 싶지는 않고 특정 SKU에 해당하는 행에만 lock을 걸 수 있을까?&lt;/p&gt;
&lt;p&gt;한가지 답은 Product 모델 속성 하나를 사용해 전체 상태 변경이 완료되었는지 표시하고, 여러 동시성 작업자들이 이 속성을 획득하기 위해 경쟁하는 자원으로 활용하는 방법이다. 두 트랜잭션이 &lt;code class=&quot;language-text&quot;&gt;batches&lt;/code&gt; 에 대한 세계 상태를 동시에 읽고 둘 다 &lt;code class=&quot;language-text&quot;&gt;allocation&lt;/code&gt; 테이블을 업데이트 하려고 한다면, 각 트랜잭션이 &lt;code class=&quot;language-text&quot;&gt;product_table&lt;/code&gt; 에 있는 &lt;code class=&quot;language-text&quot;&gt;version_number&lt;/code&gt; 를 업데이트하도록 강제할 수 있다. 이러면 경쟁하는 트랜잭션 중 하나만 승리하고, 세계가 일관성 있게 남게 된다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.cosmicpython.com/book/images/apwp_0704.png&quot; alt=&quot;두 트랜잭션 예시:  Product 에 동시 업데이트를 시도하는 시퀀스 다이어그램&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;둘 다 버전 &lt;code class=&quot;language-text&quot;&gt;3&lt;/code&gt;을 가져간다&lt;/li&gt;
&lt;li&gt;모델에 allocate을 하면 버전 &lt;code class=&quot;language-text&quot;&gt;4&lt;/code&gt;를 담고있는 Product 객체가 생긴다
&lt;ul&gt;
&lt;li&gt;해당 객체를 먼저 커밋한 사항이 반영된다&lt;/li&gt;
&lt;li&gt;늦게 커밋한 사람은 버전이 안맞아서 못 한다. 혹은 다시 하거나&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;낙관적-동시성-제어와-재시도&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%82%99%EA%B4%80%EC%A0%81-%EB%8F%99%EC%8B%9C%EC%84%B1-%EC%A0%9C%EC%96%B4%EC%99%80-%EC%9E%AC%EC%8B%9C%EB%8F%84&quot; aria-label=&quot;낙관적 동시성 제어와 재시도 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;낙관적 동시성 제어와 재시도&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;어쨌거나 성능과 충돌 가능성을 측정 후 어떤 정책을 가져가야 할지 평가해야 한다.&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;낙관적/비관적 동시성 제어에 대해
&lt;ul&gt;
&lt;li&gt;낙관적 동시성 제어(&lt;em&gt;Optimistic Concurrency Control&lt;/em&gt;)
&lt;ul&gt;
&lt;li&gt;여러 사용자의 DB 변경 충돌이 &lt;em&gt;드물 것이다&lt;/em&gt; 라고 생각한다&lt;/li&gt;
&lt;li&gt;일단 업데이트 하고 문제 시 통지받을 수 있는 방법이 있는지만 확실히 한다&lt;/li&gt;
&lt;li&gt;충돌 발생 시 어떻게 처리해야 할지 명시해야 한다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;비관적(&lt;em&gt;pessimistic&lt;/em&gt;) 동시성 제어
&lt;ul&gt;
&lt;li&gt;여러 사용자의 DB 변경 충돌이 &lt;em&gt;잦을 것이다&lt;/em&gt; 라고 가정한다&lt;/li&gt;
&lt;li&gt;모든 충돌을 피하려 노력하고, 안전성을 위해 모든 대상을 lock을 사용해 잠근다&lt;/li&gt;
&lt;li&gt;실패 처리는 DB가 해줘서 고민할 필요는 없지만, deadlock을 고민해봐야 한다&lt;/li&gt;
&lt;li&gt;E.g.,
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;batches&lt;/code&gt; 테이블 전체를 lock 걸거나, &lt;code class=&quot;language-text&quot;&gt;SELECT FOR UPDATE&lt;/code&gt; 를 사용한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;실패 처리에 대한 방안
&lt;ol&gt;
&lt;li&gt;실패한 연산을 처음부터 다시 함
&lt;ol&gt;
&lt;li&gt;두 트랜잭션 예시에서 실패한 쪽은 다시 요청해서 결과를 받아본다&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;771-버전-번호를-구현하는-방법&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#771-%EB%B2%84%EC%A0%84-%EB%B2%88%ED%98%B8%EB%A5%BC-%EA%B5%AC%ED%98%84%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95&quot; aria-label=&quot;771 버전 번호를 구현하는 방법 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;7.7.1 버전 번호를 구현하는 방법&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;도메인의 &lt;code class=&quot;language-text&quot;&gt;version_number&lt;/code&gt; 를 사용
&lt;ol&gt;
&lt;li&gt;해당 값을 &lt;code class=&quot;language-text&quot;&gt;Product&lt;/code&gt; 생성자에 추가하고 &lt;code class=&quot;language-text&quot;&gt;Product.allocate()&lt;/code&gt; 가 버전 번호를 올리는 경우&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;서비스 계층이 수행
&lt;ol&gt;
&lt;li&gt;(근거) 버전 번호는 도메인의 관심사가 아니기 때문이다&lt;/li&gt;
&lt;li&gt;따라서 서비스 계층에서 &lt;code class=&quot;language-text&quot;&gt;Product&lt;/code&gt; 에 저장소를 통해 버전번호를 덧붙이고, &lt;code class=&quot;language-text&quot;&gt;commit()&lt;/code&gt; 전에 버전 번호를 증가한다고 가정할 수 있다&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;인프라와 측에서 사용(controversial)
&lt;ol&gt;
&lt;li&gt;(근거) 버전 번호는 결국 인프라와 관련있다&lt;/li&gt;
&lt;li&gt;따라서 UoW와 저장소가 처리한다
&lt;ol&gt;
&lt;li&gt;저장소는 자신이 읽어 온 상품의 모든 버전 번호에 접근 가능하다&lt;/li&gt;
&lt;li&gt;UoW는 상품이 변경됐다는 가정 하에 자신이 아는 상품의 버전 번호를 증가할 수 있다&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;3번 방법은 “모든” 제품이 변경되었다고 가정하지 않고서는 구현할 방법이 없다.&lt;/p&gt;
&lt;p&gt;2번 방법은 상태 변경에 대한 책임이 서비스-도메인 계층 사이에 있어서 지저분하다(저자 曰)&lt;/p&gt;
&lt;p&gt;도메인 관심사와 무관하게 가장 나은 방안이 1번 방안이다(저자 曰)&lt;/p&gt;
&lt;p&gt;그럼 어디 둘까? 애그리게이트에 둔다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Product&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            sku&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            batches&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; List&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;Batch&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            version_number&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sku
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;batches &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; batches
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;version_number &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; version_number

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;allocate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            line&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; OrderLine&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            batch &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;b &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; b &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;sorted&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;batches&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;can_allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            batch&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;version_number &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# (1)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; batch&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;reference
        &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; StopIteration&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; OutOfStock&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;Out of stock for sku &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;이 쯤 처리한다
&lt;ol&gt;
&lt;li&gt;참고: 버전 번호에 대해 고심하고있다면 “번호” 란 말이 그다지 중요하지 않다는 사실을 깨달으면 좋을 듯 하다.&lt;/li&gt;
&lt;li&gt;중요한 점은 &lt;code class=&quot;language-text&quot;&gt;Product&lt;/code&gt; 애그리게이트 변경 시 &lt;code class=&quot;language-text&quot;&gt;Product&lt;/code&gt; DB 컬럼이 변경된다는 사실이다.&lt;/li&gt;
&lt;li&gt;매번 임의로 UUID를 생성하거나, Snowflake ID&lt;sup id=&quot;fnref-6&quot;&gt;&lt;a href=&quot;#fn-6&quot; class=&quot;footnote-ref&quot;&gt;6&lt;/a&gt;&lt;/sup&gt; 같은 걸 쓰는건 어떨까 싶다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;78-데이터-무결성-규칙-테스트&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#78-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%AC%B4%EA%B2%B0%EC%84%B1-%EA%B7%9C%EC%B9%99-%ED%85%8C%EC%8A%A4%ED%8A%B8&quot; aria-label=&quot;78 데이터 무결성 규칙 테스트 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;7.8 데이터 무결성 규칙 테스트&lt;/h1&gt;
&lt;p&gt;이 대로 했을 때 의도대로 잘 되는지 살펴보자! 동시에 트랜잭션을 시도하면 모두 버전 번호를 올릴 수는 없으니 둘 중 하나는 실패할 것이다.&lt;/p&gt;
&lt;p&gt;느린 트랜잭션&lt;sup id=&quot;fnref-7&quot;&gt;&lt;a href=&quot;#fn-7&quot; class=&quot;footnote-ref&quot;&gt;7&lt;/a&gt;&lt;/sup&gt;을 하나 임의로 만들어보자:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;try_to_allocate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;orderid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; exceptions&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    line &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;OrderLine&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;orderid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SqlAlchemyUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            product &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;products&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sku&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            product&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            time&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sleep&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;commit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt; Exception &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;traceback&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;format_exc&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        exceptions&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;append&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;어떻게 테스트하는지 살펴보자:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_concurrent_updates_to_version_are_not_allowed&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;postgres_session_factory&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; batch &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; random_sku&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; random_batchref&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    session &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; postgres_session_factory&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    insert_batch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;session&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; batch&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; eta&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; product_version&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;commit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    order1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; order2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; random_orderid&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; random_orderid&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    exceptions &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# type: List[Exception]&lt;/span&gt;
    try_to_allocate_order1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;lambda&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; try_to_allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;order1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; exceptions&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    try_to_allocate_order2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;lambda&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; try_to_allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;order2&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; exceptions&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    thread1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; threading&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Thread&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;target&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;try_to_allocate_order1&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;#(1)&lt;/span&gt;
    thread2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; threading&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Thread&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;target&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;try_to_allocate_order2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;#(1)&lt;/span&gt;
    thread1&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;start&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    thread2&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;start&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    thread1&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;join&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    thread2&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;join&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;version&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;execute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;SELECT version_number FROM products WHERE sku=:sku&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token builtin&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sku&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; version &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;#(2)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;exception&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; exceptions
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;could not serialize access due to concurrent update&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;exception&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;#(3)&lt;/span&gt;

    orders &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;execute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;SELECT orderid FROM allocations&quot;&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot; JOIN batches ON allocations.batch_id = batches.id&quot;&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot; JOIN order_lines ON allocations.orderline_id = order_lines.id&quot;&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot; WHERE order_lines.sku=:sku&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token builtin&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sku&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; orders&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;rowcount &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;#(4)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SqlAlchemyUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;execute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;select 1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;원하는 동시성 행동 방식을 잘 재현할 수 있는 두 스레드를 실행시킨다.
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;read1&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;read2&lt;/code&gt; 그리고 &lt;code class=&quot;language-text&quot;&gt;write1&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;write2&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;버전 번호가 &lt;code class=&quot;language-text&quot;&gt;1&lt;/code&gt; 오른 것을 확인한다&lt;/li&gt;
&lt;li&gt;필요하면 이런 식으로 확인한다&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;allocate()&lt;/code&gt; 이 하나만 되었음을 검사한다&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;781-db-트랜잭션-격리-수준을-사용하여-동시성-규칙을-강제&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#781-db-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98-%EA%B2%A9%EB%A6%AC-%EC%88%98%EC%A4%80%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EC%97%AC-%EB%8F%99%EC%8B%9C%EC%84%B1-%EA%B7%9C%EC%B9%99%EC%9D%84-%EA%B0%95%EC%A0%9C&quot; aria-label=&quot;781 db 트랜잭션 격리 수준을 사용하여 동시성 규칙을 강제 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;7.8.1 DB 트랜잭션 격리 수준을 사용하여 동시성 규칙을 강제&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;(Postgres 에만 국한되는건 아니지만) 트랜잭션 격리 수준을 &lt;code class=&quot;language-text&quot;&gt;REPEATABLE READ&lt;/code&gt; 로 조절한다. 상세한 정보는 &lt;a href=&quot;https://www.postgresql.org/docs/current/transaction-iso.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Postgres 공식 문서&lt;/a&gt;를 읽자&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;DEFAULT_SESSION_FACTORY &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sessionmaker&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    bind&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;create_engine&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        config&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_postgres_uri&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        isolation_level&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;REPEATABLE READ&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;782-비관적-동시성-제어-예제-select-for-update&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#782-%EB%B9%84%EA%B4%80%EC%A0%81-%EB%8F%99%EC%8B%9C%EC%84%B1-%EC%A0%9C%EC%96%B4-%EC%98%88%EC%A0%9C-select-for-update&quot; aria-label=&quot;782 비관적 동시성 제어 예제 select for update permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;7.8.2 비관적 동시성 제어 예제: &lt;code class=&quot;language-text&quot;&gt;SELECT FOR UPDATE&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;해당 방안은 비관적 동시성 제어 방안 중 하나이다. &lt;code class=&quot;language-text&quot;&gt;SELECT FOR UPDATE&lt;/code&gt; &lt;sup id=&quot;fnref-8&quot;&gt;&lt;a href=&quot;#fn-8&quot; class=&quot;footnote-ref&quot;&gt;8&lt;/a&gt;&lt;/sup&gt;는 두 트랜잭션이 동시에 같은 row를 읽도록 허용하지 않는다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;SELECT FOR UPDATE&lt;/code&gt; 는 lock으로 사용할 row를 선택하는 방안이다(업데이트 대상 row일 필요는 없다). 두 트랜잭션이 동시에 &lt;code class=&quot;language-text&quot;&gt;SELECT FOR UPDATE&lt;/code&gt; 를 수행하면 두 업데이트 중 하나만 승리하고 나머지는 상대방이 lock을 풀 때 까지 기다려야 한다. 이는 동시성 패턴을 아래와 같이 바꾼다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;AS-IS&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;read1&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;read2&lt;/code&gt; , &lt;code class=&quot;language-text&quot;&gt;write1&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;write2(fail)&lt;/code&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;TO-BE&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;read1&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;write1&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;read2&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;write2(succeed)&lt;/code&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;p&gt;이걸 “Read-Modify-Write” failure mode 라고 부르는 사람도 있다. 아래 게시글을 읽고 통찰을 얻자!&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://oreil.ly/uXeZI&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;“PostgreSQL Anti-Patterns: Read-Modify-Write Cycles”&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;REPEATABLE READ&lt;/code&gt; 나 &lt;code class=&quot;language-text&quot;&gt;SELECT FOR UPDATE&lt;/code&gt; 어떤걸 하든 트레이드오프가 있다. 상기 테스트코드와 같은 접근을 하면 어떤 식으로 바뀌는지 알 수 있다. 물론 테스트코드를 더 좋게 보강해야겠지만…&lt;/p&gt;
&lt;p&gt;동시성 제어를 어떻게 할지는 비즈니스 환경, 저장소 기술에 따라 달라진다.&lt;/p&gt;
&lt;h1 id=&quot;79-마치며&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#79-%EB%A7%88%EC%B9%98%EB%A9%B0&quot; aria-label=&quot;79 마치며 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;7.9 마치며&lt;/h1&gt;
&lt;p&gt;이번 장은 애그리게이트의 개념을 살펴봤다.&lt;/p&gt;
&lt;p&gt;애그리게이트는…&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;모델의 일부 부분집합에 대한 주 진입점 역할을 한다&lt;/li&gt;
&lt;li&gt;모든 모델 객체에 대한 비즈니스 규칙과 불변조건을 강제하는 역할을 담당하도록 객체를 명시적으로 모델링한다&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;올바른 애그리게이트를 잘 선택해야 한다! 시간이 지나고 요구사항 등등 재검토를 수행하다 보면 애그리게이트로 고른 객체가 달라질 수도 있다.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.dddcommunity.org/library/vernon_2011/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 링크&lt;/a&gt;를 꼭 읽어보자. 존 버넌이 효과적인 애그리게이트 설계에 대해 쓴 글이다.&lt;/p&gt;
&lt;p&gt;그러면 이어서, 애그리게이트의 트레이드오프에 대해 살펴보자.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;장점&lt;/th&gt;
&lt;th&gt;단점&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;애그리게이트는 도메인 모델 클래스 중 어떤 부분이 공개되어있고, 어떤 부분이 비공개인지 결정할 수 있다(멤버함수, 멤버변수에 _ 하나를 붙여서)&lt;/td&gt;
&lt;td&gt;엔티티, VO를 적당히 잘 감싼 객체가 또 하나 생긴다. 솔직히 이해하기 너무 어렵다….&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;연산 주변에 명시적인 Bounded Context를 모델링할 수 있으면 ORM 성능 문제 예방에 도움된다&lt;/td&gt;
&lt;td&gt;한번에 한 가지 애그리게이트만 변경할 수 있다는 규칙을 엄격히 지키도록 해야하는데, 그것도 정말 어렵다…&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;애그리게이트는 자신이 담당한 모델에 대한 상태변경만을 책임지도록 하면 시스템 추론 및 불변조건 제어가 쉬워진다&lt;/td&gt;
&lt;td&gt;애그리게이트 사이의 최종 일관성을 처리하는 과정이 복잡해질 수 있다. 와 정말 너무 어렵다…………&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&quot;791-애그리게이트와-일관성-경계&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#791-%EC%95%A0%EA%B7%B8%EB%A6%AC%EA%B2%8C%EC%9D%B4%ED%8A%B8%EC%99%80-%EC%9D%BC%EA%B4%80%EC%84%B1-%EA%B2%BD%EA%B3%84&quot; aria-label=&quot;791 애그리게이트와 일관성 경계 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;7.9.1 애그리게이트와 일관성 경계&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;애그리게이트는 도메인 모델에 대한 진입점이다
&lt;ol&gt;
&lt;li&gt;도메인에 속한 것을 바꿀 수 있는 방식을 제한하면 시스템을 더 쉽게 추론할 수 있다&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;애그리게이트는 Bounded Context를 책임진다
&lt;ol&gt;
&lt;li&gt;애그리게이트의 역할은 여러 객체로 이루어진 그룹에 적용할 불변조건에 대한 비즈니스 규칙을 관리하는 것이다&lt;/li&gt;
&lt;li&gt;자신이 담당하는 객체 사이와 객체와 비즈니스 규칙 사이의 일관성을 검사하고, 어떤 변경이 일관성을 해친다면 이를 거부하는 것도 애그리게이트의 할 일이다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;애그리게이트와 동시성 문제는 공존한다
&lt;ol&gt;
&lt;li&gt;동시성 검사 구현 방안을 고민하면 자연스럽게 트랜잭션과 lock까지 간다. 이는 성능과 직결된 이야기다&lt;/li&gt;
&lt;li&gt;애그리게이트를 제대로 고르는 것은 도메인을 개념적으로 잘 조직화하는 것 뿐 아니라 성능까지 살펴보는 것이다&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;710-1부-돌아보기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#710-1%EB%B6%80-%EB%8F%8C%EC%95%84%EB%B3%B4%EA%B8%B0&quot; aria-label=&quot;710 1부 돌아보기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;7.10 1부 돌아보기&lt;/h1&gt;
&lt;p&gt;아무리 예제를 베끼고 내가 짜야할 것들을 짜고 했지만 이걸 만들다니….&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.cosmicpython.com/book/images/apwp_0705.png&quot; alt=&quot;이겼다! 제 1부 끝!&quot;&gt;&lt;/p&gt;
&lt;p&gt;뭘 만들어낸건지 리뷰해보자.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;테스트 피라미드 → 검증된 도메인 모델 생성
&lt;ol&gt;
&lt;li&gt;비즈니스 요구사항에 맞게 시스템이 어떻게 도는지를 코드로 작성했다&lt;/li&gt;
&lt;li&gt;비즈니스 요구사항이 바뀌면 테스트도 마찬가지로 변하면 된다&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;API 핸들러, DB 등의 구조를 분리했다
&lt;ol&gt;
&lt;li&gt;애플리케이션 외부에서 하부구조를 끼워넣을 수 있게 만들었다&lt;/li&gt;
&lt;li&gt;코드 베이스의 조직화가 이루어졌다&lt;/li&gt;
&lt;/ol&gt;
→ 코드 내부가 파악하지도 못하게 복잡해지는 것은 막했다&lt;/li&gt;
&lt;li&gt;DIP를 적용했다. 포트와 어댑터에서 영향받은 “저장소” 와 UoW를 사용했다
&lt;ol&gt;
&lt;li&gt;저장소 수준의 테스트코드와 UoW 수준의 테스트코드를 분리했다&lt;/li&gt;
&lt;li&gt;시스템의 한쪽 끝부터 다른쪽 끝까지 테스트했다&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Bounded Context
&lt;ol&gt;
&lt;li&gt;변경이 필요할 때마다 전체 시스템을 잠그고 싶지않아서, 어떤 부분에 대해서만 일관성을 가지는지를 나눴다&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;2부에서는 모델을 넘어서는 일관성을 처리하기 위한 방안을 살펴볼 것이다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;경고!&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;이런 패턴이 하나씩하나씩 붙을 때 마다 전부 비용이다.&lt;/p&gt;
&lt;p&gt;간접계층 하나하나가 모두 비용이다.
이 패턴을 모르는 사람에게 혼동을 야기할 수 있다. 이것도 큰 비용이다.
만약 만들 앱이 DB를 단순히 감싸는 CRUD wrapper 라면? 앞으로 이것 외의 일을 할 것 같지 않다면?&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;이런 복잡한걸 쓸 필요가 없다&lt;/em&gt;.&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;왠지 &lt;a href=&quot;http://www.yes24.com/Product/Goods/114667254&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 책의 3장&lt;/a&gt;을 다시 읽어봐야할 것 같은 느낌이다. 저기서 본 내용들의 일부가 여기도 나온다.&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-2&quot;&gt;할당 후 배치의 가용 재고 수량이 라인의 상품 수량만큼 감소하므로 비즈니스 제약 사항을 만족한다면 항상 가용 재고 수량은 &lt;code class=&quot;language-text&quot;&gt;0&lt;/code&gt;보다 크거나 같다.&lt;a href=&quot;#fnref-2&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-3&quot;&gt;이 코드의 모델의 경우 배치가 컬렉션이다.&lt;a href=&quot;#fnref-3&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-4&quot;&gt;&lt;a href=&quot;https://www.cosmicpython.com/book/chapter_01_domain_model.html#allocation_notes&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;A product is identified by a SKU, …&lt;/a&gt; 하면서 이미 풀어놨음&lt;a href=&quot;#fnref-4&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-5&quot;&gt;&lt;a href=&quot;https://haandol.github.io/2021/10/11/thoughts-for-ddd-starters.html#fn:1&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 분의 블로그 게시글&lt;/a&gt;을 보고 뽐뿌가 왔다… 꼭 지식을 머리속에 집어넣도록 하자&lt;a href=&quot;#fnref-5&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-6&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Snowflake_ID&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://en.wikipedia.org/wiki/Snowflake_ID&lt;/a&gt; 를 의미한다&lt;a href=&quot;#fnref-6&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-7&quot;&gt;동시성 버그 재현을 위해 스레드 사이에서 세마포어나 비슷한 동기화 기능을 쓰는 편이 테스트 행동 방식을 보다 잘 보장할 수 있다.&lt;a href=&quot;#fnref-7&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-8&quot;&gt;&lt;a href=&quot;https://www.postgresql.org/docs/current/explicit-locking.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://www.postgresql.org/docs/current/explicit-locking.html&lt;/a&gt;&lt;a href=&quot;#fnref-8&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[파이썬으로 살펴보는 아키텍처 패턴 (6)]]></title><description><![CDATA[파이썬으로 살펴보는 아키텍처 패턴을 읽고 이해한 내용을 작성합니다. 챕터 6, 작업단위 패턴에 대한 내용입니다.]]></description><link>https://blog.s3ich4n.me/books/cosmic-python/2023-04-16-pt01-ch06</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/cosmic-python/2023-04-16-pt01-ch06</guid><pubDate>Sun, 16 Apr 2023 19:09:45 GMT</pubDate><content:encoded>&lt;p&gt;이 내용은 “파이썬으로 살펴보는 아키텍처 패턴” 을 읽고 작성한 내용입니다. 블로그 게시글과, 작성한 코드를 함께 보시면 더욱 좋습니다.&lt;/p&gt;
&lt;p&gt;6장은 해당 코드를 살펴봐주세요. &lt;a href=&quot;https://github.com/s3ich4n/cosmicpython-study/tree/main/pt1/ch06&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;코드 링크&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;6장-unit-of-workuow-pattern&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#6%EC%9E%A5-unit-of-workuow-pattern&quot; aria-label=&quot;6장 unit of workuow pattern permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;6장 Unit of Work(UoW) Pattern&lt;/h1&gt;
&lt;p&gt;작업 단위 패턴(UoW Pattern) 은 저장소와 서비스 계층 패턴을 하나로 묶어주는 것을 의미한다.&lt;/p&gt;
&lt;p&gt;저장소 패턴이 영속적 저장소 개념에 대한 추상화라면 UoW 패턴은 원자적 연산(atomic operation) 개념에 대한 추상화를 의미한다. 이 패턴을 사용하면 서비스 계층과 데이터 계층의 분리가 가능하다.&lt;/p&gt;
&lt;p&gt;이게…&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;%5Bhttps://www.cosmicpython.com/book/images/apwp_0601.png%5D(https://www.cosmicpython.com/book/images/apwp_0601.png)&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;이런 식의 UoW를 추가하여 DB의 상태를 관리하게 된다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;%5Bhttps://www.cosmicpython.com/book/images/apwp_0602.png%5D(https://www.cosmicpython.com/book/images/apwp_0602.png)&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;목표는 다음과 같다&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;API는 두 가지 일만 함
&lt;ul&gt;
&lt;li&gt;작업 단위 초기화&lt;/li&gt;
&lt;li&gt;서비스 호출
&lt;ul&gt;
&lt;li&gt;서비스는 UoW와 협력(저자는 UoW도 계층처럼 생각하는 편)한다&lt;/li&gt;
&lt;li&gt;서비스 함수 자체나 API는 DB와 직접 대화하지 않는다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;이 작업은 컨텍스트 매니저를 통해 수행한다(SQLAlchemy에서 이 철학을 쓴다)&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;61-작업-단위는-저장소와-협력&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#61-%EC%9E%91%EC%97%85-%EB%8B%A8%EC%9C%84%EB%8A%94-%EC%A0%80%EC%9E%A5%EC%86%8C%EC%99%80-%ED%98%91%EB%A0%A5&quot; aria-label=&quot;61 작업 단위는 저장소와 협력 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;6.1 작업 단위는 저장소와 협력&lt;/h1&gt;
&lt;p&gt;이 패턴을 적용한 코드는 대충 이런 모습이다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;allocate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    orderid&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; qty&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    line &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; OrderLine&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;orderid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; qty&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;#(1)&lt;/span&gt;
        batches &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;batches&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;#(2)&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
        batchref &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; batches&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;commit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;#(3)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;contextmanager&lt;/code&gt; 로 UoW 시작&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;uow.batches&lt;/code&gt; 는 배치 저장소다. 즉 UoW는 영속적 저장소에 대한 접근을 제공한다.&lt;/li&gt;
&lt;li&gt;작업이 끝나면 커밋하거나 롤백한다&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;(흠… uow 컨텍스트 매니저 끝에 try-except-finally 등으로 명시하는건 어떨까?
→ 라고 생각했다면 6.6장을 보십시오)&lt;/p&gt;
&lt;p&gt;UoW는 영속적 저장소에 대한 단일 진입점으로 작용한다. UoW는 어떤 객체가 메모리에 적재되었으며 어떤 객체가 최종 상태인지 기억한다&lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;p&gt;이 방식의 장점은 아래와 같다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;작업에 사용할 DB의 안정적인 스냅샷을 제공하고, 연산을 진행하는 과정에서 변경하지 않은 객체에 대한 스냅샷도 제공한다&lt;/li&gt;
&lt;li&gt;변경 내용을 한번에 영속화할 방법을 제공한다. 어딘가 잘못되어도 일관성 없는 상태로 끝나지 않는다&lt;/li&gt;
&lt;li&gt;영속성을 처리하기 위한 간단한 API와 저장소를 쉽게 얻을 수 있는 장소를 제공한다&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;62-테스트-통합-테스트로-uow-조정하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#62-%ED%85%8C%EC%8A%A4%ED%8A%B8-%ED%86%B5%ED%95%A9-%ED%85%8C%EC%8A%A4%ED%8A%B8%EB%A1%9C-uow-%EC%A1%B0%EC%A0%95%ED%95%98%EA%B8%B0&quot; aria-label=&quot;62 테스트 통합 테스트로 uow 조정하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;6.2 테스트-통합 테스트로 UoW 조정하기&lt;/h1&gt;
&lt;p&gt;UoW의 통합 테스트는 아래와 같다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_uow_can_retrieve_a_batch_and_allocate_to_it&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;session_factory&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    session &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; session_factory&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    insert_batch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;session&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;batch1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;HIPSTER-WORKBENCH&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;commit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    uow &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SqlAlchemyUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;session_factory&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;    &lt;span class=&quot;token comment&quot;&gt;# (1)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        batch &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;batches&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;reference&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;batch1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# (2)&lt;/span&gt;
        line &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;OrderLine&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;o1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;HIPSTER-WORKBENCH&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        batch&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;commit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    batchref &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; get_allocated_batch_ref&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;session&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;o1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;HIPSTER-WORKBENCH&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; batchref &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;batch1&apos;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;UoW는 “뭘 해야할지”를 테스트한다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;커스텀 세션 팩토리로 세션을 받아온다&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;uow.batches&lt;/code&gt; 를 통해서 배치 저장소에 대해 접근한다&lt;/li&gt;
&lt;li&gt;작업이 끝나면 UoW에 대한 &lt;code class=&quot;language-text&quot;&gt;commit()&lt;/code&gt; 을 호출한다&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;insert_batch&lt;/code&gt; 나 &lt;code class=&quot;language-text&quot;&gt;get_allocated_batch_ref&lt;/code&gt; 는 헬퍼 함수다&lt;/p&gt;
&lt;h1 id=&quot;63-작업-단위와-작업-단위의-contextmanager&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#63-%EC%9E%91%EC%97%85-%EB%8B%A8%EC%9C%84%EC%99%80-%EC%9E%91%EC%97%85-%EB%8B%A8%EC%9C%84%EC%9D%98-contextmanager&quot; aria-label=&quot;63 작업 단위와 작업 단위의 contextmanager permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;6.3 작업 단위와 작업 단위의 &lt;code class=&quot;language-text&quot;&gt;contextmanager&lt;/code&gt;&lt;/h1&gt;
&lt;p&gt;테스트 코드에서는 UoW의 인터페이스가 뭘 해야될지 기재했다. 그렇다면 추상 클래스를 통해 인터페이스를 제공하자.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; abc

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; pt1&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ch06&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;adapters &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; repository

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AbstractUnitOfWork&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;abc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ABC&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    batches&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; repository&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractRepository &lt;span class=&quot;token comment&quot;&gt;# (1)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__aexit__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; exc_type&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; exc_val&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; exc_tb&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# (2)&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;rollback&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# (4)&lt;/span&gt;

    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@abc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;abstractmethod&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;commit&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# (3)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; NotImplementedError

    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@abc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;abstractmethod&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;rollback&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# (4)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; NotImplementedError&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;저장소에 접근할 수 있도록 설정한다.&lt;/li&gt;
&lt;li&gt;컨텍스트 매니저에 대한 매직 메소드. 이를 통해 &lt;code class=&quot;language-text&quot;&gt;with&lt;/code&gt; 구문을 쓸 수 있다.
&lt;ol&gt;
&lt;li&gt;추가로, &lt;code class=&quot;language-text&quot;&gt;__aenter__&lt;/code&gt; 나 &lt;code class=&quot;language-text&quot;&gt;__aexit__&lt;/code&gt; 은 비동기 처리를 위한 구문이다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;커밋할 때가 되면 이 메소드로 커밋한다.&lt;/li&gt;
&lt;li&gt;문제가 생기면 예외를 발생시켜 컨텍스트 매니저를 빠져나가면 알아서 rollback 한다&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;631-sqlalchemy-세션을-이용하는-실제-uow&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#631-sqlalchemy-%EC%84%B8%EC%85%98%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%98%EB%8A%94-%EC%8B%A4%EC%A0%9C-uow&quot; aria-label=&quot;631 sqlalchemy 세션을 이용하는 실제 uow permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;6.3.1 SQLAlchemy 세션을 이용하는 실제 UoW&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SqlAlchemyUnitOfWork&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;AbstractUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; session_factory&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_session_factory &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; session_factory &lt;span class=&quot;token comment&quot;&gt;# (1)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__aenter__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# (2)&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_session &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_session_factory&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;batches &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; repository&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SqlAlchemyRepository&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;session&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__aenter__&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__aexit__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; exc_type&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; exc_val&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; exc_tb&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__aexit__&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;exc_type&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; exc_val&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; exc_tb&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;close&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# (3)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;commit&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# (4)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;commit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;rollback&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# (4)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;rollback&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;세션 팩토리를 여기서 골라갈 수 있게 한다. 통합테스트에서는 오버라이드를 수행해서 SQLite를 쓰게 만들 것이다&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;__aenter__&lt;/code&gt; 는 DB세션 시작 및 저장소를 인스턴스화한다&lt;/li&gt;
&lt;li&gt;컨텍스트 관리자에서 나올 때 세션을 닫는다&lt;/li&gt;
&lt;li&gt;세션에 사용할 &lt;code class=&quot;language-text&quot;&gt;commit()&lt;/code&gt; 과 &lt;code class=&quot;language-text&quot;&gt;rollback()&lt;/code&gt;을 제공한다&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;632-테스트를-위한-가짜-uow&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#632-%ED%85%8C%EC%8A%A4%ED%8A%B8%EB%A5%BC-%EC%9C%84%ED%95%9C-%EA%B0%80%EC%A7%9C-uow&quot; aria-label=&quot;632 테스트를 위한 가짜 uow permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;6.3.2 테스트를 위한 가짜 UoW&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;FakeUnitOfWork&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;batches &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; FakeRepository&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# (1)&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;committed &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# (2)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;commit&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;committed &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# (2)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;rollback&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;pass&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mark&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;asyncio&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_add_batch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    uow &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; FakeUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# (3)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; services&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add_batch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;b1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;CRUNCHY-ARMCHAIR&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;batches&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;b1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;committed

&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mark&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;asyncio&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_returns_allocation&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    uow &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; FakeUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# (3)&lt;/span&gt;

    repo &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; FakeRepository&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;for_batch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;b1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;COMPLICATED-LAMP&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; eta&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; services&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;o1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;COMPLICATED-LAMP&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; result &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;b1&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;이 둘은 마치 결합된(coupled) 것 처럼 밀접하게 연관되어있다. 그렇지만 이 둘은 서로 협력자니까 크게 문제되지 않는다&lt;/li&gt;
&lt;li&gt;가짜 commit과 &lt;code class=&quot;language-text&quot;&gt;FakeSession&lt;/code&gt; 은 제 3자의 코드가 아니라 “내 코드” 를 가짜로 구현한 것이다. 이것은 큰 개선이다! ‘&lt;a href=&quot;https://github.com/testdouble/contributing-tests/wiki/Don&amp;#x27;t-mock-what-you-don&amp;#x27;t-own&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;당신이 만든 것이 아니면 모킹하지 마라&lt;/a&gt;’ 하는 말에 부합하기 때문이다.&lt;/li&gt;
&lt;li&gt;테스트에서는 UoW를 인스턴스화 하고 서비스 계층에 저장소와 세션을 넘기는 대신 이거 하나로 퉁칠 수 있다. 훨씬 덜 번거롭다!&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;당신이-만든-것이-아니면-모킹하지-마라dont-mock-what-you-dont-own&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8B%B9%EC%8B%A0%EC%9D%B4-%EB%A7%8C%EB%93%A0-%EA%B2%83%EC%9D%B4-%EC%95%84%EB%8B%88%EB%A9%B4-%EB%AA%A8%ED%82%B9%ED%95%98%EC%A7%80-%EB%A7%88%EB%9D%BCdont-mock-what-you-dont-own&quot; aria-label=&quot;당신이 만든 것이 아니면 모킹하지 마라dont mock what you dont own permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;당신이 만든 것이 아니면 모킹하지 마라(&lt;strong&gt;Don’t mock what you don’t own)&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;세션보다 UoW를 모킹한게 편한 이유는 뭘까? 두가지 가짜(UoW, 세션)는 목적이 같다. 영속성 게층을 바꿔서 실제 DB를 안 쓰고 메모리 상에서 테스트할 수 있게 하는 것이다. 가짜 객체 두 개를 써서 얻을 수 있는 최종 설계에 차이가 있다.&lt;/p&gt;
&lt;p&gt;예를들어 SQLAlchemy 대신 목 객체를 만들어서 Session을 코드 전반에 쓰면, DB 접근 코드가 코드베이스 여기저기에 흩어진다. 이런 상황을 피하기 위해 영속적 계층에 대한 접근을 제한해서 필요한 것”만” 가지게 한다.&lt;/p&gt;
&lt;p&gt;코드를 Session 인터페이스와 결합하면 SQLAlchemy의 모든 복잡성과 결합하기로 하는 대신 더 간단한 추상화를 택하고 이를 통해 책임을 명확히 분리한다.&lt;/p&gt;
&lt;p&gt;이 문단이 시사하는 바는 복잡한 하위 시스템 위에 간단한 추상화를 만들도록 해주는 기본 규칙이다. 간단한 추상화를 하면 성능상으로는 동일하나 내 설계가 맞는 방안인지 보다 신중하게 생각하도록 해준다.&lt;/p&gt;
&lt;h1 id=&quot;64-uow-를-서비스계층에-써먹기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#64-uow-%EB%A5%BC-%EC%84%9C%EB%B9%84%EC%8A%A4%EA%B3%84%EC%B8%B5%EC%97%90-%EC%8D%A8%EB%A8%B9%EA%B8%B0&quot; aria-label=&quot;64 uow 를 서비스계층에 써먹기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;6.4 UoW 를 서비스계층에 써먹기&lt;/h1&gt;
&lt;p&gt;이런식으로 리팩토링이 된다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add_batch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        ref&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        sku&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        qty&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        eta&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Optional&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;date&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractUnitOfWork &lt;span class=&quot;token comment&quot;&gt;# (1)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;batches&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Batch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ref&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; qty&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; eta&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;commit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;allocate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        orderid&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        sku&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        qty&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractUnitOfWork  &lt;span class=&quot;token comment&quot;&gt;# (1)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    line &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;OrderLine&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;orderid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; qty&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        batches &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;batches&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;not&lt;/span&gt; is_valid_sku&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; batches&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; InvalidSku&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&apos;Invalid sku &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        batchref &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; batches&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;commit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;서비스 계층의 의존성은 UoW 추상화 하나 뿐이다&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;65-커밋롤백에-대한-명시적-테스트&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#65-%EC%BB%A4%EB%B0%8B%EB%A1%A4%EB%B0%B1%EC%97%90-%EB%8C%80%ED%95%9C-%EB%AA%85%EC%8B%9C%EC%A0%81-%ED%85%8C%EC%8A%A4%ED%8A%B8&quot; aria-label=&quot;65 커밋롤백에 대한 명시적 테스트 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;6.5 커밋/롤백에 대한 명시적 테스트&lt;/h1&gt;
&lt;p&gt;UoW를 구현해봤으니, 이러면 커밋/롤백을 테스트 하고싶어진다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mark&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;asyncio&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_rolls_back_uncommitted_work_by_default&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;session_factory&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    uow &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SqlAlchemyUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;session_factory&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        insert_batch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_session&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;batch1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;MEDIUM-PLINTH&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    new_session &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; session_factory&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    rows &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; new_session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;execute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;text&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;SELECT * FROM batches&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; rows &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mark&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;asyncio&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_rolls_back_on_error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;session_factory&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyException&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Exception&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;pass&lt;/span&gt;

    uow &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; unit_of_work&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SqlAlchemyUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;session_factory&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;raises&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;MyException&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            insert_batch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_session&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;batch1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;MEDIUM-PLINTH&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; MyException&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    new_session &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; session_factory&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    rows &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; new_session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;execute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;text&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;SELECT * FROM batches&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; rows &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;아래 내용을 테스트한다!&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;커밋 안 한 내용이 DB에 실제로 “없는지” 확인&lt;/li&gt;
&lt;li&gt;롤백으로 인해 DB에 실제로 “없는지” 확인&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;Tip&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;트랜잭션 같은 ‘불확실한’ DB동작을 ‘실제’ DB엔진에 대해 테스트할 가치가 있다.
Postgres같은 RDBMS로 바꾸고 나서 테스트하면 훨씬 편리할 것이다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;66-명시적-커밋과-암시적-커밋&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#66-%EB%AA%85%EC%8B%9C%EC%A0%81-%EC%BB%A4%EB%B0%8B%EA%B3%BC-%EC%95%94%EC%8B%9C%EC%A0%81-%EC%BB%A4%EB%B0%8B&quot; aria-label=&quot;66 명시적 커밋과 암시적 커밋 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;6.6 명시적 커밋과 암시적 커밋&lt;/h1&gt;
&lt;p&gt;디폴트로 결과를 커밋하고 예외 발생 시에만 롤백하는 (처음 내 생각대로) 의 UoW는 &lt;code class=&quot;language-text&quot;&gt;__aexit__&lt;/code&gt; 에서 &lt;code class=&quot;language-text&quot;&gt;exn_type&lt;/code&gt; 이 &lt;code class=&quot;language-text&quot;&gt;None&lt;/code&gt; 일 때 커밋하는 것이다.&lt;/p&gt;
&lt;p&gt;그런데 저자는 명시적 커밋이 낫다고 생각한다. 소프트웨어가 명령을 안 내리면 &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;아무 것도 안 한다&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;가 낫다라고 생각한다. 코드의 실행 상태를 추론하기도 보다 나아진다. 명시적이니까.&lt;/p&gt;
&lt;p&gt;그리고 롤백하면 걍 마지막 지점으로 돌아가니까 중간 변화를 모두 포기한다. 로직 파악이 수월하다는 장점이 있다.&lt;/p&gt;
&lt;h1 id=&quot;67-예제-uow를-사용해-여러-연산을-원자적-단위로-묶기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#67-%EC%98%88%EC%A0%9C-uow%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%B4-%EC%97%AC%EB%9F%AC-%EC%97%B0%EC%82%B0%EC%9D%84-%EC%9B%90%EC%9E%90%EC%A0%81-%EB%8B%A8%EC%9C%84%EB%A1%9C-%EB%AC%B6%EA%B8%B0&quot; aria-label=&quot;67 예제 uow를 사용해 여러 연산을 원자적 단위로 묶기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;6.7 예제: UoW를 사용해 여러 연산을 원자적 단위로 묶기&lt;/h1&gt;
&lt;p&gt;UoW를 통한 코드 추론이 쉬워지는 것을 살펴보자!&lt;/p&gt;
&lt;h2 id=&quot;671-예제-1-재할당&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#671-%EC%98%88%EC%A0%9C-1-%EC%9E%AC%ED%95%A0%EB%8B%B9&quot; aria-label=&quot;671 예제 1 재할당 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;6.7.1 예제 1: 재할당&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;reallocate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        line&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; OrderLine&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; AbstractUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        batch &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;batches&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;sku&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; batch &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; InvalidSku&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;invalid sku &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        batch&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;deallocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# (1)&lt;/span&gt;
        allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# (2)&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;commit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;deallocate()&lt;/code&gt;이 실패하면 당연히 &lt;code class=&quot;language-text&quot;&gt;allocate()&lt;/code&gt;이 안 돌기를 바란다&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;allocate()&lt;/code&gt;이 실패하면 &lt;code class=&quot;language-text&quot;&gt;deallocate()&lt;/code&gt; 한 결과만 커밋하고 싶지는 않을 것이다&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;둘 다 제대로 작동하기를 바란다는 뜻&lt;/p&gt;
&lt;h2 id=&quot;672-예제-2-배치-수량-변경&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#672-%EC%98%88%EC%A0%9C-2-%EB%B0%B0%EC%B9%98-%EC%88%98%EB%9F%89-%EB%B3%80%EA%B2%BD&quot; aria-label=&quot;672 예제 2 배치 수량 변경 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;6.7.2 예제 2: 배치 수량 변경&lt;/h2&gt;
&lt;p&gt;운송 중 문제가 생겨 제대로 배송이 안 되었다는 상황을 코드로 풀어보자&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;change_batch_quantity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        batchref&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        new_qty&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; AbstractUnitOfWork&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        batch &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;batches&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;reference&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;batchref&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        batch&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;change_purchased_quantity&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;new_qty&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; batch&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;available_quantity &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            line &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; batch&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;deallocate_one&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# (1)&lt;/span&gt;
        uow&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;commit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;원하는 만큼 할당 해제를 하려 하지만, 실패하면 그 어떤 사항도 적용되면 안 된다! 정합성을 유지해야한다!&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;68-통합-테스트-정리하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#68-%ED%86%B5%ED%95%A9-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%A0%95%EB%A6%AC%ED%95%98%EA%B8%B0&quot; aria-label=&quot;68 통합 테스트 정리하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;6.8 통합 테스트 정리하기&lt;/h1&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;integration&lt;/code&gt; 디렉토리 안을 보면 테스트 관련 코드가 3개 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;test_orm.py&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;SQLAlchemy 를 내 로직에 맞게 풀어낸 것을 테스트한다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;test_repository.py&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;주요 리포지토리 로직을 테스트한다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;test_uow.py&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;추상화 레벨을 올리면 좋을듯?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;69-마치며&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#69-%EB%A7%88%EC%B9%98%EB%A9%B0&quot; aria-label=&quot;69 마치며 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;6.9 마치며&lt;/h1&gt;
&lt;p&gt;UoW의 유용성과 &lt;code class=&quot;language-text&quot;&gt;contextmanager&lt;/code&gt; 를 통한 pythonic code 생성을 맛보았다.&lt;/p&gt;
&lt;p&gt;근데 이미 사실 SQLAlchemy 내부적으로 Session 객체가 UoW대로 구현되어있다. SQLAlchemy의 세션객체는 DB에서 새 엔티티를 읽을 때마다 엔티티의 변화를 추적하고, 세션 &lt;code class=&quot;language-text&quot;&gt;flush&lt;/code&gt; 를 수행할 때 모든 내용을 한꺼번에 영속화한다.&lt;/p&gt;
&lt;p&gt;근데 쓰는 이유가 있겠지? 여기까지의 트레이드오프를 살펴보자:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;장점&lt;/th&gt;
&lt;th&gt;단점&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;원자적 연산을 표현하는 좋은 추상화 레벨을 가진다. contextmanager 를 사용해서 atomic하게 한 그룹으로 묶어야 하는 코드 블록을 시각적으로 쉽게 알아볼 수 있다.&lt;/td&gt;
&lt;td&gt;ORM은 이미 원자성을 중심으로 좋은 추상화를 제공할 수도 있다. SQLAlchemy에는 이미 contextmanager를 제공한다. 세션을 주고받는 것 만으로도 많은 기능을 꽁으로 먹을 수 있다&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;트랜잭션 시작-끝 을 명시적으로 제어할 수 있고, 앱이 실패하면 롤백한다. 연산이 부분적으로 커밋되는 걱정을 덜어낼 수 있다&lt;/td&gt;
&lt;td&gt;롤백, 다중스레딩, nested transactions등의 코드를 짤 때는 보다 더 신중하게 접근해야 한다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;원자성은 트랜잭션 뿐 아니라 이벤트, 메시지 버스를 사용할 때도 도움이 된다.&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;SQLAlchemy의 Session API는 풍부한 기능과 도메인에서 불필요한 연산을 제공한다. UoW는 세션을 단순화해 핵심부분만 쓸 수 있게 해준다. UoW를 시작하고, 커밋하거나 작업결과를 갖다버릴 수도 있다(&lt;em&gt;thrown away&lt;/em&gt;).&lt;/p&gt;
&lt;p&gt;UoW를 써서 Repository 객체에 접근하는건 그냥 SQLAlchemy Session 만 써선 쓸 수 없는 장점을 가진다.&lt;/p&gt;
&lt;h2 id=&quot;uow-정리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#uow-%EC%A0%95%EB%A6%AC&quot; aria-label=&quot;uow 정리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;UoW 정리&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;UoW 패턴은 데이터 무결성 중심 추상화다
&lt;ol&gt;
&lt;li&gt;연산 끝에 commit (이후 flush) 를 통해 도메인 모델의 일관성을 강화하고 성능향상(?)에 도움이 된다&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;저장소, 서비스 계층 패턴과 밀접하게 연관되어 작동한다
&lt;ol&gt;
&lt;li&gt;UoW는 원자적 업데이를 표현해 데이터 접근에 대한 추상화를 완성시켜준다. 서비스 계층의 유스케이스들은 블록단위로 성공하거나 실패하는 별도의 작업단위로 실행된다&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;contextmanager를 쓰는 유스케이스
&lt;ol&gt;
&lt;li&gt;rollback을 파이썬스럽게 풀어냈다는 점에서 이미 매우 훌륭하다&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;SQLAlchemy는 이미 UoW 패턴을 제공한다
&lt;ol&gt;
&lt;li&gt;SQLAlchemy의 Session 객체를 더 간단히 추상화해서 필요한 기능”만” 쓸 수 있게 노출시킨다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;UoW 도 추상화로 또 감싸서 의존성 역전 원칙을 활용한다&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;어떤 목표를 달성하기 위해 서로 협력하는 객체를 묘사하는 협력자(collaborator) 라는 단어가 있다. UoW와 Repository는 객체 모델링의 측면에서 아주 적절한 협력자의 예시라 할 수 있다. 책임 주도 설계에서 자신의 역할 안에서 협력하는 여러 객체를 이웃 객체(object neighborhood)라고 한다.&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[파이썬으로 살펴보는 아키텍처 패턴 (5)]]></title><description><![CDATA[파이썬으로 살펴보는 아키텍처 패턴을 읽고 이해한 내용을 작성합니다. 챕터 5, 높은 기어비와 낮은 기어비의 TDD에 대한 내용입니다.]]></description><link>https://blog.s3ich4n.me/books/cosmic-python/2023-04-16-pt01-ch05</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/cosmic-python/2023-04-16-pt01-ch05</guid><pubDate>Sun, 16 Apr 2023 03:26:01 GMT</pubDate><content:encoded>&lt;p&gt;이 내용은 “파이썬으로 살펴보는 아키텍처 패턴” 을 읽고 작성한 내용입니다. 블로그 게시글과, 작성한 코드를 함께 보시면 더욱 좋습니다.&lt;/p&gt;
&lt;p&gt;5장은 해당 코드를 살펴봐주세요. &lt;a href=&quot;https://github.com/s3ich4n/cosmicpython-study/tree/main/pt1/ch05&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;코드 링크&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;5장-tdd-in-high-gear-and-low-gear&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#5%EC%9E%A5-tdd-in-high-gear-and-low-gear&quot; aria-label=&quot;5장 tdd in high gear and low gear permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;5장 &lt;strong&gt;TDD in High Gear and Low Gear&lt;/strong&gt;&lt;/h1&gt;
&lt;p&gt;기어비가 뭔소린가 했는데 걍 1단 2단 … 그거였음. 스틱 몰 때의 그것.&lt;/p&gt;
&lt;p&gt;4장까지 오면서 서비스계층으로 작동하는 애플리케이션에 필요한 오케스트레이션 책임을 좀 나눴다. 서비스 계층을 씀으로 인해 유스케이스와 워크플로우를 명확히 나눌 수 있었다.&lt;/p&gt;
&lt;p&gt;이를 통해 4.5.1에서 말한 아래 내용을 점검할 수 있다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;저장소에서 객체를 가져온다&lt;/li&gt;
&lt;li&gt;애플리케이션이 아는 세계를 바탕으로 요청검사/검증(assertion) 한다&lt;/li&gt;
&lt;li&gt;도메인 서비스를 호출한다&lt;/li&gt;
&lt;li&gt;모두 정상실행했다면 변경된 상태를 저장/업데이트 한다&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;현재 단위테스트는 저수준에서 작동하며 모델에 직접 작용한다. 5장에서는 이런 테스트를 보다 상위 계층으로 끌어올려본다. 이때 해당하는 트레이드오프와 더 많은 일반적 테스트 지침을 살펴보자.&lt;/p&gt;
&lt;h1 id=&quot;51-테스트-피라미드는-어떻게-생겼나&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#51-%ED%85%8C%EC%8A%A4%ED%8A%B8-%ED%94%BC%EB%9D%BC%EB%AF%B8%EB%93%9C%EB%8A%94-%EC%96%B4%EB%96%BB%EA%B2%8C-%EC%83%9D%EA%B2%BC%EB%82%98&quot; aria-label=&quot;51 테스트 피라미드는 어떻게 생겼나 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;5.1 테스트 피라미드는 어떻게 생겼나?&lt;/h1&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;cosmic-python-py3.10&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; C:&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;cosmic_python&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;pt1&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;ch0&lt;span class=&quot;token operator&quot;&gt;&lt;span class=&quot;token file-descriptor important&quot;&gt;5&lt;/span&gt;&gt;&lt;/span&gt;pytest --collect-only &lt;span class=&quot;token parameter variable&quot;&gt;-qq&lt;/span&gt;
pt1/ch05/tests/e2e/test_app.py: &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;

pt1/ch05/tests/integration/test_repository.py: &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;

pt1/ch05/tests/unit/test_allocate.py: &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;
pt1/ch05/tests/unit/test_batches.py: &lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt;
pt1/ch05/tests/unit/test_services.py: &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;그래도 피라미드처럼 생기긴 했구나…&lt;/p&gt;
&lt;h1 id=&quot;52-도메인-계층-테스트를-서비스-계층으로-옮겨야하나&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#52-%EB%8F%84%EB%A9%94%EC%9D%B8-%EA%B3%84%EC%B8%B5-%ED%85%8C%EC%8A%A4%ED%8A%B8%EB%A5%BC-%EC%84%9C%EB%B9%84%EC%8A%A4-%EA%B3%84%EC%B8%B5%EC%9C%BC%EB%A1%9C-%EC%98%AE%EA%B2%A8%EC%95%BC%ED%95%98%EB%82%98&quot; aria-label=&quot;52 도메인 계층 테스트를 서비스 계층으로 옮겨야하나 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;5.2 도메인 계층 테스트를 서비스 계층으로 옮겨야하나?&lt;/h1&gt;
&lt;p&gt;한 단계 더 나아가면…&lt;/p&gt;
&lt;p&gt;서비스 계층에 대해 소프트웨어를 테스트하기 때문에 더이상 도메인 모델 테스트가 필요없다. 대신 1장에서 작성한 도메인 레벨의 테스트를 서비스 계층에 대한 테스트로 재작성한다.&lt;/p&gt;
&lt;h2 id=&quot;추상화를-한-단계-끌어올리자&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%B6%94%EC%83%81%ED%99%94%EB%A5%BC-%ED%95%9C-%EB%8B%A8%EA%B3%84-%EB%81%8C%EC%96%B4%EC%98%AC%EB%A6%AC%EC%9E%90&quot; aria-label=&quot;추상화를 한 단계 끌어올리자 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;추상화를 한 단계 끌어올리자!&lt;/h2&gt;
&lt;h3 id=&quot;이-코드를&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%B4-%EC%BD%94%EB%93%9C%EB%A5%BC&quot; aria-label=&quot;이 코드를 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;이 코드를…&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_prefers_current_stock_batches_to_shipments&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    in_stock_batch &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Batch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;in-stock-batch&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;RETRO-CLOCK&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; eta&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    shipment_batch &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Batch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;shipment-batch&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;RETRO-CLOCK&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; eta&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;tomorrow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    line &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; OrderLine&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;oref&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;RETRO-CLOCK&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;in_stock_batch&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; shipment_batch&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; in_stock_batch&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;available_quantity &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;90&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; shipment_batch&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;available_quantity &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;대충-이런-식으로&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8C%80%EC%B6%A9-%EC%9D%B4%EB%9F%B0-%EC%8B%9D%EC%9C%BC%EB%A1%9C&quot; aria-label=&quot;대충 이런 식으로 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;대충 이런 식으로…&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mark&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;asyncio&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_prefers_current_stock_batches_to_shipments&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    in_stock_batch &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Batch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;in-stock-batch&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;RETRO-CLOCK&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; eta&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    shipment_batch &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Batch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;shipment-batch&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;RETRO-CLOCK&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; eta&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;tomorrow&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    repo &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; FakeRepository&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;in_stock_batch&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; shipment_batch&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    line &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;OrderLine&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;oref&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;RETRO-CLOCK&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; services&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; repo&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; FakeSession&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; in_stock_batch&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;available_quantity &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;90&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; shipment_batch&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;available_quantity &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;이걸-왜-함&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%B4%EA%B1%B8-%EC%99%9C-%ED%95%A8&quot; aria-label=&quot;이걸 왜 함 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;이걸 왜 함?&lt;/h2&gt;
&lt;p&gt;테스트로 시스템을 보다 쉽게 바꿀 수 있다는 것은 동의한다. 체감도 해봤으니까.&lt;/p&gt;
&lt;p&gt;하지만 저자는 도메인 모델에 의해 시간을 너무 허비하는 경우가 있을 수 있다고 한다. 코드베이스 하나 고치면 수십 수백개의 제반기능 테스트가 바뀔 수도 있으니까…&lt;/p&gt;
&lt;p&gt;테스트의 목적을 잘 생각해보자.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;변하면 안 되는 시스템의 특성을 강제로 유지하기 위해 사용한다&lt;/li&gt;
&lt;li&gt;E.g.,
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;200&lt;/code&gt; 리턴이 계속 뜨는지?&lt;/li&gt;
&lt;li&gt;DB 세션이 커밋하고 있는지?&lt;/li&gt;
&lt;li&gt;도메인 로직이 여전히 도는지?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;클린코드에서는 내게 &lt;a href=&quot;https://blog.s3ich4n.me/books/clean-code/2023-02-10-pt09#%EA%B9%A8%EB%81%97%ED%95%9C-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%BD%94%EB%93%9C-%EC%9C%A0%EC%A7%80%ED%95%98%EA%B8%B0&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;뭐라 말했는지&lt;/a&gt; 떠올려보자&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;깨끗한 테스트코드?&lt;/li&gt;
&lt;li&gt;테스트의 존재의의는 실제 코드 점검&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;⇒ 이는 설계와 아키텍처를 깨끗하게 보존하는 열쇠!
- 이게 있어야 로직 고치기가 쉽다&lt;/p&gt;
&lt;p&gt;잘 생각해보자. 프로그램을 바꾸면 테스트가 깨진다. 코드의 설계를 바꿀 때 코드에 의존하는 테스트가 실패한다는 뜻이다.&lt;/p&gt;
&lt;p&gt;책은 서비스 계층이 시스템을 다양한 방식으로 조정할 수 있는 API를 형성하게 된다는 점을 시사한다. API에 대해 테스트를 짜면 도메인 모델 리팩토링 시 변경해야하는 코드를 줄일 수 있다. 서비스 계층 테스트만 하도록 제한하고, 모델 객체의 ‘사적인’ 속성이나 메소드, 테스트가 직접 상호작용하지 못하게 하면 모델객체를 보다 자유롭게 리팩토링할 수 있다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;테스트에 넣는 코드는 하나하나가 본드방울 같아서 시스템을 특정 모양으로 만든다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;테스트가 저수준이면 시스템 각 부분을 바꾸기가 어려워진다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;53-어떤-종류의-테스트를-싸야할까&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#53-%EC%96%B4%EB%96%A4-%EC%A2%85%EB%A5%98%EC%9D%98-%ED%85%8C%EC%8A%A4%ED%8A%B8%EB%A5%BC-%EC%8B%B8%EC%95%BC%ED%95%A0%EA%B9%8C&quot; aria-label=&quot;53 어떤 종류의 테스트를 싸야할까 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;5.3 어떤 종류의 테스트를 싸야할까?&lt;/h1&gt;
&lt;p&gt;“그럼 죄다 다시 짜요?” 할 것이다. 이 질문에 답하기 위해선 결합과 설계 피드백 사이의 트레이드오프를 반드시 이해해야한다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;%5Bhttps://www.cosmicpython.com/book/images/apwp_0501.png%5D(https://www.cosmicpython.com/book/images/apwp_0501.png)&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;익스트림 프로그래밍(XP)에서는 ‘코드에 귀기울여라(listen to the code)’ 라고 한다. (?) 테스트를 짤 때, 테스트 대상인 코드가 쓰기 어려운 코드인걸 발견하거나 코드 냄새를 맡을 수도 있다. 이러면 리팩토링하고 설계를 재점검 한다.&lt;/p&gt;
&lt;p&gt;하지만 대상 코드와 더 밀접하게 연관되어 작업할 때만 이런 피드백을 받을 수 있다. HTTP API에 대한 테스트는 훨씬 더 높은 수준의 추상화를 사용하므로 객체의 세부설계에 대한 피드백을 제공하지 않는다.&lt;/p&gt;
&lt;p&gt;전체 앱을 다시짜도 URL, 요청형식을 바꾸는게 아니면 앱은 HTTP 테스트를 계속 통과한다. 이러면 DB 스키마 변경 등의 대규모 변경 시에도 코드가 안망가지겠다 하는 자신감이 붙는다.&lt;/p&gt;
&lt;p&gt;이런 스펙트럼의 반대쪽에는 1장같은 테스트가 있다. 이런 테스트가 있으면 객체에 대한 이해증진에 크게 도움이 된다. 도메인 언어가 곧 테스트니까.&lt;/p&gt;
&lt;p&gt;이런 수준에서의 테스트는 새 행동양식을 ‘스케치’ 하고 코드가 어떻게 생겼는지를 살펴볼 수 있다. 하지만 이런 테스트는 특정 구현과 긴밀하게 연관되어있어서 코드 디자인을 개선하려면 이런 테스트를 다른 테스트로 대치하거나 바꿔야 한다.&lt;/p&gt;
&lt;h1 id=&quot;54-high-and-low-gear&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#54-high-and-low-gear&quot; aria-label=&quot;54 high and low gear permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;5.4 High and Low Gear&lt;/h1&gt;
&lt;p&gt;새 기능을 추가하거나 버그를 수정할 때 도메인 모델을 크게 바꿀 필요가 없다. 도메인 모델을 바꿔야 하는 경우 더 낮은 결합과 더 높은 커버리지를 제공하므로 서비스에 대한 테스트를 작성하는 게 더 좋다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;add_stock&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;cancel_order&lt;/code&gt; 같은 함수를 만드는 경우, 서비스 계층에 대한 테스트를 짜면 좀 더 빠르게 결합이 적은 테스트를 작성할 수 있다.&lt;/p&gt;
&lt;p&gt;새 플젝을 시작하거나 아주 어려운 특정 문제를 다뤄야 한다면 도메인 모델에 대한 테스트를 다시 짜서, 이를 통한 피드백을 얻고 의도를 더 명확하게 설명하는 “살아있는” 문서(테스트코드!)를 얻을 수 있다.&lt;/p&gt;
&lt;p&gt;이래서 필자는 저단기어, 고단기어라는 메타포(은유)를 사용했다. low gear로 빠르게 움직이기 시작하면 high gear로 바꿔서 더 빠르게 움직일 수 있다. 위험해서 속도를 낮춰야되면 기어비를 낮춰야된다.&lt;/p&gt;
&lt;h1 id=&quot;55-서비스-계층-테스트를-도메인으로부터-분리하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#55-%EC%84%9C%EB%B9%84%EC%8A%A4-%EA%B3%84%EC%B8%B5-%ED%85%8C%EC%8A%A4%ED%8A%B8%EB%A5%BC-%EB%8F%84%EB%A9%94%EC%9D%B8%EC%9C%BC%EB%A1%9C%EB%B6%80%ED%84%B0-%EB%B6%84%EB%A6%AC%ED%95%98%EA%B8%B0&quot; aria-label=&quot;55 서비스 계층 테스트를 도메인으로부터 분리하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;5.5 서비스 계층 테스트를 도메인으로부터 분리하기&lt;/h1&gt;
&lt;p&gt;서비스 테스트에는 도메인 모델에 대한 의존성이 있다. 테스트 데이터 설정 및 서비스 계층 함수 호출을 위해 도메인 객체를 쓰기 때문이다.&lt;/p&gt;
&lt;p&gt;이를 위해 원시타입만 사용하도록 다시 짜야한다.&lt;/p&gt;
&lt;p&gt;서비스 안의 &lt;code class=&quot;language-text&quot;&gt;allocate()&lt;/code&gt; 함수부터 시작하자.&lt;/p&gt;
&lt;p&gt;테스트가 함수를 호출하면서 원시타입을 쓰게 리팩토링 후… 5.5.1을 통해 헬퍼 함수나 픽스처로 도메인 모델을 내보내는 추상화를 한다. → 이러면 테스트의 의존성은 최대한 떨어뜨릴 수 있다.&lt;/p&gt;
&lt;p&gt;해당 서비스 로직에서는 모델을 쓰도록 한다!&lt;/p&gt;
&lt;h2 id=&quot;551-바꿔보자-1&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#551-%EB%B0%94%EA%BF%94%EB%B3%B4%EC%9E%90-1&quot; aria-label=&quot;551 바꿔보자 1 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;5.5.1 바꿔보자 (1)&lt;/h2&gt;
&lt;h3 id=&quot;테스트가-이렇게-풀리고&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%85%8C%EC%8A%A4%ED%8A%B8%EA%B0%80-%EC%9D%B4%EB%A0%87%EA%B2%8C-%ED%92%80%EB%A6%AC%EA%B3%A0&quot; aria-label=&quot;테스트가 이렇게 풀리고 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;테스트가 이렇게 풀리고&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;FakeRepository&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;AbstractRepository&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@staticmethod&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;for_batch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ref&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; qty&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; eta&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; FakeRepository&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
            model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Batch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ref&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; qty&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; eta&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# for_batch 같은 팩토리 함수를 만들어서 모든 도메인 의존성을 픽스처에 옮긴다!&lt;/span&gt;
&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mark&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;asyncio&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_returns_allocation&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    repo &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; FakeRepository&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;for_batch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;b1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;COMPLICATED-LAMP&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; eta&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; services&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;o1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;COMPLICATED-LAMP&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; repo&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; FakeSession&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; result &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;b1&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;본-로직은-이렇게-풀린다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%B3%B8-%EB%A1%9C%EC%A7%81%EC%9D%80-%EC%9D%B4%EB%A0%87%EA%B2%8C-%ED%92%80%EB%A6%B0%EB%8B%A4&quot; aria-label=&quot;본 로직은 이렇게 풀린다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;본 로직은 이렇게 풀린다&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;allocate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        orderid&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        sku&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        qty&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        repo&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; repository&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractRepository&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        session&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot; batches를 line에 할당한다.

    FYI,
        의존성 역전 원칙이 여기 들어감에 유의!
        고수준 모듈인 서비스 계층은 저장소라는 추상화에 의존한다.
        구현의 세부내용은 어떤 영속 저장소를 선택했느냐에 따라 다르지만
        같은 추상화에 의존한다.

    :param orderid:
    :param sku:
    :param qty:
    :param repo:
    :param session:
    :return:
    &quot;&quot;&quot;&lt;/span&gt;
    line &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;OrderLine&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;orderid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; qty&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    batches &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; repo&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;not&lt;/span&gt; is_valid_sku&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; batches&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; InvalidSku&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&apos;Invalid sku &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    batchref &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; batches&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;commit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; batchref&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;552-추가해보자-2&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#552-%EC%B6%94%EA%B0%80%ED%95%B4%EB%B3%B4%EC%9E%90-2&quot; aria-label=&quot;552 추가해보자 2 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;5.5.2 추가해보자 (2)&lt;/h2&gt;
&lt;p&gt;재고 추가 서비스(&lt;code class=&quot;language-text&quot;&gt;add_batch&lt;/code&gt;)를 만든다고 하자. 서비스 계층의 공식적인 유스케이스를 쓰는 서비스 계층 테스트 작성이 가능하다. 도메인에 대한 의존관계 또한 떼어낼 수 있다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;저자의 팁&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;일반적으로 서비스 계층 테스트에서 도메인 계층에 있는 요소가 필요하다면
이는 서비스 계층이 완전하지 않다는 사실을 보여주는 지표&lt;em&gt;일 수 있다&lt;/em&gt;(&lt;em&gt;it may be an indication that your service layer is incomplete)&lt;/em&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;테스트는-이렇게&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%85%8C%EC%8A%A4%ED%8A%B8%EB%8A%94-%EC%9D%B4%EB%A0%87%EA%B2%8C&quot; aria-label=&quot;테스트는 이렇게 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;테스트는 이렇게&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@pytest&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;mark&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;asyncio&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test_add_batch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    repo&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; session &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; FakeRepository&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; FakeSession&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; services&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add_batch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;b1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;CRUNCHY-ARMCHAIR&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; repo&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; repo&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;b1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;assert&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;committed&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;서비스-코드는-이렇게&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%BD%94%EB%93%9C%EB%8A%94-%EC%9D%B4%EB%A0%87%EA%B2%8C&quot; aria-label=&quot;서비스 코드는 이렇게 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;서비스 코드는 이렇게&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add_batch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        ref&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        sku&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        qty&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        eta&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Optional&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;date&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        repo&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; repository&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractRepository&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        session&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; repo&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Batch&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ref&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; qty&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; eta&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;commit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;진짜 최소한의 사용만을 했다.&lt;/p&gt;
&lt;p&gt;저자가 원하는 것은 &lt;strong&gt;모든&lt;/strong&gt; 서비스 계층 테스트에 대해 의존성 없이 오직 서비스 자체와 원시타입만을 이용해서 짜는 것이다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;저자는 &lt;code class=&quot;language-text&quot;&gt;add_batch&lt;/code&gt; 가 필요할 수도 있으니 만들어두고 테스트에서 의존성도 떼어냈다. 그래서 언제든지 리팩토링할 수 있는 것이다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;56-e2e-테스트에-도달할-때-까지-계속-개선하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#56-e2e-%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%97%90-%EB%8F%84%EB%8B%AC%ED%95%A0-%EB%95%8C-%EA%B9%8C%EC%A7%80-%EA%B3%84%EC%86%8D-%EA%B0%9C%EC%84%A0%ED%95%98%EA%B8%B0&quot; aria-label=&quot;56 e2e 테스트에 도달할 때 까지 계속 개선하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;5.6 E2E 테스트에 도달할 때 까지 계속 개선하기&lt;/h1&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;add_batch&lt;/code&gt; 를 추가해서 서비스 계층 테스트를 모델에서 분리할 수 있었다.&lt;/p&gt;
&lt;p&gt;배치를 추가하는 API 엔드포인트를 추가하면 &lt;code class=&quot;language-text&quot;&gt;add_stock&lt;/code&gt; 같은 픽스처를 없앨 수도 있다.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;이건 좀 신박하네…. 어차피 필요한 기능이다 싶어서 과감하게 넣은건가? 이러면 테스트용 API 이런식인가?&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;이거 정상적으로 돌리는건 UoW 되고나서 다시 할거다.&lt;/p&gt;
&lt;p&gt;하드코딩 SQL을 API콜로 바꾸면 API를 제외한 의존성을 분리완료했다는 의미가 된다(!).&lt;/p&gt;
&lt;h1 id=&quot;57-마치며&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#57-%EB%A7%88%EC%B9%98%EB%A9%B0&quot; aria-label=&quot;57 마치며 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;5.7 마치며&lt;/h1&gt;
&lt;p&gt;서비스 계층을 만들면 대부분의 테스트를 단위 테스트로 옮기고 건전한 테스트 피라미드(&lt;em&gt;a healthy test pyramid&lt;/em&gt;)를 만들 수 있다.&lt;/p&gt;
&lt;p&gt;여러 유형의 테스트를 작성하는 간단한 규칙&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;‘특성 당 E2E 테스트 하나를 만든다’ 라는 목표를 잡자
&lt;ol&gt;
&lt;li&gt;이런 식의 테스트는 HTTP API를 쓸 가능성이 높다. 피처가 잘 작동하는 지 보고, 이에 따라 움직이는 모든 부품이 잘 연결되는지 살펴보는 것이다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;테스트 대부분은 서비스 계층을 사용하여 만드는 것을 권한다.
&lt;ol&gt;
&lt;li&gt;이런 식의 테스트는 커버리지, 실행 시간, 효율 사이를 잘 절충하도록 도와준다.
&lt;ol&gt;
&lt;li&gt;각 테스트는 어떤 기능의 한 경로를 테스트하고 I/O에 가짜 객체(&lt;em&gt;fakes for I/O&lt;/em&gt;)를 사용하는 경향이 있다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;이런 테스트는 모든 edge case를 다루고, 비즈니스 로직의 모든 입력/출력을 테스트해볼 수 있다.
&lt;ol&gt;
&lt;li&gt;8장을 보고나서 업데이트 할 것이다. 서로 협력하는 도메인 객체 사이의 저수준 단위 테스트를 제거함으로서 배워보자.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;도메인 모델을 사용하는 핵심 테스트를 적게 작성하고 유지하자
&lt;ol&gt;
&lt;li&gt;이런 테스트는 커버리지가 작고(좁은 범위를 테스트), 더 깨지기 쉽다. 하지만 이 테스트가 제공하는 피드백이 가장 크다.&lt;/li&gt;
&lt;li&gt;이런 테스트를 서비스 계층 기반으로 바꿀 수 있으면 바로바로 하는 것을 권한다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;오류 처리도 특성으로 취급하자
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;이상적인 경우&lt;/strong&gt; 앱은 모든 오류가 엔트리포인트까지(나는 FastAPI) 올라와서 처리된다.즉 테스트를 아래와 같이 유지하면 된다는 뜻이다:
&lt;ol&gt;
&lt;li&gt;모든 비정상경로를 테스트하는 E2E 테스트 한개&lt;/li&gt;
&lt;li&gt;각 기능의 정상경로만 테스트&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;</content:encoded></item><item><title><![CDATA[파이썬으로 살펴보는 아키텍처 패턴 (4)]]></title><description><![CDATA[파이썬으로 살펴보는 아키텍처 패턴을 읽고 이해한 내용을 작성합니다. 챕터 4, 결합과 추상화에 대한 내용입니다.]]></description><link>https://blog.s3ich4n.me/books/cosmic-python/2023-04-15-pt01-ch04</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/cosmic-python/2023-04-15-pt01-ch04</guid><pubDate>Sat, 15 Apr 2023 22:19:24 GMT</pubDate><content:encoded>&lt;p&gt;이 내용은 “파이썬으로 살펴보는 아키텍처 패턴” 을 읽고 작성한 내용입니다. 블로그 게시글과, 작성한 코드를 함께 보시면 더욱 좋습니다.&lt;/p&gt;
&lt;p&gt;4장은 해당 코드를 살펴봐주세요. &lt;a href=&quot;https://github.com/s3ich4n/cosmicpython-study/tree/main/pt1/ch04&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;코드 링크&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;4장-api와-서비스-계층&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#4%EC%9E%A5-api%EC%99%80-%EC%84%9C%EB%B9%84%EC%8A%A4-%EA%B3%84%EC%B8%B5&quot; aria-label=&quot;4장 api와 서비스 계층 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4장 API와 서비스 계층&lt;/h1&gt;
&lt;p&gt;이런 구조를 만들 것이다&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.cosmicpython.com/book/images/apwp_0401.png&quot; alt=&quot;Untitled&quot;&gt;&lt;/p&gt;
&lt;p&gt;이 장에서는 오케스트레이션 로직, 비즈니스 로직, 연결 코드 사이의 차이를 이해한다. 워크플로우 조정 및 시스템의 유스케이스를 정의하는 서비스 계층 패턴을 알아본다.&lt;/p&gt;
&lt;p&gt;테스트도 살펴본다. 서비스 계층과 데이터베이스에 대한 저장소 추상화를 조합할 것이다. 이를 통해 도메인 모델 뿐 아니라 유스케이스의 전체 워크플로우를 테스트할 것이다.&lt;/p&gt;
&lt;p&gt;테스트할 때 보면 프로덕션 코드는 &lt;code class=&quot;language-text&quot;&gt;SqlAlchemyRepository&lt;/code&gt; 를 쓰고, 테스트할 때는 &lt;code class=&quot;language-text&quot;&gt;FakeRepository&lt;/code&gt;를 쓰게 한다.&lt;/p&gt;
&lt;h1 id=&quot;41-애플리케이션을-실세계와-연결하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#41-%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98%EC%9D%84-%EC%8B%A4%EC%84%B8%EA%B3%84%EC%99%80-%EC%97%B0%EA%B2%B0%ED%95%98%EA%B8%B0&quot; aria-label=&quot;41 애플리케이션을 실세계와 연결하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.1 애플리케이션을 실세계와 연결하기&lt;/h1&gt;
&lt;p&gt;이게 가장 빨라야한다! MVP니까…&lt;/p&gt;
&lt;p&gt;도메인에 필요한걸 만들고 주문할당(allocate)을 하는 도메인 서비스도 만들었고, 리포지토리 인터페이스도 만들었다…&lt;/p&gt;
&lt;p&gt;그러면 다음 할 일은 아래와 같다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;플라스크를 써서 &lt;code class=&quot;language-text&quot;&gt;allocate&lt;/code&gt; 도메인 서비스 앞에 API 엔드포인트를 둔다. DB 세션과 저장소를 연결한다. 이렇게 만든 시스템은 e2e 테스트와 빠르게 만든 SQL 문으로 테스트한다.&lt;/li&gt;
&lt;li&gt;서비스 계층을 리팩토링한다. 플라스크와 도메인 모델 사이에 유스케이스를 담는 추상화 계층을 만든다. 몇 가지 서비스 계층 테스트를 만들고 &lt;code class=&quot;language-text&quot;&gt;FakeRepository&lt;/code&gt; 를 써서 코드를 테스트한다.&lt;/li&gt;
&lt;li&gt;서비스 계층의 기능을 여러 유형의 파라미터로 실험한다. 원시 데이터 타입으로 서비스 계층의 클라이언트 (테스트와 API)를 모델에서 분리해본다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;42-첫-e2e-테스트&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#42-%EC%B2%AB-e2e-%ED%85%8C%EC%8A%A4%ED%8A%B8&quot; aria-label=&quot;42 첫 e2e 테스트 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.2 첫 E2E 테스트&lt;/h1&gt;
&lt;p&gt;실제 API 엔드포인트(HTTP)와 실제 DB를 사용하는 테스트를 한, 두개정도 짜고 리팩토링 또 한다.&lt;/p&gt;
&lt;p&gt;일단 처음엔 어쨌거나 만든다. 랜덤 문자열을 생성하고, DB에 row를 넣는 함수를 실제로 짠다.&lt;/p&gt;
&lt;h1 id=&quot;43-직접-구현하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#43-%EC%A7%81%EC%A0%91-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0&quot; aria-label=&quot;43 직접 구현하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.3 직접 구현하기&lt;/h1&gt;
&lt;p&gt;책에선 플라스크를, 나는 FastAPI를 통해서 짰다. 그런데 이 테스트의 한계는 DB커밋을 해야한다는 점이다.&lt;/p&gt;
&lt;h1 id=&quot;44-db-검사가-필요한-오류조건&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#44-db-%EA%B2%80%EC%82%AC%EA%B0%80-%ED%95%84%EC%9A%94%ED%95%9C-%EC%98%A4%EB%A5%98%EC%A1%B0%EA%B1%B4&quot; aria-label=&quot;44 db 검사가 필요한 오류조건 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.4 DB 검사가 필요한 오류조건&lt;/h1&gt;
&lt;p&gt;이런 케이스는 DB 측의 데이터 무결성 검사다. 도메인 서비스 호출 전에 캐치해야한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;도메인이 재고가 소진된 sku에 대해 예외가 발생하면?&lt;/li&gt;
&lt;li&gt;존재하지 않는 sku에 대한 예외처리는?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;근데 이 방어로직을 API에 넣으면 E2E 테스트 갯수가 점점 많아지게되고 역피라미드형 테스트가 된다. 테스트코드도 꼬인다…&lt;/p&gt;
&lt;p&gt;따라서, API에 있던 일부 로직을 유스케이스로 빼고, 이를 테스트하기 위해 &lt;code class=&quot;language-text&quot;&gt;FakeRepository&lt;/code&gt;를 쓸 때가 왔다.&lt;/p&gt;
&lt;h1 id=&quot;45-서비스-계층-소개와-서비스-계층-테스트용-fakerepository-사용&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#45-%EC%84%9C%EB%B9%84%EC%8A%A4-%EA%B3%84%EC%B8%B5-%EC%86%8C%EA%B0%9C%EC%99%80-%EC%84%9C%EB%B9%84%EC%8A%A4-%EA%B3%84%EC%B8%B5-%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%9A%A9-fakerepository-%EC%82%AC%EC%9A%A9&quot; aria-label=&quot;45 서비스 계층 소개와 서비스 계층 테스트용 fakerepository 사용 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.5 서비스 계층 소개와 서비스 계층 테스트용 &lt;code class=&quot;language-text&quot;&gt;FakeRepository&lt;/code&gt; 사용&lt;/h1&gt;
&lt;p&gt;API는 가만보면 오케스트레이션이다. 저장소에서 뭐 갖고와서 DB 상태에 맞게 검증도 하고 오류 처리도 하고, 성공적이면 DB에 값도 커밋한다. 근데 이런 작업은 API하고는 관련이 없다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;FakeRepository&lt;/code&gt; 를 이용해서 진짜 손쉽게 AAA 테스트코드를 구현했다&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;FakeSession&lt;/code&gt; 을 이용해서 세션도 가짜로 만든다. 6장서 리팩토링할거다&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;→ 당연하겠지만 커밋도 테스트 대상이다&lt;/p&gt;
&lt;h2 id=&quot;451-서비스-함수-작성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#451-%EC%84%9C%EB%B9%84%EC%8A%A4-%ED%95%A8%EC%88%98-%EC%9E%91%EC%84%B1&quot; aria-label=&quot;451 서비스 함수 작성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.5.1 서비스 함수 작성&lt;/h2&gt;
&lt;p&gt;이런 구성을 가져간다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;저장소에서 객체를 가져온다&lt;/li&gt;
&lt;li&gt;애플리케이션이 아는 세계를 바탕으로 요청검사/검증(assertion) 한다&lt;/li&gt;
&lt;li&gt;도메인 서비스를 호출한다&lt;/li&gt;
&lt;li&gt;모두 정상실행했다면 변경된 상태를 저장/업데이트 한다&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;452-deallocate-을-만든다면&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#452-deallocate-%EC%9D%84-%EB%A7%8C%EB%93%A0%EB%8B%A4%EB%A9%B4&quot; aria-label=&quot;452 deallocate 을 만든다면 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.5.2 &lt;code class=&quot;language-text&quot;&gt;deallocate&lt;/code&gt; 을 만든다면?&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;제 1 사이클: 일단 짜자
&lt;ul class=&quot;contains-task-list&quot;&gt;
&lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; disabled&gt;  deallocate하는 도메인 로직부터 짜고 테스트한다&lt;/li&gt;
&lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; disabled&gt;  저장소 로직을 만든다&lt;/li&gt;
&lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; disabled&gt;  유스케이스를 만든다&lt;/li&gt;
&lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; disabled&gt;  e2e를 만든다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;제 2 사이클: 3장에서 본 내용을 적용해보자…
&lt;ul class=&quot;contains-task-list&quot;&gt;
&lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; disabled&gt;  올바른 추상화를 하고있나?&lt;/li&gt;
&lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; disabled&gt;  바운더리가 어디어디 끊어지고, 이를 함수레벨로 나눌 수 있을까?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;UoW 하고나서 다시 할거다…&lt;/p&gt;
&lt;h1 id=&quot;46-왜-서비스라-부름&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#46-%EC%99%9C-%EC%84%9C%EB%B9%84%EC%8A%A4%EB%9D%BC-%EB%B6%80%EB%A6%84&quot; aria-label=&quot;46 왜 서비스라 부름 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.6 왜 서비스라 부름?&lt;/h1&gt;
&lt;p&gt;여기서 서비스라 부르는건 두 가지가 있다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;도메인 서비스
&lt;ol&gt;
&lt;li&gt;도메인 모델에 속하지만, 엔티티/VO에 속하지 않는 로직을 부르는 이름이다.&lt;/li&gt;
&lt;li&gt;E.g., 쇼핑카트 애플리케이션을 만든다고 할 때
&lt;ol&gt;
&lt;li&gt;도메인 서비스로 세금 관련 규칙을 구현한다&lt;/li&gt;
&lt;li&gt;모델에서는 중요하지만, 세금 관련만을 위한 영속적 엔티티를 빼지 않으려고 하는 것이다&lt;/li&gt;
&lt;li&gt;구현한다면 &lt;code class=&quot;language-text&quot;&gt;TaxCalculator&lt;/code&gt; 라는 클래스나 &lt;code class=&quot;language-text&quot;&gt;calculate_tax&lt;/code&gt; 같은 함수들로 처리하면 될 것이다&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;서비스 계층
&lt;ol&gt;
&lt;li&gt;외부 세계로부터 오는 요청을 처리해 연산을 오케스트레이션 한다.&lt;/li&gt;
&lt;li&gt;아래 단계를 수행하여 애플리케이션을 제어한다
&lt;ol&gt;
&lt;li&gt;DB에서 데이터를 얻는다&lt;/li&gt;
&lt;li&gt;도메인 모델을 업데이트한다&lt;/li&gt;
&lt;li&gt;바뀐 내용을 영속화한다&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;비즈니스 로직과 떼어내서 프로그램을 깔끔하게 두자&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;461-처리과정&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#461-%EC%B2%98%EB%A6%AC%EA%B3%BC%EC%A0%95&quot; aria-label=&quot;461 처리과정 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.6.1 처리과정&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;또 리팩토링…&lt;/li&gt;
&lt;/ol&gt;
&lt;ul class=&quot;contains-task-list&quot;&gt;
&lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; checked disabled&gt;  개별 테스트도 메모리로 하면 되고, 값 준비해야되는걸 픽스처로 처리하자.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;yield&lt;/code&gt; 전후로 setup, teardown으로 두자&lt;/p&gt;
&lt;ul class=&quot;contains-task-list&quot;&gt;
&lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; checked disabled&gt;  DB initialize 로직을 실제 앱 실행, 테스팅 두가지로 나누고 providers override로 처리하자
&lt;ul class=&quot;contains-task-list&quot;&gt;
&lt;li class=&quot;task-list-item&quot;&gt;
&lt;p&gt;&lt;input type=&quot;checkbox&quot; checked disabled&gt;  이러면 의존성 역전이 되는건지 살펴보자&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;This helps in testing. This also helps in overriding API clients with stubs for the development or staging environment.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://python-dependency-injector.ets-labs.org/providers/overriding.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Provider overriding&lt;/a&gt; , Dependency Injector&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;되는듯!&lt;/p&gt;
&lt;/li&gt;
&lt;li class=&quot;task-list-item&quot;&gt;
&lt;p&gt;&lt;input type=&quot;checkbox&quot; checked disabled&gt;  일단 너무 많은기능을 한번에 할려는 것 같으니 구획을 좀 나눠보자&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;테스트 구동 프로시저
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;AsyncClient&lt;/code&gt;로 앱 구동함 → DB처리를 여기서도 함&lt;/li&gt;
&lt;li&gt;DB처리
&lt;ol&gt;
&lt;li&gt;‘엔진’ 생성&lt;/li&gt;
&lt;li&gt;메타데이터를 통한 테스트DB 생성&lt;/li&gt;
&lt;li&gt;SQLAlchemy의 ‘세션’ 생성&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;앱 구동 프로시저 (영 불안한 코드…)
&lt;ul&gt;
&lt;li&gt;ORM 사용을 위한 SQLAlchemy의 ‘매핑’ 수행&lt;/li&gt;
&lt;li&gt;세션메이커 만들고 필요할 때마다 yield 해가게 세팅함&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li class=&quot;task-list-item&quot;&gt;&lt;input type=&quot;checkbox&quot; checked disabled&gt;  도메인 서비스 관련 처리과정
&lt;ul&gt;
&lt;li&gt;테스트를 나눠서 성공했다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;서비스 계층 처리과정
&lt;ul&gt;
&lt;li&gt;UoW 로 나누면서 해결할거다. 지금은 세션의 아래 문제 때문에 못한다
&lt;ul&gt;
&lt;li&gt;처음 선언시 engine 주소&lt;/li&gt;
&lt;/ul&gt;
&lt;code class=&quot;language-text&quot;&gt;&amp;lt;pt1.ch04.adapters.postgres.AsyncSQLAlchemy object at 0x000002A79A5C7670&gt;&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;테스트 환경서…&lt;/li&gt;
&lt;/ul&gt;
override로 주입한 db의 engine 주소 &lt;code class=&quot;language-text&quot;&gt;&amp;lt;pt1.ch04.adapters.postgres.AsyncSQLAlchemy object at 0x000002A79AA650C0&gt;&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;다시 로직에서…&lt;/li&gt;
&lt;/ul&gt;
init_session_factory 으로 세션을 가져오는 sqlalchemy engine 주소 &lt;code class=&quot;language-text&quot;&gt;&amp;lt;pt1.ch04.adapters.postgres.AsyncSQLAlchemy object at 0x000002A79A5C7670&gt;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;즉, 주소가 다르니까 거기서 갖고와봤자… 이런걸로 진 빼지말고 개선하면서 해결하자&lt;/li&gt;
&lt;li&gt;❓이런 상황에서는 어떻게 시간분배를 해야할까? 이건 어디에 어떻게 물어보면 좋을까?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;47-디렉토리-구조를-잡자&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#47-%EB%94%94%EB%A0%89%ED%86%A0%EB%A6%AC-%EA%B5%AC%EC%A1%B0%EB%A5%BC-%EC%9E%A1%EC%9E%90&quot; aria-label=&quot;47 디렉토리 구조를 잡자 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.7 디렉토리 구조를 잡자&lt;/h1&gt;
&lt;p&gt;여기서는 책에서 제시하는 구조를 &lt;strong&gt;일단&lt;/strong&gt; 따른다. 주관은 지식이 생긴 후에 갖추는 것이 맞다고 생각한다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;domain&lt;/code&gt; → 도메인 모델
&lt;ol&gt;
&lt;li&gt;클래스마다 파일을 만든다&lt;/li&gt;
&lt;li&gt;엔티티 VO, Aggragate에 대한 부모 클래스도 여기에&lt;/li&gt;
&lt;li&gt;exception이나 command, event도 여기&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;service_layer&lt;/code&gt; → 서비스 계층
&lt;ol&gt;
&lt;li&gt;서비스 계층 예외가 추가가능&lt;/li&gt;
&lt;li&gt;uow를 여기…&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;adapters&lt;/code&gt; → ‘포트와 어댑터’ 용어에 사용된 &lt;strong&gt;어댑터&lt;/strong&gt;
&lt;ol&gt;
&lt;li&gt;외부 I/O를 감싸는 추상화(redis_client.py)를 넣음&lt;/li&gt;
&lt;li&gt;secondary adapter, driven adapter, inward-facing adapter 라고 일컫는다&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;entrypoints&lt;/code&gt; → 애플리케이션 제어 시점, ‘포트와 어댑터의’ &lt;strong&gt;어댑터&lt;/strong&gt;
&lt;ol&gt;
&lt;li&gt;primary adapter, driving adapter, outward-facing adatper 라고 일컫는다&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;포트&lt;/strong&gt;는? 어댑터가 구현하는 &lt;strong&gt;추상 인터페이스&lt;/strong&gt;이다. 포트를 구현하는 어댑터와 같은 파일 안에 포트를 넣는다.&lt;/p&gt;
&lt;h1 id=&quot;48-마무리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#48-%EB%A7%88%EB%AC%B4%EB%A6%AC&quot; aria-label=&quot;48 마무리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.8 마무리&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;API 엔드포인트가 얇고 짜기 쉬워진다 → 웹 기능만 모아놨다&lt;/li&gt;
&lt;li&gt;도메인에 대한 API 정의를 했다. 논리적인 작업을 통으로 모아놓은 엔트리포인트다&lt;/li&gt;
&lt;li&gt;서비스 계층의 장점은 아래와 같다
&lt;ul&gt;
&lt;li&gt;테스트를 ‘높은 기어비’로 작성할 수 있다&lt;/li&gt;
&lt;li&gt;도메인 모델을 적합한 형태로 리팩토리링 할 수 있다&lt;/li&gt;
&lt;li&gt;이를 활용하여 유스케이스를 제공할 수 있는 한 이미 존재하는 많은 테스트를 재작성하지 않고도 새 설계를 테스트할 수 있다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;테스트 피라미드도 (아직까지) 나쁘지 않다&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;481-dip가-어떻게-돌아가는지&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#481-dip%EA%B0%80-%EC%96%B4%EB%96%BB%EA%B2%8C-%EB%8F%8C%EC%95%84%EA%B0%80%EB%8A%94%EC%A7%80&quot; aria-label=&quot;481 dip가 어떻게 돌아가는지 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4.8.1 DIP가 어떻게 돌아가는지….&lt;/h2&gt;
&lt;p&gt;서비스 계층이 어떻게 의존하는지 다시 살펴보자.&lt;/p&gt;
&lt;p&gt;서비스 계층은 도메인 모델, &lt;code class=&quot;language-text&quot;&gt;AbstractRepository&lt;/code&gt; 를 받는다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;allocate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        line&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;OrderLine&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        repo&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; repository&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AbstractRepository&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        session&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot; batches를 line에 할당한다.

    FYI,
        의존성 역전 원칙이 여기 들어감에 유의!
        고수준 모듈인 서비스 계층은 저장소라는 추상화에 의존한다.
        구현의 세부내용은 어떤 영속 저장소를 선택했느냐에 따라 다르지만
        같은 추상화에 의존한다.

    :param line:
    :param repo:
    :param session:
    :return:
    &quot;&quot;&quot;&lt;/span&gt;
    batches &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; repo&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;not&lt;/span&gt; is_valid_sku&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; batches&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; InvalidSku&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&apos;Invalid sku &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sku&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    batchref &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; batches&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;commit&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; batchref&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;그죠?&lt;/p&gt;
&lt;p&gt;프로덕션 상에서는 &lt;code class=&quot;language-text&quot;&gt;SqlAlchemyRepository&lt;/code&gt;를 플라스크가 “제공” 하면 DIP가 이루어진다.&lt;/p&gt;
&lt;p&gt;여기까지의 트레이드오프를 살펴보자&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;장점&lt;/th&gt;
&lt;th&gt;단점&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;애플리케이션의 모든 유스케이스를 넣을 유일한 위치가 생긴다&lt;/td&gt;
&lt;td&gt;앱이 순수한 웹앱일 경우, 컨트롤러/뷰 함수는 모든 유스케이스를 넣을 유일한 위치가 된다&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;정교한 도메인로직을 API뒤로 숨긴다. 리팩토링이 쉬워진다&lt;/td&gt;
&lt;td&gt;서비스 계층도 또다른 추상화 계층이다&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;‘HTTP와 말하는 기능’을 ‘할당을 말하는 기능’으로부터 말끔하게 분리했다&lt;/td&gt;
&lt;td&gt;서비스 계층이 너무 커지면 anemic domain 이 된다. 컨트롤러에서 오케스트레이션 로직이 생길 때 서비스 계층을 만드는게 낫다&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;저장소 패턴 및 FakeRepository 와 조합하면 도메인 계층보다 더 높은 수준에서 테스트를 쓸 수 있다. 통합테스트 없이 개별 테스트가 가능해진다.&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;(5장에서 더 자세히 보자)&lt;/td&gt;
&lt;td&gt;풍부한 도메인 모델로 얻을 수 있는 이익 대부분은 단순히 컨트롤러에서 로직을 뽑아내 모델 계층으로 보내는 것 만으로 얻을 수 있다. 컨트롤러와 모델 계층 사이에 또다른 계층을 추가할 필요가 없다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;대부분의 경우 얇은 컨트롤러와 두꺼운 모델로 충분하기 때문이다.&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;개선해야 할 점도 있다&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;서비스 계층 API가 &lt;code class=&quot;language-text&quot;&gt;OrderLine&lt;/code&gt; 객체를 사용해 표현되므로, 서비스 계층이 여전히 도메인과 연관되어있다. 이 고리를 끊자.&lt;/li&gt;
&lt;li&gt;서비스 계층은 세션 객체와 밀접하게 결합되어 있다. UoW로 풀어보자.&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;끝으로&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%81%9D%EC%9C%BC%EB%A1%9C&quot; aria-label=&quot;끝으로 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;끝으로&lt;/h1&gt;
&lt;p&gt;잘 되겠지… 하는 코드를 점차 없애자. 저기서 문제가 나면 어떻게 할 거야…&lt;/p&gt;
&lt;p&gt;SQLAlchemy 2.0 쿼리 방안을 좀 익혀두자&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.sqlalchemy.org/en/20/changelog/migration_20.html#migration-orm-usage&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;SQLAlchemy 2.0 - Major Migration Guide
—
SQLAlchemy 2.0 Documentation&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;sqlite&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#sqlite&quot; aria-label=&quot;sqlite permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;sqlite?&lt;/h2&gt;
&lt;p&gt;SQLite는 딱히 TRUNCATE TABLE이 없다. 그래서 &lt;code class=&quot;language-text&quot;&gt;DELETE FROM&lt;/code&gt; 으로 다 날리면 된다&lt;/p&gt;
&lt;p&gt;한편 postgres에서 DB 테스트하고 날릴거면 &lt;code class=&quot;language-text&quot;&gt;nextval&lt;/code&gt; 시퀀스 초기화라거나 그런 부분들도 생각해야한다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[파이썬으로 살펴보는 아키텍처 패턴 (3)]]></title><description><![CDATA[파이썬으로 살펴보는 아키텍처 패턴을 읽고 이해한 내용을 작성합니다. 챕터 3, 결합과 추상화에 대한 내용입니다.]]></description><link>https://blog.s3ich4n.me/books/cosmic-python/2023-04-13-pt01-ch03</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/cosmic-python/2023-04-13-pt01-ch03</guid><pubDate>Thu, 13 Apr 2023 22:51:20 GMT</pubDate><content:encoded>&lt;p&gt;이 내용은 “파이썬으로 살펴보는 아키텍처 패턴” 을 읽고 작성한 내용입니다. 블로그 게시글과, 작성한 코드를 함께 보시면 더욱 좋습니다.&lt;/p&gt;
&lt;p&gt;3장은 해당 코드를 살펴봐주세요. &lt;a href=&quot;https://github.com/s3ich4n/cosmicpython-study/tree/main/pt1/ch03&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;코드 링크&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;3장-결합과-추상화&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#3%EC%9E%A5-%EA%B2%B0%ED%95%A9%EA%B3%BC-%EC%B6%94%EC%83%81%ED%99%94&quot; aria-label=&quot;3장 결합과 추상화 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3장 결합과 추상화&lt;/h1&gt;
&lt;p&gt;어떤 컴포넌트가 깨지는 것을 두려워해서 다른 컴포넌트롤 못건들이면, 두 컴포넌트가 결합되어 있다고 말한다. 결합은 엮여있음을 의미한다.&lt;/p&gt;
&lt;p&gt;그런데 지역적 결합은 ‘응집’이라고 표현한다.&lt;/p&gt;
&lt;p&gt;전역적 결합은 코드를 ‘진흙 공’ 처럼 서로 뭉치게 만든다. 앱이 커지면 커질 수록 결합을 훨씬 빠르게 하기 때문에 시스템은 사실상 고착화된다.&lt;/p&gt;
&lt;p&gt;따라서 추상화를 통해 세부사항을 감출 필요가 있다.&lt;/p&gt;
&lt;h1 id=&quot;31-추상적인-상태는-테스트를-더-쉽게-한다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#31-%EC%B6%94%EC%83%81%EC%A0%81%EC%9D%B8-%EC%83%81%ED%83%9C%EB%8A%94-%ED%85%8C%EC%8A%A4%ED%8A%B8%EB%A5%BC-%EB%8D%94-%EC%89%BD%EA%B2%8C-%ED%95%9C%EB%8B%A4&quot; aria-label=&quot;31 추상적인 상태는 테스트를 더 쉽게 한다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.1 추상적인 상태는 테스트를 더 쉽게 한다&lt;/h1&gt;
&lt;p&gt;따라가보자…&lt;/p&gt;
&lt;h2 id=&quot;요구사항&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9A%94%EA%B5%AC%EC%82%AC%ED%95%AD&quot; aria-label=&quot;요구사항 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;요구사항&lt;/h2&gt;
&lt;p&gt;두 파일 디렉토리를 동기화하는 코드를 작성하고자 한다. 각 디렉토리를 &lt;strong&gt;원본&lt;/strong&gt;, &lt;strong&gt;사본&lt;/strong&gt;이라고 하자.&lt;/p&gt;
&lt;h2 id=&quot;해야할일&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%95%B4%EC%95%BC%ED%95%A0%EC%9D%BC&quot; aria-label=&quot;해야할일 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;해야할일&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;원본에 파일이 있지만 사본에 없으면 파일위치를 원본 → 사본 으로 옮긴다&lt;/li&gt;
&lt;li&gt;원본에 파일이 있지만 사본에 있는(내용이 같은)파일과 이름이 다르면 사본의 파일 이름을 원본 파일이름과 같게 변경한다&lt;/li&gt;
&lt;li&gt;사본에 파일이 있지만 원본에 없다면 사본의 파일을 삭제한다&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;파일-해시코드-핵심로직&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%8C%8C%EC%9D%BC-%ED%95%B4%EC%8B%9C%EC%BD%94%EB%93%9C-%ED%95%B5%EC%8B%AC%EB%A1%9C%EC%A7%81&quot; aria-label=&quot;파일 해시코드 핵심로직 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;파일 해시코드 (핵심로직)&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; hashlib

BLOCK_SIZE &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;65_536&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;hash_file&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;path&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    hasher &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; hashlib&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sha1&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; path&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;rb&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        buf &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;read&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;BLOCK_SIZE&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; buf&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            hasher&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;update&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;buf&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            buf &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;read&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;BLOCK_SIZE&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; hasher&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;hexdigest&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;311-1차-코드작성안&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#311-1%EC%B0%A8-%EC%BD%94%EB%93%9C%EC%9E%91%EC%84%B1%EC%95%88&quot; aria-label=&quot;311 1차 코드작성안 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.1.1 1차 코드작성안&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;처음부터 문제를 풀 때는 보통 간단한 구현을 짜고, 이걸 가지고 리팩토링 한다.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;가장 작은 부분부터 일단 만들면서 더 풍부하고, 더 좋은 해법의 설계를 가져가는 것을 반복한다.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;바꿔말하면 &lt;strong&gt;처음 코드는 보통 구지단 말이다. 처음부터 못해도 좋다. 빠르게 이터레이션을 가져가면서 좋은 코드로 바꾸는 연습을 하자.&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;문제점&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AC%B8%EC%A0%9C%EC%A0%90&quot; aria-label=&quot;문제점 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;문제점?&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;두 디렉토리 차이점 알아내기 라는 도메인 로직이 I/O 코드와 긴밀하게 “결합” 되어있다
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;pathlib&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;shutil&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;hashlib&lt;/code&gt; 을 다 써야함&lt;/li&gt;
&lt;li&gt;비록 퓨어 파이썬 라이브러리라고 하지만….&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;테스트가 충분하지 않다
&lt;ul&gt;
&lt;li&gt;테스트케이스가 모자라다 → 커버리지가 낮다&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;shutil.move()&lt;/code&gt; 가 잘못 사용중이다(!)
&lt;ul&gt;
&lt;li&gt;버그를 찾으려면 테스트를 더 해야한다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;확장성이 없음. 아래 요구사항이 오면 코드를 싹 갈아야한다
&lt;ul&gt;
&lt;li&gt;되는지 안 되는지만 알려주는 &lt;code class=&quot;language-text&quot;&gt;--dry-run&lt;/code&gt; 같은 기능을 추가하려면?&lt;/li&gt;
&lt;li&gt;원격서버와 동기화 해야한다면?&lt;/li&gt;
&lt;li&gt;클라우드 저장 장치와 동기화 해야한다면?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;32-올바른-추상화-선택&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#32-%EC%98%AC%EB%B0%94%EB%A5%B8-%EC%B6%94%EC%83%81%ED%99%94-%EC%84%A0%ED%83%9D&quot; aria-label=&quot;32 올바른 추상화 선택 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.2 올바른 추상화 선택&lt;/h1&gt;
&lt;p&gt;테스트하기 쉽게 짜려면 생각을 다시 해보자.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;요구사항의 어떤 부분을 코드화할지 생각한다&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;→ 파일 시스템의 어떤 기능을 코드에서 쓸지 생각해본다
2. 코드 내에는 3가지 뚜렷한 서로 다른 일이 일어남을 캐치한다. 즉, 코드의 &lt;strong&gt;책임&lt;/strong&gt;을 찾는다
1. &lt;code class=&quot;language-text&quot;&gt;os.walk&lt;/code&gt; 을 사용해 시스템 정보 및 파일해시를 구한다 (원본, 사본 모두에서 처리)
2. 파일이 새 파일인지, 이름이 변경된 파일인지, 중복된 파일인지 정한다
3. 원본과 사본을 일치시키기 위해 파일 복사하거나, 옮기거나, 삭제한다.&lt;/p&gt;
&lt;p&gt;세 가지 책임에 대해 &lt;strong&gt;단순화한 추상화(simplifying abstraction)&lt;/strong&gt; 을 찾으려는 과정이다. 마치 인터페이스를 만드는 것 처럼… 개선해보자!&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;시스템 정보 및 파일 해시를 구하는 딕셔너리를 만들 때, 원본 및 사본의 모든 파일해시를 다 구하고 연산한다면?&lt;/li&gt;
&lt;li&gt;두 번째, 세 번째 책임은 어떻게 해결할 것인가?&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;→ “&lt;strong&gt;무엇&lt;/strong&gt;” 을 원하는가와 원하는 바를 “&lt;strong&gt;어떻게&lt;/strong&gt;” 달성할 지를 분리하자.
1. 프로그램이 아래와 비슷한 명령 목록을 출력하도록 하자&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;    ```python
    (&quot;COPY&quot;, &quot;sourcepath&quot;, &quot;destpath&quot;),
    (&quot;MOVE&quot;, &quot;old&quot;, &quot;new&quot;),
    ```
    
2. 여기서 파일 시스템을 표현하는 두 딕셔너리를 입력받는 테스트 작성 가능&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;… 그러면 아래와 같이 말을 바꿀 수 있다
&lt;ol&gt;
&lt;li&gt;(이전) 어떤 주어진 실제 파일 시스템에 대해 함수를 실행하면 어떤 일이 일어나는지 검사하자&lt;/li&gt;
&lt;li&gt;(이후) 어떤 파일 시스템의 &lt;strong&gt;추상화&lt;/strong&gt;에 대해 함수를 실행하면 어떤 &lt;strong&gt;추상화된&lt;/strong&gt; 동작이 일어나는지 검사하자&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;33-선택한-추상화-구현&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#33-%EC%84%A0%ED%83%9D%ED%95%9C-%EC%B6%94%EC%83%81%ED%99%94-%EA%B5%AC%ED%98%84&quot; aria-label=&quot;33 선택한 추상화 구현 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.3 선택한 추상화 구현&lt;/h1&gt;
&lt;p&gt;어려운 개발 도서들은 말은 좋지. 실제로 코드를 어떻게 짤까? 일단 목표를 다시 생각해보자.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;시스템에서 트릭이 적용된 부분을 분리해서 격리한다&lt;/li&gt;
&lt;li&gt;실제 파일 시스템 없이도 테스트가 되게 한다&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;외부 상태에 대해 의존성이 없는 코드의 ‘코어’를 만들고, 외부 세계를 표현하는 입력에 대해 이 코어가 어떻게 반응하는지 생각해보자&lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;p&gt;step 1) 코드에서 로직과 상태가 있는 부분을 분리한다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;입력 수집
&lt;ol&gt;
&lt;li&gt;이 코드를 나눠서 원본, 사본의 경로와 해시를 모두 구했다&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;함수형 코어 호출
&lt;ol&gt;
&lt;li&gt;if 구문이 여기서 갈릴 것이다&lt;/li&gt;
&lt;li&gt;개별 테스트로 빼기도 쉽다&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;출력 적용
&lt;ol&gt;
&lt;li&gt;처음에 들어온 명령만 처리하면 된다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이러면 큰 로직과 저수준 I/O의 의존성을 함수단위로 풀었다. 쉽게 코드의 코어를 테스트할 수 있다(&lt;code class=&quot;language-text&quot;&gt;determine_actions&lt;/code&gt;)!&lt;/p&gt;
&lt;p&gt;전체를 테스트하려는 통합/인수테스트도 유지할 수도 있다만, 더 나아가 &lt;code class=&quot;language-text&quot;&gt;sync()&lt;/code&gt; 를 다듬어서 단위테스트를 겸해서 동시에 e2e 테스트까지 할 수도 있다. 이걸 책의 공동저자는 &lt;code class=&quot;language-text&quot;&gt;edge-to-edge&lt;/code&gt; 테스트라고 부른다.&lt;/p&gt;
&lt;h2 id=&quot;331-의존성-주입과-가짜를-사용한-edge-to-edge-테스트&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#331-%EC%9D%98%EC%A1%B4%EC%84%B1-%EC%A3%BC%EC%9E%85%EA%B3%BC-%EA%B0%80%EC%A7%9C%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%9C-edge-to-edge-%ED%85%8C%EC%8A%A4%ED%8A%B8&quot; aria-label=&quot;331 의존성 주입과 가짜를 사용한 edge to edge 테스트 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.3.1 의존성 주입과 가짜를 사용한 edge-to-edge 테스트&lt;/h2&gt;
&lt;p&gt;새 시스템을 짤 때는 위에서 언급한 추상화를 통한 구현을 하자. 어느 시점이 되면 시스템의 더 큰 덩어리를 한번에 테스트하고자 할 것이다.&lt;/p&gt;
&lt;p&gt;저자는 이 때 한번에 테스트하되 가짜 I/O를 사용하는 류의 edge-to-edge 테스트를 추천한다.&lt;/p&gt;
&lt;p&gt;요컨대, 어느 파일 시스템에서(&lt;code class=&quot;language-text&quot;&gt;filesystem&lt;/code&gt;) 액션을 취할지를 테스트하는 방법을 DI를 통한 테스트 더블로 처리할 수 있다.&lt;/p&gt;
&lt;h2 id=&quot;332-mockpatch-를-쓰지-않는-이유&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#332-mockpatch-%EB%A5%BC-%EC%93%B0%EC%A7%80-%EC%95%8A%EB%8A%94-%EC%9D%B4%EC%9C%A0&quot; aria-label=&quot;332 mockpatch 를 쓰지 않는 이유 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3.3.2 &lt;code class=&quot;language-text&quot;&gt;mock.patch&lt;/code&gt; 를 쓰지 않는 이유&lt;/h2&gt;
&lt;p&gt;mock을 통한 monkey patching을 별로라고 하면서, 테스트 더블을 소개한다. 왜 안쓰는지를 설명하는 지에 대한 이유는 다음과 같다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;사용중인 의존성을 다른 코드로 패치하면, 테스트는 되지만 설계 개선에 도움되지 않는다.&lt;/li&gt;
&lt;li&gt;mock을 쓴 테스트는 코드 베이스의 세부사항에 더 밀접하게 결합된다. 코드베이스가 뭘 하는지를 모킹하기 때문에, 이 또한 결합이다 라고 한단하는 것 같다.&lt;/li&gt;
&lt;li&gt;결국 코드 베이스를 알아야하니까 test suite을 보고 바로 이해하기 힘들어진다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;여기 내용은 유닛 테스팅 책을 좀 보고 다시 이해해야겠다… 여전히 모르겠다.&lt;/p&gt;
&lt;h1 id=&quot;마무리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%88%EB%AC%B4%EB%A6%AC&quot; aria-label=&quot;마무리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;마무리&lt;/h1&gt;
&lt;p&gt;비즈니스 로직과 I/O 사이의 인터페이스를 단순화하는게 중요하다는 것을 배웠다. 올바른 추상화를 찾는 것은 어렵다. 아래는 올바른 추상화를 하기 위한 방법이다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;지저분한 시스템 상태를 표현할 수 있는 파이썬 객체가 있나? 있다면 이를 활용해 시스템의 상태를 반환하는 단일함수를 생각해보자.&lt;/li&gt;
&lt;li&gt;시스템의 구성요소 중 어떤 부분에 선을 그을 수 있을까? 이 각각의 추상화 사이의 &lt;a href=&quot;https://www.informit.com/articles/article.aspx?p=359417&amp;#x26;seqNum=2&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이음매(seams)&lt;/a&gt;를 어떻게 만들 수 있을까?&lt;/li&gt;
&lt;li&gt;시스템의 여러 부분을 서로 다른 책임을 지니는 구성요소로 나누는 합리적인 방법은 무엇일까? 명시적으로 표현해야 하는 암시적인 개념은 무엇일까?&lt;/li&gt;
&lt;li&gt;어떤 의존관계가 존재하는가? 핵심 비즈니스 로직은 무엇인가?&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;계속 연습하자… 계속…&lt;/p&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;Gary Bernhardt 가 말한 &lt;a href=&quot;https://github.com/kbilsted/Functional-core-imperative-shell/blob/master/README.md&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Functional Core, Imperative Shell&lt;/a&gt; 이라는 접근방법이다. 상세한건 링크 참고&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[파이썬으로 살펴보는 아키텍처 패턴 (2)]]></title><description><![CDATA[파이썬으로 살펴보는 아키텍처 패턴을 읽고 이해한 내용을 작성합니다. 챕터 2, 저장소 패턴에 대한 내용입니다.]]></description><link>https://blog.s3ich4n.me/books/cosmic-python/2023-04-13-pt01-ch02</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/cosmic-python/2023-04-13-pt01-ch02</guid><pubDate>Thu, 13 Apr 2023 20:44:23 GMT</pubDate><content:encoded>&lt;p&gt;이 내용은 “파이썬으로 살펴보는 아키텍처 패턴” 을 읽고 작성한 내용입니다. 블로그 게시글과, 작성한 코드를 함께 보시면 더욱 좋습니다.&lt;/p&gt;
&lt;p&gt;2장은 해당 코드를 살펴봐주세요. &lt;a href=&quot;https://github.com/s3ich4n/cosmicpython-study/tree/main/pt1/ch02&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;코드 링크&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;2장&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2%EC%9E%A5&quot; aria-label=&quot;2장 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2장&lt;/h1&gt;
&lt;p&gt;Repository Pattern: 데이터 저장소를 추상화&lt;/p&gt;
&lt;p&gt;이득&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;모델 계층과 데이터 계층을 분리할 수 있다&lt;/li&gt;
&lt;li&gt;데이터베이스의 복잡성을 감춰서 시스템을 테스트하기 좋게 만든다&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;21-도메인-모델-영속화&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#21-%EB%8F%84%EB%A9%94%EC%9D%B8-%EB%AA%A8%EB%8D%B8-%EC%98%81%EC%86%8D%ED%99%94&quot; aria-label=&quot;21 도메인 모델 영속화 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.1. 도메인 모델 영속화&lt;/h1&gt;
&lt;p&gt;애자일하게 개발할 땐 뭐가 필요하냐? MVP가 빨리 나와야된다. 책에선 e2e 테스트부터 바로 들어간 후 웹 프레임워크에 기능을 넣고 외부로부터 내부 방향으로 테스트를 한다고 한다.&lt;/p&gt;
&lt;p&gt;어쨌거나 영속적 저장소가 필요한건 사실이다.&lt;/p&gt;
&lt;h1 id=&quot;22-pseudo-code로-뭐-필요한지-보자&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#22-pseudo-code%EB%A1%9C-%EB%AD%90-%ED%95%84%EC%9A%94%ED%95%9C%EC%A7%80-%EB%B3%B4%EC%9E%90&quot; aria-label=&quot;22 pseudo code로 뭐 필요한지 보자 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.2. pseudo-code로 뭐 필요한지 보자&lt;/h1&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; fastapi &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; FastAPI

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; model &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; OrderLine&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; allocate

app &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; FastAPI&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@app&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;post&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;/allocate&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    status_code&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;201&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;allocate_endpoint&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# line = OrderLine(request.params, ...)&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# batches = ...&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# allocate(line, batches)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;대충 이런 코드가 필요하다…&lt;/p&gt;
&lt;h1 id=&quot;23-데이터-접근에-dip-적용하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#23-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%91%EA%B7%BC%EC%97%90-dip-%EC%A0%81%EC%9A%A9%ED%95%98%EA%B8%B0&quot; aria-label=&quot;23 데이터 접근에 dip 적용하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.3. 데이터 접근에 DIP 적용하기&lt;/h1&gt;
&lt;p&gt;계층을 분리하는게 핵심이다!&lt;/p&gt;
&lt;p&gt;그리고 도메인 모델은 &lt;strong&gt;의존성을 단 하나도 두지 않도록&lt;/strong&gt; 한다. 사실 &lt;code class=&quot;language-text&quot;&gt;pydantic&lt;/code&gt; 을 쓰는 것도 편해서 그런거지 가능하면 dataclassse를 쓰는 형태로 갖고가는게 맞는 것 같다…&lt;/p&gt;
&lt;p&gt;의존성이 비즈니스 로직 즉, 도메인 모델로 들어오도록 하는 방법으로 가도록 한다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/0910fd71995de03f54fbe806d2b8ca76/58354/001.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 48.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAB2HAAAdhwGP5fFlAAABnElEQVQoz52Sy0tbQRSH7z+ka1/YjUioC9GlC6sVWtJIVIxGlC5aUISq0AQ1O5eFko1QEIzSa2M0ehNNLpg0qdFCNOkj6SMPlTzuV+7kFl2V2AMfnDMz5ze/OYyU/FpA53M6z3kqL/KLbwVK5Qp6aJrGfUJqs8j0PvfTP6vweD5A9/Q+neNeEhc5caBa1YRovUgmm1eIPZqr0ffygJ6ZPeH2vxzmiyW9iy0lxRvPmS5B4apUEzJu5Y4Dff9fSObFIJOrKk9eBRiaV7CthBlzhhhxhJhYCTPlUhlfDmN3qdhXVayvjxkxsBqMOkM8XQiiRL8jNQx4aLXItFp2aBveocn8nmazLDBN+Oiy79Fp2+XhpE/U+nqTQYvR1/JMpnFwmw3/JdJhJMNRLEvwo0HsFiWaMbjNj+JZ1NMfnCZ/ixE53VESlzmO41l+5m+QuGdc35RxuD/hWk/wYu0E23JI5Etv40TOfyFVqhr1UK5UheBZKkf7sMwD6wcxho4xr3iyzjtfsn6Hf79P8bqMR0kLNg9rbAW+sOFPkc4U+QMoLrZNPfIhugAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/0910fd71995de03f54fbe806d2b8ca76/8ac56/001.webp 240w,
/static/0910fd71995de03f54fbe806d2b8ca76/d3be9/001.webp 480w,
/static/0910fd71995de03f54fbe806d2b8ca76/e46b2/001.webp 960w,
/static/0910fd71995de03f54fbe806d2b8ca76/29105/001.webp 1396w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/0910fd71995de03f54fbe806d2b8ca76/8ff5a/001.png 240w,
/static/0910fd71995de03f54fbe806d2b8ca76/e85cb/001.png 480w,
/static/0910fd71995de03f54fbe806d2b8ca76/d9199/001.png 960w,
/static/0910fd71995de03f54fbe806d2b8ca76/58354/001.png 1396w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/0910fd71995de03f54fbe806d2b8ca76/d9199/001.png&quot;
            alt=&quot;Untitled&quot;
            title=&quot;Untitled&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;Untitled&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;다시말해, 높은 계층의 도메인이 하부 구조(표현계층이든 DB든)에 의존하면 안 된다 라는 것이다.&lt;/p&gt;
&lt;h1 id=&quot;24-책에서의-모델을-db로-바꾸려면&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#24-%EC%B1%85%EC%97%90%EC%84%9C%EC%9D%98-%EB%AA%A8%EB%8D%B8%EC%9D%84-db%EB%A1%9C-%EB%B0%94%EA%BE%B8%EB%A0%A4%EB%A9%B4&quot; aria-label=&quot;24 책에서의 모델을 db로 바꾸려면 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.4 책에서의 모델을 DB로 바꾸려면?&lt;/h1&gt;
&lt;p&gt;“할당” 이라는 개념은 &lt;code class=&quot;language-text&quot;&gt;OrderLine&lt;/code&gt; 과 &lt;code class=&quot;language-text&quot;&gt;Batch&lt;/code&gt; 를 연결하는 개념이다. 이걸 DB화 해보자.&lt;/p&gt;
&lt;h2 id=&quot;241-일반적인-orm-orm에-의존하는-모델&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#241-%EC%9D%BC%EB%B0%98%EC%A0%81%EC%9D%B8-orm-orm%EC%97%90-%EC%9D%98%EC%A1%B4%ED%95%98%EB%8A%94-%EB%AA%A8%EB%8D%B8&quot; aria-label=&quot;241 일반적인 orm orm에 의존하는 모델 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.4.1 일반적인 ORM: ORM에 의존하는 모델&lt;/h2&gt;
&lt;p&gt;모델 객체를 SQL문으로 매핑해주는 프레임워크를 ORM(Object Relational Mapping)이라 한다. 객체-도메인 모델-데이터베이스 를 이어주는 역할을 하기 때문이다.&lt;/p&gt;
&lt;p&gt;ORM은 영속성 무지(Persistence Ignorance)가 가장 중요한 역할을 한다. 데이터를 어떻게 쌓고 어떻게 영속화 하는지는 관심없도록 한다.&lt;/p&gt;
&lt;p&gt;Declarative 형식으로 짜면 모델이 ORM에 의존하게 된다고 한다.&lt;/p&gt;
&lt;p&gt;이걸 뒤집으려면 스키마를 따로 짜고, 스키마와 도메인 모델을 상호 변환하는 매퍼를 정의할 필요가 있다. 이걸 SQLAlchemy에선 imperative mapping(혹은 classical mapping) 이라고 한다. &lt;a href=&quot;https://docs.sqlalchemy.org/en/20/orm/mapping_styles.html#imperative-mapping&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;참고링크&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;참고사항&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;SQLAlchemy 2.0 들어서선 Imperative mapping 방법이 좀 바뀌었다. &lt;a href=&quot;https://docs.sqlalchemy.org/en/20/orm/mapping_styles.html#imperative-mapping&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;해당링크 참고&lt;/a&gt;
&lt;code class=&quot;language-text&quot;&gt;relationship&lt;/code&gt; 기재의 경우 &lt;code class=&quot;language-text&quot;&gt;properties&lt;/code&gt; 라는 kwargs로 넣어주면 된다&lt;/p&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;242-의존성-역전-모델에-의존하는-orm으로-만들기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#242-%EC%9D%98%EC%A1%B4%EC%84%B1-%EC%97%AD%EC%A0%84-%EB%AA%A8%EB%8D%B8%EC%97%90-%EC%9D%98%EC%A1%B4%ED%95%98%EB%8A%94-orm%EC%9C%BC%EB%A1%9C-%EB%A7%8C%EB%93%A4%EA%B8%B0&quot; aria-label=&quot;242 의존성 역전 모델에 의존하는 orm으로 만들기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.4.2 의존성 역전: 모델에 의존하는 ORM으로 만들기&lt;/h2&gt;
&lt;p&gt;요는 명시적 매퍼를 정의해서 내가 만든 코드로 테이블을 의존시키는 것이다.&lt;/p&gt;
&lt;p&gt;진짜 핵심은 &lt;strong&gt;“도메인”이 다른 하부 구조에 의존하게 않도록&lt;/strong&gt; 만드는 것이다.&lt;/p&gt;
&lt;p&gt;도메인 모델을 잘 가져가는 것이 객체지향 패러다임을 계속해서 가져갈 수 있도록 하는 힘이다.&lt;/p&gt;
&lt;h1 id=&quot;25-저장소-패턴-소개&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#25-%EC%A0%80%EC%9E%A5%EC%86%8C-%ED%8C%A8%ED%84%B4-%EC%86%8C%EA%B0%9C&quot; aria-label=&quot;25 저장소 패턴 소개 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.5 저장소 패턴 소개&lt;/h1&gt;
&lt;p&gt;저장소 패턴(Repository pattern)은 영속적 저장소를 추상화한 것이다.&lt;/p&gt;
&lt;p&gt;컴퓨팅 환경에서는 저장공간이 유한하기 때문에 어딘가에 데이터를 넣고 조회하는 것이 너무나 당연하다. 그리고 설령 모든 객체가 메모리 안에 있을 수 있다 하더라도 나중에 다시 찾을 수 있도록 어딘가에 보관해야한다.&lt;/p&gt;
&lt;h2 id=&quot;251-추상화한-저장소&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#251-%EC%B6%94%EC%83%81%ED%99%94%ED%95%9C-%EC%A0%80%EC%9E%A5%EC%86%8C&quot; aria-label=&quot;251 추상화한 저장소 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.5.1 추상화한 저장소&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;add()&lt;/code&gt;: 원소를 저장소에 저장한다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;get()&lt;/code&gt;: 원소를 저장소에서 가져온다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;도메인과 서비스 계층에서 데이터에 접근할 떄는 &lt;strong&gt;저 함수들만을 사용&lt;/strong&gt;하도록 하면 결합을 끊을 수 있다. 이 때 가상 저장소는 &lt;code class=&quot;language-text&quot;&gt;ABC&lt;/code&gt;로 만들면 된다.&lt;/p&gt;
&lt;p&gt;ABC 대신 덕 타이핑, &lt;a href=&quot;https://peps.python.org/pep-0544/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;PEP 544(프로토콜)&lt;/a&gt; 도 방안이다.&lt;/p&gt;
&lt;p&gt;덕 타이핑은 add(thing), get(id) 메소드를 제공하는 &lt;strong&gt;어떠한 객체&lt;/strong&gt;든 다 덕 타이핑을 할 수도 있다.&lt;/p&gt;
&lt;p&gt;파이썬 3.8 들어서는 PEP 544를 통해 필요한 값만 골라서 처리할 수 있는 프로토콜이 더 낫다고 생각한다. 자세한 사항은 Fluent Python 11장을 참고하자. &lt;a href=&quot;https://junstar92.tistory.com/356&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;관련 링크1&lt;/a&gt;, &lt;a href=&quot;https://blog.doosikbae.com/entry/Fluent-Python-Chapter-11-%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4-%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C%EC%97%90%EC%84%9C-ABC%EA%B9%8C%EC%A7%80&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;관련 링크2&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;252-트레이드오프&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#252-%ED%8A%B8%EB%A0%88%EC%9D%B4%EB%93%9C%EC%98%A4%ED%94%84&quot; aria-label=&quot;252 트레이드오프 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.5.2 트레이드오프?&lt;/h2&gt;
&lt;p&gt;으레 사람들이 이런 말을 한다. 이걸로 얻는 이득과 손해가 뭐지?&lt;/p&gt;
&lt;p&gt;지역적으로는 좀더 복잡해지고 지속적으로 유지보수를 해야하지만, 전체적으로는 점차적으로 나아지는 길이다.&lt;/p&gt;
&lt;p&gt;DDD를 한번 시작했다면 돌이키기 힘들다. 하지만 각각의 계층을 보다 유지보수 하기 쉬워진다.&lt;/p&gt;
&lt;p&gt;저장소 패턴이 추가되면 어떤 그림이 되는지 살펴보자&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 794px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/995f7dcb14b4c7f20ac72c39b320e977/7de01/002.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 87.91666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAB2HAAAdhwGP5fFlAAACc0lEQVQ4y52U/U9SURjH+Ytqq361reYy7WUrtTfYKpdZLSodolOUGNS0WGsrfqGVP7S2Ns201rJkghcvcO9FIkBrNlci8iqS2UBM7redgzKwzGt3e+6559yzzznf8zzfI4OERxRF8pYyFTLreBQvbEG8ZGbRZw2izxZErzWIAdK3BcH64gXoVkGBdV0CdtePoEI1hpM3OZzQclAYBFSoWOyqH0HjAy/dXS63FuJfIlcEPHuLw846C/bfYHBc40R1hwvVHU7su85gx3kLrt33QOpDoDL3p3lYhCicgQRM/VNo6Hai1zoD1p+AxR3F55lFfA0voc3sg+aRH+0bovNxAE0PvfgwlczvsHgFMtj11IfpuZ/IZHNY+LGCdDaHIS6MvUoGNVoecoMbB1QsarU8DrU4INcLtP+aDf0JdAXiMPR4kVrKlkjxT6dwWueCQs/j3G0B8qJWYeDpUTHeWB7o9MfxaiyEYSEC8+AXqE1uPLd8wzAfoauSo1j5tYpEKkMjnkqXtInvGcQW0ljOruaBl4xums2yq6Oo6eSohEo1S/t7LlrRcNctuQZpUgpAJYODzSwtm6oWB8qUa0DjOEQxRydvWjbFdchPJjDkCsMiRPCej+CykaeSbZ4o3rrCIP/XJ6+3/3TKxoE7zyaQXFzexH7YPlD3xIdYMv1fMAq0f4xjgAnhjWOOZlvf46OS33ER9I/OgptIlHh5S+CFbgGVzSyOtDpwTOPCGb2A8iY7yhvtONzqgMqU97Io9Qyv3PPgaFvew6d0PGq1HHVAlZqlZdRu9hfKRhKQXE9EKskokU2CfBO7DdpD4CfntydZ+gUrLSm/Adh2AefyQf/GAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/995f7dcb14b4c7f20ac72c39b320e977/8ac56/002.webp 240w,
/static/995f7dcb14b4c7f20ac72c39b320e977/d3be9/002.webp 480w,
/static/995f7dcb14b4c7f20ac72c39b320e977/ae710/002.webp 794w&quot;
              sizes=&quot;(max-width: 794px) 100vw, 794px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/995f7dcb14b4c7f20ac72c39b320e977/8ff5a/002.png 240w,
/static/995f7dcb14b4c7f20ac72c39b320e977/e85cb/002.png 480w,
/static/995f7dcb14b4c7f20ac72c39b320e977/7de01/002.png 794w&quot;
            sizes=&quot;(max-width: 794px) 100vw, 794px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/995f7dcb14b4c7f20ac72c39b320e977/7de01/002.png&quot;
            alt=&quot;Untitled&quot;
            title=&quot;Untitled&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;Untitled&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;만들거면 테스트부터 만들어보자.&lt;/p&gt;
&lt;h1 id=&quot;26-테스트에-사용하는-가짜-저장소를-쉽게-만드는-방법&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#26-%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%97%90-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%EA%B0%80%EC%A7%9C-%EC%A0%80%EC%9E%A5%EC%86%8C%EB%A5%BC-%EC%89%BD%EA%B2%8C-%EB%A7%8C%EB%93%9C%EB%8A%94-%EB%B0%A9%EB%B2%95&quot; aria-label=&quot;26 테스트에 사용하는 가짜 저장소를 쉽게 만드는 방법 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.6 테스트에 사용하는 가짜 저장소를 쉽게 만드는 방법&lt;/h1&gt;
&lt;p&gt;파이썬 원형을 만들고 테스트할 때 저걸로 대신 쓰면 된다.&lt;/p&gt;
&lt;h1 id=&quot;27-파이썬에서의-포트-어댑터&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#27-%ED%8C%8C%EC%9D%B4%EC%8D%AC%EC%97%90%EC%84%9C%EC%9D%98-%ED%8F%AC%ED%8A%B8-%EC%96%B4%EB%8C%91%ED%84%B0&quot; aria-label=&quot;27 파이썬에서의 포트 어댑터 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.7 파이썬에서의 포트, 어댑터?&lt;/h1&gt;
&lt;p&gt;포트와 어댑터는 객체지향에서 나온 단어다. 이 책에선 아래와같이 쓰인다&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;포트
&lt;ul&gt;
&lt;li&gt;애플리케이션과 추상화하려는 대상 사이의 인터페이스&lt;/li&gt;
&lt;li&gt;추상 기반 클래스를 쓴다&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;AbstractRepository&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;어댑터
&lt;ul&gt;
&lt;li&gt;이 인터페이스나 추상화가 뒤에있는 구현이라는 정의를 채택함&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;SqlAlchemyRepository&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;FakeRepository&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;28-pros-and-cons&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#28-pros-and-cons&quot; aria-label=&quot;28 pros and cons permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2.8 pros and cons&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;장점&lt;/th&gt;
&lt;th&gt;단점&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;영속적 저장소와 도메인 모델 사이의 인터페이스를 간단히 유지할 수 있다&lt;/td&gt;
&lt;td&gt;ORM이 어느정도 (모델과 저장소의) 결합을 완화시켜준다. (ORM을 쓰면) 외래키를 바꾸기는 어렵지만, 필요할 때 MySQL과 Postgres를 서로 바꾸기 쉽다&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;모델과 인프라 사이의 사항을 완전히 분리한다 → 단위 테스트에 대한 가짜 저장소 생성이 쉽고 저장소 해법을 변경하기도 쉽다&lt;/td&gt;
&lt;td&gt;ORM 매핑을 수동으로 하려면 작업과 코드가 더 필요하다&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;영속성 고려 전 도메인 모델을 작성하면 비즈니스 문제에 집중하기 쉽다. 접근 방식을 극적으로 바꾸고 싶을 때 외래키나 마이그레이션 등에 대해 고려하지 않고 모델이 이를 반영할 수 있다.&lt;/td&gt;
&lt;td&gt;간접 계층을 추가하면 유지보수 비용이 증가함을 의미한다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;객체를 테이블에 매핑하는 과정을 원하는 대로 제어할 수 있어서 스키마를 단순히 할 수 있다&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;단순 CRUD만 가질거면 도메인 모델이나 저장소를 안써도 된다. 도메인이 복잡할 수록 인프라에 대해 신경쓰지 않을 정도로 투자하면 모델이나 코드를 보다 쉽게 변경할 수 있다. 그게 최고의 장점이다.&lt;/p&gt;
&lt;h1 id=&quot;정리하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A0%95%EB%A6%AC%ED%95%98%EA%B8%B0&quot; aria-label=&quot;정리하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;정리하기&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;ORM에 의존성 역전을 적용하자. ORM은 모델을 임포트 해야한다. 반대로 되면 안 된다.&lt;/li&gt;
&lt;li&gt;저장소 패턴은 영속적 저장소에 대한 단순한 추상화다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;번외&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%B2%88%EC%99%B8&quot; aria-label=&quot;번외 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;번외&lt;/h1&gt;
&lt;h2 id=&quot;text-사용-시&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#text-%EC%82%AC%EC%9A%A9-%EC%8B%9C&quot; aria-label=&quot;text 사용 시 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;text&lt;/code&gt; 사용 시…&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.sqlalchemy.org/en/20/tutorial/dbapi_transactions.html#sending-parameters&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;파라미터는 꼭 이렇게 보내자…&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Engine&lt;/code&gt; 을 쓰건, &lt;code class=&quot;language-text&quot;&gt;Session&lt;/code&gt; 을 쓰건 이런 식이다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;매핑&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%A4%ED%95%91&quot; aria-label=&quot;매핑 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;매핑&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;sqlalchemy.Table&lt;/code&gt; 로 매핑하나 &lt;code class=&quot;language-text&quot;&gt;sqlalchemy.orm.DeclarativeBase&lt;/code&gt; 로 하나 똑같다&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.sqlalchemy.org/en/20/tutorial/metadata.html#using-orm-declarative-forms-to-define-table-metadata&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://docs.sqlalchemy.org/en/20/tutorial/metadata.html#using-orm-declarative-forms-to-define-table-metadata&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;둘 다 충분히 테이블에 엮이지 않도록 한다. 다만 ORM Declarative로 가면 특정 RDBMS에 대한 지원을 보다 더 낫게 할 수도 있다&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;mypy&lt;/code&gt; 를 이용한 타입 힌팅을 충분히 가져갈 수 있다&lt;/li&gt;
&lt;li&gt;persistance / object loading 작동에 필요한 테이블 메타데이터를 한번에 가져와서 쓸 수 있다
&lt;ol&gt;
&lt;li&gt;SQLAlchemy에 대한 이해도가 높아야겠지만, 쓴다면 당연히 높은 이해도를 제고해야 하는 것이 마땅하다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;어차피 추상 리포지토리를 개별 리포지토리가 상속하고, 개별 리포지토리에서는 접근하고자 하는 RDBMS(SQLAlchemy 예시니까) 별로 다르게 코드가 나온다.
이게 길어지면 모듈로 분리하여 코드를 작성하면 될 일이다.
다른 어댑터나 포트는 다른 개별 리포지토리 형식으로 구현될텐데 말이지.&lt;/p&gt;
&lt;p&gt;근데 결국 아는만큼 쓴다고, &lt;code class=&quot;language-text&quot;&gt;Table&lt;/code&gt; 로 매핑하면서 쓰다가 필요할 때 ORM Declarative로 넘어가는게 나을 듯 싶다.&lt;/p&gt;
&lt;h2 id=&quot;모델---쿼리-엮기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AA%A8%EB%8D%B8---%EC%BF%BC%EB%A6%AC-%EC%97%AE%EA%B8%B0&quot; aria-label=&quot;모델   쿼리 엮기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;모델 - 쿼리 엮기&lt;/h2&gt;
&lt;h3 id=&quot;배운-점&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%B0%B0%EC%9A%B4-%EC%A0%90&quot; aria-label=&quot;배운 점 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;배운 점&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;논리적인 흐름을 DB로 풀어낼 때…
&lt;ul&gt;
&lt;li&gt;VO가 그대로 테이블이 될 수 있다&lt;/li&gt;
&lt;li&gt;엔티티 내의 특정 값(&lt;code class=&quot;language-text&quot;&gt;set&lt;/code&gt;값인 &lt;code class=&quot;language-text&quot;&gt;allocations&lt;/code&gt;) 은 &lt;code class=&quot;language-text&quot;&gt;OrderLine&lt;/code&gt; 을 모아두는 논리적인 값이다
&lt;ul&gt;
&lt;li&gt;이 값이 테이블이 될 수 있다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;allocate()&lt;/code&gt; 함수를 통해 &lt;code class=&quot;language-text&quot;&gt;OrderLine&lt;/code&gt;을 &lt;code class=&quot;language-text&quot;&gt;Batch&lt;/code&gt;에 allocate 할 수도 있다.
&lt;ul&gt;
&lt;li&gt;Java에선 이런 것 하나하나 인터페이스로 처리했어야 했었을 것을 함수 단위로 그냥 선언하고 땡&lt;/li&gt;
&lt;li&gt;다만 하나의 모듈(&lt;code class=&quot;language-text&quot;&gt;model.py&lt;/code&gt;) 안에 잘 두고 분리를 잘 해야할 것이다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;복습&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%B3%B5%EC%8A%B5&quot; aria-label=&quot;복습 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;복습&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;테이블 만들고 &lt;code class=&quot;language-text&quot;&gt;mapper&lt;/code&gt; 로 매핑하는 건 기존 프로젝트들에서 해왔던 것과 유사하다&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;리포지토리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A6%AC%ED%8F%AC%EC%A7%80%ED%86%A0%EB%A6%AC&quot; aria-label=&quot;리포지토리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;리포지토리&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;안 엮인 쿼리를 짜면 greenlet 에러 뜬다. 쿼리를 엮으면서 동시에 &lt;code class=&quot;language-text&quot;&gt;selectinload&lt;/code&gt; 를 배웠음.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;쿼리 1 예시&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;N+1 쿼리 방지를 위한 방안 소개
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;selectinload&lt;/code&gt;&lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt; 를 통해 특정 테이블에 대해서만 내보낼 수 있는 SELECT 양식을 사용하여 쿼리함.&lt;/li&gt;
&lt;li&gt;내부적으로는 두개의 쿼리를 하고 그 결과물을 처리한다고 보면 됨&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;query &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;execute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            select&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Batch&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;# 이 라인 없으면 에러납니다!&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;# relationship으로 엮인 테이블을 참조할 방도가 없어요~~~&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;options&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;selectinload&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Batch&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocations&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;filter_by&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;reference&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;reference&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;scalar_one&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;쿼리 2 예시&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;상기 쿼리 1과 마찬가지의 예시임&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;query &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;session&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;scalars&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
            select&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Batch&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;options&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;selectinload&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Batch&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;allocations&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;all&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;&lt;a href=&quot;https://soogoonsoogoonpythonists.github.io/sqlalchemy-for-pythonist/tutorial/7.%20ORM%20%EB%B0%A9%EC%8B%9D%EC%9C%BC%EB%A1%9C%20%EA%B4%80%EB%A0%A8%20%EA%B0%9C%EC%B2%B4%20%EC%9E%91%EC%97%85%ED%95%98%EA%B8%B0.html#select-in-loading-%E1%84%87%E1%85%A1%E1%86%BC%E1%84%89%E1%85%B5%E1%86%A8&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;참고 링크&lt;/a&gt;&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[파이썬으로 살펴보는 아키텍처 패턴 (1)]]></title><description><![CDATA[파이썬으로 살펴보는 아키텍처 패턴을 읽고 이해한 내용을 작성합니다. 챕터 1, 도메인 모델링에 대한 내용입니다.]]></description><link>https://blog.s3ich4n.me/books/cosmic-python/2023-04-11-pt01-ch01</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/cosmic-python/2023-04-11-pt01-ch01</guid><pubDate>Tue, 11 Apr 2023 17:55:00 GMT</pubDate><content:encoded>&lt;p&gt;이 내용은 “파이썬으로 살펴보는 아키텍처 패턴” 을 읽고 작성한 내용입니다. 블로그 게시글과, 작성한 코드를 함께 보시면 더욱 좋습니다.&lt;/p&gt;
&lt;p&gt;1장은 해당 코드를 살펴봐주세요. &lt;a href=&quot;https://github.com/s3ich4n/cosmicpython-study/tree/main/pt1/ch01&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;코드 링크&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;1장-도메인-모델링&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1%EC%9E%A5-%EB%8F%84%EB%A9%94%EC%9D%B8-%EB%AA%A8%EB%8D%B8%EB%A7%81&quot; aria-label=&quot;1장 도메인 모델링 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1장 도메인 모델링&lt;/h1&gt;
&lt;p&gt;이번 장에서는&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;엔티티&lt;/li&gt;
&lt;li&gt;값 객체(Value object)&lt;/li&gt;
&lt;li&gt;도메인 서비스(Domain service)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;를 알아보도록 한다.&lt;/p&gt;
&lt;h2 id=&quot;11-도메인-모델&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#11-%EB%8F%84%EB%A9%94%EC%9D%B8-%EB%AA%A8%EB%8D%B8&quot; aria-label=&quot;11 도메인 모델 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.1. 도메인 모델?&lt;/h2&gt;
&lt;p&gt;비즈니스 로직 계층을 도메인 모델로 부른다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;도메인: 해결하려는 문제. 회사마다 다르겠죠? 회사에서 고객에게 뭘 내어줘야 할 지가 곧 도메인.&lt;/li&gt;
&lt;li&gt;모델: 유용한 특성을 포함하는 프로세스나 현상의 지도&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;객체를 통한 개념의 추상화, 의인화를 하면 눈과 손에 잡히니 생각을 더 확장하기 쉽다.&lt;/p&gt;
&lt;p&gt;이걸 도출하는 설계가 DDD(Domain-driven Design)라 할 수 있다. 그리고 아래 책들은 읽고 오면 다음 내용이 수월하게 읽힙니다. 안 읽고 독파하면 ‘왜 저게 저렇게 됨?’ 이란 의문이 계속 생긴다고 생각한다. 위에서 아래 순으로 쭉 읽으면 좋다고 생각한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.yes24.com/Product/Goods/18249021&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;객체지향의 사실과 오해&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://product.kyobobook.co.kr/detail/S000001766446&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;도메인 주도 설계 철저 입문&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://product.kyobobook.co.kr/detail/S000001766367&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;오브젝트&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.yes24.com/Product/Goods/48577718&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;(반 버논) 도메인 주도 설계 핵심&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;책을 보면, 책 대로 나온 “고객의 주문에 할당하는 프로세스를 조율”하기 위해 시스템을 배치한 다이어그램이 나온다. 이런 주요 모델부터 뽑아서 시작하면 될 것이다.&lt;/p&gt;
&lt;h2 id=&quot;12-도메인-언어-탐구&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#12-%EB%8F%84%EB%A9%94%EC%9D%B8-%EC%96%B8%EC%96%B4-%ED%83%90%EA%B5%AC&quot; aria-label=&quot;12 도메인 언어 탐구 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.2. 도메인 언어 탐구&lt;/h2&gt;
&lt;p&gt;이걸 하기 위해 유비쿼터스 언어, DSL 등의 각종 도구를 들고와서 포스트잇으로 나눈다. 각 파트 사람이 둘러앉아 뭐가 뭐다 하는 논의를 잘 거치면 된다는 뜻이다.&lt;/p&gt;
&lt;h2 id=&quot;13-도메인-모델-단위-테스트&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#13-%EB%8F%84%EB%A9%94%EC%9D%B8-%EB%AA%A8%EB%8D%B8-%EB%8B%A8%EC%9C%84-%ED%85%8C%EC%8A%A4%ED%8A%B8&quot; aria-label=&quot;13 도메인 모델 단위 테스트 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.3. 도메인 모델 단위 테스트&lt;/h2&gt;
&lt;p&gt;도메인을 만든다. 그냥 클래스로 만들고 불변객체에 대해서도 만든다.&lt;/p&gt;
&lt;p&gt;불변객체는 &lt;code class=&quot;language-text&quot;&gt;@dataclass(frozen=True)&lt;/code&gt; 로 만들 수 있다.&lt;/p&gt;
&lt;p&gt;코드를 작성하더라도 아래와 같이 접근한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;테스트 먼저, 개념 다음&lt;/li&gt;
&lt;li&gt;도메인 전문가들의 언어를 따르고, 그 예제를 코드로 옮긴 후 계속해서 나아간다(그래야 실제 요구사항을 반영하는 것이니).&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;131-vo로-쓰기-좋은-dataclass&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#131-vo%EB%A1%9C-%EC%93%B0%EA%B8%B0-%EC%A2%8B%EC%9D%80-dataclass&quot; aria-label=&quot;131 vo로 쓰기 좋은 dataclass permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.3.1. VO로 쓰기 좋은 &lt;code class=&quot;language-text&quot;&gt;@dataclass&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;dataclass&lt;/code&gt; 는 VO로 쓰기 좋다. value equality(값 동등성)을 부여할 수 있다. 얘는 데이터는 있고 식별자(ID)가 없다.&lt;/p&gt;
&lt;h3 id=&quot;132-vo와-엔티티&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#132-vo%EC%99%80-%EC%97%94%ED%8B%B0%ED%8B%B0&quot; aria-label=&quot;132 vo와 엔티티 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.3.2 VO와 엔티티&lt;/h3&gt;
&lt;p&gt;엔티티는 정체성이 있다. 객체를 식별할 유일무이한 값이 있단 뜻이다&lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;. 파이썬에선 이를 위해 &lt;code class=&quot;language-text&quot;&gt;__eq__(self, other)&lt;/code&gt; 매직 메소드와 &lt;code class=&quot;language-text&quot;&gt;__hash__(self)&lt;/code&gt; 매직 메소드를 만든다. 이걸 통해서 엔티의 identity에 대한 동일성 점검을 구현할 수 있다. 책에선 &lt;a href=&quot;https://docs.python.org/3/glossary.html#term-hashable&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;파이썬에서의 hashable&lt;/a&gt; 의 뜻을 설명한 공식문서 경로와 &lt;a href=&quot;https://hynek.me/articles/hashes-and-equality/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 링크&lt;/a&gt;를 통해 소개한다.&lt;/p&gt;
&lt;h2 id=&quot;14-도메인-서비스-함수&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#14-%EB%8F%84%EB%A9%94%EC%9D%B8-%EC%84%9C%EB%B9%84%EC%8A%A4-%ED%95%A8%EC%88%98&quot; aria-label=&quot;14 도메인 서비스 함수 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.4. 도메인 서비스 함수&lt;/h2&gt;
&lt;p&gt;모든걸 객체로 만들 필요는 없다.&lt;/p&gt;
&lt;p&gt;필요하면 파이썬은 그걸 객체화할 필요가 없다. 함수로 만들고 처리하면 되니까. → ‘동사’ 로 표현되는 부분을 표현하려면 그냥 함수로 풀어쓰면 된다.&lt;/p&gt;
&lt;p&gt;근데 이런 식으로 도메인 서비스를 죄다 만들면 객체가 아니라 도메인 서비스 함수에 힘이 더 실리게 된다. 그렇게 힘이 잔뜩 빠진 도메인 객체를 &lt;a href=&quot;https://martinfowler.com/bliki/AnemicDomainModel.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;anemic domain model&lt;/a&gt; 이라 일컫는다.&lt;/p&gt;
&lt;h3 id=&quot;141-매직-메소드-쓸-때-pythonic-idioms-를-써먹으려면&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#141-%EB%A7%A4%EC%A7%81-%EB%A9%94%EC%86%8C%EB%93%9C-%EC%93%B8-%EB%95%8C-pythonic-idioms-%EB%A5%BC-%EC%8D%A8%EB%A8%B9%EC%9C%BC%EB%A0%A4%EB%A9%B4&quot; aria-label=&quot;141 매직 메소드 쓸 때 pythonic idioms 를 써먹으려면 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.4.1 매직 메소드 쓸 때 pythonic idioms 를 써먹으려면?&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;next()&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;sorted()&lt;/code&gt; 를 구현하려면 도메인 모델 내의 &lt;code class=&quot;language-text&quot;&gt;__gt__&lt;/code&gt; 가 구현되어야 한다.&lt;/p&gt;
&lt;h3 id=&quot;142-예외를-사용한-도메인-개념-표현&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#142-%EC%98%88%EC%99%B8%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%9C-%EB%8F%84%EB%A9%94%EC%9D%B8-%EA%B0%9C%EB%85%90-%ED%91%9C%ED%98%84&quot; aria-label=&quot;142 예외를 사용한 도메인 개념 표현 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1.4.2 예외를 사용한 도메인 개념 표현&lt;/h3&gt;
&lt;p&gt;도메인 전문가하고 얘기하다보면 ‘이건 이렇게 할 수 없습니다’ 가 도출되는데, 이걸 예외로직으로 풀어내면 된다.&lt;/p&gt;
&lt;p&gt;그러고보니 도메인 개념 안에도 별도의 exception을 도출해서 써먹으면 좋을 것 같다…&lt;/p&gt;
&lt;h1 id=&quot;정리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A0%95%EB%A6%AC&quot; aria-label=&quot;정리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;정리&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;이 방법론은 DDD로 설계 후 도메인 모델을 도출하고 작업하는걸 권장한다. 그렇게 시작한 프로젝트라면 무리없이 작업가능하다&lt;/li&gt;
&lt;li&gt;도메인 모델에 주요 개념들이 계속해서 들어갈거다.&lt;/li&gt;
&lt;li&gt;엔티티 구현 시
&lt;ul&gt;
&lt;li&gt;파이썬의  &lt;code class=&quot;language-text&quot;&gt;__eq__(self, other)&lt;/code&gt; 매직 메소드와 &lt;code class=&quot;language-text&quot;&gt;__hash__(self)&lt;/code&gt; 매직 메소드를 오버라이딩해서 객체간의 동일함을 점검할 수 있도록 하자&lt;/li&gt;
&lt;li&gt;객체를 파이썬스럽게(pythonic) 써먹으려면 매직메소드를 내 논리에 맞게 오버라이딩해서 써먹어보자&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;VO는 &lt;code class=&quot;language-text&quot;&gt;@dataclass(frozen=True)&lt;/code&gt;  을 사용하라&lt;/li&gt;
&lt;li&gt;‘상속 보다는 구성을 사용하라’ 라는 유명한 말을 파이썬에서 써먹을 때, 저자는 &lt;a href=&quot;https://peps.python.org/pep-0544/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;PEP 544 (프로토콜)&lt;/a&gt;을 활용하라고 한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;자바로 치면 &lt;code class=&quot;language-text&quot;&gt;hashCode()&lt;/code&gt; , &lt;code class=&quot;language-text&quot;&gt;equals()&lt;/code&gt; 같은걸로 객체의 유일성 제공 및 동등함 부여를 체크한다 라는 말&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[서블릿부터 스프링 프레임워크까지]]></title><description><![CDATA[PEP 333을 보고, 자바 진영의 서블릿과 웹 프레임워크의 금자탑인 스프링 프레임워크 까지 함께 알아보게 되었습니다.]]></description><link>https://blog.s3ich4n.me/devlog/docker/2023-03-13-from-servlet-to-spring</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/docker/2023-03-13-from-servlet-to-spring</guid><pubDate>Mon, 13 Mar 2023 23:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Servlet? JSP? JavaBeans? 평소 헷갈렸던 개념들을 쭉 나열하고 하나씩 이해해 보았습니다. 나아가 이를 통해 스프링 프레임워크가 얼마나 큰 개념들을 함께 내포하고 있는지도 간략히 살펴보았습니다.&lt;/p&gt;
&lt;p&gt;자바 웹 애플리케이션을 이해하기 위한 개념들에 대해 알아봅시다.&lt;/p&gt;
&lt;h1 id=&quot;서블릿&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%84%9C%EB%B8%94%EB%A6%BF&quot; aria-label=&quot;서블릿 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;서블릿?&lt;/h1&gt;
&lt;p&gt;Java Servlet은 Java를 이용하여 웹 어플리케이션을 작성할 수 있는 인터페이스(API)를 제공합니다. Java Servlet API를 이용하면 웹 클라이언트의 요청과 응답을 처리하고, 데이터베이스 연결, 파일 업로드, 보안 인증 등 다양한 웹 개발에 필요한 기능을 구현할 수 있습니다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;javax.servlet&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;javax.servlet.http&lt;/code&gt; 패키지안에 서블릿 작성을 위한 인터페이스와 클래스가 있습니다. 아래의 “서블릿 구성요소”에서 후술합니다. 특히 &lt;code class=&quot;language-text&quot;&gt;HttpServlet&lt;/code&gt; 클래스는 HTTP 관련 서비스를 처리하기 위해 &lt;code class=&quot;language-text&quot;&gt;doGet&lt;/code&gt; 및 &lt;code class=&quot;language-text&quot;&gt;doPost&lt;/code&gt;와 같은 메서드를 제공합니다.&lt;/p&gt;
&lt;p&gt;JSP는 Java Servlet 기술을 확장하여, HTML 문서 안에 Java 코드를 삽입할 수 있도록 해줍니다. 이렇게 함으로써, 웹 개발자는 더욱 쉽게 동적인 웹 페이지를 생성하고, 데이터베이스와의 상호작용 등을 수행할 수 있습니다.&lt;/p&gt;
&lt;p&gt;Spring Framework는 Java Servlet API를 기반으로 하며, 의존성 주입, AOP(Aspect-Oriented Programming), MVC(Model-View-Controller) 패턴, 데이터 액세스, 보안 등 다양한 기능을 제공합니다. Spring Framework를 사용하면 Java 기반의 웹 어플리케이션을 더욱 빠르고 효율적으로 개발할 수 있습니다.&lt;/p&gt;
&lt;p&gt;따라서, JSP와 Spring Framework는 Java Servlet을 기반으로 하고 있으며, 이를 이용하여 웹 개발을 보다 쉽게하고, 효율적으로 할 수 있도록 도와줍니다.&lt;/p&gt;
&lt;h2 id=&quot;서블릿-구성요소&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%84%9C%EB%B8%94%EB%A6%BF-%EA%B5%AC%EC%84%B1%EC%9A%94%EC%86%8C&quot; aria-label=&quot;서블릿 구성요소 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;서블릿 구성요소&lt;/h2&gt;
&lt;p&gt;서블릿의 기본 구성 요소는 다음과 같습니다. 논의하면서 주로 HTTP 서블릿에 대해 이야기할 것입니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Servlet Interface: 서블릿 인터페이스는 &lt;code class=&quot;language-text&quot;&gt;javax.servlet&lt;/code&gt; 패키지에 정의되어 있으며, 서블릿 클래스가 구현해야 하는 메서드를 정의합니다. 서블릿 클래스는 반드시 이 인터페이스를 구현해야 합니다.&lt;/li&gt;
&lt;li&gt;Servlet Container: 서블릿 컨테이너는 웹 어플리케이션 서버의 일부로, &lt;a href=&quot;https://docs.oracle.com/javaee/5/tutorial/doc/bnafi.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;서블릿의 생명 주기(lifecycle)&lt;/a&gt;를 관리하고 HTTP 요청 및 응답을 처리합니다. Tomcat, Jetty, GlassFish 등의 서버가 서블릿 컨테이너의 역할을 수행합니다.
&lt;ol&gt;
&lt;li&gt;생명주기를 간략히 설명하면 아래와 같습니다.
&lt;ol&gt;
&lt;li&gt;서블릿의 인스턴스가 존재하지 않는 경우 웹 컨테이너는…
&lt;ol&gt;
&lt;li&gt;서블릿 클래스를 로드합니다.&lt;/li&gt;
&lt;li&gt;서블릿 클래스의 인스턴스를 만듭니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;init&lt;/code&gt; 메소드를 호출하여 서블릿 인스턴스를 초기화합니다. 초기화는 서블릿 초기화에서 다룹니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;요청 및 응답 개체를 전달하여 서비스 메서드를 호출합니다. 서비스 메서드는 서비스 메서드 작성에서 설명합니다.&lt;/li&gt;
&lt;li&gt;컨테이너가 서블릿을 제거해야 하는 경우 서블릿의 &lt;code class=&quot;language-text&quot;&gt;destroy&lt;/code&gt; 메소드를 호출하여 서블릿을 종료합니다. 종료는 서블릿 종료에서 설명합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;톰캣이 상기 내용을 토대로 구현되어있겠죠.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Servlet Request: 클라이언트로부터 전송된 HTTP 요청을 나타냅니다. &lt;code class=&quot;language-text&quot;&gt;ServletRequest&lt;/code&gt; 인터페이스는 HTTP 요청에 대한 다양한 메타데이터(메서드, URI, 헤더, 쿠키 등)를 포함합니다.
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.oracle.com/javaee/5/tutorial/doc/bnafv.html#bnafw&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;해당 대목&lt;/a&gt;을 중점으로 살펴보시면 이해하기 쉽습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Servlet Response: 클라이언트로 전송할 HTTP 응답을 나타냅니다. &lt;code class=&quot;language-text&quot;&gt;ServletResponse&lt;/code&gt; 인터페이스는 HTTP 응답에 대한 다양한 메타데이터(상태 코드, 헤더 등)를 포함합니다.
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.oracle.com/javaee/5/tutorial/doc/bnafv.html#bnafz&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;해당 대목&lt;/a&gt;을 중점으로 살펴보시면 이해하기 쉽습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Servlet Config: 서블릿 설정 정보를 나타냅니다. &lt;code class=&quot;language-text&quot;&gt;ServletConfig&lt;/code&gt; 인터페이스는 서블릿 초기화 파라미터와 서블릿 이름을 포함합니다.&lt;/li&gt;
&lt;li&gt;Servlet Context: 웹 어플리케이션의 전역 정보를 나타냅니다. &lt;code class=&quot;language-text&quot;&gt;ServletContext&lt;/code&gt; 인터페이스는 웹 어플리케이션의 루트 디렉토리 경로, 서블릿 컨텍스트 초기화 파라미터 등의 정보를 포함합니다.
&lt;ol&gt;
&lt;li&gt;서블릿 컨텍스트는 &lt;a href=&quot;https://docs.oracle.com/javaee/5/tutorial/doc/bnagl.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 링크&lt;/a&gt;를 참조하십시오.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;참고: 그 외에 세션 유지 및 Finalize 관련 요소에 대한 설명은 생략합니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;이러한 서블릿의 기본 구성 요소를 활용하여 웹 어플리케이션을 구현할 수 있습니다. 서블릿은 또한 자바 EE(Java Enterprise Edition) 표준 기술의 일부이며, 다양한 웹 개발 프레임워크와 라이브러리를 포함하여 대규모 웹 어플리케이션을 개발하는 데 필수적인 기술입니다.&lt;/p&gt;
&lt;h1 id=&quot;jsp&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#jsp&quot; aria-label=&quot;jsp permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;JSP?&lt;/h1&gt;
&lt;p&gt;JavaServer Pages (JSP)는 서블릿 기술을 확장하여 웹 어플리케이션 개발을 보다 쉽게 할 수 있도록 해주는 기술입니다. JSP는 HTML 코드와 자바 코드를 혼합하여 웹 페이지를 생성할 수 있도록 합니다.&lt;/p&gt;
&lt;h2 id=&quot;jsp-구성요소&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#jsp-%EA%B5%AC%EC%84%B1%EC%9A%94%EC%86%8C&quot; aria-label=&quot;jsp 구성요소 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;JSP 구성요소&lt;/h2&gt;
&lt;p&gt;JSP의 핵심 요소는 다음과 같습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Scriptlets&lt;/code&gt;: &lt;code class=&quot;language-text&quot;&gt;&amp;lt;% %&gt;&lt;/code&gt; 태그 내에 자바 코드를 작성하는 것으로, JSP 페이지를 생성하는 데 필요한 로직을 처리할 수 있습니다.&lt;/li&gt;
&lt;li&gt;Declarations: &lt;code class=&quot;language-text&quot;&gt;&amp;lt;%! %&gt;&lt;/code&gt; 태그 내에 전역 변수 및 메서드를 선언하는 것으로, JSP 페이지 내에서 재사용 가능한 코드를 작성할 수 있습니다.&lt;/li&gt;
&lt;li&gt;Directives: &lt;code class=&quot;language-text&quot;&gt;&amp;lt;%@ %&gt;&lt;/code&gt; 태그 내에 JSP 페이지의 속성을 설정하는 것으로, import 문, 에러 페이지 지정, 캐시 설정 등을 할 수 있습니다.&lt;/li&gt;
&lt;li&gt;Expressions: &lt;code class=&quot;language-text&quot;&gt;&amp;lt;%= %&gt;&lt;/code&gt; 태그 내에 자바 표현식을 작성하는 것으로, JSP 페이지에서 계산된 값을 출력할 수 있습니다.&lt;/li&gt;
&lt;li&gt;Actions: &lt;code class=&quot;language-text&quot;&gt;jsp:*&lt;/code&gt; 태그로 표시되며, JSP 컨테이너에서 실행되는 특수 태그로, JavaBean 객체의 값을 출력하거나, 페이지 이동 및 조건 분기 등의 로직을 처리할 수 있습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;jsp-대신&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#jsp-%EB%8C%80%EC%8B%A0&quot; aria-label=&quot;jsp 대신 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;JSP 대신..?&lt;/h2&gt;
&lt;p&gt;AFAIK, 요즘은 JSP를 쓰기보단 아래 조합들이 더 쓰인다고 하더군요.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Spring Boot + Thymeleaf&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Spring Boot는 웹 어플리케이션을 빠르게 개발할 수 있게 해주는 프레임워크이며, Thymeleaf는 템플릿 엔진 중 하나입니다. Spring Boot에서 Thymeleaf를 사용하면 서블릿을 이용하여 웹 어플리케이션을 개발할 수 있습니다. Thymeleaf는 JSP보다 유연한 문법을 제공하며, 자바 코드를 사용하지 않아도 HTML과 연동하기 쉽습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Spring Boot + Freemarker&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Spring Boot에서 Freemarker를 사용하면 서블릿을 이용하여 웹 어플리케이션을 개발할 수 있습니다. Freemarker는 Thymeleaf와 유사한 템플릿 엔진으로, JSP보다 유연한 문법을 제공합니다. 또한, 자바 코드를 사용하지 않아도 HTML과 연동하기 쉽습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Spring Boot + Mustache&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Spring Boot에서 Mustache를 사용하면 서블릿을 이용하여 웹 어플리케이션을 개발할 수 있습니다. Mustache는 JSP나 Thymeleaf보다 문법이 단순하며, 자바 코드를 사용하지 않아도 HTML과 연동하기 쉽습니다. 또한, Mustache는 서버와 클라이언트 간의 데이터 교환을 쉽게 할 수 있도록 지원합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;java-beans&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#java-beans&quot; aria-label=&quot;java beans permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Java Beans?&lt;/h1&gt;
&lt;p&gt;JavaBeans 구성 요소는 쉽게 재사용하고 응용 프로그램으로 함께 구성할 수 있는 Java 클래스입니다. 특정 디자인 규칙을 따르는 모든 Java 클래스는 JavaBeans 구성 요소입니다.&lt;/p&gt;
&lt;p&gt;JavaBeans 클래스는 다음과 같은 규칙을 따릅니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;클래스는 파라미터가 없는 생성자를 제공해야 합니다.&lt;/li&gt;
&lt;li&gt;클래스의 속성은 private으로 선언되어야 하며, getter/setter 메서드를 제공해야 합니다.&lt;/li&gt;
&lt;li&gt;getter/setter 메서드는 public으로 선언되어야 하며, 메서드 이름은 get/set으로 시작해야 합니다.&lt;/li&gt;
&lt;li&gt;속성 이름은 get/set 메서드 이름에서 get/set 접두사를 제외한 나머지 부분이 됩니다. 예를 들어, &lt;code class=&quot;language-text&quot;&gt;getName()/setName()&lt;/code&gt; 메서드가 있다면 속성 이름은 name이 됩니다.&lt;/li&gt;
&lt;li&gt;클래스는 &lt;code class=&quot;language-text&quot;&gt;Serializable&lt;/code&gt; 인터페이스를 구현해야 합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;JavaBeans는 재사용성이 높은 컴포넌트를 개발할 때 유용합니다. 예를 들어, 데이터베이스에서 데이터를 가져와 웹 페이지에 표시하는데 사용될 수 있는 데이터 모델 클래스를 개발할 때 JavaBeans 규약을 따르면, 이를 JSP나 서블릿과 쉽게 연동할 수 있습니다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;주 - 웹 응용 프로그램에서 사용할 때 MVC 아키텍처는 종종 모델-2 아키텍처라고 합니다. 프레젠테이션과 비즈니스 로직을 혼합하는 4장, Java Servlet 기술에서 논의된 서점의 예는 모델-1 아키텍처로 알려진 것을 따릅니다. Model-2 아키텍처는 웹 애플리케이션 설계에 권장되는 접근 방식입니다.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.oracle.com/javaee/5/tutorial/doc/bnahb.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;출처&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;java-beans와-spring-framework의-관계&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#java-beans%EC%99%80-spring-framework%EC%9D%98-%EA%B4%80%EA%B3%84&quot; aria-label=&quot;java beans와 spring framework의 관계 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Java Beans와 Spring Framework의 관계&lt;/h1&gt;
&lt;p&gt;Spring Framework에서는 JavaBeans를 매우 활발하게 사용합니다. Spring Framework에서는 자바 객체를 컨테이너에서 관리하기 위해 JavaBeans 규약을 따르는 POJO(Plain Old Java Object) 클래스를 사용합니다.&lt;/p&gt;
&lt;p&gt;Spring Framework에서는 POJO 클래스를 컨테이너에 등록하고, 필요한 객체를 DI(Dependency Injection)를 통해 주입하여 사용합니다. DI는 객체 간의 의존성을 줄이기 위해 사용되며, 객체를 생성하고 관리하는 작업을 프레임워크가 대신 처리합니다.&lt;/p&gt;
&lt;p&gt;Spring Framework에서는 POJO 클래스가 JavaBeans 규약을 따르면, 컨테이너에서 해당 클래스의 객체를 생성하고 DI를 적용할 수 있습니다. 따라서, Spring Framework에서는 POJO 클래스의 멤버 변수를 private으로 선언하고, getter/setter 메서드를 제공하여 JavaBeans 규약을 따르도록 작성합니다.&lt;/p&gt;
&lt;p&gt;예를 들어, 다음은 Spring Framework에서 사용할 수 있는 간단한 POJO 클래스입니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;User&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; age&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;setName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getAge&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; age&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;setAge&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; age&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;age &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; age&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위의 코드에서는 JavaBeans 규약을 따르기 위해 속성을 private으로 선언하고, getter/setter 메서드를 제공합니다.&lt;/p&gt;
&lt;p&gt;Spring Framework에서는 이 POJO 클래스를 다음과 같이 등록하고 DI를 적용할 수 있습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token annotation punctuation&quot;&gt;@Configuration&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AppConfig&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Bean&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;User&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;User&lt;/span&gt; user &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        user&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;John&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        user&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setAge&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; user&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token annotation punctuation&quot;&gt;@Service&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;UserService&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Autowired&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;User&lt;/span&gt; user&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;printUser&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;out&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;user&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;, &quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; user&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getAge&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;위의 코드에서는 &lt;code class=&quot;language-text&quot;&gt;AppConfig&lt;/code&gt; 클래스에서 User 객체를 Bean으로 등록하고, &lt;code class=&quot;language-text&quot;&gt;UserService&lt;/code&gt; 클래스에서 &lt;code class=&quot;language-text&quot;&gt;Autowired&lt;/code&gt; 어노테이션을 사용하여 User 객체를 DI 받습니다. 이렇게 등록된 User 객체는 &lt;code class=&quot;language-text&quot;&gt;UserService&lt;/code&gt; 클래스에서 사용되어 출력됩니다.&lt;/p&gt;
&lt;p&gt;따라서, Spring Framework에서는 JavaBeans 규약을 따르는 POJO 클래스를 사용하여 객체를 생성하고 DI를 적용하므로, 객체 간의 의존성을 줄이고 코드의 재사용성을 높일 수 있습니다.&lt;/p&gt;
&lt;h1 id=&quot;spring-framework의-핵심-요소&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#spring-framework%EC%9D%98-%ED%95%B5%EC%8B%AC-%EC%9A%94%EC%86%8C&quot; aria-label=&quot;spring framework의 핵심 요소 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Spring Framework의 핵심 요소?&lt;/h1&gt;
&lt;p&gt;사실상 스프링 프레임워크를 간략하게 이해하기 위해 여기까지 왔습니다.&lt;/p&gt;
&lt;p&gt;그래서, 스프링 프레임워크의 런타임으로 정말 핵심적인 컴포넌트들을 소개하면 아래 요소들이 나오는 것이었습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Spring Core container
&lt;ul&gt;
&lt;li&gt;스프링 프레임워크의 기본&lt;/li&gt;
&lt;li&gt;스프링 DI의 근간&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;AOP
&lt;ul&gt;
&lt;li&gt;AOP 지원. 이는 추후 다른 게시글로 소개하겠습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;데이터 접근/통합 레이어
&lt;ul&gt;
&lt;li&gt;ORM, DAO 등이 속합니다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;웹 레이어
&lt;ul&gt;
&lt;li&gt;HTTP 뿐 아니라 웹소켓 등이 속합니다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;테스팅 레이어
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.spring.io/spring-framework/docs/current/reference/html/testing.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;해당 링크&lt;/a&gt;를 참고하여 주십시오.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;https://docs.spring.io/spring-framework/docs/4.3.x/spring-framework-reference/html/images/spring-overview.png&quot; alt=&quot;도식은 이렇습니다.&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;마무리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%88%EB%AC%B4%EB%A6%AC&quot; aria-label=&quot;마무리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;마무리&lt;/h1&gt;
&lt;p&gt;이상으로 헷갈렸던 개념들을 모두 정리할 수 있었습니다. 글을 한번 되짚어봅시다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Servlet은 웹 앱을 작성하기 위한 기본 뼈대입니다.&lt;/li&gt;
&lt;li&gt;JSP는 HTML 코드와 자바 코드를 혼합하여 웹 페이지를 생성하는 기술입니다. 하지만 확장성이나 코드의 유연함에서 좀 아쉬운 면이 있지요.&lt;/li&gt;
&lt;li&gt;JavaBeans는 재사용성을 중시하고 데이터를 자바스럽게 표현하는 기술입니다. 그 나름의 프로토콜을 가지고 있으며, 이는 Spring Framework에도 활발하게 쓰입니다.&lt;/li&gt;
&lt;li&gt;Spring Framework가 얼마나 많은 연구들의 총집이자 금자탑인지 알게되었습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;긴 글 읽어주셔서 감사합니다.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;참고문서&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.oracle.com/javaee/5/tutorial/doc/docinfo.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Java EE 5 튜토리얼&lt;/a&gt; (사실 이 속에 정답이 거의 들어있었습니다!)&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://johngrib.github.io/wiki/spring-bean-config-configuration/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Configuration annotation을 통한 Spring Bean 설정&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.digitalocean.com/community/tutorials/spring-configuration-annotation&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Spring &lt;code class=&quot;language-text&quot;&gt;@Configuration&lt;/code&gt; Annotation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[클린 코드 스터디 (13): 동시성(Concurrency)]]></title><description><![CDATA[2023년 1월부터 시작한 클린 코드 독파 스터디 후, 매 모임 전 준비하는 게시글을 공유합니다. 이 글은 13장, 동시성(concurrency)에 대해 알아봅니다.]]></description><link>https://blog.s3ich4n.me/books/clean-code/2023-03-07-pt01</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/clean-code/2023-03-07-pt01</guid><pubDate>Tue, 07 Mar 2023 22:51:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;13-동시성concurrency&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#13-%EB%8F%99%EC%8B%9C%EC%84%B1concurrency&quot; aria-label=&quot;13 동시성concurrency permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;13. 동시성(Concurrency)&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;객체는 처리의 추상화다. 스레드는 일정의 추상화다.&lt;/p&gt;
&lt;p&gt;James. O. Coplien&lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;동시성과 깔끔한 코드는 양립하기 매우 힘듭니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;문제 발생 전까지 올바른 원인을 파악하기 매우 힘듭니다.&lt;/li&gt;
&lt;li&gt;껍데기는 멀쩡하나 깊숙한 곳에 문제가 있는 다중 스레드 코드도 짜기 쉽습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이 챕터를 통해 아래 내용을 살펴보겠습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;여러 스레드/프로세스를 왜 사용하는가?&lt;/li&gt;
&lt;li&gt;무엇 때문에 동시성이 어려운가?&lt;/li&gt;
&lt;li&gt;이런 어려움을 대처하고 어떻게 깨끗한 코드를 짤 것인가?&lt;/li&gt;
&lt;li&gt;테스트 방법 및 구체적 지침&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;일러두기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%BC%EB%9F%AC%EB%91%90%EA%B8%B0&quot; aria-label=&quot;일러두기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;일러두기&lt;/h2&gt;
&lt;p&gt;먼저, 이 아티클에서는 책에서 제시하는 내용을 간략히 살펴볼 예정입니다.저희 스터디에서는 후에 부록 A 동시성 II 를 함께 보면서 더 다뤄볼 예정입니다. 또한 뮤텍스, 세마포어 및 모니터를 각자 살펴보고 각자 자신이 선택한 언어에서 동시성 프로그래밍을 어떤 원칙으로 구현하였는지 살펴볼 예정입니다.&lt;/p&gt;
&lt;h2 id=&quot;동시성이-필요한-이유&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8F%99%EC%8B%9C%EC%84%B1%EC%9D%B4-%ED%95%84%EC%9A%94%ED%95%9C-%EC%9D%B4%EC%9C%A0&quot; aria-label=&quot;동시성이 필요한 이유 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;동시성이 필요한 이유?&lt;/h2&gt;
&lt;p&gt;동시성은 결합(coupling)을 없애는 전략입니다. 이는 ‘무엇’과 ‘언제’를 분리하는 전략입니다. 단일 스레드 프로그램은 이 둘이 항상 밀접합니다. 이런 프로그램을 디버깅한다면 breakpoint를 잡고 시스템의 상태를 파악합니다.&lt;/p&gt;
&lt;p&gt;동시성이 필요하다면 “무엇”과 “언제”를 분리하는 것이 좋습니다. 시스템 상에 큰 루프 하나가 아니라, 작은 협력 프로그램 여럿을 통해 결과를 내는 것을 생각하면 됩니다. 이렇게 만들어진 시스템은 전체 구조파악 및 문제 분리라는 관점에서 수월해집니다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Servelt&lt;/code&gt;이 그 예시입니다. 초기 서블릿은 스레드 풀을 만들고 그 한계에 대해 요청/응답을 처리할 수 있었습니다. &lt;a href=&quot;https://www.oreilly.com/library/view/head-first-servlets/9780596516680/ch04s04.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;헤드퍼스트 게시글&lt;/a&gt;을 살펴보시면 이해가 빠를겁니다&lt;sup id=&quot;fnref-2&quot;&gt;&lt;a href=&quot;#fn-2&quot; class=&quot;footnote-ref&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;p&gt;그렇지만 이런 구현을 문제없이 하기란 결코 쉽지 않습니다! 구조적 이점에 비해 구현 난이도가 어렵기 때문입니다. 그럼에도 불구하고, 한번에 여러 작업(사용자 요청이 되었건, 연산이 되었건…)을 처리할 수 있는 시스템은 성능 향상을 이끌어낼 수 있습니다.&lt;/p&gt;
&lt;h3 id=&quot;미신과-오해&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AF%B8%EC%8B%A0%EA%B3%BC-%EC%98%A4%ED%95%B4&quot; aria-label=&quot;미신과 오해 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;미신과 오해&lt;/h3&gt;
&lt;p&gt;동시성은 어렵습니다. 오해하기 쉬운 것들이 몇가지 있습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;동시성은 항상 성능을 올린다?
&lt;ul&gt;
&lt;li&gt;대기시간이 아주 길어 여러 스레드가 프로세서를 공유할 수 있거나&lt;/li&gt;
&lt;li&gt;여러 프로세서가 동시에 처리할 독립적 계산이 “충분히” 많아야 성능이 올라갑니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;동시성을 구현해도 설계는 변하지 않는다?
&lt;ul&gt;
&lt;li&gt;“무엇”과 “언제”를 분리하는 것은 시스템 자체가 바뀌는 것을 의미합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;웹, EJB 컨테이너 등을 쓰면 동시성을 몰라도 된다?
&lt;ul&gt;
&lt;li&gt;사용하는 프레임워크나 라이브러리의 근간이 어떻게 돌아가는지 알아야합니다. 그래야 동시 수정과 데드락을 어떻게 해결할지 생각할 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;그렇지만 아래와 같이 동시성에 대한 타당한 생각을 할 수 있습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;동시성은 다소 부하를 유발합니다.
&lt;ul&gt;
&lt;li&gt;성능 측면에서 부하가 걸립니다.&lt;/li&gt;
&lt;li&gt;코드도 더 짜야합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;동시성은 복잡합니다.&lt;/li&gt;
&lt;li&gt;동시성 버그는 재현하기 어렵습니다. 그래서 이 버그들을 글리치로 오해할 수도 있습니다.&lt;/li&gt;
&lt;li&gt;동시성을 구현하려면 설계전략을 다시 생각해봐야 합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;난관&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%82%9C%EA%B4%80&quot; aria-label=&quot;난관 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;난관&lt;/h2&gt;
&lt;p&gt;왜 동시성을 구현하기 어려울까요?&lt;/p&gt;
&lt;p&gt;자바 진영에서 두 스레드가 동시에 같은 변수를 다루는 케이스를 살펴봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; listIdUsed&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getNextId&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;lastIdUsed&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;두 스레드가 &lt;code class=&quot;language-text&quot;&gt;getNextId()&lt;/code&gt; 를 호출한다고 했을 때, 아래 세 경우가 발생합니다.
264&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;스레드 1이 &lt;code class=&quot;language-text&quot;&gt;43&lt;/code&gt;을 받음. 다른 스레드는 &lt;code class=&quot;language-text&quot;&gt;44&lt;/code&gt;를 받음. &lt;code class=&quot;language-text&quot;&gt;lastIdUsed&lt;/code&gt;는 44가 됨&lt;/li&gt;
&lt;li&gt;스레드 1이 &lt;code class=&quot;language-text&quot;&gt;44&lt;/code&gt;을 받음. 다른 스레드는 &lt;code class=&quot;language-text&quot;&gt;43&lt;/code&gt;를 받음. &lt;code class=&quot;language-text&quot;&gt;lastIdUsed&lt;/code&gt;는 44가 됨&lt;/li&gt;
&lt;li&gt;스레드 1이 &lt;code class=&quot;language-text&quot;&gt;43&lt;/code&gt;을 받음. 다른 스레드는 &lt;code class=&quot;language-text&quot;&gt;43&lt;/code&gt;를 받음. &lt;code class=&quot;language-text&quot;&gt;lastIdUsed&lt;/code&gt;는 43이 됨&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;두 스레드가 자바 코드 하나를 읽는 “경로” 를 ”&lt;strong&gt;잘못&lt;/strong&gt;” 내어놓을 수 있습니다. 이 경로는 정말 많습니다. 이를 알기위해선 정확히 JIT 컴파일러가 바이트코드를 다루는 방식과 자바 메모리 모델이 atomic한 연산으로 판단하는 최소 단위를 알아야 합니다&lt;sup id=&quot;fnref-3&quot;&gt;&lt;a href=&quot;#fn-3&quot; class=&quot;footnote-ref&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;p&gt;잘못된 결과를 내어놓는 일부 경로로 인해 답이 달라지는 것이 문제이기 때문입니다. 그렇다면 이러한 문제를 회피하는 방안을 살펴봅시다.&lt;/p&gt;
&lt;h2 id=&quot;동시성-방어-원칙&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8F%99%EC%8B%9C%EC%84%B1-%EB%B0%A9%EC%96%B4-%EC%9B%90%EC%B9%99&quot; aria-label=&quot;동시성 방어 원칙 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;동시성 방어 원칙&lt;/h2&gt;
&lt;h3 id=&quot;srp&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#srp&quot; aria-label=&quot;srp permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;SRP&lt;/h3&gt;
&lt;p&gt;동시성을 다루는 코드는 최대한 작게 만듭시다! 아래 사항을 고려하여 제작하는 편이 좋습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;동시성 코드는 독자적인 개발, 변경, 조율 주기가 있습니다.&lt;/li&gt;
&lt;li&gt;잘못 구현한 동시성 코드는 어디로 튈지 모릅니다.&lt;/li&gt;
&lt;li&gt;동시성 코드는 독자적 난관이 있습니다. 다른 코드를 짤 때와는 다르며, 훨씬 어렵습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;권장사항&lt;/strong&gt;: 동시성 코드는 다른 코드와 분리합시다.&lt;/p&gt;
&lt;h3 id=&quot;따름-정리corollary-자료-범위-제한&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%94%B0%EB%A6%84-%EC%A0%95%EB%A6%ACcorollary-%EC%9E%90%EB%A3%8C-%EB%B2%94%EC%9C%84-%EC%A0%9C%ED%95%9C&quot; aria-label=&quot;따름 정리corollary 자료 범위 제한 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;따름 정리(Corollary): 자료 범위 제한&lt;/h3&gt;
&lt;p&gt;critical section을 보호할 필요가 있습니다. 예를들어 자바에서는 &lt;code class=&quot;language-text&quot;&gt;synchronized&lt;/code&gt; 라는 키워드가 있지요.&lt;sup id=&quot;fnref-4&quot;&gt;&lt;a href=&quot;#fn-4&quot; class=&quot;footnote-ref&quot;&gt;4&lt;/a&gt;&lt;/sup&gt;이런 critical section을 많이 줄이는 것도 필요합니다. 공유 자료를 수정하는 위치가 많아질 수록 다음 가능성도 커집니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;보호할 critical section을 빼먹을 수 있습니다. 이는 공유 자료를 수정하는 모든 코드가 망가지는 원인이 됩니다.&lt;/li&gt;
&lt;li&gt;모든 critical section이 보호되었는지 확인하느라 노력과 수고를 기울이게 됩니다.&lt;/li&gt;
&lt;li&gt;버그 찾기가 더 힘들어집니다…&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;권장사항&lt;/strong&gt;: 자료를 캡슐화하고 공유자료를 최대한 줄입시다.&lt;/p&gt;
&lt;h3 id=&quot;corollary-자료-사본을-사용하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#corollary-%EC%9E%90%EB%A3%8C-%EC%82%AC%EB%B3%B8%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0&quot; aria-label=&quot;corollary 자료 사본을 사용하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Corollary: 자료 사본을 사용하기&lt;/h3&gt;
&lt;p&gt;가능한 객체 자체를 복사하여 읽기 전용으로 씁시다. 객체를 복사하는 시간과 부하가 걱정된다면 실측해서 비교해봅시다.&lt;/p&gt;
&lt;h3 id=&quot;corollary-스레드는-독립적으로-구현합시다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#corollary-%EC%8A%A4%EB%A0%88%EB%93%9C%EB%8A%94-%EB%8F%85%EB%A6%BD%EC%A0%81%EC%9C%BC%EB%A1%9C-%EA%B5%AC%ED%98%84%ED%95%A9%EC%8B%9C%EB%8B%A4&quot; aria-label=&quot;corollary 스레드는 독립적으로 구현합시다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Corollary: 스레드는 독립적으로 구현합시다.&lt;/h3&gt;
&lt;p&gt;각 스레드가 독자적인 시스템에서 동작하는 것 처럼 처리합시다.&lt;/p&gt;
&lt;p&gt;권장사항: 프로그램을 독자적인 스레드로(가능하면 다른 프로세서에서) 구동해도 괜찮도록 자료를 독립적인 단위로 분할합시다.&lt;/p&gt;
&lt;h2 id=&quot;라이브러리를-이해하십시오&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%EB%A5%BC-%EC%9D%B4%ED%95%B4%ED%95%98%EC%8B%AD%EC%8B%9C%EC%98%A4&quot; aria-label=&quot;라이브러리를 이해하십시오 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;라이브러리를 이해하십시오&lt;/h2&gt;
&lt;p&gt;자바 5 등의 과거 얘기가 주로 나오지만, 핵심을 짚읍시다.&lt;/p&gt;
&lt;h3 id=&quot;thread-safe-컬렉션-관련&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#thread-safe-%EC%BB%AC%EB%A0%89%EC%85%98-%EA%B4%80%EB%A0%A8&quot; aria-label=&quot;thread safe 컬렉션 관련 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Thread-safe 컬렉션 관련&lt;/h3&gt;
&lt;p&gt;언어별로 스레드 간 공유해도 사용할 수 있는 컬렉션을 사용합시다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;권장사항&lt;/strong&gt;: 언어가 제공하는 클래스를 검토하십시오.&lt;/p&gt;
&lt;h2 id=&quot;실행-모델을-이해하십시오&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%8B%A4%ED%96%89-%EB%AA%A8%EB%8D%B8%EC%9D%84-%EC%9D%B4%ED%95%B4%ED%95%98%EC%8B%AD%EC%8B%9C%EC%98%A4&quot; aria-label=&quot;실행 모델을 이해하십시오 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;실행 모델을 이해하십시오&lt;/h2&gt;
&lt;p&gt;다중 스레드 애플리케이션을 분류하는 방식은 여러가지 입니다. 기본용어부터 이해해봅시다.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;용어&lt;/th&gt;
&lt;th&gt;설명&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Bound Resource&lt;/td&gt;
&lt;td&gt;다중 스레드 환경에서 사용하는 자원으로, 크기나 숫자가 제한적임.&lt;br /&gt;DB 연결, 길이가 일정한 읽기/쓰기 버퍼 등.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Mutual Exclusion&lt;/td&gt;
&lt;td&gt;한 번에 한 스레드만 공유 자료나 공유 자원을 사용할 수 있는 경우.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Starvation&lt;/td&gt;
&lt;td&gt;한 스레드나 여러 스레드가 영원히/오랫동안 자원을 기다리는 경우.&lt;br /&gt;항상 짧은 스레드에만 우선순위를 주면 긴 스레드는 굶어죽는다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Deadlock&lt;/td&gt;
&lt;td&gt;여러 스레드가 서로 끝나기를 기다리는 경우. 이러면 서로 기다리니까 진행이 안된다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Livelock&lt;/td&gt;
&lt;td&gt;락을 거는 단게에서 각 스레드가 서로를 방해하는 경우. &lt;em&gt;‘상대 스레드가 점유중이다’&lt;/em&gt; 라는 상황을 서로 바라보는 탓에 영원히/오랫동안 대기하는 경우를 의미한다.&lt;sup id=&quot;fnref-5&quot;&gt;&lt;a href=&quot;#fn-5&quot; class=&quot;footnote-ref&quot;&gt;5&lt;/a&gt;&lt;/sup&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;아래에는 다중 스레드 프로그래밍에서 사용하는 실행 모델을 살펴봅시다&lt;sup id=&quot;fnref-6&quot;&gt;&lt;a href=&quot;#fn-6&quot; class=&quot;footnote-ref&quot;&gt;6&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;h3 id=&quot;생산자-소비자producer-consumer-문제&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%83%9D%EC%82%B0%EC%9E%90-%EC%86%8C%EB%B9%84%EC%9E%90producer-consumer-%EB%AC%B8%EC%A0%9C&quot; aria-label=&quot;생산자 소비자producer consumer 문제 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;생산자-소비자(Producer-Consumer) 문제&lt;/h3&gt;
&lt;p&gt;생산자 스레드가 정보를 생성하여 버퍼나 큐에 넣고, 소비자 스레드가 이를 가져와 사용하며, 서로에게 정보 여부를 확인하는 시그널을 주고받는 것이 기본 가정입니다. 잘못하면 생산자, 소비자 모두 진행 가능하지만 동시에 &lt;strong&gt;서로에게서 시그널을 기다릴 가능성이 존재&lt;/strong&gt;합니다.&lt;/p&gt;
&lt;p&gt;데드락을 어떻게 풀어나갈지 논의하는 문제입니다.&lt;/p&gt;
&lt;p&gt;상세한 내용은 &lt;a href=&quot;https://en.wikipedia.org/wiki/Producer%E2%80%93consumer_problem&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;영문 위키백과 글&lt;/a&gt;을 참고하여 주시길 바랍니다.&lt;/p&gt;
&lt;h3 id=&quot;읽기-쓰기readers-writers-문제&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%BD%EA%B8%B0-%EC%93%B0%EA%B8%B0readers-writers-%EB%AC%B8%EC%A0%9C&quot; aria-label=&quot;읽기 쓰기readers writers 문제 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;읽기-쓰기(Readers-Writers) 문제&lt;/h3&gt;
&lt;p&gt;읽기 스레드를 위한 주된 정보원으로 공유 자원을 사용하지만, 쓰기 스레드가 이 공유 자원을 이따금 갱신하는 것이 기본 가정입니다. &lt;strong&gt;처리율(throughput)이 높아지면 Starvation이 생겨&lt;/strong&gt; 오래된 정보가 쌓이지만, &lt;strong&gt;갱신을 허용하면 처리율에 영향을 미칩&lt;/strong&gt;니다.&lt;/p&gt;
&lt;p&gt;쓰기 스레드와 읽기 스레드 양쪽의 균형을 잡는 방안에 대해 논의하는 문제입니다.&lt;/p&gt;
&lt;p&gt;상세한 내용은 &lt;a href=&quot;https://en.wikipedia.org/wiki/Readers%E2%80%93writers_problem&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;영문 위키백과 글&lt;/a&gt;을 참고하여 주시길 바랍니다.&lt;/p&gt;
&lt;h3 id=&quot;식사하는-철학자들dining-philosophers-문제&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%8B%9D%EC%82%AC%ED%95%98%EB%8A%94-%EC%B2%A0%ED%95%99%EC%9E%90%EB%93%A4dining-philosophers-%EB%AC%B8%EC%A0%9C&quot; aria-label=&quot;식사하는 철학자들dining philosophers 문제 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;식사하는 철학자들(Dining Philosophers) 문제&lt;/h3&gt;
&lt;p&gt;이런 내용입니다. 그림과 함께 살펴보시죠.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;둥근 식탁에 철학자들이 둘러 앉아서 식사를 하려 합니다.&lt;/p&gt;
&lt;p&gt;각 철학자 왼쪽에는 젓가락이 있고, 식탁 가운데는 큰 스파게티 접시가 있습니다.&lt;/p&gt;
&lt;p&gt;이들은 배가 고프면 젓가락 두 개를 가지고 먹어야 합니다.&lt;/p&gt;
&lt;p&gt;자신의 좌측 또는 우측 철학자가 젓가락을 쓰는 중이라면, 젓가락을 내려놓을 때 까지 기다려야 합니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 244px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/a8f4bb560aada3dd7d45cc9da0bc25c5/603fe/001.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 96.25000000000001%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAATABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAQCBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAethgtSCyELwf//EAB4QAAIBAwUAAAAAAAAAAAAAAAECAAMEEhAREyEx/9oACAEBAAEFAqwJjMWVd8cXip2OaHy20//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABsQAAEEAwAAAAAAAAAAAAAAAAABEBEhAhIx/9oACAEBAAY/AksiRJ6LtZT5N//EAB4QAAICAgIDAAAAAAAAAAAAAAABESExcRBBUYGh/9oACAEBAAE/IWjqK8EWItMVEPPZileiasibKfg1utoyaM/Tj//aAAwDAQACAAMAAAAQIM88/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPxAf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPxAf/8QAHxABAAIBAwUAAAAAAAAAAAAAAQARIRAxcUFhgaHB/9oACAEBAAE/EEhm5DWejHD0S2hZRzjkZahBZ7jsG0ehXmwwBRGgNa8T30V8f1p//9k=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/a8f4bb560aada3dd7d45cc9da0bc25c5/8ac56/001.webp 240w,
/static/a8f4bb560aada3dd7d45cc9da0bc25c5/d4674/001.webp 244w&quot;
              sizes=&quot;(max-width: 244px) 100vw, 244px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/a8f4bb560aada3dd7d45cc9da0bc25c5/09b79/001.jpg 240w,
/static/a8f4bb560aada3dd7d45cc9da0bc25c5/603fe/001.jpg 244w&quot;
            sizes=&quot;(max-width: 244px) 100vw, 244px&quot;
            type=&quot;image/jpeg&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/a8f4bb560aada3dd7d45cc9da0bc25c5/603fe/001.jpg&quot;
            alt=&quot;Dining Philosophers Problem&quot;
            title=&quot;Dining Philosophers Problem&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;Dining Philosophers Problem&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;이 문제는 철학자를 스레드로, 포크를 리소스로 생각해보면 됩니다. 프로그램 내에서 여러 프로세스가 리소스를 얻기 위해 경쟁해야 합니다. 주의해서 설계하지 않으면 데드락, 라이브락, throughput 저하, 효율 저하가 생기지요.&lt;/p&gt;
&lt;p&gt;상세한 내용은 &lt;a href=&quot;https://en.wikipedia.org/wiki/Dining_philosophers_problem&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;영문 위키백과 글&lt;/a&gt;을 참고하여 주시길 바랍니다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;권장사항&lt;/strong&gt;: 위에서 설명한 기본 알고리즘과 각 해법을 이해합시다.&lt;/p&gt;
&lt;h2 id=&quot;동기화하는-메소드-사이에-존재하는-의존성을-이해합시다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8F%99%EA%B8%B0%ED%99%94%ED%95%98%EB%8A%94-%EB%A9%94%EC%86%8C%EB%93%9C-%EC%82%AC%EC%9D%B4%EC%97%90-%EC%A1%B4%EC%9E%AC%ED%95%98%EB%8A%94-%EC%9D%98%EC%A1%B4%EC%84%B1%EC%9D%84-%EC%9D%B4%ED%95%B4%ED%95%A9%EC%8B%9C%EB%8B%A4&quot; aria-label=&quot;동기화하는 메소드 사이에 존재하는 의존성을 이해합시다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;동기화하는 메소드 사이에 존재하는 의존성을 이해합시다&lt;/h2&gt;
&lt;p&gt;동기화하는 메소드 사이에 의존성이 존재하면 동시성 코드에 찾기 힘든 버그가 생깁니다. 자바는 개별 메소드를 보호하는 &lt;code class=&quot;language-text&quot;&gt;synchronized&lt;/code&gt; 라는 개념이 있습니다. 하지만 공유 클래스 하나에 동기화된 메소드가 여럿이라면 구현이 올바른지 체크해야 합니다. 이는 &lt;a href=&quot;&quot;&gt;부록 A 동시성 II의 “메소드 사이에서 존재하는 의존성을 조심하라”&lt;/a&gt; 를 참조해주십시오.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;권장사항&lt;/strong&gt;: 공유 객체 하나에는 메소드 하나만 사용합시다.&lt;/p&gt;
&lt;p&gt;공유 객체 하나에 여러 메소드가 필요한 상황도 생깁니다. 그럴 떄는 아래 세가지 방법을 고려합시다&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;클라이언트에서 잠금
&lt;ul&gt;
&lt;li&gt;클라이언트에서 첫 번째 메소드를 호출하기 전 서버를 잠급니다.&lt;/li&gt;
&lt;li&gt;마지막 메소드를 호출할 때 까지 잠금을 유지합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;서버에서 잠금
&lt;ul&gt;
&lt;li&gt;서버에 아래 메소드를 구현합니다:&lt;/li&gt;
&lt;li&gt;서버를 잠그고 모든 메소드를 호출한 후 잠금을 해제한다&lt;/li&gt;
&lt;li&gt;클라이언트는 상기 메소드를 호출합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;연결서버(Adapted Server)
&lt;ul&gt;
&lt;li&gt;잠금을 수행하는 중간단계를 생성합니다.&lt;/li&gt;
&lt;li&gt;서버에서 잠금 방식과 유사하지만, 원래 서버를 변경하지 않습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;동기화하는-부분을-작게-만드십시오&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8F%99%EA%B8%B0%ED%99%94%ED%95%98%EB%8A%94-%EB%B6%80%EB%B6%84%EC%9D%84-%EC%9E%91%EA%B2%8C-%EB%A7%8C%EB%93%9C%EC%8B%AD%EC%8B%9C%EC%98%A4&quot; aria-label=&quot;동기화하는 부분을 작게 만드십시오 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;동기화하는 부분을 작게 만드십시오&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;synchronized&lt;/code&gt; 를 사용하여 락을 설정한 모든 코드 영역은 한 번에 한 스레드만 실행이 가능합니다. 락은 스레드를 지연시키고 부하를 가중하기 때문에 필요한 critical section만을 감싸야 합니다.&lt;/p&gt;
&lt;h2 id=&quot;올바른-종료코드는-구현하기-어렵습니다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%98%AC%EB%B0%94%EB%A5%B8-%EC%A2%85%EB%A3%8C%EC%BD%94%EB%93%9C%EB%8A%94-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0-%EC%96%B4%EB%A0%B5%EC%8A%B5%EB%8B%88%EB%8B%A4&quot; aria-label=&quot;올바른 종료코드는 구현하기 어렵습니다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;올바른 종료코드는 구현하기 어렵습니다&lt;/h2&gt;
&lt;p&gt;깔끔하게 종료하는 코드를 잘 짜기는 어렵습니다. 아래 두 케이스로 살펴봅시다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;부모 스레드가 자식 스레드를 여럿 만들고 모두 끝나는 시그널을 대기한다고 가정합시다. 자식 스레드 하나가 데드락에 걸리면, 부모도 자식도 모두 영원히 대기하겠지요.&lt;/li&gt;
&lt;li&gt;부모 스레드가 자식 스레드에게 종료하라는 시그널을 전달했다고 가정합시다. 그런데 두 자식 스레드가 서로 생산자/소비자 관계였고 하필이면 생산자가 먼저 죽어서 소비자가 블록되어서 종료 시그널을 못 받는다면 영원히 대기하겠지요.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;그런고로 깔끔하게 종료하는 다중 스레드 코드는 공을들여 올바르게 구현해야 할 것입니다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;권장사항&lt;/strong&gt;: 종료 코드를 개발 초기부터 잘 고민하고 동작하게 초기부터 구현하십시오. 이미 나온 좋은 알고리즘을 검토하여 사용하십시오.&lt;/p&gt;
&lt;h2 id=&quot;스레드-코드-테스트하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%8A%A4%EB%A0%88%EB%93%9C-%EC%BD%94%EB%93%9C-%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EA%B8%B0&quot; aria-label=&quot;스레드 코드 테스트하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;스레드 코드 테스트하기&lt;/h2&gt;
&lt;p&gt;스레드가 하나라면 충분한 테스트로 위험을 낮출 수 있습니다. 하지만 스레드가 두개 이상이면 극도로 복잡해집니다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;권장사항&lt;/strong&gt;: 문제를 노출하는 테스트 케이스를 작성하십시오. 프로그램 설저오가 시스템 설정, 부하를 바꾸어가며 자주 돌리십시오. 테스트가 실패하면 원인을 추적하십시오. ‘다시 돌려보니 잘 돈다’ 라는 이유로 넘어가지 마십시오.&lt;/p&gt;
&lt;p&gt;고려할 사항이 아주 많으므로 아래 구체적 지침을 살펴봅시다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;#%EC%A7%80%EC%B9%A8-1&quot;&gt;말이 안 되는 실패는 잠정적인 스레드 문제로 취급하십시오&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%EC%A7%80%EC%B9%A8-2&quot;&gt;다중 스레드를 고려하지 않은 순차 코드부터 제대로 돌게 만드십시오&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%EC%A7%80%EC%B9%A8-3&quot;&gt;다중 스레드를 쓰는 코드 부분을 다양한 환경에 쉽게 끼워 넣을 수 있도록 스레드 코드를 구현하십시오&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%EC%A7%80%EC%B9%A8-4&quot;&gt;다중 스레드를 쓰는 코드 부분을 상황에 맞춰 조정할 수 있게 작성하십시오&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%EC%A7%80%EC%B9%A8-5&quot;&gt;프로세서(Processor) 수보다 많은 스레드를 돌려보십시오&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%EC%A7%80%EC%B9%A8-6&quot;&gt;다른 플랫폼에서 돌려보십시오&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%EC%A7%80%EC%B9%A8-7&quot;&gt;코드에 보조 코드(instrument)를 넣어 돌리십시오. 강제로 실패를 일으키게 해보십시오&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;지침-1&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A7%80%EC%B9%A8-1&quot; aria-label=&quot;지침 1 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;지침 1&lt;/h3&gt;
&lt;p&gt;다중 스레드 코드는 진짜 말도 안 되는 오류를 일으킵니다.&lt;/p&gt;
&lt;p&gt;이런 일회성 문제를 꼭 캐치해두고, 잠정적인 스레드 문제로 취급하십시오. 이런 문제는 &lt;em&gt;필연적&lt;/em&gt; 일테니까요.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://media.tenor.com/QRTVgLglL6AAAAAd/thanos-avengers.gif&quot; alt=&quot;I am... inevitable.&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;권장사항&lt;/strong&gt;: 시스템 실패를 ‘일회성’으로 치부하지 마십시오.&lt;/p&gt;
&lt;h3 id=&quot;지침-2&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A7%80%EC%B9%A8-2&quot; aria-label=&quot;지침 2 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;지침 2&lt;/h3&gt;
&lt;p&gt;스레드 환경 밖에서부터 코드가 제대로 도는지 반드시 확인합시다. 문제가 아닌 것을 하나씩 없애는 것으로도 충분히 도움됩니다. 스레드가 호출하는 POJO 단위부터 테스트 코드로 검증합시다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;권장사항&lt;/strong&gt;: 스레드 환경 밖의 버그와 스레드 환경 안의 버그를 동시에 디버깅하지 마십시오. 먼저 스레드 환경 밖에서 코드를 올바르게 테스트 하십시오.&lt;/p&gt;
&lt;h3 id=&quot;지침-3&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A7%80%EC%B9%A8-3&quot; aria-label=&quot;지침 3 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;지침 3&lt;/h3&gt;
&lt;p&gt;다중 스레드를 쓰는 코드를 다양한 설정으로 실행하기 쉽게 구현하십시오.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;한 스레드로 실행하거나, 여러 스레드로 실행하거나, 실행 중 스레드 수를 바꿔봅니다.&lt;/li&gt;
&lt;li&gt;스레드 코드를 실제 환경이나 테스트 환경에서 돌려봅니다.&lt;/li&gt;
&lt;li&gt;테스트 코드를 빨리, 천천히, 다양한 속도로 돌려봅니다.&lt;/li&gt;
&lt;li&gt;반복 테스트가 가능하도록 테스트 케이스를 작성합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;권장사항&lt;/strong&gt;: 다양한 설정에서 실행할 목적으로 다른 환경에 쉽게 끼워넣을 수 있게 코드를 구현하십시오.&lt;/p&gt;
&lt;h3 id=&quot;지침-4&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A7%80%EC%B9%A8-4&quot; aria-label=&quot;지침 4 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;지침 4&lt;/h3&gt;
&lt;p&gt;적절한 스레드 갯수는 서비스 별로 모두 다릅니다. 그러므로 그 스레드 갯수를 조율하기 쉽게 코드를 작성하십시오. 프로그램이 도는 도중에 스레드 개수를 변경하는 방법도 고려해보십시오. 더 나아가 프로그램의 처리율/효율에 따라 스스로 스레드 개수를 조율하는 코드가 되면 이상적일 것입니다.&lt;/p&gt;
&lt;h3 id=&quot;지침-5&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A7%80%EC%B9%A8-5&quot; aria-label=&quot;지침 5 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;지침 5&lt;/h3&gt;
&lt;p&gt;시스템이 스레드를 swapping할 때도 문제가 일어날 수 있습니다. swapping을 일으키면 프로세서(processor) 수 보다 많은 스레드를 돌립니다. swapping이 잦을 수록 critical section을 빼먹은 코드나 데드락을 일으키는 코드를 찾기 쉬워집니다.&lt;/p&gt;
&lt;h3 id=&quot;지침-6&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A7%80%EC%B9%A8-6&quot; aria-label=&quot;지침 6 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;지침 6&lt;/h3&gt;
&lt;p&gt;다중 스레드 코드는 플랫폼에 따라 다르게 구현될 수 있습니다. 코드가 돌아갈 가능성이 있는 플랫폼 모두에서 테스트를 수행하는 것이 바람직합니다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;권장사항&lt;/strong&gt;: 처음부터 그리고 자주 모든 목표 플랫폼에서 코드를 구동하십시오.&lt;/p&gt;
&lt;h3 id=&quot;지침-7&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A7%80%EC%B9%A8-7&quot; aria-label=&quot;지침 7 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;지침 7&lt;/h3&gt;
&lt;p&gt;스레드 코드는 진짜 어쩌다가 한 번 문제를 일으킵니다. 간단한 테스트로는 나오지도 않습니다. 이런 코드는 수많은 경로 중 아주 소수만 실패하기 때문입니다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://media.tenor.com/bh9qpfX5b8cAAAAd/movie-what-will-happen.gif&quot; alt=&quot;내가 말 해주면 실현이 안 돼.&quot;&gt;&lt;/p&gt;
&lt;p&gt;이런 드문 오류를 자주 일으키려면, 코드 실행순서를 바꿔봅시다. 자바라면 &lt;code class=&quot;language-text&quot;&gt;Object.wait()&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;Object.yield()&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;Object.priority()&lt;/code&gt; 등을 추가하여 코드를 다양한 순서로 실행해봅시다.&lt;/p&gt;
&lt;p&gt;(자바기준?) 각 메소드는 스레드가 실행되는 순서에 영향을 미칩니다. 따라서 버그가 드러날 가능성도 높아집니다. 자바라면, &lt;a href=&quot;https://www.baeldung.com/java-testing-multithreaded&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이런 게시글&lt;/a&gt; 의 라이브러리들을 참고하시는 것도 하나의 방법일 겁니다.&lt;/p&gt;
&lt;h2 id=&quot;정리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A0%95%EB%A6%AC&quot; aria-label=&quot;정리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;정리&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;다중 스레드 코드는 짜기 힘듭니다! 진짜 왜 일어나는지 모르는 버그가 생길 수 있습니다.&lt;/li&gt;
&lt;li&gt;SRP를 준수해서 짭시다. 이 때 스레드를 아는 코드와 스레드를 몰라도 되는 코드를 분리해서, 최대한 작게 만듭시다.&lt;/li&gt;
&lt;li&gt;잠정적인 원인을 파악합시다. 동시성 오류나 경계 조건으로 인한 문제는 특히나 잡기 어려우니 주의합시다.&lt;/li&gt;
&lt;li&gt;무심코 쓰는 라이브러리와 동시성 처리를 위한 기본 알고리즘을 이해합시다.&lt;/li&gt;
&lt;li&gt;락은 필요한 부분에 작게 답시다. 필요하다면 객체 설계를 바꿀 필요가 있습니다.&lt;/li&gt;
&lt;li&gt;사소한 문제다 싶은 것들도 반드시 기억해두고 테스트해봅시다.&lt;/li&gt;
&lt;li&gt;보조 코드를 만들고 스레드 순서 까지 &lt;em&gt;흔들어서&lt;/em&gt; 테스트를 최대한 많이 해보도록 고민해봅시다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;아래 링크를 통해 추가내용을 살펴보시기를 권장드립니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/404&quot;&gt;부록 A 동시성 II&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/404&quot;&gt;파이썬에서의 동시성 프로그래밍에 대하여(연재글)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;&lt;a href=&quot;https://www.amazon.com/Concurrent-Programming-Java%C2%99-Principles-Pattern/dp/0201310090&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;자바 병행 프로그래밍 디자인 원리와 패턴&lt;/a&gt;의 저자입니다.  &lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-2&quot;&gt;문득 &lt;code class=&quot;language-text&quot;&gt;asyncio&lt;/code&gt; 의 이벤트 루프가 생각나서 이런 것도 검색해봤습니다. &lt;a href=&quot;https://velog.io/@jihoson94/EventLoopModelInSpring&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 링크&lt;/a&gt;를 읽어보십시오.  &lt;a href=&quot;#fnref-2&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-3&quot;&gt;&lt;a href=&quot;/404&quot;&gt;이 부분&lt;/a&gt;을 살펴보십시오. 요약하자면, (당시 자바 기준) &lt;em&gt;숫자를 더하고 리턴하는 코드&lt;/em&gt; 자체는 바이트코드 8개를 씁니다. 이 때 여러 스레드가 이 명령을 뒤섞어서 실행하기만 해도 분기가 정말 많아집니다.  &lt;a href=&quot;#fnref-3&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-4&quot;&gt;아래 링크들이 도움 되었습니다. &lt;br /&gt;&lt;a href=&quot;https://tourspace.tistory.com/54&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Java의 동기화 Synchronized 개념 정리#1&lt;/a&gt;&lt;br /&gt;&lt;a href=&quot;https://tourspace.tistory.com/55&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Java의 동기화 Synchronized 개념 정리#2&lt;/a&gt;  &lt;a href=&quot;#fnref-4&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-5&quot;&gt;&lt;a href=&quot;https://stackoverflow.com/a/8863671&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 링크&lt;/a&gt; 의 내용이 도움 되었습니다.  &lt;a href=&quot;#fnref-5&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-6&quot;&gt;Tanenbaum의 Modern Operating Systems, Chapter 2 관련 장표가 상당히 도움되었습니다. &lt;a href=&quot;http://www.ece.sunysb.edu/~yang/333slides-2010/MOS-3e-02-2010.pdf&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;참고링크&lt;/a&gt;  &lt;a href=&quot;#fnref-6&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[클린 코드 스터디 (12): 창발성(Emergence)]]></title><description><![CDATA[2023년 1월부터 시작한 클린 코드 독파 스터디 후, 매 모임 전 준비하는 게시글을 공유합니다. 이 글은 12장, 창발성(Emergence)에 대해 알아봅니다.]]></description><link>https://blog.s3ich4n.me/books/clean-code/2023-02-24-pt01</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/clean-code/2023-02-24-pt01</guid><pubDate>Fri, 24 Feb 2023 22:51:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;12-창발성emergence&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#12-%EC%B0%BD%EB%B0%9C%EC%84%B1emergence&quot; aria-label=&quot;12 창발성emergence permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;12. 창발성(Emergence)&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;emergence&lt;/strong&gt; [ ih-&lt;strong&gt;mur&lt;/strong&gt;-ju&lt;em&gt;h&lt;/em&gt;ns ]&lt;/p&gt;
&lt;p&gt;noun.&lt;/p&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;&lt;em&gt;Evolution.&lt;/em&gt; the appearance of new properties or species in the course of development or evolution.&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;p&gt;그렇다면, 코드를 어떻게 꽃피울지에 대한 접근방법을 알아봅시다. 어떻게 첫 발을 내딛어야 할까요?&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/3d9505f0b4060dbd2ce2964a777c7bce/aa991/001.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 98.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAIEAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHxKvqY24RISD//xAAZEAACAwEAAAAAAAAAAAAAAAABAgAQEkL/2gAIAQEAAQUCVdQIStcwX//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABwQAAEDBQAAAAAAAAAAAAAAACAAAQIRMUFRkf/aAAgBAQAGPwK9E8tBnof/xAAdEAADAAICAwAAAAAAAAAAAAAAAREhMUFRYXGR/9oACAEBAAE/IaJHsYBTHPJH0xeH8FsnXY9kXQLEXkie0f/aAAwDAQACAAMAAAAQl8c+/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPxAf/8QAFhEAAwAAAAAAAAAAAAAAAAAAABAR/9oACAECAQE/ECv/xAAfEAEBAAMAAAcAAAAAAAAAAAABEQAhMUFRYXGh0fH/2gAIAQEAAT8QZYAW84NEMIUU3h48z8zL1SezHtgcNYj35cBJT1v7w4BrWKCGPcoUFevnn//Z&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/3d9505f0b4060dbd2ce2964a777c7bce/8ac56/001.webp 240w,
/static/3d9505f0b4060dbd2ce2964a777c7bce/d3be9/001.webp 480w,
/static/3d9505f0b4060dbd2ce2964a777c7bce/e46b2/001.webp 960w,
/static/3d9505f0b4060dbd2ce2964a777c7bce/f992d/001.webp 1440w,
/static/3d9505f0b4060dbd2ce2964a777c7bce/62ac3/001.webp 1850w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/3d9505f0b4060dbd2ce2964a777c7bce/09b79/001.jpg 240w,
/static/3d9505f0b4060dbd2ce2964a777c7bce/7cc5e/001.jpg 480w,
/static/3d9505f0b4060dbd2ce2964a777c7bce/6a068/001.jpg 960w,
/static/3d9505f0b4060dbd2ce2964a777c7bce/644c5/001.jpg 1440w,
/static/3d9505f0b4060dbd2ce2964a777c7bce/aa991/001.jpg 1850w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/jpeg&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/3d9505f0b4060dbd2ce2964a777c7bce/6a068/001.jpg&quot;
            alt=&quot;&amp;quot;That&amp;#39;s one small step for man, one giant leap for mankind.&amp;quot;&quot;
            title=&quot;&amp;quot;That&amp;#39;s one small step for man, one giant leap for mankind.&amp;quot;&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;“That’s one small step for man, one giant leap for mankind.”&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;창발적-설계로-깔끔한-코드를-구현합시다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%B0%BD%EB%B0%9C%EC%A0%81-%EC%84%A4%EA%B3%84%EB%A1%9C-%EA%B9%94%EB%81%94%ED%95%9C-%EC%BD%94%EB%93%9C%EB%A5%BC-%EA%B5%AC%ED%98%84%ED%95%A9%EC%8B%9C%EB%8B%A4&quot; aria-label=&quot;창발적 설계로 깔끔한 코드를 구현합시다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;창발적 설계로 깔끔한 코드를 구현합시다&lt;/h2&gt;
&lt;p&gt;밥 아저씨와 켄트 백 등의 고수들은 아래 설계 규칙 4가지가 소프트웨어 설계 품질을 높여준다고 합니다.&lt;/p&gt;
&lt;p&gt;특히 켄트 백은 아래 규칙을 따르면 설계는 ‘단순하다’ 라고 말합니다. 이 순서는 중요도 순입니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;제 1규칙
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;#%ED%85%8C%EC%8A%A4%ED%8A%B8_%EC%BD%94%EB%93%9C&quot;&gt;단순한 설계 규칙 1: 모든 테스트 코드를 실행하십시오&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%EB%A6%AC%ED%8C%A9%ED%86%A0%EB%A7%81&quot;&gt;단순한 설계 규칙 2~4: 리팩토링&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%EC%A4%91%EB%B3%B5_%EC%A0%9C%EA%B1%B0&quot;&gt;중복 제거&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%ED%91%9C%ED%98%84%ED%95%98%EA%B8%B0&quot;&gt;프로그래머의 의도를 표현&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%ED%81%B4%EB%9E%98%EC%8A%A4_%EB%B0%8F_%EB%A9%94%EC%86%8C%EB%93%9C%EC%9D%98_%EC%88%98%EB%A5%BC_%EC%B5%9C%EC%86%8C%ED%99%94&quot;&gt;클래스 및 메소드의 수를 최소화&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;테스트-코드&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%BD%94%EB%93%9C&quot; aria-label=&quot;테스트 코드 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;테스트 코드&lt;/h2&gt;
&lt;p&gt;최우선으로, 설계의도 대로 돌아가는 시스템을 내놓아야 합니다. 아무리 좋은 시스템을 문서로 설계한다 하더라도 돌아가는 최소한의 결과물이 없다면 노력에 대한 가치를 인정받기 힘듭니다.&lt;/p&gt;
&lt;p&gt;테스트를 거쳐 모든 테스트 케이스를 항상 통과하는 시스템은 ‘테스트가 가능한 시스템’ 입니다. 테스트가 불가능하다면 검증도 불가능합니다.&lt;/p&gt;
&lt;p&gt;테스트가 가능한 시스템을 만들려하면 설계품질 또한 높아집니다. 크기가 작고 단독 목적만을 수행하는 클래스가 나옵니다. SRP를 준수하는 클래스는 테스트하기 더욱 쉽습니다. 테스트 케이스가 많을 수록 더욱 쉽게 코드를 작성합니다. 이런 이유로 철저한 테스트가 가능한 시스템은 더 나은 설계의 초석이 됩니다.&lt;/p&gt;
&lt;p&gt;결합도가 높으면 테스트 케이스를 작성하기 어렵습니다. 테스트 케이스를 많이 작성할 수록 DIP같은 원칙을 적용하고 DI, 인터페이스, 추상화 등의 도구를 통해 결합도를 낮춥니다. 이 것이 설계 품질을 올리는 길입니다.&lt;/p&gt;
&lt;p&gt;테스트 케이스를 만들고 계속 돌리면, 낮은 결합도와 높은 응집도를 달성합니다. 따라서 &lt;strong&gt;테스트 케이스 작성은 설계 품질을 올리는 길&lt;/strong&gt; 입니다.&lt;/p&gt;
&lt;h2 id=&quot;리팩토링&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A6%AC%ED%8C%A9%ED%86%A0%EB%A7%81&quot; aria-label=&quot;리팩토링 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;리팩토링&lt;/h2&gt;
&lt;p&gt;테스트코드가 있다면 코드와 클래스를 정리해도 됩니다. 점진적으로 코드를 좋게 만들어보고 다시 정리합니다. 테스트를 계속 돌리면서 기존 기능이 깨지지 않았는지 점검합니다. &lt;strong&gt;시스템이 깨질까 걱정하지 마십시오. 테스트코드가 있습니다.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;리팩토링에서는 설게 품질을 높이는 기법을 적용합니다. SOLID 원칙을 적용하고, 1장부터 11장까지 논의했던 사항을 모조리 적용합니다. 이 단계에서 중복을 제거하고, 프로그래머의 의도를 표현하고, 클래스나 메소드의 수를 최소한으로 줄이면 됩니다.&lt;/p&gt;
&lt;h2 id=&quot;중복-제거&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A4%91%EB%B3%B5-%EC%A0%9C%EA%B1%B0&quot; aria-label=&quot;중복 제거 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;중복 제거&lt;/h2&gt;
&lt;p&gt;중복은 추가작업, 추가위험, 불필요한 복잡도의 원인입니다. 공통 코드를 새로운 메소드로 뽑아서 다른 클래스로 빼는 방법이나, &lt;a href=&quot;https://refactoring.guru/design-patterns/template-method&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;TEMPLATE METHOD 패턴&lt;/a&gt;을 사용하는 것이 방법입니다.&lt;/p&gt;
&lt;h2 id=&quot;표현하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%91%9C%ED%98%84%ED%95%98%EA%B8%B0&quot; aria-label=&quot;표현하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;표현하기&lt;/h2&gt;
&lt;p&gt;일필휘지(一筆揮之)는 어렵습니다. 코드 작성 또한 하나의 글쓰기입니다. 그렇기 때문에 몇번이고 탈고를 거쳐야 좋은 코드가 완성됩니다.&lt;/p&gt;
&lt;p&gt;좋은 코드를 작성하는 것은 나의 의도를 상대방이 읽을 수 있게 고치는 것을 의미합니다. 이런 코드는 결함을 일으킬 확률이 낮고 유지보수 비용이 적게 듭니다. 그렇다면 어떤 방안이 있는지 살펴봅시다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;좋은 이름을 선택합시다. 이름과 기능이 딴판인 클래스나 메소드를 작성하지 맙시다.&lt;/li&gt;
&lt;li&gt;함수와 클래스의 크기를 가능한 줄입시다. 작은 코드는 읽기 쉽습니다&lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;.&lt;/li&gt;
&lt;li&gt;표준 명칭을 사용합시다. 디자인 패턴을 사용했다면 클래스 이름에 패턴명을 넣어줍시다(E.g., &lt;code class=&quot;language-text&quot;&gt;VISITOR&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;COMMAND&lt;/code&gt;, etc.). 그러면 상대방이 훨씬 빠르게 이해할 수 있습니다.&lt;/li&gt;
&lt;li&gt;테스트 케이스를 꼼꼼하게 작성합시다. 남들이 나의 코드를 읽을 때 사용하는 ‘예시’입니다. 잘 만든 테스트 케이스로 클래스의 기능을 표현할 수 있습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;위의 4가지 방안을 지키기 위해 노력하는 것이 필요합니다. 동료와 나를 위한 길이니까요.&lt;/p&gt;
&lt;h2 id=&quot;클래스-및-메소드의-수를-최소화&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%81%B4%EB%9E%98%EC%8A%A4-%EB%B0%8F-%EB%A9%94%EC%86%8C%EB%93%9C%EC%9D%98-%EC%88%98%EB%A5%BC-%EC%B5%9C%EC%86%8C%ED%99%94&quot; aria-label=&quot;클래스 및 메소드의 수를 최소화 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;클래스 및 메소드의 수를 최소화&lt;/h2&gt;
&lt;p&gt;상기 개념을 극단으로 사용하면 득보다 실이 많아집니다. 분명 좋은 개념이지만 도그마로 인식하면 안 됩니다. 실용적인 방식을 택하는 것이 유연하기 때문입니다.&lt;/p&gt;
&lt;p&gt;무의미하고 독단적인 정책을 서로에게 강요하지 말고 논리로 설득합시다. 또한 우선순위가 더 높은 사항을 먼저 준수합시다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://media4.giphy.com/media/O0AEyXviC1vtC/giphy.gif&quot; alt=&quot;테스트&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;결론&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B2%B0%EB%A1%A0&quot; aria-label=&quot;결론 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;결론&lt;/h2&gt;
&lt;p&gt;선대 프로그래머들이 남긴 경험의 정수를 꼭 흡수하여 이런 원칙을 단번에 활용할 수 있기를 바랍니다. 저 또한 그러고 싶습니다…&lt;/p&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;더 나아가, 코드리뷰를 쉽게 하기 위해서 최소한의 구현을 빠르게 하고 리뷰받읍시다. &lt;a href=&quot;https://smartbear.com/learn/code-review/best-practices-for-peer-code-review/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;긴 코드는 리뷰를 설렁설렁 하게 됩니다.&lt;/a&gt; &lt;br /&gt;아울러 &lt;a href=&quot;https://hugooodias.medium.com/the-anatomy-of-a-perfect-pull-request-567382bb6067&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;PR에 대한 이야기&lt;/a&gt;도 살펴보십시오.  &lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[2023년 과제형 코딩 테스트 후기 (2)]]></title><description><![CDATA[2월에 수행한 과제형 코딩 테스트에 대해 리뷰하는 글입니다. 이 글에서는 무엇이 모자랐고, 어떤 것을 집중해야할지 배운 내용에 대해 작성하였습니다.]]></description><link>https://blog.s3ich4n.me/retrospect/2023-02-20-assignment-pt02</link><guid isPermaLink="false">https://blog.s3ich4n.me/retrospect/2023-02-20-assignment-pt02</guid><pubDate>Mon, 20 Feb 2023 18:01:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;연재-안내&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%97%B0%EC%9E%AC-%EC%95%88%EB%82%B4&quot; aria-label=&quot;연재 안내 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;연재 안내&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/retrospect/2023-02-20-assignment-pt01&quot;&gt;2023년 과제형 코딩 테스트 후기 (1)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;2023년 과제형 코딩 테스트 후기 (2)&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;들어가며&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0&quot; aria-label=&quot;들어가며 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;들어가며&lt;/h1&gt;
&lt;p&gt;이 게시글은 최근 치렀던 코딩 테스트를 회고하는 게시글입니다.&lt;/p&gt;
&lt;p&gt;이 게시글에선 무엇으로 인해 코딩 테스트에서 탈락이라는 고배를 마셨는지, 그 원인을 스스로 반추해보는 내용이 주가 될 것입니다.&lt;/p&gt;
&lt;h1 id=&quot;목차&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AA%A9%EC%B0%A8&quot; aria-label=&quot;목차 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;목차&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#%EC%99%9C-%EB%96%A8%EC%96%B4%EC%A1%8C%EC%9D%84%EA%B9%8C&quot;&gt;왜 떨어졌을까?&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#%EC%99%84%EC%84%B1%EB%90%9C-%EC%86%8C%ED%94%84%ED%8A%B8%EC%9B%A8%EC%96%B4%EA%B0%80-%EA%B8%B0%EB%B3%B8%EC%9D%B4%EB%8B%A4&quot;&gt;완성된 소프트웨어가 기본이다&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98-%ED%95%99%EC%8A%B5-%EB%B6%80%EC%A1%B1&quot;&gt;아키텍처 학습 부족&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%ED%8C%8C%EC%9D%B4%EC%8D%AC-deep-dive-%EC%A7%84%EC%A7%9C-%ED%95%98%EA%B3%A0%EC%9E%88%EB%82%98&quot;&gt;파이썬 deep-dive, 진짜 하고있나?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%EC%97%90-%EB%8C%80%ED%95%9C-deep-dive%EA%B0%80-%EB%AA%A8%EC%9E%90%EB%9D%BC%EC%A7%80-%EC%95%8A%EC%95%98%EB%82%98&quot;&gt;사용하는 라이브러리에 대한 deep-dive가 모자라지 않았나?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%ED%8F%89%EC%86%8C-%EC%A4%91%EC%8B%9C%ED%95%98%EB%8A%94-%EB%8F%99%EB%A3%8C%EC%97%90-%EB%8C%80%ED%95%9C-%EB%B0%B0%EB%A0%A4%EB%A5%BC-%ED%95%B4%EB%91%90%EC%97%88%EB%82%98&quot;&gt;평소 중시하는 ‘동료에 대한 배려’를 해두었나?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%EB%A7%88%EB%AC%B4%EB%A6%AC&quot;&gt;마무리&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;왜-떨어졌을까&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%99%9C-%EB%96%A8%EC%96%B4%EC%A1%8C%EC%9D%84%EA%B9%8C&quot; aria-label=&quot;왜 떨어졌을까 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;왜 떨어졌을까?&lt;/h1&gt;
&lt;p&gt;완성하지 못한 소프트웨어에, 외부 공부의 모자람, 그리고 막상 파이썬을 사랑한다고는 하지만 정말 그렇지 않음이 복합적으로 적용된 것이라고 복기할 수 있겠습니다.&lt;/p&gt;
&lt;h2 id=&quot;완성된-소프트웨어가-기본이다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%99%84%EC%84%B1%EB%90%9C-%EC%86%8C%ED%94%84%ED%8A%B8%EC%9B%A8%EC%96%B4%EA%B0%80-%EA%B8%B0%EB%B3%B8%EC%9D%B4%EB%8B%A4&quot; aria-label=&quot;완성된 소프트웨어가 기본이다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;완성된 소프트웨어가 기본이다&lt;/h2&gt;
&lt;p&gt;앞서 말했듯 많은 것을 배웠으나, 가장 중요한 결과 달성에 실패했습니다. 이것이 가장 큰 원인이지 않았을까 합니다.&lt;/p&gt;
&lt;p&gt;완성되지 않은 소프트웨어는 내부적으로 아무리 깔끔하고 좋다고 한들 아무런 가치를 창출하지 않습니다. 과제의 본 목적을 벗어나 기술을 탐미하는 것은 엔지니어로서의 자세라고 할 수 없습니다. 신기술이어서, 뜻대로 돌아가는게 신기해서, 뭔가 블록맞추기가 완성되는 즐거움에 취해서 본질을 생각하지 않는 것은 경계해야 할 자세입니다.&lt;/p&gt;
&lt;h2 id=&quot;아키텍처-학습-부족&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98-%ED%95%99%EC%8A%B5-%EB%B6%80%EC%A1%B1&quot; aria-label=&quot;아키텍처 학습 부족 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;아키텍처 학습 부족&lt;/h2&gt;
&lt;p&gt;DDD나 클린 아키텍처, 헥사고널 아키텍처를 단기간에 올바른 방안으로 쓰기는 쉽지 않습니다. 이견없는 주제를 향해 많은 사람이 머리를 맞대는 현업과 달리, 이 자리는 제 역량을 점검받는 자리였기 때문입니다. 따라서 평소에 얼마나 이런 설계 방법이나 외부 사항들을 학습했는지, 토이프로젝트를 수행해본 적은 있는지를 평가받는 자리입니다. 매력적인 지원자가 되고 싶었다면 평소에 미리미리 했어야 했습니다.&lt;/p&gt;
&lt;p&gt;‘망치를 들면 모든 것이 못으로 보인다’라는 격언이 있습니다. (발언의 의도와 다르게) 여러 망치를 가진 기술자는 선택의 폭이 그만큼 넓어지죠. 어느 도메인에 속하더라도 사용할 수 있는 여러가지 접근 방법을 학습해야 하지 않을까요? 이 점을 사무치게 반성했습니다.&lt;/p&gt;
&lt;h2 id=&quot;파이썬-deep-dive-진짜-하고있나&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%8C%8C%EC%9D%B4%EC%8D%AC-deep-dive-%EC%A7%84%EC%A7%9C-%ED%95%98%EA%B3%A0%EC%9E%88%EB%82%98&quot; aria-label=&quot;파이썬 deep dive 진짜 하고있나 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;파이썬 deep-dive, 진짜 하고있나?&lt;/h2&gt;
&lt;p&gt;주력 언어를 파이썬으로 두고, 이를 잘 쓰고자 하는 노력이 부족했지 않았나 하는 생각을 하게 되었습니다. 아래에서 설명하겠습니다.&lt;/p&gt;
&lt;h3 id=&quot;random-라이브러리는-seed-기반임을-알고있었나&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#random-%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%EB%8A%94-seed-%EA%B8%B0%EB%B0%98%EC%9E%84%EC%9D%84-%EC%95%8C%EA%B3%A0%EC%9E%88%EC%97%88%EB%82%98&quot; aria-label=&quot;random 라이브러리는 seed 기반임을 알고있었나 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;random&lt;/code&gt; 라이브러리는 seed 기반임을 알고있었나?&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/python/cpython/blob/main/Lib/random.py&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;random&lt;/code&gt;이란 파이썬 기본 라이브러리&lt;/a&gt;는 객체 생성 시의 &lt;code class=&quot;language-text&quot;&gt;seed&lt;/code&gt; 값을 기반으로 연산을 하는 유사-난수 생성로직 입니다. &lt;code class=&quot;language-text&quot;&gt;random&lt;/code&gt; 라이브러리의 시드는 기본값으로 현재 시각을 시드로 사용하고, 랜덤난수가 주어진다면 이를 사용합니다(&lt;a href=&quot;https://docs.python.org/3/library/random.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;관련 설명&lt;/a&gt;). 특정 시드를 누군가가 &lt;em&gt;예측한다&lt;/em&gt; 면, 어떤 값이 리턴됨을 “예측”할 수 있을 것입니다. 설령 MT19937 로 난수를 훌륭하게 예측했다 하더라도요. 또한 현재 제가 사용한 로직은 &lt;a href=&quot;https://mhibio.tistory.com/62&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 CTF 문제의 write-up&lt;/a&gt;을 보아도 충분히 깨질 수 있는 가능성이 열려있음을 알 수 있습니다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;참고) &lt;code class=&quot;language-text&quot;&gt;random&lt;/code&gt;은 cryptographically secure 하지 않습니다. &lt;br &gt;그러한 목적이라면 &lt;code class=&quot;language-text&quot;&gt;secure&lt;/code&gt; 같은 라이브러리를 사용하기를 권장합니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;논외로, 매 호출 시 새로운 시드값을 계속 생성하여 사용하는 것도 좋은 방법은 아닌 듯 합니다. 뾰족한 대안이 생각나지 않고 빠르게 구현해야 했다면, 차라리 이런 최소한의 조치라도 했다면 어땠을까 합니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;로직 설계
&lt;ol&gt;
&lt;li&gt;확신이 서지 않는 로직이므로, 비록 공식 라이브러리라 할지라도 이른바 &lt;a href=&quot;/books/clean-code/2023-02-03-pt08&quot;&gt;“경계” 소프트웨어&lt;/a&gt;로 간주한다.&lt;/li&gt;
&lt;li&gt;얼마든지 교체할 수 있도록 ‘랜덤 값 제공 라이브러리’를 wrapping 하여 객체간의 상호작용으로 사용한다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;로직구현
&lt;ol&gt;
&lt;li&gt;“랜덤”한 시간에 한번씩 시드값을 외부 in-memory service에 기록한다. 시드값은 예측하기 어려운 값을 사용한다(현재시각값에 &lt;code class=&quot;language-text&quot;&gt;salt&lt;/code&gt;를 추가한 해시 등).&lt;/li&gt;
&lt;li&gt;“랜덤”한 값이 필요하다면, in-memory service에서 가지고와서 사용한다.&lt;/li&gt;
&lt;li&gt;“랜덤”한 시간 후 시드값을 새로운 값으로 갱신한다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;사용하는-라이브러리에-대한-deep-dive가-모자라지-않았나&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%EC%97%90-%EB%8C%80%ED%95%9C-deep-dive%EA%B0%80-%EB%AA%A8%EC%9E%90%EB%9D%BC%EC%A7%80-%EC%95%8A%EC%95%98%EB%82%98&quot; aria-label=&quot;사용하는 라이브러리에 대한 deep dive가 모자라지 않았나 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;사용하는 라이브러리에 대한 deep-dive가 모자라지 않았나?&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;pytest&lt;/code&gt;의 미숙함이 너무나 아쉬웠습니다. 테스트의 중요성은 이미 알고있음에도, 정작 필요한 부분을 테스트해보지 못하였습니다. 그리고 &lt;code class=&quot;language-text&quot;&gt;pytest&lt;/code&gt;의 사용법이 미숙하여 적재적소에 이를 활용하지 못했습니다.&lt;/p&gt;
&lt;h3 id=&quot;애플리케이션-테스트는-왜-못했나&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98-%ED%85%8C%EC%8A%A4%ED%8A%B8%EB%8A%94-%EC%99%9C-%EB%AA%BB%ED%96%88%EB%82%98&quot; aria-label=&quot;애플리케이션 테스트는 왜 못했나 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;애플리케이션 테스트는 왜 못했나?&lt;/h3&gt;
&lt;p&gt;서비스 레이어에서, &lt;code class=&quot;language-text&quot;&gt;Mocking&lt;/code&gt; 을 통해 얼마든지 객체를 갈아끼워서 테스트할 수 있음을 꾀했습니다만 이를 많이 다뤄보지 못했기 때문에 시간이 지체되었습니다. 따라서, 로직만을 검증하자는 케이스를 작성할 때도 쓸데없이 시간이 많이 소요되어 결국 틀만 짜고 테스트를 마무리하지 못했습니다.&lt;/p&gt;
&lt;h3 id=&quot;e2e-test는-왜-못했나&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#e2e-test%EB%8A%94-%EC%99%9C-%EB%AA%BB%ED%96%88%EB%82%98&quot; aria-label=&quot;e2e test는 왜 못했나 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;e2e test는 왜 못했나?&lt;/h3&gt;
&lt;p&gt;FastAPI에서 제공하는 &lt;code class=&quot;language-text&quot;&gt;TestClient&lt;/code&gt;는 이벤트 루프 관리를 제대로 못해주는 것으로 파악되었습니다. 따라서 차라리 늦더라도 &lt;code class=&quot;language-text&quot;&gt;httpx&lt;/code&gt; 의 &lt;code class=&quot;language-text&quot;&gt;AsyncClient&lt;/code&gt;를 어떻게든 학습하여 풀어내는 것이 필요했습니다. 또한 테스트코드 구동 시 DB관련 이슈도 &lt;code class=&quot;language-text&quot;&gt;mark.anyio&lt;/code&gt;로 했더니 &lt;code class=&quot;language-text&quot;&gt;trio&lt;/code&gt; 쪽에서 이벤트 루프 문제가 생깁니다. 이 또한 이벤트 루프를 &lt;code class=&quot;language-text&quot;&gt;asyncio&lt;/code&gt; 로 지정해서 풀어냈어야 했습니다. 이런 유스케이스는 일일이 학습하지 않으면 절대 알 수 없는 것들입니다. &lt;a href=&quot;https://fastapi.tiangolo.com/advanced/async-tests/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;공식 문서를 봤음에도&lt;/a&gt; 배우지 못함에 반성합니다.&lt;/p&gt;
&lt;h2 id=&quot;평소-중시하는-동료에-대한-배려를-해두었나&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%8F%89%EC%86%8C-%EC%A4%91%EC%8B%9C%ED%95%98%EB%8A%94-%EB%8F%99%EB%A3%8C%EC%97%90-%EB%8C%80%ED%95%9C-%EB%B0%B0%EB%A0%A4%EB%A5%BC-%ED%95%B4%EB%91%90%EC%97%88%EB%82%98&quot; aria-label=&quot;평소 중시하는 동료에 대한 배려를 해두었나 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;평소 중시하는 ‘동료에 대한 배려’를 해두었나?&lt;/h2&gt;
&lt;p&gt;마지막까지 섬세함을 보일 수 있는 부분 또한 채우지 못해 매우 아쉬웠습니다.&lt;/p&gt;
&lt;h3 id=&quot;api-docs-제공은-왜-하지-못했나&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#api-docs-%EC%A0%9C%EA%B3%B5%EC%9D%80-%EC%99%9C-%ED%95%98%EC%A7%80-%EB%AA%BB%ED%96%88%EB%82%98&quot; aria-label=&quot;api docs 제공은 왜 하지 못했나 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;API Docs 제공은 왜 하지 못했나?&lt;/h3&gt;
&lt;p&gt;FastAPI는 OAS 3.0 표준에 의거한 문서 뿐 아니라 ReDoc과 Swagger 페이지를 함께 제공해줍니다. 이는 FastAPI의 강점 중 하나이지요. 원래라면, 스펙 공유를 위해 OAS 3.0 YAML 파일을 작성하는 수고를 들일 필요가 있습니다. 그렇지만 로직에 코드로 작성하여 이러한 문제를 최소한으로 하는 방안은 외부에 너무나도 쉽게 잘 정리되어 있습니다. &lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt; 그렇지만 다른 부분에 시간을 너무 투자하여 이러한 디테일을 더한 채로 서비스하지 못한 것이 너무 아쉽습니다.&lt;/p&gt;
&lt;h3 id=&quot;진행사항-공유를-위한-문서화-제공은&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A7%84%ED%96%89%EC%82%AC%ED%95%AD-%EA%B3%B5%EC%9C%A0%EB%A5%BC-%EC%9C%84%ED%95%9C-%EB%AC%B8%EC%84%9C%ED%99%94-%EC%A0%9C%EA%B3%B5%EC%9D%80&quot; aria-label=&quot;진행사항 공유를 위한 문서화 제공은 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;진행사항 공유를 위한 문서화 제공은?&lt;/h3&gt;
&lt;p&gt;진행사항 공유는 전체 구성원들에게 정말 중요한 일입니다. 특히나 애자일함을 중시하는 조직이라면 더더욱 그렇지요. DDD에서 말하는 유비쿼터스 언어를 잘 정의한 문서라도 하나 만들었다면, 이를 토대로 의사소통할 수 있는 방안을 제공할 수 있지 않았나 싶습니다. 이런 부분들에 대해 &lt;strong&gt;제 스스로만 ‘알고있고’&lt;/strong&gt; 공유하려는 시그널을 보여주지 못한 것이 아쉽습니다.&lt;/p&gt;
&lt;h1 id=&quot;마무리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%88%EB%AC%B4%EB%A6%AC&quot; aria-label=&quot;마무리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;마무리&lt;/h1&gt;
&lt;p&gt;이번 테스트를 통해 아래 사항을 얻을 수 있었습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;무엇이 모자랐는지 돌아볼 수 있었습니다.
&lt;ol&gt;
&lt;li&gt;완성을 못했습니다. 사실 이것만 해도 할 말이 없습니다.&lt;/li&gt;
&lt;li&gt;기술적으로는 아래 면면들을 돌이켜볼 수 있었습니다.
&lt;ol&gt;
&lt;li&gt;아키텍처에 대해 스스로 공부해야 할 필요가 있겠습니다.&lt;/li&gt;
&lt;li&gt;사용하는 라이브러리나 기술에 대해 스스로 공부해야 할 필요가 있겠습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;함께 일 할 구성원을 배려하지 못한 사항에 대해 돌이켜 볼 수 있었습니다.
&lt;ol&gt;
&lt;li&gt;API 문서화의 부재가 아쉬웠습니다.&lt;/li&gt;
&lt;li&gt;작업사항 공유의 부재가 아쉬웠습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;마지막으로&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%88%EC%A7%80%EB%A7%89%EC%9C%BC%EB%A1%9C&quot; aria-label=&quot;마지막으로 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;마지막으로…&lt;/h1&gt;
&lt;p&gt;토이 프로젝트를 하거나, 현업에서 일을 하거나 할 때 이런 부분들을 보이지는 않는지 반성하고 보다 나은 프로그래머가 되도록 노력해야겠습니다.&lt;/p&gt;
&lt;p&gt;떨어지면 씁쓸하죠. 하지만 과정을 복기해보니 감사할 수 있었습니다. 더 달라져봅시다. 끊임없이 배우고 익혀서 두번 다시 이런 아쉬움을 남기지 않도록 합시다.&lt;/p&gt;
&lt;p&gt;긴 글 읽어주셔서 감사합니다.&lt;/p&gt;
&lt;hr&gt;
&lt;blockquote&gt;
&lt;p&gt;Ignis aurum probat, miseria fortes viros.&lt;/p&gt;
&lt;p&gt;Seneca, &lt;em&gt;De Providentia&lt;/em&gt; &lt;a href=&quot;https://www.perseus.tufts.edu/hopper/text?doc=Perseus%3Atext%3A2007.01.0012%3Abook%3D1%3Achapter%3D5%3Asection%3D10&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;1.5.10.&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;&lt;a href=&quot;https://buzzni.com/blog/47&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이러한 사용례&lt;/a&gt;를 현업에서 사용한 바 있으나, 자주 보지않아 놓치게 되곤 합니다. 앞으로는 이런 사항을 토이프로젝트로 미리 구현해놓아야 하겠습니다.&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[2023년 과제형 코딩 테스트 후기 (1)]]></title><description><![CDATA[2월에 수행한 과제형 코딩 테스트에 대해 리뷰하는 글입니다. 이 글에서는 어떤 사항을 몸으로 익혔고, 무엇을 느꼈는지 주로 작성하였습니다.]]></description><link>https://blog.s3ich4n.me/retrospect/2023-02-20-assignment-pt01</link><guid isPermaLink="false">https://blog.s3ich4n.me/retrospect/2023-02-20-assignment-pt01</guid><pubDate>Mon, 20 Feb 2023 16:38:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;연재-안내&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%97%B0%EC%9E%AC-%EC%95%88%EB%82%B4&quot; aria-label=&quot;연재 안내 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;연재 안내&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;2023년 과제형 코딩 테스트 후기 (1)&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/retrospect/2023-02-20-assignment-pt02&quot;&gt;2023년 과제형 코딩 테스트 후기 (2)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;들어가며&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0&quot; aria-label=&quot;들어가며 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;들어가며&lt;/h1&gt;
&lt;p&gt;이 게시글은 최근 치렀던 코딩 테스트를 회고하는 게시글입니다. 떨어졌지만, 정말 많은 것을 얻었습니다.&lt;/p&gt;
&lt;p&gt;이 게시글에서는 아래 내용을 담습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;그간 궁금했던 모든 지식들이 어떻게 쓰이는지 깨달은 느낌&lt;/li&gt;
&lt;li&gt;공부해온 부분을 다시 되돌아보게 되는 소중한 경험&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;목차&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AA%A9%EC%B0%A8&quot; aria-label=&quot;목차 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;목차&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#%ED%81%B4%EB%A6%B0-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98-hexagonal-architecture&quot;&gt;클린 아키텍처, Hexagonal Architecture&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%EB%8F%84%EB%A9%94%EC%9D%B8-%EA%B5%AC%EC%83%81-%EB%B0%8F-%EA%B5%AC%EC%A1%B0-%EC%8C%93%EC%95%84%EC%98%AC%EB%A6%AC%EA%B8%B0&quot;&gt;도메인 구상 및 구조 쌓아올리기&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#TDD%EC%99%80-%ED%85%8C%EC%8A%A4%ED%8A%B8-%ED%94%BC%EB%9D%BC%EB%AF%B8%EB%93%9C&quot;&gt;TDD와 테스트 피라미드&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%EC%BD%94%EB%93%9C-%EC%99%84%EC%84%B1%EA%B3%BC%EC%A0%95&quot;&gt;코드 완성과정&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%EA%B5%AC%EC%B2%B4%EC%A0%81%EC%9D%B8-%EC%8A%A4%ED%8E%99-%EA%B2%B0%EC%A0%95%EC%9D%84-%ED%86%B5%ED%95%9C-%EC%99%84%EC%84%B1&quot;&gt;구체적인 스펙 결정을 통한 완성&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%EC%84%A4%EA%B3%84-%EB%B0%8F-%EA%B0%9C%EB%B0%9C%EC%97%90-%EC%82%AC%EC%9A%A9%EB%90%9C-%EB%8F%84%EA%B5%AC%EB%93%A4&quot;&gt;설계 및 개발에 사용된 도구들&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;클린-아키텍처-hexagonal-architecture&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%81%B4%EB%A6%B0-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98-hexagonal-architecture&quot; aria-label=&quot;클린 아키텍처 hexagonal architecture permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;클린 아키텍처, Hexagonal Architecture&lt;/h1&gt;
&lt;p&gt;먼저 이 글은 과제형 테스트를 수행한 소개를 위주로 말씀드리고자 합니다(사실 DDD나 클린 아키텍처 등을 하나의 게시글로 요약하기도 힘들겠죠). 보다 상세한 내용은 연재글로 다시 기록하겠습니다. &lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt; &lt;sup id=&quot;fnref-2&quot;&gt;&lt;a href=&quot;#fn-2&quot; class=&quot;footnote-ref&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;p&gt;본 과제를 수행하며 이름으로만 듣던 DDD(Domain-driven Design)를 접하게 되었습니다. DDD는 Eric Evans가 제시한 개념입니다. 소프트웨어 설계를 회사(혹은 단체)와 연관있는 일련의 요구사항(비즈니스)을 표현하기 위한 “도메인”이란 단어로 묶어 설계하는 소프트웨어 설계 기법입니다. 도메인은 “(지식·활동의) 영역[분야], (책임의) 범위” 를 의미하지요. 즉, 개발하고자 하는 일련의 아키텍처를 도메인 간의 상호작용으로 이해하고 풀어나가는 방식입니다. 이를 적용하기 위해 자연스럽게 객체지향 패러다임으로 접근하게 되었습니다.&lt;/p&gt;
&lt;p&gt;저는 과제에 필요한 도메인을 설계하고, 이를 그림으로 묶었습니다. 이후 설계방법에 대한 방향성을 잡고, 클린 아키텍처와 Hexagonal Architecture(aka. Ports and Adapters Architecture, 이하 헥사고널 아키텍처) 를 참고하였습니다. 그 키워드를 토대로 프로젝트를 구성하였습니다. &lt;sup id=&quot;fnref-3&quot;&gt;&lt;a href=&quot;#fn-3&quot; class=&quot;footnote-ref&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aD3zDFzcF5Y2_27dvU213Q.png&quot; alt=&quot;이제야 어렴풋이 이해가 가는 육각형입니다&quot;&gt;&lt;/p&gt;
&lt;p&gt;본 과제를 수행하며 참고한 프로젝트 5개를 소개드리고자 합니다. 모두 파이썬으로 구성되어 있습니다. 추후 DDD 및 클린아키텍처, 나아가 헥사고널 아키텍처를 연재하며 해당 프로젝트를 다시 살펴보도록 하겠습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;프로젝트를 한번에 소화하긴 어렵지만 정말 도움되는 리포지토리
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/pgorecki/python-ddd&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://github.com/pgorecki/python-ddd&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;실질적인 구현에 도움되었던 리포지토리
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/GArmane/python-fastapi-hex-todo&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://github.com/GArmane/python-fastapi-hex-todo&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/iktakahiro/dddpy&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://github.com/iktakahiro/dddpy&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/slimovich/Realworld-fastapi-gino-template&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://github.com/slimovich/Realworld-fastapi-gino-template&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/fkromer/code/tree/appendix_fastapi&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://github.com/fkromer/code/tree/appendix_fastapi 접근 후 &lt;code class=&quot;language-text&quot;&gt;appendix_fastapi&lt;/code&gt; 브랜치를 참고&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;도메인-구상-및-구조-쌓아올리기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8F%84%EB%A9%94%EC%9D%B8-%EA%B5%AC%EC%83%81-%EB%B0%8F-%EA%B5%AC%EC%A1%B0-%EC%8C%93%EC%95%84%EC%98%AC%EB%A6%AC%EA%B8%B0&quot; aria-label=&quot;도메인 구상 및 구조 쌓아올리기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;도메인 구상 및 구조 쌓아올리기&lt;/h1&gt;
&lt;p&gt;과제 전반을 보고, 도메인이 어떻게 흘러갈지를 결정해야겠지요. 저는 우선 도메인이 어떻게 흐르는지에 먼저 집중했습니다. &lt;sup id=&quot;fnref-4&quot;&gt;&lt;a href=&quot;#fn-4&quot; class=&quot;footnote-ref&quot;&gt;4&lt;/a&gt;&lt;/sup&gt; 아래와 같은 도표를 통해 전체 프로젝트가 어떻게 구상될지 이해하였습니다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 473px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/a49d027e7b75350e20b5ab9fcdae33f3/c7c3c/01_domain.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 89.58333333333334%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAACTklEQVQ4y4VU63qqMBD0XU6V+yUhIURAAUVF2/5oz/u/ypxvl0oL+p3+CMjuOpnszGbl+jl+W46n4YUF3MjAi+wUe1a7+h/I9NtV2Pg5EqngxxprR001S+DVM4CfMVp+aFA1N0ht0PY3GNvjZSOf1q9+go0A43vjjixSueN1Hj6h7RFCNVC6RSprbFw9bXrHeGDoBcQoRxRbqLxFIkpItftimkPICo6nkIiK42O9QRgX3wxpESMqKusO3fGC9nDlwvPwivYwIIgKqLzk73p/4vrL8Ib+fMNwfcehv3HsKcMgMkhlhT9rAaV3DOz4mnNhbKDyBmsng+srZJzPmfV05GUPqeHGHtEc3hGmFfzQTjliEUQWTfeKSNaI5Q6Oq+eiPNiEfBcYmLKD0AZOYCaRaBG7bX2BLkoESQ6H41+iLL30bRWLWFqUuwan61/4YcGg99q1q5CqHKEwI+Cjyt8sWZzqjNPwATc0sOWZbSKyPVx/ZOsFBee8qJidcDV6LoPnj/KTVcLYQmQ1A79sBISsWShSWpsxT0f0FtPCPaQGb6sO+7bH7e2DE/v2hP78yn0s6wOO/cD22FYNx2nTtrugOw6TulMP6eGHGnFqIVWNjZOxFYgR5ehNdknEFqnYwgsU4rRkg1P8DrQ4suKmn4ZPtkEi6tkFQCNGbCkfJBUzHIdhbrcfooyJrNgjyTRcuqpml4VmMaTZI04lQlHP+jZjeP8D7ZBkW0ilHgCZgW8QSTp2Ci8uFxsurq9p7MgCseHLdOnNMW/hRjm8r8l5BvgPN+A1dwgcnxkAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/a49d027e7b75350e20b5ab9fcdae33f3/8ac56/01_domain.webp 240w,
/static/a49d027e7b75350e20b5ab9fcdae33f3/7124e/01_domain.webp 473w&quot;
              sizes=&quot;(max-width: 473px) 100vw, 473px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/a49d027e7b75350e20b5ab9fcdae33f3/8ff5a/01_domain.png 240w,
/static/a49d027e7b75350e20b5ab9fcdae33f3/c7c3c/01_domain.png 473w&quot;
            sizes=&quot;(max-width: 473px) 100vw, 473px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/a49d027e7b75350e20b5ab9fcdae33f3/c7c3c/01_domain.png&quot;
            alt=&quot;이런 식으로 도메인을 기본 흐름을 정리해 보았습니다.&quot;
            title=&quot;이런 식으로 도메인을 기본 흐름을 정리해 보았습니다.&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;이런 식으로 도메인을 기본 흐름을 정리해 보았습니다.&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;여기까지 정리하고 코드를 쌓는 사항이 가장 오래 걸렸습니다. 정말 오랜만에 학습과 설계를 동시에 하다보니, 노트로 적어가며 필수개념들을 해제했었네요.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/f7ec5fef710ac54da2d6134e66147dc5/93719/02_work_in_progress.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAwACBP/EABUBAQEAAAAAAAAAAAAAAAAAAAID/9oADAMBAAIQAxAAAAEXx0hFBTf/xAAaEAADAAMBAAAAAAAAAAAAAAABAgMABBES/9oACAEBAAEFApx6J6qozDyZ0HWqFBuDn//EABURAQEAAAAAAAAAAAAAAAAAAAAR/9oACAEDAQE/AVf/xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAgEBPwFH/8QAGxAAAgIDAQAAAAAAAAAAAAAAAAERIRIxkaH/2gAIAQEABj8Ctk5vhBCLN+H/xAAYEAEBAQEBAAAAAAAAAAAAAAABEQAhYf/aAAgBAQABPyEbzpigRk7hVZYTuBXL5nKhz//aAAwDAQACAAMAAAAQvz//xAAWEQEBAQAAAAAAAAAAAAAAAAAAAUH/2gAIAQMBAT8Q1D//xAAYEQACAwAAAAAAAAAAAAAAAAAAARFBUf/aAAgBAgEBPxCoHg//xAAZEAEBAQEBAQAAAAAAAAAAAAABEQAhMVH/2gAIAQEAAT8QGsDcCwckZIGHfV9H6Z87FCJwy1HYNPTePRBrzf/Z&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/f7ec5fef710ac54da2d6134e66147dc5/8ac56/02_work_in_progress.webp 240w,
/static/f7ec5fef710ac54da2d6134e66147dc5/d3be9/02_work_in_progress.webp 480w,
/static/f7ec5fef710ac54da2d6134e66147dc5/e46b2/02_work_in_progress.webp 960w,
/static/f7ec5fef710ac54da2d6134e66147dc5/f992d/02_work_in_progress.webp 1440w,
/static/f7ec5fef710ac54da2d6134e66147dc5/882b9/02_work_in_progress.webp 1920w,
/static/f7ec5fef710ac54da2d6134e66147dc5/c67aa/02_work_in_progress.webp 4000w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/f7ec5fef710ac54da2d6134e66147dc5/09b79/02_work_in_progress.jpg 240w,
/static/f7ec5fef710ac54da2d6134e66147dc5/7cc5e/02_work_in_progress.jpg 480w,
/static/f7ec5fef710ac54da2d6134e66147dc5/6a068/02_work_in_progress.jpg 960w,
/static/f7ec5fef710ac54da2d6134e66147dc5/644c5/02_work_in_progress.jpg 1440w,
/static/f7ec5fef710ac54da2d6134e66147dc5/0f98f/02_work_in_progress.jpg 1920w,
/static/f7ec5fef710ac54da2d6134e66147dc5/93719/02_work_in_progress.jpg 4000w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/jpeg&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/f7ec5fef710ac54da2d6134e66147dc5/6a068/02_work_in_progress.jpg&quot;
            alt=&quot;이를 준비하며 작성한 종이는 이정도로 양이 늘었습니다.&quot;
            title=&quot;이를 준비하며 작성한 종이는 이정도로 양이 늘었습니다.&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;이를 준비하며 작성한 종이는 이정도로 양이 늘었습니다.&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;h1 id=&quot;tdd와-테스트-피라미드&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#tdd%EC%99%80-%ED%85%8C%EC%8A%A4%ED%8A%B8-%ED%94%BC%EB%9D%BC%EB%AF%B8%EB%93%9C&quot; aria-label=&quot;tdd와 테스트 피라미드 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;TDD와 테스트 피라미드&lt;/h1&gt;
&lt;p&gt;&lt;a href=&quot;/books/clean-code/2023-02-10-pt09#first&quot;&gt;FIRST 원칙&lt;/a&gt;에 맞게 내 로직을 방어할 수 있는 코드가 있다면 그것만큼 든든한게 없죠. 클린 아키텍처, 헥사고널 아키텍처에서도 마찬가지입니다. 각 레이어별로 필요한 테스트는 반드시 존재해야 한다고 생각했고, 이에 따라 디렉토리를 구성하였습니다. 각각 도메인 레이어 테스트, 인프라스트럭처 레이어 테스트, 서비스 레이어 테스트, e2e 테스트로 나누었고 공통 코드를 &lt;code class=&quot;language-text&quot;&gt;util&lt;/code&gt; 디렉토리로 빼서 이 쪽을 바라보도록 했습니다.&lt;/p&gt;
&lt;p&gt;본 과제에서는 아래와 같은 디렉토리 구조로 구상하였습니다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;.
└── tests
    ├── modules
    │   ├── DOMAIN01
    │   │   ├── domain
    │   │   └── e2e
    │   ├── DOMAIN02
    │   │   ├── domain
    │   │   ├── e2e
    │   │   ├── factories
    │   │   ├── infrastructure
    │   │   └── service
    │   └── DOMAIN03
    │       ├── domain
    │       ├── e2e
    │       └── factories
    └── utils&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id=&quot;코드-완성과정&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%BD%94%EB%93%9C-%EC%99%84%EC%84%B1%EA%B3%BC%EC%A0%95&quot; aria-label=&quot;코드 완성과정 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;코드 완성과정&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;코드 규칙에 대한 추가사항을 정의했습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;프로젝트 세팅과 동시에 pre-commit hook을 두어 일관된 규칙을 통해 코드를 작성하도록 했습니다.&lt;/li&gt;
&lt;li&gt;하나의 커밋에는 하나의 작업단위만을 커밋하고, 커밋 컨벤션에 의거하여 작업내용을 기록하였습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;서비스 레이어에서 커맨드와 쿼리를 별도로 분리해두었습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;커맨드보다는 쿼리가 훨씬 더 빈번하게 일어나는 작업이므로, 이를 처리하는 역할을 분리하도록 생각했습니다.&lt;/li&gt;
&lt;li&gt;커맨드는 atomic한 작업을 반드시 수반해야 하므로, 코드의 관심사를 분리해야 추후 유지보수가 쉬운 코드가 될 것이라는 생각이 들었습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;필요에 따른 분기별 로직 처리를 &lt;a href=&quot;https://refactoring.guru/design-patterns/strategy&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;STRATEGY 패턴&lt;/a&gt;으로 풀어보았습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;조건에 따라 수행하는 알고리즘이 계속해서 증가할 것으로 판단하였습니다.&lt;/li&gt;
&lt;li&gt;알고리즘이 추가/삭제됨과 상관 없이, 객체가 “필요한 값을 요청한다” 만 호출해도 원하는 결과를 얻어올 수 있는 이점을 얻었습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;구체적인-스펙-결정을-통한-완성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B5%AC%EC%B2%B4%EC%A0%81%EC%9D%B8-%EC%8A%A4%ED%8E%99-%EA%B2%B0%EC%A0%95%EC%9D%84-%ED%86%B5%ED%95%9C-%EC%99%84%EC%84%B1&quot; aria-label=&quot;구체적인 스펙 결정을 통한 완성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;구체적인 스펙 결정을 통한 완성&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;인프라스트럭처 레이어에 쓰이는 기술들은 아래와 같이 선택했습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;영속적 데이터 저장에는 &lt;code class=&quot;language-text&quot;&gt;PostgreSQL&lt;/code&gt;을, 인메모리 DB에는 &lt;code class=&quot;language-text&quot;&gt;Redis&lt;/code&gt;를 사용하였습니다(Redis는 시간상의 문제로 구현까지는 생각하지 못하였습니다).&lt;/li&gt;
&lt;li&gt;특정 도메인 메시지를 주고받을 때 사용할 이벤트 전달용 메시지 큐로는, 익숙하게 사용하던 &lt;code class=&quot;language-text&quot;&gt;Kafka&lt;/code&gt; 혹은 레퍼런스가 많은 &lt;code class=&quot;language-text&quot;&gt;RabbitMQ&lt;/code&gt; 를 생각하였습니다(이 또한 제한 시간 내에는 구현하지 못했네요).&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;표현 레이어에 사용할 웹 프레임워크는 FastAPI를 사용하였습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;토이프로젝트처럼 간단히 접근할 것이 아니라, 수많은 요청에도 부담없이 사용될 수 있도록 하기 위하여 기존에 프로덕션 레벨에서 사용해본 경험을 이용하였습니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Gunicorn&lt;/code&gt; 매니저 프로세스와 &lt;code class=&quot;language-text&quot;&gt;uvicorn&lt;/code&gt; 프로세스들을 경우에 맞게 확장하여 Throughput을 확장하도록 구성했습니다.&lt;/li&gt;
&lt;li&gt;비동기 처리를 할 수 있도록 라이브러리부터 프레임워크까지 쉽게 대비할 수 있는 프레임워크를 선택하였습니다.&lt;/li&gt;
&lt;li&gt;작은 서비스를 여럿을 만들고 서로 통신하도록 하여, 표현계층도 다른 표현계층과 서로 메시지를 주고받을 수 있도록 설계하였습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이후, 최종적으로 아래와 같은 디렉토리 구조를 구상하였습니다: &lt;sup id=&quot;fnref-5&quot;&gt;&lt;a href=&quot;#fn-5&quot; class=&quot;footnote-ref&quot;&gt;5&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;.
├── api
│   └── endpoints
├── config
├── modules
│   ├── DOMAIN01
│   │   ├── application
│   │   ├── domain
│   │   └── infrastructure
│   │   │   └── postgres
│   │   │       └── models
│   ├── DOMAIN02
│   │   ├── application
│   │   ├── domain
│   │   │   └── OBJECT01          # [5]
│   │   │       └── helpers
│   │   └── infrastructure
│   │       └── postgres
│   │           ├── models
│   │           └── repositories
│   └── DOMAIN03
│   │   ├── application
│   │   ├── domain
│   │   └── infrastructure
│   │       └── postgres
│   │           ├── models
│   │           └── repositories
│   └── common
└── tests
│   └── ...(아래에 테스트코드 구조를 그대로)
└── utils
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id=&quot;설계-및-개발에-사용된-도구들&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%84%A4%EA%B3%84-%EB%B0%8F-%EA%B0%9C%EB%B0%9C%EC%97%90-%EC%82%AC%EC%9A%A9%EB%90%9C-%EB%8F%84%EA%B5%AC%EB%93%A4&quot; aria-label=&quot;설계 및 개발에 사용된 도구들 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;설계 및 개발에 사용된 도구들&lt;/h1&gt;
&lt;h2 id=&quot;mermaidjs를-통한-도식-표현&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#mermaidjs%EB%A5%BC-%ED%86%B5%ED%95%9C-%EB%8F%84%EC%8B%9D-%ED%91%9C%ED%98%84&quot; aria-label=&quot;mermaidjs를 통한 도식 표현 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;mermaid.js&lt;/code&gt;를 통한 도식 표현&lt;/h2&gt;
&lt;p&gt;간단한 도식을 표현하는데는 &lt;a href=&quot;https://mermaid.js.org/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;mermaid.js&lt;/a&gt; 만한 도구가 없지요. 복잡해진다면 복잡해질 수록 전문 툴을 사용하는 것이 맞으나, 간단히 처리하는 데는 이만한 녀석이 없습니다.&lt;/p&gt;
&lt;h2 id=&quot;jetbrains의-http-client&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#jetbrains%EC%9D%98-http-client&quot; aria-label=&quot;jetbrains의 http client permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;JetBrains의 &lt;code class=&quot;language-text&quot;&gt;HTTP Client&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;마침 이런 도구를 최근에 학습하였고, 빠르게 IDE 내에서 바로 사용할 수 있다는 장점을 십분 활용하였습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.jetbrains.com/help/pycharm/http-client-in-product-code-editor.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;참고 링크 #1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.jetbrains.com/help/pycharm/exploring-http-syntax.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;참고 링크 #2&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;er-diagram엔&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#er-diagram%EC%97%94&quot; aria-label=&quot;er diagram엔 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;ER diagram엔?&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://www.erdcloud.com/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;ERD Cloud&lt;/a&gt; 라는 도구가 쓰기 정말 쉽고 좋았습니다.&lt;/p&gt;
&lt;h1 id=&quot;마무리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%88%EB%AC%B4%EB%A6%AC&quot; aria-label=&quot;마무리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;마무리&lt;/h1&gt;
&lt;p&gt;이번 테스트를 통해 아래 사항을 얻을 수 있었습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;객체지향적 패러다임을 논리적으로 꽃피울 수 있는 DDD의 개념의 기초를 배웠습니다.&lt;/li&gt;
&lt;li&gt;도메인 별로 어떻게 객체를 끌어내고, 이를 통해 어떻게 메시지를 주고받으며 어떤 방식으로 서로 상호작용하는지 확실히 알게 되었습니다.&lt;/li&gt;
&lt;li&gt;이를 실현하는 방법인 클린 아키텍처, 헥사고널 아키텍처의 기초적인 부분을 배우고 구현하였습니다. 또, 기술을 필요에 따라 선택하는 이유를 확실히 알게 되었습니다.&lt;/li&gt;
&lt;li&gt;테스트 피라미드를 두어, 주요 레이어 별 테스팅이 어떻게 되면 좋을지 구상하였습니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;mermaid.js&lt;/code&gt; 및 JetBrians의 기본 도구와 ER Diagram 설계 도구를 익혔습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;다음 2부에서는, 왜 떨어졌을지에 대해 스스로 반추하는 게시글로 찾아뵙겠습니다.&lt;/p&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;이를 학습하기 전, 이 전에 읽었던 객체지향의 사실과 오해의 내용이 정말 도움되었습니다(&lt;a href=&quot;https://www.youtube.com/watch?v=26S4VFUWlJM&amp;#x26;t=3434s&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 영상&lt;/a&gt;은 그 일부를 올린 것이니 보시면 매우 좋습니다). 저는 &lt;a href=&quot;https://search.shopping.naver.com/book/catalog/32436316743?NaPm=ct%3Dlebllqq0%7Cci%3D69c2124ba02d2115182c8d68fe4f85205a3ace74%7Ctr%3Dboksl1%7Csn%3D95694%7Chk%3D0425ef7e53fce8d8c45d6816648c48f8ec5cb238&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;도메인 주도 개발 시작하기: DDD 핵심 개념 정리부터 구현까지&lt;/a&gt; 와 &lt;a href=&quot;https://play.google.com/store/books/details/%ED%8C%8C%EC%9D%B4%EC%8D%AC%EC%9C%BC%EB%A1%9C*%EC%82%B4%ED%8E%B4%EB%B3%B4%EB%8A%94*%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98*%ED%8C%A8%ED%84%B4_TDD_DDD_EDM*%EC%A0%81%EC%9A%A9%ED%95%98%EA%B8%B0?id=PeUxEAAAQBAJ&amp;#x26;hl=ko&amp;#x26;gl=US&amp;#x26;pli=1&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;파이썬으로 살펴보는 아키텍처 패턴: TDD, DDD, EDM 적용하기&lt;/a&gt; 를 상당부분 참고하였습니다.&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-2&quot;&gt;DDD에 대한 전반적인 이해에 아래 글들이 상당히 도움되었습니다.&lt;br &gt;&lt;a href=&quot;https://happycloud-lee.tistory.com/94&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;DDD 핵심만 빠르게 이해하기&lt;/a&gt;&lt;br &gt;&lt;a href=&quot;https://incheol-jung.gitbook.io/docs/q-and-a/architecture/ddd&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Domain Driven Design&lt;/a&gt; &lt;br &gt;상기 글들을 보고 &lt;a href=&quot;https://tech.kakao.com/2022/12/12/ddd-of-recommender-team/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 글을&lt;/a&gt; 함께 보신다면 보다 빠르게 이해하실 수 있으시리라 믿습니다.&lt;a href=&quot;#fnref-2&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-3&quot;&gt;Hexagonal Architecture는 이 글들을 참고하시면 상당히 도움되시리라 믿습니다. &lt;br &gt;&lt;a href=&quot;https://dataportal.kr/74#DDD%EC%25--%25--%25--%EA%25B-%25-D%EC%25B-%25B-%EC%25A-%25--%ED%25--%25A-&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Why DDD, Clean Architecture and Hexagonal?&lt;/a&gt;&lt;br &gt;&lt;a href=&quot;https://engineering.linecorp.com/ko/blog/port-and-adapter-architecture/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;지속 가능한 소프트웨어 설계 패턴: 포트와 어댑터 아키텍처 적용하기&lt;/a&gt;&lt;br &gt;&lt;a href=&quot;https://blog.imqa.io/hexagonal-architecture/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;헥사고날 아키텍쳐(Hexagonal Architecture)&lt;/a&gt;&lt;br &gt;&lt;a href=&quot;https://mesh.dev/20210910-dev-notes-007-hexagonal-architecture/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;헥사고날(Hexagonal) 아키텍처 in 메쉬코리아&lt;/a&gt;&lt;a href=&quot;#fnref-3&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-4&quot;&gt;늦게 회고하자면, &lt;a href=&quot;https://www.youtube.com/watch?v=F7EnW8dfetU&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 영상&lt;/a&gt; 을 함께 보았다면 더 좋았을 것입니다. 이벤트 스토밍을 통해 도메인 간의 유기적인 정보교환 뿐 아니라, 실제 업무를 수행하면서 나올 법한 행위를 수행할 수 있었음을 보여줄 수 있었을 것입니다.&lt;a href=&quot;#fnref-4&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-5&quot;&gt;이 부분은 정확히 어떻게 설계할지 몰라서 다른 서비스들을 최대한 참고하였습니다. 도메인 객체가 이렇게 비대해지는 것을 어떻게 제어해야할지도 학습해야겠습니다.&lt;a href=&quot;#fnref-5&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[클린 코드 스터디 (11): 시스템]]></title><description><![CDATA[2023년 1월부터 시작한 클린 코드 독파 스터디 후, 매 모임 전 준비하는 게시글을 공유합니다. 이 글은 11장, 시스템에 대해 알아봅니다.]]></description><link>https://blog.s3ich4n.me/books/clean-code/2023-02-17-pt01</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/clean-code/2023-02-17-pt01</guid><pubDate>Fri, 17 Feb 2023 22:51:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;11-시스템&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#11-%EC%8B%9C%EC%8A%A4%ED%85%9C&quot; aria-label=&quot;11 시스템 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;11. 시스템&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;복잡성은 죽음이다. 개발자에게서 생기를 앗아가며, 제품을 계획하고 제작하고 테스트하기 어렵게 만든다.&lt;/p&gt;
&lt;p&gt;Ray Ozzie, Chief Software Architect, Microsoft Corporation.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;저는 이 챕터를 배우기 위해 기존 챕터들을 배워왔다고 생각합니다. 왜 그렇게 생각했는지 풀어보겠습니다.&lt;/p&gt;
&lt;h2 id=&quot;도시를-세운다면&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8F%84%EC%8B%9C%EB%A5%BC-%EC%84%B8%EC%9A%B4%EB%8B%A4%EB%A9%B4&quot; aria-label=&quot;도시를 세운다면 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;도시를 세운다면?&lt;/h2&gt;
&lt;p&gt;도시는 한 사람이 모두 관리할 수 없습니다. 관리해야 하는 세부사항에 따라 관리자들을 두고 세부 작업을 나누었기 때문에 이와 같은 마법이 가능합니다. 다시 말해 도시가 &lt;em&gt;돌아가는&lt;/em&gt; 이유는 적절한 추상화와 모듈화 덕분이라고 할 수 있습니다.&lt;/p&gt;
&lt;p&gt;앞서 살펴본 챕터 내용을 종합하여 추상화와 모듈화, 나아가 시스템 수준에서까지 이를 유지하는 방법을 논의해봅시다.&lt;/p&gt;
&lt;h2 id=&quot;시스템-제작과-시스템-사용을-분리하라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%8B%9C%EC%8A%A4%ED%85%9C-%EC%A0%9C%EC%9E%91%EA%B3%BC-%EC%8B%9C%EC%8A%A4%ED%85%9C-%EC%82%AC%EC%9A%A9%EC%9D%84-%EB%B6%84%EB%A6%AC%ED%95%98%EB%9D%BC&quot; aria-label=&quot;시스템 제작과 시스템 사용을 분리하라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;시스템 제작과 시스템 사용을 분리하라&lt;/h2&gt;
&lt;p&gt;제작(Construction), 사용(User)는 아주 다릅니다.&lt;/p&gt;
&lt;p&gt;건물로 예를 들어봅시다. 공사중일 때의 외관과 내부는 온통 바쁜 현장의 모습일 것입니다. 완공된 뒤의 건물은 지어진 목적에 따라 이용되겠지요. 이처럼 소프트웨어 시스템 또한 아래와 같이 ‘제작’과 ‘사용’을 분리해야 합니다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;소프트웨어 시스템은&lt;/p&gt;
&lt;p&gt;애플리케이션 객체를 제작하고 의존성을 서로 ‘연결’ 하는 &lt;strong&gt;준비 과정&lt;/strong&gt; 과&lt;/p&gt;
&lt;p&gt;준비 과정 후에 이어지는 &lt;strong&gt;런타임 로직&lt;/strong&gt; 을 분리해야 합니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;관심사concern&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B4%80%EC%8B%AC%EC%82%ACconcern&quot; aria-label=&quot;관심사concern permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;관심사(concern)&lt;/h3&gt;
&lt;p&gt;이번 챕터에서는 여러 &lt;strong&gt;관심사&lt;/strong&gt; 를 살펴볼 것입니다. 또한 &lt;strong&gt;관심사 분리&lt;/strong&gt; 와 같은 설계방안을 주요 설계 기법중 하나로 소개하고 있습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;em&gt;시작 단계&lt;/em&gt;는 애플리케이션이 풀어야 할 &lt;strong&gt;관심사&lt;/strong&gt; 중 하나 입니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이를 이야기 하며 대다수의 애플리케이션이 시작단계라는 관심사를 분리하지 않음을 시사합니다. 준비 과정 코드와 런타임 로직을 &lt;em&gt;뒤섞는&lt;/em&gt; 케이스를 설명합니다. 우선 아래코드를 살펴봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Service&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getService&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;service &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        service &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyServiceImpl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; service&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이런 기법은 Lazy Initialization, Lazy Evaluation 이라고 하며 아래와 같은 장단점이 있습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;장점
&lt;ul&gt;
&lt;li&gt;필요하기 전까지 객체를 생성하지 않으므로, 불필요한 부하가 걸리지 않습니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;null&lt;/code&gt; 포인터 반환이 없습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;단점
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;getService&lt;/code&gt; 메소드는 &lt;code class=&quot;language-text&quot;&gt;MyServiceImpl&lt;/code&gt; 이란 구현체에 의존합니다
&lt;ul&gt;
&lt;li&gt;의존성 해결이 되지 않으면 컴파일이 안 됩니다.&lt;/li&gt;
&lt;li&gt;이 객체가 &lt;strong&gt;모든 상황&lt;/strong&gt;에 적합할까요? 이런 설정을 자주 사용한다면 &lt;em&gt;중복이 심각&lt;/em&gt; 해지고 모&lt;em&gt;듈성이 떨어지기 쉽&lt;/em&gt; 습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;테스트가 힘듭니다
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;MyServiceImpl&lt;/code&gt; 을 Mock object로 service 필드에 할당해야 합니다.&lt;/li&gt;
&lt;li&gt;런타임 로직에서 준비과정 로직을 섞었기 때문에, &lt;code class=&quot;language-text&quot;&gt;service&lt;/code&gt; 변수를 호출하는 모든 실행경로를 테스트 해야합니다. → 책임이 둘이 되므로 이 메소드는 두가지 일을 하기 때문에 작게나마 SRP를 위배합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;따라서, 적절한 시기에 사용하도록 하면서 의존성을 해소하기 위한 방안을 찾아야 합니다.&lt;/p&gt;
&lt;h3 id=&quot;main-분리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#main-%EB%B6%84%EB%A6%AC&quot; aria-label=&quot;main 분리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;main&lt;/code&gt; 분리&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;main&lt;/code&gt; 분리는 시스템 생성과 시스템 사용을 분리하는 기법 중 하나입니다. 예시와 아래 그림을 통해 살펴봅시다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;생성 코드를 &lt;code class=&quot;language-text&quot;&gt;main&lt;/code&gt; 으로 몰고, 나머지 시스템은 별도 객체 생성 및 의존성 연결을 해두었다고 가정해봅시다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 849px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/c667bd99d14a07251b6678d7481e91c2/f96df/001.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 72.91666666666666%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAB2HAAAdhwGP5fFlAAACJUlEQVQ4y4VUa2vqQBDN//+sXyqCFEV7KypCio+K9MuFaiutxV5tfKX4Qo2a1DzcbHIuO9aUeq92wsnMJjNnJ3t2I/m+D8/z/gtfXL64f9nZfN+HhDNGZJ+ErNWB7+zwk0nj8Rj1eh2NRgMPDw/kxbjT6QjGPbFuwCnf7WPPQ7vdDmoOEOPZbAapVqshFAohGo0imUwiFoshHA4jm83CsW04nEN7U9D5lYEFwDJNpFIpxONxXF9fUyxwcXFBxFK320WhUEClUsHt7S35YrFIM3qcU1fO0wus9xGY0gO3bdzXaiiXy6hWq1QjfKlUwmAw+L6G/JMgMM8jx5qv4EoPdu4Gvut+S3GPxtJh4Xe7HSaTCc2y59qT+TsG9vQC5+43WLO1f8e/lLVt+7TKjLGAKFDasmCl8+DDd7h/3v5R9firJDHDarXCer2GUFx4gQ9dDz6X3T/C0w24A5WefRgG1WiaRjUiXi6X1K30/PyMy8tLUiyTyRCEgqViES7nMJcapssFXuUCLG0FhzHcyDKurq6Qy+UoX/h0Oo1WqwVJSB2JRJBIJIJtILaQLMtwGQP3PPRUFUqpAr41iTCfz9OkgkRA1Ij6ZrMJyTRNale0v1gsKBYwDOP7Yq03Qbjdbin3AJE/n89hWdb5o+c4DjabDZEb2y2WmgZd14nw5NELzusnDioLon6/D1VVMZ1OafEVRcFwOMRoNMJx3QHSqZ/CT3YgOO7wL1bpW+Sr2PTcAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/c667bd99d14a07251b6678d7481e91c2/8ac56/001.webp 240w,
/static/c667bd99d14a07251b6678d7481e91c2/d3be9/001.webp 480w,
/static/c667bd99d14a07251b6678d7481e91c2/51e4d/001.webp 849w&quot;
              sizes=&quot;(max-width: 849px) 100vw, 849px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/c667bd99d14a07251b6678d7481e91c2/8ff5a/001.png 240w,
/static/c667bd99d14a07251b6678d7481e91c2/e85cb/001.png 480w,
/static/c667bd99d14a07251b6678d7481e91c2/f96df/001.png 849w&quot;
            sizes=&quot;(max-width: 849px) 100vw, 849px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/c667bd99d14a07251b6678d7481e91c2/f96df/001.png&quot;
            alt=&quot;001&quot;
            title=&quot;001&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;이런 코드는 제어흐름을 따라가기 수월합니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;main&lt;/code&gt; 에서는 필요한 객체를 생성하고 애플리케이션에 전달합니다.&lt;/li&gt;
&lt;li&gt;애플리케이션은 이를 사용합니다. 애플리케이션은 주는대로 잘 쓴다고 할 수 있겠지요.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;팩토리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%8C%A9%ED%86%A0%EB%A6%AC&quot; aria-label=&quot;팩토리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;팩토리&lt;/h3&gt;
&lt;p&gt;하지만 객체 생성시점을 애플리케이션이 결정해야할 때도 있습니다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;주문 처리 시스템으로 예를 들어봅시다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;LineItem&lt;/code&gt; 이란 인스턴스를 사용하여 &lt;code class=&quot;language-text&quot;&gt;Order&lt;/code&gt;를 추가하는 로직이 있다고 가정해봅시다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;초기화 단계에서 어떤 &lt;code class=&quot;language-text&quot;&gt;LineItem&lt;/code&gt; 구현체에 따라 &lt;code class=&quot;language-text&quot;&gt;Order&lt;/code&gt; 를 추가할지에 대한 로직은 &lt;a href=&quot;https://refactoring.guru/ko/design-patterns/abstract-factory&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;추상 팩토리 패턴&lt;/a&gt;이 어울립니다. 아래 도식을 살펴봅시다.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/a97cea6c1f68e9e424d57b35abbf5b3b/5eb75/002.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 60.83333333333334%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAB2HAAAdhwGP5fFlAAABwklEQVQoz41Sa4+aUBDl//8JNcZKfP+ATYzvxI378JmmqStCQV7WVkBQ4Gxm2uti1w+d5GS4ZO7MOXOPFMcxLpcLzuczZzpzUP6+QTZEnYCoTdOUQSH1ej3kcjnUajWUSiWUy2X4QYDj/ieUpxdolgnveITruqhUKlzXaDS4djKZcJMkST4arlYrtNtt9Pt9dLtdDAYDnOMYoePi8PUbjpstLmkK3/MwHA5BBDqdDuf1ev2ZoZBDErKRqD8QPz4jfl38uZQknKMoYogGIou4Nrzujoro4vMM4egRiWV/DMlIC4LgpqmAdDgcYFkWVFWFYRiwXYdoIJm8AqqO6NdvGKYJQ9ehKAp0XYfneXz5dDp9bkj7KBQKqNfrkGWZl628vWFHQ55e0Ht4wBdZ5odotVrI5/OYzWZXliQ/y17SNA3z+RzL5RLT6ZSz7/sIwxCRaUHXNB5EA5vNJorFIhaLxY2V7u4wG+zJv16jNZimif1+z7Btm5mR3PF4jNFoxM6gTK8uEU2iKygL0JkeivZF38REgP47jsO+rFarVw/TAOneS/1vEFNajwApupH8r7dIIsnY7XbYbrfYbDYgV9zzn9jhO6hGhBzRuJY3AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/a97cea6c1f68e9e424d57b35abbf5b3b/8ac56/002.webp 240w,
/static/a97cea6c1f68e9e424d57b35abbf5b3b/d3be9/002.webp 480w,
/static/a97cea6c1f68e9e424d57b35abbf5b3b/e46b2/002.webp 960w,
/static/a97cea6c1f68e9e424d57b35abbf5b3b/f992d/002.webp 1440w,
/static/a97cea6c1f68e9e424d57b35abbf5b3b/882b9/002.webp 1920w,
/static/a97cea6c1f68e9e424d57b35abbf5b3b/295d4/002.webp 2247w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/a97cea6c1f68e9e424d57b35abbf5b3b/8ff5a/002.png 240w,
/static/a97cea6c1f68e9e424d57b35abbf5b3b/e85cb/002.png 480w,
/static/a97cea6c1f68e9e424d57b35abbf5b3b/d9199/002.png 960w,
/static/a97cea6c1f68e9e424d57b35abbf5b3b/07a9c/002.png 1440w,
/static/a97cea6c1f68e9e424d57b35abbf5b3b/29114/002.png 1920w,
/static/a97cea6c1f68e9e424d57b35abbf5b3b/5eb75/002.png 2247w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/a97cea6c1f68e9e424d57b35abbf5b3b/d9199/002.png&quot;
            alt=&quot;002&quot;
            title=&quot;002&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;의존성은 &lt;code class=&quot;language-text&quot;&gt;OrderProcessing&lt;/code&gt; 애플리케이션으로 향합니다.&lt;/li&gt;
&lt;li&gt;필요에 따라 어떤 팩토리를 사용할지 인터페이스를 통해 알려 줄 뿐입니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;MakeLineItem()&lt;/code&gt;을 통해 &lt;code class=&quot;language-text&quot;&gt;OrderProcessing&lt;/code&gt; 객체가 어떻게 만들어지는지는 관심을 두지 않습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;의존성-주입&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%98%EC%A1%B4%EC%84%B1-%EC%A3%BC%EC%9E%85&quot; aria-label=&quot;의존성 주입 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;의존성 주입&lt;/h3&gt;
&lt;p&gt;의존성 주입(Dependency Injection)은 사용과 제작을 분리하는 강력한 메커니즘 중 하나입니다. 제어 역전(Inversion of Control, IoC) 기법을 의존성 관리에 적용한 메커니즘을 의미합니다. 제어 역전에서는 한 객체가 맡은 보조책임을 새 객체에게 전가합니다. 새 객체는 전달받은 책임만을 맡으므로 SRP를 지킵니다.&lt;/p&gt;
&lt;p&gt;초기화 지연을 통한 장점도 얻을 수 있습니다. 대다수의 DI 컨테이너는 필요하면 팩토리를 호출하거나 프록시를 생성합니다.&lt;/p&gt;
&lt;p&gt;파이썬에서는 이를 사용하는 &lt;a href=&quot;https://python-dependency-injector.ets-labs.org/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;아주 걸출한 라이브러리&lt;/a&gt;가 있습니다. 예시를 한번 살펴봅시다. 주석의 번호와 아래 번호를 쫓아가며 읽어 주십시오.&lt;/p&gt;
&lt;h3 id=&quot;의존성-주입-예시-1-의존성-주입의-에시&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%98%EC%A1%B4%EC%84%B1-%EC%A3%BC%EC%9E%85-%EC%98%88%EC%8B%9C-1-%EC%9D%98%EC%A1%B4%EC%84%B1-%EC%A3%BC%EC%9E%85%EC%9D%98-%EC%97%90%EC%8B%9C&quot; aria-label=&quot;의존성 주입 예시 1 의존성 주입의 에시 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;의존성 주입 예시 1. 의존성 주입의 에시&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; dependency_injector &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; containers&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; providers
&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; dependency_injector&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;wiring &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Provide&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; inject


&lt;span class=&quot;token comment&quot;&gt;# 1.&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Container&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;containers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;DeclarativeContainer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;

    config &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; providers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Configuration&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    api_client &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; providers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Singleton&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        ApiClient&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        api_key&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;config&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;api_key&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        timeout&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;config&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;timeout&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    service &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; providers&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Factory&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        Service&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        api_client&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;api_client&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;token comment&quot;&gt;# 2.&lt;/span&gt;
&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@inject&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;service&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Service &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Provide&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;Container&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;service&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; __name__ &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;__main__&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    container &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Container&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    container&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;config&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;api_key&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;from_env&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;API_KEY&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; required&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    container&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;config&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;timeout&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;from_env&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;TIMEOUT&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; as_&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; default&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    container&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;wire&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;modules&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;__name__&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;	&lt;span class=&quot;token comment&quot;&gt;# 3.&lt;/span&gt;

    main&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 4. &amp;lt;-- 의존성이 자동으로 주입되었습니다.&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;with&lt;/span&gt; container&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;api_client&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;override&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mock&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Mock&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        main&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 5. &amp;lt;-- 오버라이드한 의존성이 자동으로 주입되었습니다.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Container&lt;/code&gt; 안에, 설정(Configuration), 싱글톤(Singleton), 팩토리(Factory) 형식으로 주입할 요소들을 준비해둡니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;main()&lt;/code&gt; 위에, &lt;code class=&quot;language-text&quot;&gt;@inject&lt;/code&gt; 데코레이터를 달아서 이를 주입하도록 설정합니다.&lt;/li&gt;
&lt;li&gt;어떤 모듈에 의존성을 주입할지 결정합니다. 해당 구문을 통해 &lt;strong&gt;wiring을 해주어야 의존성이 주입&lt;/strong&gt; 됨에 유의합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;3.&lt;/code&gt; 구문을 통해, 함수 실행과 동시에 의존성을 주입합니다.&lt;/li&gt;
&lt;li&gt;테스트 할 때도, mock 객체를 위와같이 주입해주면 얼마든지 변경 가능합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;의존성-주입-예시-2-fastapi-환경변수-로드&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%98%EC%A1%B4%EC%84%B1-%EC%A3%BC%EC%9E%85-%EC%98%88%EC%8B%9C-2-fastapi-%ED%99%98%EA%B2%BD%EB%B3%80%EC%88%98-%EB%A1%9C%EB%93%9C&quot; aria-label=&quot;의존성 주입 예시 2 fastapi 환경변수 로드 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;의존성 주입 예시 2. FastAPI 환경변수 로드&lt;/h3&gt;
&lt;p&gt;이어서 &lt;code class=&quot;language-text&quot;&gt;FastAPI&lt;/code&gt; 앱 구동시 환경변수 로드에 대한 부분을 의존성 주입으로 해제한 예시를 살펴봅시다.&lt;/p&gt;
&lt;p&gt;먼저, 설정값은 &lt;code class=&quot;language-text&quot;&gt;Pydantic&lt;/code&gt;으로 뺐습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# settings.py 에서...&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; pydantic &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; BaseSettings

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ServerDescriptionSettings&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;BaseSettings&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DataSettings&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;BaseSettings&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Settings&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;BaseSettings&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    DEBUG&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Field&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;env&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;DEBUG&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; default&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    desc&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ServerDescriptionSettings &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; ServerDescriptionSettings&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    data&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; DataSettings &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; DataSettings&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Config&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        case_sensitive &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;


settings &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Settings&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;main.py&lt;/code&gt; 에서 컨테이너 객체 생성 후, &lt;code class=&quot;language-text&quot;&gt;FastAPI&lt;/code&gt; 의 컨테이너 값에 의존성을 주입하는 코드입니다&lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# main.py 에서...&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; config&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;apis &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; Settings

container &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Container&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
container&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;config&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;from_pydantic&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Settings&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 상기 환경변수를 로드해옴&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 로드해온 환경변수를 사용&lt;/span&gt;
app &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; FastAPI&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    description&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;container&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;config&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;desc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;REST_SERVICE_DESCRIPTION&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    openapi_url&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;container&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;config&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;desc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;OPENAPI_URL&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    title&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;container&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;config&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;desc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;REST_SERVICE_NAME&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    version&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;container&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;config&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;desc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;REST_SERVICE_VERSION&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
app&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;container &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; container	&lt;span class=&quot;token comment&quot;&gt;# FastAPI의 방식대로 DI 컨테이너를 전달&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;확장&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%99%95%EC%9E%A5&quot; aria-label=&quot;확장 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;확장&lt;/h2&gt;
&lt;p&gt;하나의 거대한 도시가 완성되기까진 많은 과정이 있었을 것입니다. 아마도 처음은 작은 군락에서 시작했겠지요. 군락이 마을로, 나아가 도시로 성장하는 과정이 있었을 것입니다. 그 과정 동안 &lt;strong&gt;이상적인&lt;/strong&gt; 발전이 이루어졌을까요? 그렇지 않았을 것입니다. 현대적인 계획도시라 하더라도 미처 예상치 못한 확장이 있게 마련입니다.&lt;/p&gt;
&lt;p&gt;이 챕터는 &lt;em&gt;‘처음부터 올바른 시스템’&lt;/em&gt; 을 만들 수는 없음을 시사합니다. 이를 위한 두 가지 방안을 제시합니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;코드 레벨 에서의 관점입니다. 오늘 맞추어 개발하고, 내일 맞추어 개발하되 이를 작게 점진적으로 개발하는 것이 필요하다고 말합니다. 그를 위해 깨끗한 코드를 지향하며 TDD, 리팩토링을 수행하는 것으로 확장 가능하게 합니다.&lt;/li&gt;
&lt;li&gt;시스템 레벨에서는 &lt;strong&gt;관심사의 분리&lt;/strong&gt; 를 통해 소프트웨어 아키텍처를 점진적으로 발전하는 것을 말합니다. 아이러니하게도 수명이 소프트웨어 시스템은 &lt;em&gt;수명이 짧기&lt;/em&gt; 때문에 점진적으로 발전할 수 있습니다. 예시를 살펴봅시다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;EJB1&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;EJB2&lt;/code&gt; 아키텍처는 어떤 부분에서 관심사 분리가 어려운지를 보여줍니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;EJB2&lt;/code&gt; 로컬 인터페이스와 &lt;code class=&quot;language-text&quot;&gt;EJB2&lt;/code&gt; 엔티티 빈 을 살펴보면 &lt;code class=&quot;language-text&quot;&gt;EJB2&lt;/code&gt; 컨테이너에 &lt;strong&gt;강하게&lt;/strong&gt; 결합되어 있음을 시사합니다.&lt;/li&gt;
&lt;li&gt;이런 식이라면 테스트도 어렵고 &lt;code class=&quot;language-text&quot;&gt;EJB2&lt;/code&gt; 가 아니라면 재사용하기 어려운 코드가 되었습니다.&lt;/li&gt;
&lt;li&gt;그런 의미로 데이터를 주고받을 때 DTO를 사용하여 주고받을 수 밖에 없었습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;횡단cross-cutting-관심사&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%9A%A1%EB%8B%A8cross-cutting-%EA%B4%80%EC%8B%AC%EC%82%AC&quot; aria-label=&quot;횡단cross cutting 관심사 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;횡단(cross-cutting) 관심사&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;EJB2&lt;/code&gt; 아키텍처는 &lt;em&gt;일부 영역&lt;/em&gt; 에서 관심사를 잘 분리하였습니다. 예를 들어 트랜잭션, 보안, 영속적 동작(persistence behaviors) 등을 소스코드가 아닌 &lt;a href=&quot;https://en.wikipedia.org/wiki/Deployment_descriptor&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;DD&lt;/a&gt;(Deployment descriptor, &lt;code class=&quot;language-text&quot;&gt;web.xml&lt;/code&gt; 같은 파일)로 분리하였습니다.&lt;/p&gt;
&lt;p&gt;영속성같은 &lt;strong&gt;관심사&lt;/strong&gt; 는 애플리케이션 각각의 경계를 넘나들기도 합니다. 따라서 모든 객체가 전반적으로 동일한 방식으로 가리키게 만들어야 합니다. 특정 RDBMS를 사용하거나, 테이블, row에 대한 명명관례, 트랜잭션에 대한 의미를 일관적으로 정의하는 식을 의미하지요.&lt;/p&gt;
&lt;p&gt;그렇지만 현실적으로 이런 코드들은 온갖 객체로 흩어지기 쉽습니다(중복되거나, 달라지거나 하는 식으로요). 이런 이유로 인해 &lt;strong&gt;횡단 관심사&lt;/strong&gt; 라는 용어가 등장하였습니다. 영속성 프레임워크, 도메인 논리 또한 모듈화하겠다는 것이지요.&lt;/p&gt;
&lt;p&gt;AOP(Aspect-Oriented Programming)이란 말은 횡단 관심사에 대해 모듈성을 확보하는 방법론을 의미합니다. AOP에서 관점(aspect)은 “특정 관심사를 지원하려면 시스템에서 특정 지점들이 동작하는 방식을 일관성있게 바꿔야 한다” 라고 합니다. 이러한 명시는 간결한 선언이나 프로그래밍 메커니즘으로 수행합니다.&lt;/p&gt;
&lt;p&gt;영속성을 예로 들자면, 영속적으로 저장할 객체와 속성을 선언하고, 영속성 책임을 프레임워크에게 위임합니다. 그러면 AOP 프레임워크는 대상 코드에 영향을 미치지 않는 상태로&lt;sup id=&quot;fnref-2&quot;&gt;&lt;a href=&quot;#fn-2&quot; class=&quot;footnote-ref&quot;&gt;2&lt;/a&gt;&lt;/sup&gt; 동작 방식을 변경합니다. 자바에서의 케이스를 살펴봅시다.&lt;/p&gt;
&lt;h2 id=&quot;자바-프록시&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9E%90%EB%B0%94-%ED%94%84%EB%A1%9D%EC%8B%9C&quot; aria-label=&quot;자바 프록시 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;자바 프록시&lt;/h2&gt;
&lt;p&gt;책에 의하면 단순한 상황에 적합합니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;proxy 메커니즘
&lt;ol&gt;
&lt;li&gt;먼저 추상화 객체, 구현체 객체 그리고 프록시 객체를 만듭니다.&lt;/li&gt;
&lt;li&gt;실행 메소드를 직접 호출하는 것을 피하여 호출합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;JDK가 제공하는 Dynamic proxy&lt;sup id=&quot;fnref-3&quot;&gt;&lt;a href=&quot;#fn-3&quot; class=&quot;footnote-ref&quot;&gt;3&lt;/a&gt;&lt;/sup&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;java.lang.reflect.Proxy&lt;/code&gt; 를 사용합니다.&lt;/li&gt;
&lt;li&gt;지정된 인터페이스에 대한 프록시 클래스의 인스턴스를 반환합니다.
이 인스턴스는 메서드 호출을 지정된 &lt;code class=&quot;language-text&quot;&gt;InvocationHandler&lt;/code&gt; 로 디스패치하는 값을 의미합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;순수-자바-aop-프레임워크&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%88%9C%EC%88%98-%EC%9E%90%EB%B0%94-aop-%ED%94%84%EB%A0%88%EC%9E%84%EC%9B%8C%ED%81%AC&quot; aria-label=&quot;순수 자바 aop 프레임워크 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;순수 자바 AOP 프레임워크&lt;/h2&gt;
&lt;p&gt;Spring AOP 등이 내부적으로 프록시를 사용합니다&lt;sup id=&quot;fnref-4&quot;&gt;&lt;a href=&quot;#fn-4&quot; class=&quot;footnote-ref&quot;&gt;4&lt;/a&gt;&lt;/sup&gt;. 스프링은 비즈니스 논리를 POJO&lt;sup id=&quot;fnref-5&quot;&gt;&lt;a href=&quot;#fn-5&quot; class=&quot;footnote-ref&quot;&gt;5&lt;/a&gt;&lt;/sup&gt;로 구현합니다. POJO는 도메인에 초점을 맞춥니다. POJO는 이름값을 합니다. 엔터프라이즈 프레임워크 뿐 아니라 다른 도메인에도 의존하지 않습니다. 따라서 테스트가 수월합니다. 그렇기 때문에 사용자 스토리를 올바르게 구현하기 쉬우며, 코드를 보수하고 개선하기 편리합니다.&lt;/p&gt;
&lt;p&gt;프로그래머는 설정파일, API를 사용하여 애플리케이션 기반 구조를 구현합니다. 이 때 스프링의 관점을 명시하고, 프레임워크는 사용자 모르게 프록시, 바이트코드 라이브러리를 통해 구현합니다. 이런 선언들이 요청에 따라 주요 객체를 생성하고 연결하는 등 DI 컨테이너의 구체적 동작을 제어합니다.&lt;/p&gt;
&lt;p&gt;스프링 v2.5의 &lt;code class=&quot;language-text&quot;&gt;app.xml&lt;/code&gt; 예시를 살펴봅시다. 이건 읽어볼 필요가 충분히 있다고 생각합니다. 각 &lt;code class=&quot;language-text&quot;&gt;bean&lt;/code&gt; 객체는 마치 마트료시카&lt;sup id=&quot;fnref-6&quot;&gt;&lt;a href=&quot;#fn-6&quot; class=&quot;footnote-ref&quot;&gt;6&lt;/a&gt;&lt;/sup&gt; 같습니다. 데이터소스-DAO-논리객체 순으로 감싸져있습니다(프록시 되었습니다).&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;xml&quot;&gt;&lt;pre class=&quot;language-xml&quot;&gt;&lt;code class=&quot;language-xml&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;beans&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
    ...
    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;bean&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;appDataSource&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;org.apache.commons.dbcp.BasicDataSource&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token attr-name&quot;&gt;destroy-method&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;close&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token attr-name&quot;&gt;&lt;span class=&quot;token namespace&quot;&gt;p:&lt;/span&gt;driverClassName&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;com.mysql.jdbc.Driver&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token attr-name&quot;&gt;&lt;span class=&quot;token namespace&quot;&gt;p:&lt;/span&gt;url&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;jdbc:mysql://localhost:3306/mydb&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token attr-name&quot;&gt;&lt;span class=&quot;token namespace&quot;&gt;p:&lt;/span&gt;username&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;me&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;

    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;bean&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;bankDataAccessObject&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;com.example.banking.persistence.BankDataAccessObject&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token attr-name&quot;&gt;&lt;span class=&quot;token namespace&quot;&gt;p:&lt;/span&gt;dataSource-ref&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;appDataSource&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;

    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;bean&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;bank&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token attr-name&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;com.example.banking.model.Bank&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token attr-name&quot;&gt;&lt;span class=&quot;token namespace&quot;&gt;p:&lt;/span&gt;dataAccessObject-ref&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;bankDataAccessObject&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;
    ...
&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;beans&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;center&gt;&lt;i&gt;구체화된 데이터 소스부터, DAO, 객체까지 참조하네요.&lt;/i&gt;&lt;/center&gt;
&lt;p&gt;클라이언트가 &lt;code class=&quot;language-text&quot;&gt;Bank&lt;/code&gt; 객체에서 &lt;code class=&quot;language-text&quot;&gt;getAccounts()&lt;/code&gt; 를 호출한다고 생각하지만, 내부에는 Bank POJO의 동작을 확장한 &lt;a href=&quot;https://refactoring.guru/design-patterns/decorator&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;DECORATOR&lt;/a&gt; 객체 집합의 외곽과 통신합니다. 필요하다면 트랜잭션이나 캐싱에도 이런 &lt;a href=&quot;https://refactoring.guru/design-patterns/decorator&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;DECORATOR&lt;/a&gt;가 얼마든지 붙을 수 있습니다. 만약 애플리케이션이 DI 컨테이너에게 (XML에 명시된) 시스템 내 최상위 객체를 요청하려면 아래와같이 사용합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token class-name&quot;&gt;XmlBeanFactory&lt;/span&gt; bf &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;XmlBeanFactory&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ClassPathResource&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;app.xml&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token class-name&quot;&gt;Bank&lt;/span&gt; bank &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Bank&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; bf&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getBean&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;bank&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;책에서 봤던 &lt;code class=&quot;language-text&quot;&gt;EJB2&lt;/code&gt; 형식의 스프링 관련 자바코드가 없어졌습니다. 이제 애플리케이션은 &lt;strong&gt;스프링과 분리&lt;/strong&gt; 되었습니다. 이를 통해 결합도 문제가 사라졌습니다.&lt;/p&gt;
&lt;h3 id=&quot;어노테이션&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%96%B4%EB%85%B8%ED%85%8C%EC%9D%B4%EC%85%98&quot; aria-label=&quot;어노테이션 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;어노테이션!&lt;/h3&gt;
&lt;p&gt;관심사와 역할을 함께 분리하는 자바의 어노테이션을 살펴봅시다&lt;sup id=&quot;fnref-7&quot;&gt;&lt;a href=&quot;#fn-7&quot; class=&quot;footnote-ref&quot;&gt;7&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;도메인 객체별로 그에 맞는 저장방식을 사용 (bad)&lt;/li&gt;
&lt;li&gt;특정 인터페이스를 상속한 도메인 객체들을 일관된 방법으로 사용 (good)
&lt;ol&gt;
&lt;li&gt;데이터 저장을 위해 추가적인 상속이 필요&lt;/li&gt;
&lt;li&gt;기존 객체와 속성충돌을 고려해야함&lt;/li&gt;
&lt;li&gt;(결과) 비즈니스 로직에 오롯이 집중하기 어려움&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;@Annotation&lt;/code&gt;을 이용 (better)
&lt;ol&gt;
&lt;li&gt;타겟이 어떤 기능을 하는지, 어떤 속성을 가지는지 한번에 지정&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;EJB3&lt;/code&gt; 이 등장할 때는 &lt;code class=&quot;language-text&quot;&gt;app.xml&lt;/code&gt; 과 자바 5의 Annotation 을 사용하여 횡단 관심사를 선언적으로 지원하는 스프링 모델을 따르게 되었습니다. 책의 예시를 살펴봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;token namespace&quot;&gt;com&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;example&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;banking&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;model&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token import&quot;&gt;&lt;span class=&quot;token namespace&quot;&gt;javax&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;persistence&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token import&quot;&gt;&lt;span class=&quot;token namespace&quot;&gt;java&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;util&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;ArrayList&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token import&quot;&gt;&lt;span class=&quot;token namespace&quot;&gt;java&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;util&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Collection&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token annotation punctuation&quot;&gt;@Entity&lt;/span&gt;
&lt;span class=&quot;token annotation punctuation&quot;&gt;@Table&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;BANKS&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Bank&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;&lt;span class=&quot;token namespace&quot;&gt;java&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;io&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;/span&gt;Serializable&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Id&lt;/span&gt; &lt;span class=&quot;token annotation punctuation&quot;&gt;@GeneratedValue&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;strategy&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;GenerationType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;AUTO&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; id&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Embeddable&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// Bank의 DB row에 인라인으로 포함된 객체&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Address&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; streetAddr1&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; streetAddr2&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; city&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; state&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; zipCode&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@Embedded&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Address&lt;/span&gt; address&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token annotation punctuation&quot;&gt;@OneToMany&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
        cascade &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;CascadeType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;ALL&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        fetch &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;FetchType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;EAGER&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        mappedBy &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;bank&quot;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Collection&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Account&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; accounts &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ArrayList&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Account&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getId&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; id&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;setId&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; id&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;id &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; id&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;addAccount&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Account&lt;/span&gt; account&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        account&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setBank&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        accounts&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;account&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Collection&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Account&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getAccounts&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; accounts&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;setAccounts&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Collection&lt;/span&gt;&lt;span class=&quot;token generics&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Account&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; accounts&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;accounts &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; accounts
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;center&gt; &lt;i&gt;스프링 코드를 들여다 볼 때의 그 수많은 그 코드들이 이런 배경을 통해 등장한 것 이었군요!&lt;/i&gt; &lt;/center&gt;
&lt;h2 id=&quot;aspectj-관점&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#aspectj-%EA%B4%80%EC%A0%90&quot; aria-label=&quot;aspectj 관점 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;AspectJ 관점&lt;/h2&gt;
&lt;p&gt;관심사를 관점으로 분리하는 가장 강력한 도구는 AspectJ 언어입니다. 보다 쉬운 설명은 &lt;a href=&quot;https://logical-code.tistory.com/118&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 게시글&lt;/a&gt;을 참고해 주십시오.&lt;/p&gt;
&lt;h2 id=&quot;테스트-주도-시스템-아키텍처-구축&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%A3%BC%EB%8F%84-%EC%8B%9C%EC%8A%A4%ED%85%9C-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98-%EA%B5%AC%EC%B6%95&quot; aria-label=&quot;테스트 주도 시스템 아키텍처 구축 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;테스트 주도 시스템 아키텍처 구축&lt;/h2&gt;
&lt;p&gt;관점 혹은 그 유사한 개념으로 관심사를 분리할 수 있다면 테스트 주도 아키텍처 구축 또한 가능해집니다. 그때그때 새 기술을 채택하여 단순한 아키텍처를 보다 복잡한 아키텍처로 변경할 수 있습니다. &lt;strong&gt;앞으로 벌어질 모든 사항을 설계하는(BDUF, Big Design Up Front)&lt;/strong&gt; 식의 접근은 변경을 쉽사리 수용하기 어렵게 합니다.&lt;/p&gt;
&lt;p&gt;소프트웨어는 그런 의미로 건물 건축보다는 정원 관리에 보다 가깝다&lt;sup id=&quot;fnref-8&quot;&gt;&lt;a href=&quot;#fn-8&quot; class=&quot;footnote-ref&quot;&gt;8&lt;/a&gt;&lt;/sup&gt; 라고 합니다. 관점을 효과적으로 분리한다면 극적인 변화 또한 경제적으로 가능함을 의미합니다. ‘아주 단순하고’ 괜찮은 아키텍처로 결과물을 빠르게 출시한 후 기반 구조를 천천히 추가해도 괜찮다는 것을 의미합니다.&lt;/p&gt;
&lt;p&gt;그렇지만, ‘무계획’으로 뛰어들면 안됩니다. 프로젝트는 일반적인 범위, 목표, 일정 및 결과로 내어놓을 시스템의 일반적 구조 또한 생각해야 합니다. 하지만 변하는 환경에 대처하여 진로를 변경할 능력 또한 갖추고 유지해야 합니다.&lt;/p&gt;
&lt;p&gt;저자는 현재까지의 이야기를 이렇게 요약하였습니다.&lt;/p&gt;
&lt;hr&gt;
&lt;blockquote&gt;
&lt;p&gt;최선의 시스템 구조는 각기 POJO(또는 다른) 객체로 구현되는 모듈화된 관심사 영역(도메인)으로 구성된다.&lt;/p&gt;
&lt;p&gt;이렇게 서로 다른 영역은 해당 영역 코드에 최소한의 영향을 미치는 관점이나 유사한 도구를 사용해 통합한다.&lt;/p&gt;
&lt;p&gt;이런 구조 역시 코드와 마찬가지로 테스트 주도 기법을 적용할 수 있다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;의사-결정을-최적화-하십시오&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%98%EC%82%AC-%EA%B2%B0%EC%A0%95%EC%9D%84-%EC%B5%9C%EC%A0%81%ED%99%94-%ED%95%98%EC%8B%AD%EC%8B%9C%EC%98%A4&quot; aria-label=&quot;의사 결정을 최적화 하십시오 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;의사 결정을 최적화 하십시오&lt;/h2&gt;
&lt;p&gt;모듈을 나누고 관심사를 분리하면 세세한 부분까지 관리/결정을 내릴 수 있습니다. 큰 시스템은 한 사람이 모든 결정을 내리기 힘듭니다. 그런 의미로 담당자에게 책임을 위임하는 것이 중요합니다.&lt;/p&gt;
&lt;p&gt;때로는 최후의 최후까지 &lt;strong&gt;결정을 미루어서&lt;/strong&gt; 최대한 정보를 모아 최선의 선택을 하는 것이 필요합니다. 이는 시스템을 &lt;strong&gt;너무 일찍 결정하지 말라&lt;/strong&gt;는 것을 시사합니다.&lt;/p&gt;
&lt;hr&gt;
&lt;blockquote&gt;
&lt;p&gt;관심사를 모듈로 분리한 POJO 시스템은 기민함을 제공한다.&lt;/p&gt;
&lt;p&gt;이런 기민함 덕택에 최신 정보에 기반해 최선의 시점에 최적의 결정을 내리기가 쉬워진다.&lt;/p&gt;
&lt;p&gt;또한 결정의 복잡성도 줄어든다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;명백한-가치가-있을-때-표준을-현명하게-사용하십시오&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AA%85%EB%B0%B1%ED%95%9C-%EA%B0%80%EC%B9%98%EA%B0%80-%EC%9E%88%EC%9D%84-%EB%95%8C-%ED%91%9C%EC%A4%80%EC%9D%84-%ED%98%84%EB%AA%85%ED%95%98%EA%B2%8C-%EC%82%AC%EC%9A%A9%ED%95%98%EC%8B%AD%EC%8B%9C%EC%98%A4&quot; aria-label=&quot;명백한 가치가 있을 때 표준을 현명하게 사용하십시오 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;명백한 가치가 있을 때 표준을 현명하게 사용하십시오&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;“도메인에 맞는 기술을 선택하라.”&lt;/strong&gt; 한마디로 정리할 수 있겠습니다. 도메인을 추구하면 고객 가치를 추구하게 됩니다. 고객에게 소프트웨어를 제공하는 것이 프로그래머의 제 1원칙이니까요.&lt;/p&gt;
&lt;hr&gt;
&lt;blockquote&gt;
&lt;p&gt;표준을 사용하면 아이디어와 컴포넌트를 재사용하기 쉽고, 비슷한 경험을 할 사람을 구하기 쉬우며, 좋은 아이디어를 캡슐화하기 쉽고, 컴포넌트를 엮기 쉽다.&lt;/p&gt;
&lt;p&gt;하지만 표준을 만드는 시간이 너무 오래 걸려 업계가 기다리지 못한다.&lt;/p&gt;
&lt;p&gt;어떤 표준은 원래 표준을 제정한 목적을 잊어버리기도 한다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;시스템은-도메인-특화-언어가-필요합니다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%8B%9C%EC%8A%A4%ED%85%9C%EC%9D%80-%EB%8F%84%EB%A9%94%EC%9D%B8-%ED%8A%B9%ED%99%94-%EC%96%B8%EC%96%B4%EA%B0%80-%ED%95%84%EC%9A%94%ED%95%A9%EB%8B%88%EB%8B%A4&quot; aria-label=&quot;시스템은 도메인 특화 언어가 필요합니다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;시스템은 도메인 특화 언어가 필요합니다&lt;/h2&gt;
&lt;p&gt;도메인 특화 언어(이하 DSL, Domain Specific Language)와 유비쿼터스 언어를 이야기합니다.&lt;/p&gt;
&lt;p&gt;도메인을 만드는 사람 모두가 읽을 수 있는 언어와 공통적으로 사용하는 단어, 어휘를 통해 &lt;strong&gt;의사소통의 간극을 줄이는&lt;/strong&gt; 것이 이 둘의 핵심입니다.&lt;/p&gt;
&lt;hr&gt;
&lt;blockquote&gt;
&lt;p&gt;DSL을 사용하면 고차원 정책에서 저차원 세부사항에 이르기까지 모든 추상화 수준과 모든 도메인을 POJO로 표현할 수 있다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;결론&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B2%B0%EB%A1%A0&quot; aria-label=&quot;결론 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;결론&lt;/h2&gt;
&lt;p&gt;시스템 또한 깨끗해야 합니다. 깨끗하지 못한 아키텍처는 도메인 논리를 흐리며 기민성을 떨어뜨립니다. 도메인 논리가 흐려지면 제품 품질이 떨어집니다. 버그가 숨어들기 쉬워지고, 스토리를 구현하기 어려워집니다. 기민성이 떨어지면 생산성이 낮아져 TDD가 제공하는 장점이 사라집니다.&lt;/p&gt;
&lt;p&gt;모든 추상화 단계에서 의도는 명확히 표현되어야 합니다. 그러려면 POJO를 작성하고, 관점 혹은 관점과 유사한 메커니즘을 사용해 각 구현 관심사를 분리해야 합니다&lt;sup id=&quot;fnref-9&quot;&gt;&lt;a href=&quot;#fn-9&quot; class=&quot;footnote-ref&quot;&gt;9&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;p&gt;무엇보다도, 시스템을 설계하든 개별 모듈을 설계하든 &lt;strong&gt;&lt;em&gt;실제로 돌아가는 가장 단순한 수단&lt;/em&gt;&lt;/strong&gt; 을 사용해야 합니다.&lt;/p&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;&lt;a href=&quot;https://python-dependency-injector.ets-labs.org/examples/fastapi.html#application-factory&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;해당 예시&lt;/a&gt; 를 로직에 맞게 푼 코드입니다. &lt;code class=&quot;language-text&quot;&gt;@inject&lt;/code&gt; 를 통해 의존성을 주입하는 코드는 예시를 살펴보시기를 강력히 권장드립니다. 또한 해당 게시글들이 매우 도움되었습니다. &lt;br /&gt;&lt;a href=&quot;https://blog.neonkid.xyz/279&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;[FastAPI] 11. Dependency Injector를 이용한 의존성 관리&lt;/a&gt;&lt;br /&gt;&lt;a href=&quot;https://www.humphreyahn.dev/blog/dependency-injector&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;파이썬 애플리케이션 의존성 주입 - dependency injector&lt;/a&gt;  &lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-2&quot;&gt;대상 소스코드를 수작업으로 편집할 필요가 없다는 뜻을 의미합니다. 예시코드나 개념을 보면 이해가 되실 것입니다.  &lt;a href=&quot;#fnref-2&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-3&quot;&gt;&lt;a href=&quot;https://taes-k.github.io/2021/05/15/dynamic-proxy-reflection/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;해당 게시글&lt;/a&gt;이 도움되었습니다.&lt;a href=&quot;#fnref-3&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-4&quot;&gt;보다 쉽고 상세한 설명은 &lt;a href=&quot;https://taes-k.github.io/2021/02/07/spring-aop-proxy/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;해당 게시글&lt;/a&gt;을 참고하십시오.  &lt;a href=&quot;#fnref-4&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-5&quot;&gt;Plain Old Java Object 를 의미합니다. &lt;em&gt;어떤 프레임워크와 라이브러리에 속하지 않는&lt;/em&gt; 쌩 자바 객체를 의미합니다. 다른 언어에서 이 용어를 본다면 &lt;em&gt;어떤 프레임워크와 라이브러리에 속하지 않는&lt;/em&gt; 객체를 의미한다고 이해하면 되지 않을까 하고 생각합니다.  &lt;a href=&quot;#fnref-5&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-6&quot;&gt;Матрёшка. 인형 속에 인형이 있고, 그 속에 인형이 계속 있는 러시아 인형을 의미합니다. &lt;a href=&quot;https://ko.wikipedia.org/wiki/%EB%A7%88%ED%8A%B8%EB%A3%8C%EC%8B%9C%EC%B9%B4&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;출처&lt;/a&gt;  &lt;a href=&quot;#fnref-6&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-7&quot;&gt;어노테이션을 이해하는데 &lt;a href=&quot;https://www.nextree.co.kr/p5864/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;해당 게시글&lt;/a&gt;이 큰 도움이 되었습니다.  &lt;a href=&quot;#fnref-7&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-8&quot;&gt;보다 상세한 내용에 대해서는 &lt;a href=&quot;https://technical-leader.tistory.com/45&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;해당 게시글&lt;/a&gt;을 참고하십시오.  &lt;a href=&quot;#fnref-8&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;li id=&quot;fn-9&quot;&gt;이런 식의 접근은 DDD(Domain-driven Development)와 직접적으로 맞닿아 있습니다.  &lt;a href=&quot;#fnref-9&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[클린 코드 스터디 (10): 클래스]]></title><description><![CDATA[2023년 1월부터 시작한 클린 코드 독파 스터디 후, 매 모임 전 준비하는 게시글을 공유합니다. 이 글은 10장, 클래스에 대해 살펴봅니다.]]></description><link>https://blog.s3ich4n.me/books/clean-code/2023-02-10-pt10</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/clean-code/2023-02-10-pt10</guid><pubDate>Fri, 10 Feb 2023 22:55:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;10-클래스&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#10-%ED%81%B4%EB%9E%98%EC%8A%A4&quot; aria-label=&quot;10 클래스 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;10. 클래스&lt;/h1&gt;
&lt;p&gt;클래스에 대해 살펴봅시다.&lt;/p&gt;
&lt;h2 id=&quot;클래스-체계&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%81%B4%EB%9E%98%EC%8A%A4-%EC%B2%B4%EA%B3%84&quot; aria-label=&quot;클래스 체계 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;클래스 체계&lt;/h2&gt;
&lt;p&gt;자바의 클래스 정의 표준 관례는 아래와 같은 순으로 코드 작성을 기대합니다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;변수 목록(&lt;code class=&quot;language-text&quot;&gt;public static&lt;/code&gt; 우선, &lt;code class=&quot;language-text&quot;&gt;private static&lt;/code&gt;이 그 다음, 마지막으로 &lt;code class=&quot;language-text&quot;&gt;private&lt;/code&gt; 순. 공개변수가 필요한 경우는 거의 없습니다)&lt;/li&gt;
&lt;li&gt;공개 함수&lt;/li&gt;
&lt;li&gt;비공개 함수&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이래서 신문기사처럼 읽힌다고 말합니다.&lt;/p&gt;
&lt;h3 id=&quot;캡슐화&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%BA%A1%EC%8A%90%ED%99%94&quot; aria-label=&quot;캡슐화 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;캡슐화&lt;/h3&gt;
&lt;p&gt;변수나 유틸리티 함수는 반드시 숨기는 편이 좋겠습니다만, &lt;code class=&quot;language-text&quot;&gt;protected&lt;/code&gt;로 두어 테스트 코드가 접근하기 쉽도록 하기도 합니다. 최대한 &lt;code class=&quot;language-text&quot;&gt;private&lt;/code&gt; 상태로 두는 것을 강조합니다.&lt;/p&gt;
&lt;h2 id=&quot;클래스는-작아야-한다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%81%B4%EB%9E%98%EC%8A%A4%EB%8A%94-%EC%9E%91%EC%95%84%EC%95%BC-%ED%95%9C%EB%8B%A4&quot; aria-label=&quot;클래스는 작아야 한다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;클래스는 작아야 한다&lt;/h2&gt;
&lt;p&gt;클래스는 작아야 합니다. 그럼 얼마나 작아야 할까요? 클래스는 “책임”을 적게 져야합니다.&lt;/p&gt;
&lt;p&gt;이에 대한 책의 첫째 예시는 &lt;code class=&quot;language-text&quot;&gt;public&lt;/code&gt; 메소드가 &lt;code class=&quot;language-text&quot;&gt;70&lt;/code&gt;개가 넘는 로직을 보유하고 있습니다. 무려 책 두쪽을 할애했습니다. 어지럽네요.. 둘째 예시는 메소드를 &lt;code class=&quot;language-text&quot;&gt;5&lt;/code&gt;개만 가지고 있는 클래스가 나옵니다. 하지만 “책임”을 많이 지고 있는 것으로 보입니다.&lt;/p&gt;
&lt;p&gt;클래스 이름은 해당 클래스의 책임을 기술해야 합니다. 간결한 이름은 간결한 클래스임을 입증합니다. 이름이 복잡하다면 책임이 클 가능성이 높습니다.&lt;/p&gt;
&lt;h3 id=&quot;단일-책임-원칙single-responsibility-principle-srp&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8B%A8%EC%9D%BC-%EC%B1%85%EC%9E%84-%EC%9B%90%EC%B9%99single-responsibility-principle-srp&quot; aria-label=&quot;단일 책임 원칙single responsibility principle srp permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;단일 책임 원칙(Single Responsibility Principle, SRP)&lt;/h3&gt;
&lt;p&gt;클래스, 모듈을 변경할 이유는 &lt;strong&gt;단 하나&lt;/strong&gt; 뿐이어야 한다 라는 원칙입니다. 책임이 하나여야 한다는 뜻입니다. 객체지향 설계를 이야기 할 때 나오는 &lt;a href=&quot;https://en.wikipedia.org/wiki/SOLID&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;SOLID&lt;/a&gt;의 &lt;code class=&quot;language-text&quot;&gt;S&lt;/code&gt;입니다.&lt;/p&gt;
&lt;p&gt;소프트웨어는 돌아가는 소프트웨어가 최고입니다. 그를 위해서라면 돌아가는 단일 책임을 “잘 정리해야” 합니다. 이런 단일 책임을 가진 작은 클래스들이 &lt;strong&gt;협력&lt;/strong&gt;하여 시스템에 필요한 동작을 수행하도록 해야합니다.&lt;/p&gt;
&lt;h3 id=&quot;응집도-cohesion&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%91%EC%A7%91%EB%8F%84-cohesion&quot; aria-label=&quot;응집도 cohesion permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;응집도 (Cohesion)&lt;/h3&gt;
&lt;p&gt;클래스는 인스턴스 변수 수가 적어야 합니다. 각 클래스 메소드는 클래스 인스턴스 변수를 하나 이상 사용해야 합니다. 일반적으로 메소드가 변수를 더 많이 사용할 수록 메소드와 클래스는 응집도가 더 높습니다. 모든 인스턴스 변수를 메소드마다 사용하는 클래스는 응집도가 가장 높습니다.&lt;/p&gt;
&lt;p&gt;‘함수를 작게’, ‘매개변수 목록을 짧게’ 짜다보면 몇몇 메소드가 쓰는 인스턴스 변수가 아주 많아질 때가 옵니다. 이 때 변수와 메소드를 분리하여 새 클래스로 쪼개면 응집도를 유지할 수 있습니다.&lt;/p&gt;
&lt;p&gt;저자가 큰 함수를 작은 함수/클래스 여럿으로 바꾼 방법론을 살펴봅시다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;테스트 코드 작성
&lt;ol&gt;
&lt;li&gt;이 모든 것을 위해 동작을 검증하는 Test suite을 작성했습니다.&lt;/li&gt;
&lt;li&gt;한 번에 하나씩, 수 차례에 걸쳐 코드를 변경하였습니다.&lt;/li&gt;
&lt;li&gt;본래 코드와 동일하게 도는지 확인했습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;코드의 변화에 주목
&lt;ol&gt;
&lt;li&gt;좀 더 길고 서술적인 이름을 변수이름을 두었습니다.&lt;/li&gt;
&lt;li&gt;코드에 주석을 달 목적으로 함수 선언와 클래스 선언을 활용했습니다.&lt;/li&gt;
&lt;li&gt;가독성을 위해 공백과 형식을 맞추었습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;책임을 나누었습니다.
&lt;ol&gt;
&lt;li&gt;실행환경을 책임지는 클래스, 렌더링을 해주는 클래스, 로직이 들어간 클래스로 분리했습니다. 각 내용 수정은 각각의 클래스에서 수행해주면 됩니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;변경하기-쉬운-클래스&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%B3%80%EA%B2%BD%ED%95%98%EA%B8%B0-%EC%89%AC%EC%9A%B4-%ED%81%B4%EB%9E%98%EC%8A%A4&quot; aria-label=&quot;변경하기 쉬운 클래스 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;변경하기 쉬운 클래스&lt;/h2&gt;
&lt;p&gt;대부분의 시스템은 지속적인 변경이 가해집니다. 바꿀 때마다 시스템은 의도치않게 돌 수 있겠지요. 깨끗한 시스템은 클래스를 체계적으로 정리하여 이 위험을 낮춥니다.&lt;/p&gt;
&lt;p&gt;클래스에 ‘손을 대’는 계기는 &lt;strong&gt;시스템의 변경&lt;/strong&gt;일 때가 가장 자연스럽습니다. 그 시기가 온다면 설계 개선에 대한 고민과 시도가 필요합니다.&lt;/p&gt;
&lt;p&gt;예시코드를 보면 하나의 덩어리였던 &lt;code class=&quot;language-text&quot;&gt;Sql&lt;/code&gt; 클래스가 아래 장점을 가지게 되었습니다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;단독책임을 가지는 각각의 메소드와 공통 유틸리티로 분리되었습니다.&lt;/li&gt;
&lt;li&gt;확장에 개방적이고 수정에 폐쇄적인 구조를 갖게 되었습니다.
&lt;ol&gt;
&lt;li&gt;확장: 파생 클래스를 통해 확장하기 쉽습니다&lt;/li&gt;
&lt;li&gt;폐쇄: 새 기능은 다른 클래스에 닫아놓아서 수정에 폐쇄적입니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;변경으로부터-격리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%B3%80%EA%B2%BD%EC%9C%BC%EB%A1%9C%EB%B6%80%ED%84%B0-%EA%B2%A9%EB%A6%AC&quot; aria-label=&quot;변경으로부터 격리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;변경으로부터 격리&lt;/h3&gt;
&lt;p&gt;객체 지향 프로그래밍을 배울 때, Concrete class와 Abstract class 클래스를 배웁니다. 이는 추상구현과 상세구현의 분리를 시사합니다. 상세한 구현에 의존한 코드는 변화에 취약하기 때문이지요.&lt;/p&gt;
&lt;p&gt;‘어떤 기능이 있음’을 먼저 생각하고, 그 구현체를 앞서 생각한 기능에 맞추어 개발할 필요가 있습니다. 이를 구현의 결합도를 낮춘다고 표현합니다. 결합도가 낮아지면 유연성과 재사용성 또한 높아집니다. 시스템이 잘 격리되어있으면 이해하기도 쉬워집니다.&lt;/p&gt;
&lt;p&gt;이러한 클래스 설계원칙을 DIP(Dependency Inversion Principle)라고 부르며 이 또한 앞서말한 SOLID의 &lt;code class=&quot;language-text&quot;&gt;D&lt;/code&gt; 입니다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[클린 코드 스터디 (9): 단위 테스트]]></title><description><![CDATA[2023년 1월부터 시작한 클린 코드 독파 스터디 후, 매 모임 전 준비하는 게시글을 공유합니다. 이 글은 9장, 단위 테스트에 대해 살펴봅니다.]]></description><link>https://blog.s3ich4n.me/books/clean-code/2023-02-10-pt09</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/clean-code/2023-02-10-pt09</guid><pubDate>Fri, 10 Feb 2023 22:51:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;9-단위-테스트&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#9-%EB%8B%A8%EC%9C%84-%ED%85%8C%EC%8A%A4%ED%8A%B8&quot; aria-label=&quot;9 단위 테스트 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;9. 단위 테스트&lt;/h1&gt;
&lt;p&gt;테스트 코드를 몰랐을 때와, 테스트 코드의 중요성을 알고 올바르게 쓰기 시작한 차이는 천양지차였습니다. 기본적인 방법은 &lt;a href=&quot;https://repo.yona.io/doortts/blog/issue/2&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 책&lt;/a&gt;으로 배우고, 파이썬에선 어떻게 쓰이는지 스스로 찾아보았습니다. 이번 장에서는 단위 테스트가 시사하는 중요한 사실 몇가지를 살펴봅시다.&lt;/p&gt;
&lt;h2 id=&quot;tdd-법칙-세-가지&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#tdd-%EB%B2%95%EC%B9%99-%EC%84%B8-%EA%B0%80%EC%A7%80&quot; aria-label=&quot;tdd 법칙 세 가지 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;TDD 법칙 세 가지&lt;/h2&gt;
&lt;p&gt;TDD는 실제 코드를 작성하기 전 단위 테스트부터 작성하라고 요구하지요. 책에서 제시하는 세 가지 법칙을 살펴봅시다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;실패하는 단위 테스트를 작성할 때 까지 실제 코드를 작성하지 않는다.&lt;/li&gt;
&lt;li&gt;컴파일은 실패하지 않으면서 실행이 실패하는 정도만 단위 테스트를 작성한다.&lt;/li&gt;
&lt;li&gt;현재 실패하는 테스트를 통과할 정도만 실제 코드를 작성한다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;말을 풀어보면…&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;실제 코드는 잘 설계된 단위 테스트를 갖추고 짜야하며&lt;/li&gt;
&lt;li&gt;그 방안은 테스트 코드 로직만 돌 정도로 짜야합니다&lt;/li&gt;
&lt;li&gt;테스트를 다시 Pass 시키고 코드를 리팩토링하면 되니까, 우선 로직을 완성해봅시다&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;정도가 되겠네요. 이러면 개발과 테스트가 30초 주기로 묶인다구요?? 절대 동의할 수 없습니다ㅠㅠ&lt;/p&gt;
&lt;p&gt;이렇게 일하면 테스트코드도 수백수천개가 나오겠지요. 그렇지만 테스트 코드가 짐이되면 어떻게 될 까요?&lt;/p&gt;
&lt;h2 id=&quot;깨끗한-테스트-코드-유지하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B9%A8%EB%81%97%ED%95%9C-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%BD%94%EB%93%9C-%EC%9C%A0%EC%A7%80%ED%95%98%EA%B8%B0&quot; aria-label=&quot;깨끗한 테스트 코드 유지하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;깨끗한 테스트 코드 유지하기&lt;/h2&gt;
&lt;p&gt;실제 코드가 진화하면 테스트 코드도 그에 따라 발맞추어야 하며, 지저분한 테스트 코드는 안하느니만 못합니다. 그런데 실제 코드를 변화시킴에 따라 더러운 테스트 코드를 바꾸기는 쉽지 않지요. 이 때 악순환이 발생합니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;더러운 테스트코드를 고치기 두려워집니다. 테스트가 있어야 코드를 검증할테니까요.&lt;/li&gt;
&lt;li&gt;더러운 코드는 필연적으로 더러운 코드를 낳습니다. 그러면 개발기간도 길어집니다.&lt;/li&gt;
&lt;li&gt;하지만 테스트 suite(슈트)마저 없으면 코드를 확인할 길이 없습니다. 그러면 다시 두려워집니다…&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;테스트 코드 또한 실제 코드 만큼이나 중요합니다.&lt;/p&gt;
&lt;h3 id=&quot;테스트는-유연성-유지보수성-재사용성을-제공합니다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%85%8C%EC%8A%A4%ED%8A%B8%EB%8A%94-%EC%9C%A0%EC%97%B0%EC%84%B1-%EC%9C%A0%EC%A7%80%EB%B3%B4%EC%88%98%EC%84%B1-%EC%9E%AC%EC%82%AC%EC%9A%A9%EC%84%B1%EC%9D%84-%EC%A0%9C%EA%B3%B5%ED%95%A9%EB%8B%88%EB%8B%A4&quot; aria-label=&quot;테스트는 유연성 유지보수성 재사용성을 제공합니다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;테스트는 유연성, 유지보수성, 재사용성을 제공합니다&lt;/h3&gt;
&lt;p&gt;테스트 코드도 유지하지 않으면 망가집니다. 이게 없으면 실제 코드를 유연하게 만들 버팀목이 사라지는 셈입니다. 따라서 실제 코드를 점검하는 Automated unit test suite은 설계와 아키텍처를 깨끗하게 보존하는 열쇠입니다. 이게 있어야 코드를 바꾸기 쉽습니다.&lt;/p&gt;
&lt;p&gt;즉 테스트 코드를 지저분하게 두지 말고 깔끔하게 만들어야 합니다. 그렇다면 깨끗한 테스트코드는 어떻게 만들까요?&lt;/p&gt;
&lt;h2 id=&quot;깨끗한-테스트-코드&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B9%A8%EB%81%97%ED%95%9C-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%BD%94%EB%93%9C&quot; aria-label=&quot;깨끗한 테스트 코드 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;깨끗한 테스트 코드&lt;/h2&gt;
&lt;p&gt;세 가지가 필요합니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;가독성&lt;/li&gt;
&lt;li&gt;가독성&lt;/li&gt;
&lt;li&gt;가독성&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;테스트 코드 또한 명료하고, 단순하고, 표현력이 좋은 코드여야 합니다.&lt;/p&gt;
&lt;p&gt;AAA(Arrange-Assert-Act) 형식&lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;으로 테스트코드를 세 부분으로 나누는 것이 권장됩니다. 정말 필요한 것들만 명료하게 제공합니다. 잡다하고 세세한 코드는 숨깁니다.&lt;/p&gt;
&lt;h3 id=&quot;dsl에-특화된-테스트-언어&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#dsl%EC%97%90-%ED%8A%B9%ED%99%94%EB%90%9C-%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%96%B8%EC%96%B4&quot; aria-label=&quot;dsl에 특화된 테스트 언어 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;DSL에 특화된 테스트 언어&lt;/h3&gt;
&lt;p&gt;도메인을 표현하기 위해 감싼 나만의 함수와 유틸리티로 로직을 바로 테스트하면 테스트가 정말 간결해지겠지요. 이런 API는 테스트 코드를 위한 특수한 API가 되지요.&lt;/p&gt;
&lt;h3 id=&quot;이중-표준&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%B4%EC%A4%91-%ED%91%9C%EC%A4%80&quot; aria-label=&quot;이중 표준 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;이중 표준&lt;/h3&gt;
&lt;p&gt;테스트 코드는 가능하면 짧게, 필요하다면 “그릇된 정보를 피하라” 라고 말했던 부분을 어길 수도 있습니다. 그렇지만 테스트를 빠르게 이해하기에는 더할나위없이 쉽지요. 실제환경에서는 신경써야할 메모리, CPU 효율도 테스트 코드 작성에는 무시될 수도 있습니다.&lt;/p&gt;
&lt;h2 id=&quot;테스트-당-assert-하나&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%85%8C%EC%8A%A4%ED%8A%B8-%EB%8B%B9-assert-%ED%95%98%EB%82%98&quot; aria-label=&quot;테스트 당 assert 하나 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;테스트 당 &lt;code class=&quot;language-text&quot;&gt;assert&lt;/code&gt; 하나&lt;/h2&gt;
&lt;p&gt;이는 &lt;code class=&quot;language-text&quot;&gt;JUnit&lt;/code&gt;의 전통 중 하나라고 합니다. 결론이 하나니까 직관적입니다. 그런데 유사 개념을 테스트할 때의 코드 중복은 어떻게 처리할까요?&lt;/p&gt;
&lt;p&gt;코드가 복잡해지면 TEMPLATE METHOD 패턴을 적용해봄직 합니다만, 처음부터 그럴 필요는 없을 것입니다(저라도 &lt;code class=&quot;language-text&quot;&gt;assert&lt;/code&gt;를 중복해서 쓰겠어요).&lt;/p&gt;
&lt;p&gt;이는 지향해야 할 태도입니다. 그런데 &lt;code class=&quot;language-text&quot;&gt;assert&lt;/code&gt;를 하나만 두기엔 너무 원론적입니다. 따라서…&lt;/p&gt;
&lt;h3 id=&quot;테스트-당-개념-하나&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%85%8C%EC%8A%A4%ED%8A%B8-%EB%8B%B9-%EA%B0%9C%EB%85%90-%ED%95%98%EB%82%98&quot; aria-label=&quot;테스트 당 개념 하나 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;테스트 당 개념 하나&lt;/h3&gt;
&lt;p&gt;한 개념을 테스트하기 위한 &lt;code class=&quot;language-text&quot;&gt;assert&lt;/code&gt;는 같이 담을 수 있겠으나, 여러 개념이 테스트 메소드 안에 들어가지 않도록 하는 편이 좋겠습니다.&lt;/p&gt;
&lt;h2 id=&quot;first&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#first&quot; aria-label=&quot;first permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;F.I.R.S.T.&lt;/h2&gt;
&lt;p&gt;저자는 이런 이름을 붙여서 아래 규칙을 따르기를 말합니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Fast: 테스트는 &lt;strong&gt;빨리 돌아야&lt;/strong&gt; 합니다. 자주 돌 수 있게 만들어야 합니다.&lt;/li&gt;
&lt;li&gt;Independent: 테스트는 &lt;strong&gt;독립적이어야&lt;/strong&gt; 합니다. 테스트는 다른 테스트에 의존해서는 안됩니다. 만일 그렇게 된다면, 가면 갈 수록 원인을 찾기 힘들어집니다.&lt;/li&gt;
&lt;li&gt;Repeatable: 어떤 환경에서든 &lt;strong&gt;반복 가능해야&lt;/strong&gt; 합니다. 네트워크가 연결되어있지 않더라도 가능해야 합니다.&lt;/li&gt;
&lt;li&gt;Self-Validating: 테스트 결과는 &lt;strong&gt;성공/실패&lt;/strong&gt; 뿐이어야 합니다. 테스트 통과를 확인하기 위해 판단하지 말아야 하고 스스로가 결과를 리턴하게 해야합니다.&lt;/li&gt;
&lt;li&gt;Timely: 적시에 테스트를 짜야합니다. 앞서 말한 “실제 코드” 작성 전에 짜야합니다. 그렇지 않으면 테스트 하기 어려워집니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;결론&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B2%B0%EB%A1%A0&quot; aria-label=&quot;결론 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;결론&lt;/h2&gt;
&lt;p&gt;테스트 코드는 중요합니다. 실제 코드만큼이나 중요하니, 이를 잘 관리해야합니다. 깨끗하게 관리하기 위해 가독성과 테스트 코드의 표준을 둡시다. 그리고 도메인을 잘 표현하는 별도 로직을 작성해서 짧고 핵심만 말하는 코드를 짜봅시다.&lt;/p&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;저자의 &lt;code class=&quot;language-text&quot;&gt;FitNesse&lt;/code&gt; 프로젝트에선 BUILD-OPERATE-CHECK 패턴이라고 부릅니다. 이렇게 부르는 이유는, 저자의 프로젝트에선 빌드하고 작동시킨 후 체크하기 때문이지요.&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[클린 코드 스터디 (8): 경계]]></title><description><![CDATA[2023년 1월부터 시작한 클린 코드 독파 스터디 후, 매 모임 전 준비하는 게시글을 공유합니다. 이 글은 8장, 경계에 대해 설명합니다.]]></description><link>https://blog.s3ich4n.me/books/clean-code/2023-02-03-pt08</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/clean-code/2023-02-03-pt08</guid><pubDate>Fri, 03 Feb 2023 22:53:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;8-경계&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#8-%EA%B2%BD%EA%B3%84&quot; aria-label=&quot;8 경계 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;8. 경계&lt;/h1&gt;
&lt;p&gt;업무를 하게 된다면 패키지를 구매하거나 오픈소스를 이용하여 개발하곤 합니다. 회사가 크다면 사내 다른 팀이 제공하는 컴포넌트를 사용하지요. 외부 코드를 자신의 조직 코드에 잘 통합해야 합니다. 그 경계를 잘 구별하는 방안에 대해 살펴봅시다.&lt;/p&gt;
&lt;h2 id=&quot;외부-코드-사용하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%99%B8%EB%B6%80-%EC%BD%94%EB%93%9C-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0&quot; aria-label=&quot;외부 코드 사용하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;외부 코드 사용하기&lt;/h2&gt;
&lt;p&gt;인터페이스를 제공하는 측은 적용성을 최대한으로 구성합니다. 쓰는 사람은 자신에게 맞는 기능이 있길 바라지요. 그렇기 때문에, 원치 않은 기능을 사용할 수도 있게 됩니다.&lt;/p&gt;
&lt;p&gt;따라서 외부 인터페이스 조차도 언제든 변할 수도 있음을 인지하고, 이를 클래스안에 숨겨서 필요한 기능만 노출시키면 제어권을 “나”에게 옮길 수 있습니다.&lt;/p&gt;
&lt;h2 id=&quot;경계-살피고-익히기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B2%BD%EA%B3%84-%EC%82%B4%ED%94%BC%EA%B3%A0-%EC%9D%B5%ED%9E%88%EA%B8%B0&quot; aria-label=&quot;경계 살피고 익히기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;경계 살피고 익히기&lt;/h2&gt;
&lt;p&gt;외부 라이브러리를 가져오면 빠르게 기능개발을 할 수 있지요. 만약 이 패키지를 사용하고 싶으면 어디서 어떻게 시작하는게 좋을까요?&lt;/p&gt;
&lt;p&gt;타 라이브러리를 가져왔지만 쓰기 힘든 경우를 생각해봅시다. 배우고, 제대로 쓰고 있는지도 파악해야하고, 내 버그인지 라이브러리의 버그인지 쫓아갈 때도 있습니다.&lt;/p&gt;
&lt;p&gt;이러한 기능에 대해 빠르게 익히는 방안을 책에선 ‘학습 테스트’&lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt; 라는 용어로 소개합니다. 마찬가지로 TDD로 작업합니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;제대로 도는 방법을 캐치합니다.&lt;/li&gt;
&lt;li&gt;제대로 쓰는 방법을 캐치합니다(구글 검색, 문서 확인, 로직 확인, 테스트).&lt;/li&gt;
&lt;li&gt;필요한 로직을 캡슐화하고 처리합니다. 그럼 나머지 로직에서는 라이브러리가 뭐하는지 몰라도 됩니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;학습-테스트는-공짜-이상이다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%95%99%EC%8A%B5-%ED%85%8C%EC%8A%A4%ED%8A%B8%EB%8A%94-%EA%B3%B5%EC%A7%9C-%EC%9D%B4%EC%83%81%EC%9D%B4%EB%8B%A4&quot; aria-label=&quot;학습 테스트는 공짜 이상이다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;학습 테스트는 공짜 이상이다&lt;/h2&gt;
&lt;p&gt;학습 테스트와 맞바꾸어야 하는 cost는 없습니다. 쓰려면 API를 배워야 하니까요. 오히려 필요한 지식만 확보하는 방법입니다. 이해도를 확실히 올려줍니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;사용하는 라이브러리의 새 버전이 나오면 학습 테스트를 돌려서, 내가 원하는 기능이 제대로 도는지 확인하면 됩니다.&lt;/li&gt;
&lt;li&gt;라이브러리가 예상대로 도는지 검증할 수 있습니다. 일단 통합된 상태의 코드를 보더라도, 학습 테스트를 통해 쉽게 업데이트를 고려해볼 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;아직-존재하지-않는-코드를-사용하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%95%84%EC%A7%81-%EC%A1%B4%EC%9E%AC%ED%95%98%EC%A7%80-%EC%95%8A%EB%8A%94-%EC%BD%94%EB%93%9C%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0&quot; aria-label=&quot;아직 존재하지 않는 코드를 사용하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;아직 존재하지 않는 코드를 사용하기&lt;/h2&gt;
&lt;p&gt;경계의 또다른 유형은 아는 코드와 모르는 코드를 분리하는 경계입니다. 이는 필요 이상으로 다른 코드를 알 수없는 경우, 아직 구현되지 않은 코드에 대해 생각할 필요가 있는 경우를 의미합니다.&lt;/p&gt;
&lt;p&gt;아직 구현되지 않은 부분에 대한 공통적으로 필요한 경계를 생각하고, 그 내용을 추상화하여 이를 통해 대화하면 구현하는 쪽이 인터페이스를 통제하게 됩니다.&lt;/p&gt;
&lt;p&gt;ADAPTER 패턴을 통해 구현할 수도 있고, Mock 객체를 적절히 이용하여 테스트할 수도 있습니다.&lt;/p&gt;
&lt;h2 id=&quot;깨끗한-경계&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B9%A8%EB%81%97%ED%95%9C-%EA%B2%BD%EA%B3%84&quot; aria-label=&quot;깨끗한 경계 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;깨끗한 경계&lt;/h2&gt;
&lt;p&gt;통제할 수 없는 코드를 사용할 때는 변경에 많은 비용이 들지 않도록 합시다.&lt;/p&gt;
&lt;p&gt;이를 위한 방법은 경계에 위치한 코드를 말끔히 분리하는 것입니다. 외부 코드에 휘둘리지 않도록 외부 라이브러리를 직접 호출하지 않고, 간접적으로 작성해봅시다.&lt;/p&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;&lt;a href=&quot;http://www.yes24.com/Product/Goods/12246033&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;테스트 주도 개발&lt;/a&gt;의 222-237쪽을 참고하십시오.&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[클린 코드 스터디 (7): 오류 처리]]></title><description><![CDATA[2023년 1월부터 시작한 클린 코드 독파 스터디 후, 매 모임 전 준비하는 게시글을 공유합니다. 이 글은 7장, 오류 처리에 대해 설명합니다.]]></description><link>https://blog.s3ich4n.me/books/clean-code/2023-02-03-pt07</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/clean-code/2023-02-03-pt07</guid><pubDate>Fri, 03 Feb 2023 22:51:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;7-오류-처리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#7-%EC%98%A4%EB%A5%98-%EC%B2%98%EB%A6%AC&quot; aria-label=&quot;7 오류 처리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;7. 오류 처리&lt;/h1&gt;
&lt;p&gt;프로그래머라면 예기치 않은 상황에 대비하기 위해 대비해야할 책임이 있습니다. 이는 깨끗한 코드와 오류 처리가 연관있다는 말입니다. 따라서 오류를 체계적으로 잘 정리할 필요가 있겠습니다.&lt;/p&gt;
&lt;h2 id=&quot;오류-코드보단-예외를-사용하자&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%98%A4%EB%A5%98-%EC%BD%94%EB%93%9C%EB%B3%B4%EB%8B%A8-%EC%98%88%EC%99%B8%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EC%9E%90&quot; aria-label=&quot;오류 코드보단 예외를 사용하자 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;오류 코드보단 예외를 사용하자&lt;/h2&gt;
&lt;p&gt;옛날 프로그래밍 언어에는 예외를 제공하지 않아서 에러코드로 처리했다고 합니다. 문제가 발생하면 에러코드도 함께 확인했어야 했죠. 하지만, 이제는 다릅니다. 로직과 오류처리 코드를 분리할 수 있습니다.&lt;/p&gt;
&lt;h2 id=&quot;try-catch-finally-구문부터-쓰자&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#try-catch-finally-%EA%B5%AC%EB%AC%B8%EB%B6%80%ED%84%B0-%EC%93%B0%EC%9E%90&quot; aria-label=&quot;try catch finally 구문부터 쓰자 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;try-catch-finally 구문부터 쓰자&lt;/h2&gt;
&lt;p&gt;이 구문을 사용하면 예외를 통해 로직이 실행되는 문제의 범위를 지정할 수 있습니다. &lt;code class=&quot;language-text&quot;&gt;try&lt;/code&gt; 구문에서 문제가 생기면 실행중단 후 &lt;code class=&quot;language-text&quot;&gt;catch&lt;/code&gt; 블록으로 로직을 옮길 수 있습니다.&lt;/p&gt;
&lt;p&gt;트랜잭션과 비슷하다고 할 수 있겠습니다. 이 구문을 통해 프로그램의 상태를 일관성있게 유지하는 것이 목표이기 때문입니다. 그러므로 예외가 발생할 수 있는 로직은 try-catch-finally 구문 안에 배치하는 편이 좋습니다.&lt;/p&gt;
&lt;p&gt;이 경우에는 &lt;a href=&quot;https://docs.python.org/3/library/unittest.html#unittest.TestCase.assertRaises&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;assertRaises()&lt;/a&gt; 를 사용해서 TDD를 구현하면 되겠지요.&lt;/p&gt;
&lt;h2 id=&quot;미확인unchecked-예외를-사용하자-java-이야기입니다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AF%B8%ED%99%95%EC%9D%B8unchecked-%EC%98%88%EC%99%B8%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EC%9E%90-java-%EC%9D%B4%EC%95%BC%EA%B8%B0%EC%9E%85%EB%8B%88%EB%8B%A4&quot; aria-label=&quot;미확인unchecked 예외를 사용하자 java 이야기입니다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;미확인(unchecked) 예외를 사용하자 (Java 이야기입니다)&lt;/h2&gt;
&lt;p&gt;옛날 자바는 메소드 선언 시 메소드가 반환할 예외를 모두 열거했습니다. 메소드가 반환하는 예외는 메소드 유형의 일부였습니다. 코드가 메소드를 사용하는 방식이 메소드 선언과 맞지 않으면 컴파일도 못했다고 합니다.&lt;/p&gt;
&lt;p&gt;그렇지만 확인된 예외를 사용하지 않게된 이유는 아래와 같습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;OCP 를 위반합니다. 확인된 예외를 던졌는데 catch 블록이 세 단계 위에 있다면 그 사이 메소드 모두가 선언부에 해당 예외를 정의해야 합니다.
→하위 단계에서 코드를 고치면 상위 단계 메소드를 모두 고치고 새로 빌드한 후 배포해야한다는 말입니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이 글들을 먼저 읽어보시는 것을 추천드립니다. &lt;a href=&quot;https://www.geeksforgeeks.org/checked-vs-unchecked-exceptions-in-java/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Checked Exceptions v. Unchecked Exceptions 기본 설명&lt;/a&gt; , &lt;a href=&quot;https://velog.io/@sangmin7648/%EB%8B%B9%EC%8B%A0%EC%9D%98-Checked-Exception%EC%9D%80-%ED%95%84%EC%9A%94-%EC%97%86%EB%8B%A4#1-openclosed-%EC%9B%90%EC%B9%99%EC%9D%98-%EC%9C%84%EB%B0%B0&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Checked Exception이 꺼려지는 이유에 대한 국내 아티클&lt;/a&gt; 을 소개합니다.&lt;/p&gt;
&lt;p&gt;정리해보자면 자바의 설계상 안전한 소프트웨어를 구현하기 위한 도구였으나 그렇게 되지 못했다 라고 이해했습니다.&lt;/p&gt;
&lt;h2 id=&quot;예외에-의미를-제공하라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%98%88%EC%99%B8%EC%97%90-%EC%9D%98%EB%AF%B8%EB%A5%BC-%EC%A0%9C%EA%B3%B5%ED%95%98%EB%9D%BC&quot; aria-label=&quot;예외에 의미를 제공하라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;예외에 의미를 제공하라&lt;/h2&gt;
&lt;p&gt;예외를 던질때는 호출스택 뿐 아니라, 오류 메시지에 적절한 정보를 담을 필요가 있습니다. 가능하다면 앱이 로그를 찍어서 디버깅하기 편하기 만들어줍니다.&lt;/p&gt;
&lt;h2 id=&quot;호출자를-고려해-예외-클래스를-정의하라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%98%B8%EC%B6%9C%EC%9E%90%EB%A5%BC-%EA%B3%A0%EB%A0%A4%ED%95%B4-%EC%98%88%EC%99%B8-%ED%81%B4%EB%9E%98%EC%8A%A4%EB%A5%BC-%EC%A0%95%EC%9D%98%ED%95%98%EB%9D%BC&quot; aria-label=&quot;호출자를 고려해 예외 클래스를 정의하라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;호출자를 고려해 예외 클래스를 정의하라&lt;/h2&gt;
&lt;p&gt;애플리케이션 단에서는 오류를 잘 잡을 궁리를 해야합니다.&lt;/p&gt;
&lt;p&gt;외부 라이브러리에서 던지는 모든 에러를 메인 로직에서 모두 캐치하려고 할 것이 아니라, 호출하는 라이브러리를 감싸서 거기서 발생하는 모든 에러를 wrapping 하는 편이 훨씬 깔끔합니다. 이 기법의 장점은 아래와 같습니다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;외부 라이브러리 API의 예외를 wrapper 클래스에서 처리할 수 있습니다.&lt;/li&gt;
&lt;li&gt;라이브러리를 갈아타도 코드 변경에 대한 비용이 적습니다.&lt;/li&gt;
&lt;li&gt;특정 라이브러리에 발목잡히지 않습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;정상-흐름을-정의하라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A0%95%EC%83%81-%ED%9D%90%EB%A6%84%EC%9D%84-%EC%A0%95%EC%9D%98%ED%95%98%EB%9D%BC&quot; aria-label=&quot;정상 흐름을 정의하라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;정상 흐름을 정의하라&lt;/h2&gt;
&lt;p&gt;상기 이야기대로 코드를 짜더라도, 로직 중단이 적합하지 않을 때가 있습니다. 이럴 땐 리팩토링에 나오는 SPECIAL CASE PATTERN이 적합합니다&lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;일단 원하는 로직을 풀어둡시다.&lt;/li&gt;
&lt;li&gt;특수사례를 클래스 혹은 객체 안에서 해소하게 묶고 결과를 리턴하게 만듭니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;null을-리턴하지-마라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#null%EC%9D%84-%EB%A6%AC%ED%84%B4%ED%95%98%EC%A7%80-%EB%A7%88%EB%9D%BC&quot; aria-label=&quot;null을 리턴하지 마라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;null&lt;/code&gt;을 리턴하지 마라&lt;/h2&gt;
&lt;p&gt;악명높은 &lt;code class=&quot;language-text&quot;&gt;NullPointerException&lt;/code&gt;이 어디서 터질지 캐치하기 힘든 로직을 짜지않기를 주문하는 글입니다. 대체 어디서 온 &lt;code class=&quot;language-text&quot;&gt;null&lt;/code&gt; 인지 알 수 없도록 코드를 짜지 않고, 이에 대한 해결책으로 앞서말한 SPECIAL CASE PATTERN을 다시 소개합니다.&lt;/p&gt;
&lt;h2 id=&quot;null을-전달하지-마라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#null%EC%9D%84-%EC%A0%84%EB%8B%AC%ED%95%98%EC%A7%80-%EB%A7%88%EB%9D%BC&quot; aria-label=&quot;null을 전달하지 마라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;null&lt;/code&gt;을 전달하지 마라&lt;/h2&gt;
&lt;p&gt;마찬가지로, &lt;code class=&quot;language-text&quot;&gt;null&lt;/code&gt;을 메소드로 전달하는 것은 더 악질이라고 합니다. 진짜 어디서 문제가 발생할지 잡기 더 힘들 것으로 보입니다… 저자는 해결책으로 아래 내용을 소개합니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;안좋은 케이스에 대해 새 Exception 을 만들고, 안좋은 케이스를 맞닥뜨렸을 때 이를 사용하는 것을 권합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;assert&lt;/code&gt; 구문을 사용해서 아예 Exception을 발생시킵니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;아예 &lt;code class=&quot;language-text&quot;&gt;null&lt;/code&gt;을 못받도록 하는 것이 합리적이라고 합니다.&lt;/p&gt;
&lt;h2 id=&quot;결론&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B2%B0%EB%A1%A0&quot; aria-label=&quot;결론 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;결론&lt;/h2&gt;
&lt;p&gt;읽기 좋은 코드 뿐 아니라 안정성 있는 코드 또한 고려해야합니다. 오류처리를 프로그램 논리와 분리하여 관심사를 각각 분리하고 이를 통해 로직(에러든 본디 로직이든)에 집중할 수 있도록 합시다.&lt;/p&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;상세한 내용은 리팩토링 개정 2판의 ‘10.5 - 특이 케이스 추가하기’ 를 참고하십시오.&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[클린 코드 스터디 (6): 객체와 자료구조]]></title><description><![CDATA[2023년 1월부터 시작한 클린 코드 독파 스터디 후, 매 모임 전 준비하는 게시글을 공유합니다. 이 글은 6장, 객체와 자료 구조에 대해 설명합니다.]]></description><link>https://blog.s3ich4n.me/books/clean-code/2023-01-27-pt06</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/clean-code/2023-01-27-pt06</guid><pubDate>Fri, 27 Jan 2023 23:11:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;6-객체와-자료-구조&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#6-%EA%B0%9D%EC%B2%B4%EC%99%80-%EC%9E%90%EB%A3%8C-%EA%B5%AC%EC%A1%B0&quot; aria-label=&quot;6 객체와 자료 구조 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;6. 객체와 자료 구조&lt;/h1&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;private&lt;/code&gt; 값으로 쓰기로 한 변수에 대해 &lt;code class=&quot;language-text&quot;&gt;public&lt;/code&gt; 하게 마구잡이로 접근하는 것은, 캡슐화를 무색하게 만듭니다.&lt;/p&gt;
&lt;h2 id=&quot;자료-추상화&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9E%90%EB%A3%8C-%EC%B6%94%EC%83%81%ED%99%94&quot; aria-label=&quot;자료 추상화 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;자료 추상화&lt;/h2&gt;
&lt;h3 id=&quot;본문-내용&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%B3%B8%EB%AC%B8-%EB%82%B4%EC%9A%A9&quot; aria-label=&quot;본문 내용 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;본문 내용&lt;/h3&gt;
&lt;p&gt;구현을 외부로 노출하지 않고 철저히 숨깁시다. 인터페이스가 외부에 노출시키는 메소드를 통해 접근하도록 체계를 꾸립시다. 예시를 살펴봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// 구체적으로 구현된 값입니다. 이를 바로 사용하지 말고...&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Point&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; x&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; y&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// ... 이런 식의 인터페이스를 상속하여, 구체적으로 구현한 클래스가 상속하게 합시다.&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// 극좌표계, 직교좌표계 모두 표현할 수 있도록 매핑되어있군요.&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Point&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getX&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;setCartesian&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; x&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; y&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getTheta&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;setPolar&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; r&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; theta&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;아래에 구현된 &lt;code class=&quot;language-text&quot;&gt;Point&lt;/code&gt; 인터페이스를 통해 구현하면, 상속받은 구현체는 직교좌표계로도, 극좌표계로도 사용할 수 있습니다. 두 좌표계 모두에 쓰이는 ‘Point’ 로서의 역할에 충실합니다. 유연하게 코드를 풀어낼 수 있지요.&lt;/p&gt;
&lt;p&gt;추상 인터페이스를 이용하여 사용자가 구현을 모른 채 자료의 핵심을 조작할 수 있어야 클래스로서의 가치를 합니다. 그저 메소드로 구현한다 하여 생기는 것이 아닙니다. 예시를 살펴봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// 추상 인터페이스가 갤런단위에 딱 묶여있습니다!&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Vehicle&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getFuelTankCapacityInGallons&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getGallonsOfGasoline&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// 이를 풀어내봅시다.&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Vehicle&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getPercentFuelRemaining&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;여기서-잠깐-파이썬이라면&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%97%AC%EA%B8%B0%EC%84%9C-%EC%9E%A0%EA%B9%90-%ED%8C%8C%EC%9D%B4%EC%8D%AC%EC%9D%B4%EB%9D%BC%EB%A9%B4&quot; aria-label=&quot;여기서 잠깐 파이썬이라면 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;여기서 잠깐) 파이썬이라면?&lt;/h3&gt;
&lt;p&gt;언어 자체의 특징을 십분 활용하여 ’&lt;em&gt;하면 안되는 짓을 하지말자&lt;/em&gt;’ 형식으로 구현할 수 있을 것입니다. 우선 파이썬에서의 특징 중 일부를 살펴보겠습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;getter, setter를 두지 않고도 &lt;strong&gt;모든 멤버변수에 접근할 수 있습니다&lt;/strong&gt;.
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;__&lt;/code&gt; (밑줄 두개, double under)를 두면 &lt;code class=&quot;language-text&quot;&gt;private&lt;/code&gt; 처리를 하는 것이 아니라, 다른 이름으로 처리됩니다(&lt;a href=&quot;https://peps.python.org/pep-0008/#method-names-and-instance-variables&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;참고링크&lt;/a&gt;).&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;dynamic typing 입니다. 타입에 대한 제한은 ‘쓰기 나름’ 으로 두고, 타입 힌팅을 명확히 하여 제공하는 편이 좋겠습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이런 특징을 토대로 getter, setter를 파이썬스럽게 구현하는 방안은 여러가지가 있습니다. 관심있으시다면, &lt;a href=&quot;https://realpython.com/python-getter-setter/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;참고링크&lt;/a&gt;를 통해 보다 상세한 구현에 대해 확인해보시길 바랍니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;상속을 이용해, 전통적인 getter, setter를 두고 파이썬에서 원래 가능하던 멤버변수 접근에 대해 &lt;code class=&quot;language-text&quot;&gt;Exception&lt;/code&gt;을 발생시킵니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;@property&lt;/code&gt; , &lt;code class=&quot;language-text&quot;&gt;@x.setter&lt;/code&gt; 데코레이터 활용 → 커스텀 로직을 넣고 클래스 내부의 값을 사용하여 보다 적극적으로 로직을 풀어낼 수 있습니다&lt;/li&gt;
&lt;li&gt;디스크립터 활용 → 2에서 반복되는 로직을 빼고 별도의 객체를 만듭니다. 이를 다른 클래스에서 사용하도록 합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;자료객체-비대칭&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9E%90%EB%A3%8C%EA%B0%9D%EC%B2%B4-%EB%B9%84%EB%8C%80%EC%B9%AD&quot; aria-label=&quot;자료객체 비대칭 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;자료/객체 비대칭&lt;/h2&gt;
&lt;p&gt;절차적 접근을 통한 코드와 객체적 접근을 통한 코드의 지향성을 살펴보고, 때에 따라 필요한 점을 잘 선택해야 함을 살펴봅시다.&lt;/p&gt;
&lt;h3 id=&quot;절차적-접근법&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A0%88%EC%B0%A8%EC%A0%81-%EC%A0%91%EA%B7%BC%EB%B2%95&quot; aria-label=&quot;절차적 접근법 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;절차적 접근법&lt;/h3&gt;
&lt;p&gt;각 도형들은 자료구조로서의 역할에 충실합니다. 동작 방식은 Geometry 클래스에서 구현합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Square&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Point&lt;/span&gt; topLeft&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; side&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Rectangle&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Point&lt;/span&gt; topLeft&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; height&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; width&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Circle&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Point&lt;/span&gt; center&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; radius&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Geometry&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;PI&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3.141592&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;area&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Object&lt;/span&gt; shape&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;NoSuchShapeException&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;shape &lt;span class=&quot;token keyword&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Square&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token class-name&quot;&gt;Square&lt;/span&gt; s &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Square&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;shape&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; s&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;side &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; s&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;side&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;shape instance of &lt;span class=&quot;token class-name&quot;&gt;Rectangle&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token class-name&quot;&gt;Rectangle&lt;/span&gt; r &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Rectangle&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;shape&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; r&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;height &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; r&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;width&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;shape instance of &lt;span class=&quot;token class-name&quot;&gt;Circle&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token class-name&quot;&gt;Circle&lt;/span&gt; c &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Circle&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;shape&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;PI&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; c&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;radius &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; c&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;radius&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;NoSuchShapeException&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;만일 둘레를 구하는 등, &lt;strong&gt;새로운 기능&lt;/strong&gt;을 추가하거나 &lt;strong&gt;새로운 도형&lt;/strong&gt;을 추가하려면 Geometry에 속한 클래스를 &lt;strong&gt;모두&lt;/strong&gt; 고쳐야합니다.&lt;/p&gt;
&lt;p&gt;반면 객체지향적 접근법이라면 새 함수를 추가하고 싶을 때 도형 클래스 전부를 고쳐야합니다&lt;sup id=&quot;fnref-1&quot;&gt;&lt;a href=&quot;#fn-1&quot; class=&quot;footnote-ref&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Square&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Shape&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Point&lt;/span&gt; topLeft&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; side&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;area&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; side &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; side&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Rectangle&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Shape&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Point&lt;/span&gt; topLeft&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; height&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; width&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;area&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; height &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; width&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Circle&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Shape&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Point&lt;/span&gt; center&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; radius&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;PI&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3.141592&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;double&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;area&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;PI&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; radius &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; radius&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;둘은 상호보완적입니다. 장단점을 비교해봅시다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;자료구조에 대한 관점에서 보았을 때
&lt;ul&gt;
&lt;li&gt;절차적 코드
&lt;ul&gt;
&lt;li&gt;기존 자료구조를 변경하지 않으면서 새 함수를 추가하기 쉽습니다.&lt;/li&gt;
&lt;li&gt;새로운 함수를 추가하기 어렵습니다. 그러려면 모든 클래스를 고쳐야 합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;객체 지향 코드
&lt;ul&gt;
&lt;li&gt;기존 함수를 변경하지 않으면서 새 클래스를 추가하기 쉽습니다&lt;/li&gt;
&lt;li&gt;새로운 자료구조를 추가하기 어렵습니다. 그러려면 모든 함수를 고쳐야 합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;살펴보았듯 아래와같이 요약할 수 있습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;객체 지향 코드에서 어려운 변경은 절차적인 코드에서 쉬우며, 절차적인 코드에서 어려운 변경은 객체 지향 코드에서 쉽습니다.&lt;/li&gt;
&lt;li&gt;새로운 자료 타입이 필요한 경우에는 클래스와 객체 지향 기법이 적합합니다. 반면 새로운 함수가 필요한 경우라면 절차적 코드와 자료구조가 좀 더 적합합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;때에 따라 잘 풀어나갑시다. 언어가 지향하는 바를 계속 공부해보고 이를 적용하는 식으로 짜면 되지 않을까 합니다. 멀티 패러다임 언어가 나타나는 이유는, 이러한 바를 토대로 필요한 패러다임을 쓰라는 배려가 아닐까 합니다.&lt;/p&gt;
&lt;h2 id=&quot;디미터-법칙&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%94%94%EB%AF%B8%ED%84%B0-%EB%B2%95%EC%B9%99&quot; aria-label=&quot;디미터 법칙 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;디미터 법칙&lt;/h2&gt;
&lt;p&gt;디미터 법칙(Law of Demeter)은 실용주의 프로그래머에서 소개된 하나의 지침이자 휴리스틱입니다. 모듈은 자신이 조작하는 객체의 속사정을 몰라야 한다 라는 내용을 가지고 있습니다. 객체는 자료를 숨기고 함수를 공개하지요. 그렇지 않다는 것은 내부 구조가 드러난다는 뜻입니다.&lt;/p&gt;
&lt;p&gt;디미터 법칙은 “클래스 C의 메소드 f는 다음과 같은 객체의 메소드만 호출하라” 라는 뜻입니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;클래스 C&lt;/li&gt;
&lt;li&gt;f 가 생성한 객체&lt;/li&gt;
&lt;li&gt;f 인수로 넘어온 객체&lt;/li&gt;
&lt;li&gt;C 인스턴스 변수에 저장된 객체&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;위 객체에서 허용된 메소드가 반환하는 객체의 메소드는 호출하면 안 됩니다. 이런식의 코드가, 저자의 관점에서 좋지 못한 예시가 되겠습니다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;final string outputDir = ctxt.getOptions().getScratchDir().getAbsolutePath();&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;이런 코드를 기차 충돌(train wrack)이라고 부른다고 합니다. 아래와 같은 방향으로 나누는 편을 권장합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token class-name&quot;&gt;Options&lt;/span&gt; opts &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; ctxt&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getOptions&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token class-name&quot;&gt;File&lt;/span&gt; scratchDir &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; opts&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getScratchDir&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; outputDir &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; scratchDir&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getAbsolutePath&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;타고 들어가며 얻는 자료구조가 많군요. 이 코드를 쓰는 함수는 많은 객체를 탐색할 줄 안다는 말입니다. 디미터 법칙을 위반하는지 살펴보려면 &lt;code class=&quot;language-text&quot;&gt;ctxt&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;Options&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;ScratchDir&lt;/code&gt;이 객체인지 자료구조인지에 따라 달려있습니다. 객체라면 숨기고, 자료구조라면 내어놓는 편이 좋으니까요.&lt;/p&gt;
&lt;h3 id=&quot;잡종-구조&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9E%A1%EC%A2%85-%EA%B5%AC%EC%A1%B0&quot; aria-label=&quot;잡종 구조 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;잡종 구조&lt;/h3&gt;
&lt;p&gt;이렇게 섞이면 절차적, 객체지향적 개념이 모두 들어가게되고 성급하게 설계하면 둘의 장점만을 취하는 최악의 경우가 생길 것입니다. 이런 구조는 되도록이면 피하는 것이 좋습니다.&lt;/p&gt;
&lt;h3 id=&quot;구조체-감추기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B5%AC%EC%A1%B0%EC%B2%B4-%EA%B0%90%EC%B6%94%EA%B8%B0&quot; aria-label=&quot;구조체 감추기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;구조체 감추기&lt;/h3&gt;
&lt;p&gt;위의 예시 코드를 조금 살펴보면 객체에게 뭔가 하라고 메시지를 주는 편이 좋겠습니다. 맥락을 살펴보니 같은 모듈에서 이 코드를 사용하는 이유가, 추상화 수준을 섞어놓은것이 그 이유였습니다. 그렇다면 적절한 객체에게 작업을 위임하는 것은 어떨까요? 내부구조를 드러내지 않고, 동시에 자신이 몰라도 되는 값이 알아서 처리하게 해주면 될 것입니다.&lt;/p&gt;
&lt;h2 id=&quot;자료-전달-객체&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9E%90%EB%A3%8C-%EC%A0%84%EB%8B%AC-%EA%B0%9D%EC%B2%B4&quot; aria-label=&quot;자료 전달 객체 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;자료 전달 객체&lt;/h2&gt;
&lt;p&gt;위에서 살펴본 자료 구조체는 DTO(Data Transfer Object) 라고도 부르기도 합니다. DB와 통신하거나 소켓에서 받은 메시지의 구문을 분석할 때 유용합니다. 흔히 DB에 저장된 가공되지 않은 정보를 앱 단에서 사용할 객체로 변환할 때 맨 먼저 사용합니다.&lt;/p&gt;
&lt;h3 id=&quot;활성-레코드&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%99%9C%EC%84%B1-%EB%A0%88%EC%BD%94%EB%93%9C&quot; aria-label=&quot;활성 레코드 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;활성 레코드&lt;/h3&gt;
&lt;p&gt;DTO의 특수한 경우입니다. save(), find() 까지 함께 제공합니다. 이 활성 레코드는 DB 테이블이나 다른 소스에서 자료를 직접 변환합니다. 이는 자료구조로 취급하는 것이 마땅합니다. 비즈니스 규칙을 담으면서 내부자료를 숨기는 객체를 따로 생성할 필요가 있습니다.&lt;/p&gt;
&lt;h2 id=&quot;결론&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B2%B0%EB%A1%A0&quot; aria-label=&quot;결론 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;결론&lt;/h2&gt;
&lt;p&gt;객체는 동작을 공개하고 자료를 숨깁니다. 그래서 기존 동작을 변경하지 않으면서 새 객체 타입을 추가하기 쉽습니다. 하지만 기존 객체에 새 동작을 추가하기는 어렵습니다.&lt;/p&gt;
&lt;p&gt;자료 구조는 별 동작 없이 자료를 노출합니다. 그래서 기존 자료 구조에서 새 동작을 추가하기는 쉽습니다. 하지만 기존 함수에 새 자료 구조를 추가하기는 어렵습니다.&lt;/p&gt;
&lt;p&gt;따라서 어떤 시스템을 구현할 때, 새로운 자료 타입을 추가하는 유연성이 필요하다면 객체가 더 적합합니다. 그렇지만 새로운 동작을 추가하는 유연성이 필요하면 자료구조와 절차적 코드가 더 적합합니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-1&quot;&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Visitor_pattern&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;VISITOR 패턴&lt;/a&gt;을 활용하여 풀어낼 수도 있지만, 이런 기법 또한 내부 구조가 VISITOR에 열리게됩니다. 캡슐화 위반이지요. 그리고 상기 살펴본 절차적 프로그램에서 볼 수 있는 구조가 반환됩니다.  &lt;a href=&quot;#fnref-1&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[클린 코드 스터디 (5): 형식 맞추기]]></title><description><![CDATA[2023년 1월부터 시작한 클린 코드 독파 스터디 후, 매 모임 전 준비하는 게시글을 공유합니다. 이 글은 5장, 형식 맞추기에 대해 살펴봅니다.]]></description><link>https://blog.s3ich4n.me/books/clean-code/2023-01-27-pt05</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/clean-code/2023-01-27-pt05</guid><pubDate>Fri, 27 Jan 2023 22:51:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;5-형식-맞추기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#5-%ED%98%95%EC%8B%9D-%EB%A7%9E%EC%B6%94%EA%B8%B0&quot; aria-label=&quot;5 형식 맞추기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;5. 형식 맞추기&lt;/h1&gt;
&lt;p&gt;프로그래머라면 누구든지 코드는 깔끔하고, 일관적이고, 꼼꼼하기를 바랄겁니다. 포맷을 맞추고 따르면 능률은 자연스레 올라갑니다. 필요하다면 도구를 도입하고, 규칙을 맞출 필요가 있습니다.&lt;/p&gt;
&lt;h2 id=&quot;형식을-맞추는-목적&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%98%95%EC%8B%9D%EC%9D%84-%EB%A7%9E%EC%B6%94%EB%8A%94-%EB%AA%A9%EC%A0%81&quot; aria-label=&quot;형식을 맞추는 목적 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;형식을 맞추는 목적&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=114392104&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;코드 컴플리트&lt;/a&gt; 에서는, &lt;a href=&quot;https://andymatuschak.org/prompts/Chase1973.pdf&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Perception in Chess&lt;/a&gt; 라는 논문에 나오는 실험을 소개합니다. 다양한 레벨(초급, 중급, 마스터)의 체스 선수에게 여러 방향에서 말의 위치를 기억하게 하는 시험이었습니다. 말이 무작위로 움직인다면 초보자들도 쉽게 기억하지만, 말의 위치가 실제 게임에서 일어날 법한 논리적 순서(일관성, 패턴)을 지킨다면 체스 마스터가 압도적인 능률을 보였습니다.&lt;/p&gt;
&lt;p&gt;이처럼, 소프트웨어에서도 업계에서 통용되는 스타일의 코드를 작성한다면 프로그래머들끼리 코드를 보았을 때 논리적 순서를 보다 빠르게 캐치할 수 있을 것입니다.&lt;/p&gt;
&lt;p&gt;따라서, 저자는 처음 잡아놓은 구현 스타일과 가독성 수준을 지속적으로 유지해야 스타일과 규율대로 코드가 유지될 것임을 말합니다. 그러면 원활한 소통을 장려하는 코드 형식을 살펴봅시다.&lt;/p&gt;
&lt;h2 id=&quot;적절한-행-길이를-유지하라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A0%81%EC%A0%88%ED%95%9C-%ED%96%89-%EA%B8%B8%EC%9D%B4%EB%A5%BC-%EC%9C%A0%EC%A7%80%ED%95%98%EB%9D%BC&quot; aria-label=&quot;적절한 행 길이를 유지하라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;적절한 행 길이를 유지하라&lt;/h2&gt;
&lt;p&gt;책의 도표대로 자바 오픈소스의 파일 길이 분포와 로그배율을 살펴보면 &lt;code class=&quot;language-text&quot;&gt;FitNesse&lt;/code&gt; 의 코드는 평균적으로 65줄, 길면 400줄, 짧으면 6줄입니다. &lt;code class=&quot;language-text&quot;&gt;JUnit&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;Time and Money&lt;/code&gt;의 길이는 500줄을 넘지 않으며, 대다수가 200줄 미만입니다. 일반적으로 큰 파일이 작은 파일보다 이해하기 쉽습니다. 동감합니다!&lt;/p&gt;
&lt;h3 id=&quot;신문기사처럼-작성하라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%8B%A0%EB%AC%B8%EA%B8%B0%EC%82%AC%EC%B2%98%EB%9F%BC-%EC%9E%91%EC%84%B1%ED%95%98%EB%9D%BC&quot; aria-label=&quot;신문기사처럼 작성하라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;신문기사처럼 작성하라&lt;/h3&gt;
&lt;p&gt;내용은 두괄식으로, 파일 이름은 헤드라인처럼 씁시다.&lt;/p&gt;
&lt;h3 id=&quot;개념은-빈-행으로-분리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B0%9C%EB%85%90%EC%9D%80-%EB%B9%88-%ED%96%89%EC%9C%BC%EB%A1%9C-%EB%B6%84%EB%A6%AC&quot; aria-label=&quot;개념은 빈 행으로 분리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;개념은 빈 행으로 분리&lt;/h3&gt;
&lt;p&gt;기능 따라서 개행만 해도 보는이가 훨씬 편하게 볼 수 있습니다. 코드의 덩어리를 논리단위대로 보기 쉽게 묶어봅시다.&lt;/p&gt;
&lt;h3 id=&quot;세로-밀집도&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%84%B8%EB%A1%9C-%EB%B0%80%EC%A7%91%EB%8F%84&quot; aria-label=&quot;세로 밀집도 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;세로 밀집도&lt;/h3&gt;
&lt;p&gt;비슷한 코드는 가까이 붙여둡시다. 불필요한 주석이 코드끼리 붙어있는 것을 방해하게 하지 맙시다.&lt;/p&gt;
&lt;h3 id=&quot;수직-거리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%88%98%EC%A7%81-%EA%B1%B0%EB%A6%AC&quot; aria-label=&quot;수직 거리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;수직 거리&lt;/h3&gt;
&lt;p&gt;프로그램을 작성하노라면, 작성한 코드에 대해 이 함수 저 함수 왔다갔다 하느라 헷갈렸던 경험이 있을겁니다. 서로 붙어있는 개념의 코드는 최대한 가까이 둡시다.&lt;/p&gt;
&lt;h2 id=&quot;가로-형식-맞추기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B0%80%EB%A1%9C-%ED%98%95%EC%8B%9D-%EB%A7%9E%EC%B6%94%EA%B8%B0&quot; aria-label=&quot;가로 형식 맞추기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;가로 형식 맞추기&lt;/h2&gt;
&lt;p&gt;가로로 80자를 넘기지 않는 관습은 적용할만합니다. 120자 정도까지도 용인할 만 합니다만 그 이상 긴 것은 너무 길다는 생각이 듭니다.&lt;/p&gt;
&lt;p&gt;솔직히 여기 나오는 규정은 각 언어별로 좋은 포맷팅 기법을 다르는 것이 좋다는 생각이 들었습니다. 파이썬을 즐겨쓰는 분이라면 &lt;a href=&quot;https://peps.python.org/pep-0008/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;PEP 8&lt;/a&gt; 을 기반으로 한 각종 포매터들이 떠오르실겁니다.&lt;/p&gt;
&lt;h2 id=&quot;팀-규칙&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%8C%80-%EA%B7%9C%EC%B9%99&quot; aria-label=&quot;팀 규칙 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;팀 규칙&lt;/h2&gt;
&lt;p&gt;팀에 속한다면 규칙을 따르는 것이 좋겠습니다. 하나의 규칙을 세울 때 최대한 일관적인 생각을 가지고 이를 유지하면, 로직에 집중할 힘이 생길 것입니다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[PEP 공부해보기 - PEP 333, PEP 3333에 대하여 (1)]]></title><description><![CDATA[PEP 시리즈 - PEP 333, PEP 3333 을 탐구합니다.]]></description><link>https://blog.s3ich4n.me/devlog/python/2023-01-22-probing-pep-333-3-wsgi-and-asgi-pt01</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/python/2023-01-22-probing-pep-333-3-wsgi-and-asgi-pt01</guid><pubDate>Sun, 22 Jan 2023 23:57:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;시리즈-안내&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%8B%9C%EB%A6%AC%EC%A6%88-%EC%95%88%EB%82%B4&quot; aria-label=&quot;시리즈 안내 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;시리즈 안내&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;PEP 333&lt;/li&gt;
&lt;li&gt;PEP 249&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;연재-안내&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%97%B0%EC%9E%AC-%EC%95%88%EB%82%B4&quot; aria-label=&quot;연재 안내 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;연재 안내&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;PEP 333 (1)&lt;/li&gt;
&lt;li&gt;PEP 333 (2)&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;들어가며&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0&quot; aria-label=&quot;들어가며 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;들어가며&lt;/h1&gt;
&lt;p&gt;이번 시리즈에서는 파이썬에서 사용하는 웹 프레임워크 인터페이스의 근본부터 이해하고, 이에 대한 이해를 통해 사용하는 프레임워크가 어떤 식으로 작성되었나 이해해보고자 합니다.&lt;/p&gt;
&lt;p&gt;따라서 모든 내용을 살펴보려는 것이 아니라, 필요한 사항에 대해 PEP 문서상의 내용을 참고하여 작성하는 것이 이번 글의 목표입니다.&lt;/p&gt;
&lt;p&gt;글에 앞서, WSGI는 어디까지 살펴보면 되는 것인지 이 그림을 통해 돌아봅시다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/372de2bba708d50f0ea0962afc2e0754/f6a84/001_wsgi_ianb.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 70.83333333333333%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAB7CAAAewgFu0HU+AAACJ0lEQVQoz22S2ZKbMBBF/f8/lae8ZJuxPRODjdlBgARIAqG1pZSXStVMcl+7TnfdU73DmCTXFCGUF3k/YOdc+JhhwOu6hhC0mxv9pUZdUVSP0c6H4Jw1xllrPmEO4PXwluaFDz6EoLzZ63JilODxCYOibCbgOIClM5VSWmsfM7GJLM0545iQqm62bfu0fRe2TuDv2pQza9ZFJkkaxZcQgr8d8yDMSCY8knGcpFIQPIB38Ky2U9Zd0vzl+Du6JkRypQdrqbZUbwvv+bZufO0IaRnHjBO+IO+NdsaAecLt2F+q5HjN0diHoMAbH3TfVO/7E2UUvAWA4L3WphmyWXTaWwv2LuzuYhXlcf++8FUJvRW9dDeD4MHfEsDD5tUkaNFWQm8Pf/fOIRDSYXSt5Bg3WZEWbVUdUFLh5m83C5YarsD8IywExliHuo4RYVSD2ryuSjrUcqwXQimdpikRPdK0bdpvP34WRXnX6Z8wX5ZpHJkWp60/5skpz/Zzla+422hV1Zc8f8elAjfNNC9LtizKaKkVAOx88I81GuwGtu67rCqHaSJ6PeDi6/l4vETH+HTG1bkpDl12qlOm1lkyKvjuw0s5F58vUZKg/ubsugxvKH+J31+SUzzVvaQNJ1lXk2Vup44s0wcYwEkplVL9MERRLMU2LjPiJEHFqU5/lfFrm9Rtc7xEr9HbJOZd+F+MMdM8G2uU0cpqJvhAR8znUTAuVzT21yLTzvwBCTYXz27iLfgAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/372de2bba708d50f0ea0962afc2e0754/8ac56/001_wsgi_ianb.webp 240w,
/static/372de2bba708d50f0ea0962afc2e0754/d3be9/001_wsgi_ianb.webp 480w,
/static/372de2bba708d50f0ea0962afc2e0754/e46b2/001_wsgi_ianb.webp 960w,
/static/372de2bba708d50f0ea0962afc2e0754/f992d/001_wsgi_ianb.webp 1440w,
/static/372de2bba708d50f0ea0962afc2e0754/e5b5c/001_wsgi_ianb.webp 1629w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/372de2bba708d50f0ea0962afc2e0754/8ff5a/001_wsgi_ianb.png 240w,
/static/372de2bba708d50f0ea0962afc2e0754/e85cb/001_wsgi_ianb.png 480w,
/static/372de2bba708d50f0ea0962afc2e0754/d9199/001_wsgi_ianb.png 960w,
/static/372de2bba708d50f0ea0962afc2e0754/07a9c/001_wsgi_ianb.png 1440w,
/static/372de2bba708d50f0ea0962afc2e0754/f6a84/001_wsgi_ianb.png 1629w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/372de2bba708d50f0ea0962afc2e0754/d9199/001_wsgi_ianb.png&quot;
            alt=&quot;이런 구성이라고 보시면 됩니다. WSGI와 HTTP 프로토콜의 흐름에 집중해주세요&quot;
            title=&quot;이런 구성이라고 보시면 됩니다. WSGI와 HTTP 프로토콜의 흐름에 집중해주세요&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;이런 구성이라고 보시면 됩니다. WSGI와 HTTP 프로토콜의 흐름에 집중해주세요&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;h1 id=&quot;논외로-두려-하는-사항&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%85%BC%EC%99%B8%EB%A1%9C-%EB%91%90%EB%A0%A4-%ED%95%98%EB%8A%94-%EC%82%AC%ED%95%AD&quot; aria-label=&quot;논외로 두려 하는 사항 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;논외로 두려 하는 사항&lt;/h1&gt;
&lt;p&gt;자주 쓰는 CPython 구현체 뿐 아니라 PyPy, Jython, IronPython 등의 파이썬 플랫폼 모두를 아우르는 글이 PEP 입니다만, 거기까지 다룰 자신도 없고 제대로 말씀드리기도 어려울 듯 합니다…&lt;/p&gt;
&lt;p&gt;따라서, CPython 기반으로 작성된 파이썬을 사용한다고 가정하도록 하겠습니다.&lt;/p&gt;
&lt;h1 id=&quot;pep-333-pep-3333&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#pep-333-pep-3333&quot; aria-label=&quot;pep 333 pep 3333 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;PEP 333, PEP 3333&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;웹 서버와 파이썬 웹 앱/프레임워크와의 인터페이스를 제안한 문서입니다.
&lt;ul&gt;
&lt;li&gt;이 문서는 2003년에 최초로 생성되었습니다(!)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Python 3 버전에 맞추어서 새로 나온 PEP 3333을 같이 보도록 하겠습니다.
&lt;ul&gt;
&lt;li&gt;이에 대해선 &lt;a href=&quot;https://mail.python.org/pipermail/python-dev/2010-September/104114.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;귀도 판 로섬의 메일&lt;/a&gt;을 살펴보세요.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;rationale-and-goals&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#rationale-and-goals&quot; aria-label=&quot;rationale and goals permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Rationale and Goals&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;해당 PEP 발표 당시 파이썬도 웹 애플리케이션이 많이 등장했으나, 웹 및 서버-웹 앱의 선택이 한정적이었습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;한편 자바는 &lt;a href=&quot;https://www.geeksforgeeks.org/servlet-api/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;servlet API&lt;/a&gt; 를 통해 어떤 자바 앱이든 웹 서버-웹 앱 간 상호작용이 가능하도록 했습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;그 시절 파이썬은 웹 통신을 위한 구현체가 따로따로 있었습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;예를 들어 아래 구현체들이 있습니다:
&lt;ul&gt;
&lt;li&gt;파이썬으로 작성된 웹서버 (&lt;a href=&quot;https://github.com/lispyclouds/medusa&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Medusa, 아카이브&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;웹 서버에 임베딩되어 쓰이는 형식 (&lt;a href=&quot;https://github.com/grisha/mod_python&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;mod_python, 코드는 관리되나 더이상 업데이트 없음&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;게이트웨이 프로토콜을 통해 파이썬을 호출한 방식 (&lt;a href=&quot;https://www.w3.org/CGI/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;CGI, 정의만 있음&lt;/a&gt;, FastCGI&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;PEP 333은 이런 불편을 덜기 위해 &lt;strong&gt;&lt;em&gt;웹 서버-웹 앱 간의 인터페이스, 즉 WSGI(Python Web Server Gateway Interface)를 제안&lt;/em&gt;&lt;/strong&gt; 한 내용입니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;별도의 WSGI 구현 에 대한 제한을 두어 필요한 사람들이 이를 보고 웹 프레임워크를 만들 수 있게끔 하는 것이 목적입니다.&lt;/li&gt;
&lt;li&gt;WSGI의 구현체는 최대한 단순하면서도 파이썬 기본 라이브러리만을 사용하여 구현해야하고, &lt;code class=&quot;language-text&quot;&gt;2.2.2&lt;/code&gt;(PEP 333 기준) 버전 이상의 파이썬 버전을 요하지 않습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;요청, 응답에 대한 구현 뿐 아니라 WSGI 기반의 추가적인 &lt;strong&gt;&lt;em&gt;미들웨어(middleware)&lt;/em&gt;&lt;/strong&gt; 구성요소를 만들어 요청, 응답에 필요한 추가적인 작업을 수행할 수 있도록 합니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;단순하고, 견고하고, 느슨하게 결합된 미들웨어로 구성된 프레임워크가 충분히 만들어질 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;specification-overview&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#specification-overview&quot; aria-label=&quot;specification overview permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Specification Overview&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;WSGI 인터페이스는 “서버(혹은 게이트웨이)” 사이드, “앱(혹은 프레임워크) 사이드” 가 있습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;서버 사이드는 &lt;code class=&quot;language-text&quot;&gt;Callable&lt;/code&gt; 객체[1]를 호출합니다. 이 객체는 앱 사이드에서 제공하는 값입니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Callable 객체가 어떻게 제공되는지는 서버/게이트웨이가 정하기 나름입니다.
&lt;ul&gt;
&lt;li&gt;일부 서버 또는 게이트웨이는 응용 프로그램 배포자가 서버 또는 게이트웨이의 인스턴스를 만들고
응용 프로그램 개체와 함께 제공하는 짧은 스크립트를 작성해야 한다고 가정합니다.&lt;/li&gt;
&lt;li&gt;다른 서버 및 게이트웨이는 구성 파일 또는 기타 메커니즘을 사용하여 응용 프로그램 개체를 가져오거나 다른 방식으로 가져와야 하는 위치를 지정할 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;서버/게이트웨이, 앱/프레임워크 사이에 존재하는 “미들웨어”라는 것을 구현할 수 있습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;이는 “미들웨어”를 포함하는 서버의 앱처럼, 혹은 애플리케이션에 포함된 서버처럼 쓰일 수도 있습니다.&lt;/li&gt;
&lt;li&gt;확장 API, 컨텐츠 변환, 탐색 등의 기타 유용한 기능을 추가로 제공해줄 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/ad03458fdaf1f7a27872e1f34f07a8a3/45662/002_server-middleware-app.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 54.58333333333334%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAB7CAAAewgFu0HU+AAABdElEQVQoz3WSfW/aMBDG8/0/0rq+qhSoFKYmEDKKByEUx46NY4fYQLBvAk8Iwfr8ddbd7567kwO4kXMOAKZomv5Ow0GIEEonqZTynDorgG+U53k8jMNfgyiOhqMhxvi2JvD9rlo654QQRYHXnEtZCbFWSllr/w9fjuQDvuaHw8HH+/2eMXbOns2OMOOccXbVJRyEK7zyQF3X6A8CgEtz51zgnOv03ipZUVZSSjEpOOfzRfbz6eEjijzw8PL0+tbRRgNAoxshhNbHOEAzNBonBSFSKQDYbDb3z48vndf0czI9ueXL5Y/7u+57P05GE/TJOTfGFKRodBP03nuqVvMsS8bJRxytMJ5l82yRAcB2t/1afVFKrbVc8NE4iYaxNrptD9ZajHFwcqurqjJbQwgxxhwHq8TtCeeLrGmaghTdftc5J5U8wm3b5st8t9/5OkqpX+kKllKq02r+WW/qf59E6+Y0IaFl6clbWWvLshRCSCmFEIyxv1rIcMiim0eTAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/ad03458fdaf1f7a27872e1f34f07a8a3/8ac56/002_server-middleware-app.webp 240w,
/static/ad03458fdaf1f7a27872e1f34f07a8a3/d3be9/002_server-middleware-app.webp 480w,
/static/ad03458fdaf1f7a27872e1f34f07a8a3/e46b2/002_server-middleware-app.webp 960w,
/static/ad03458fdaf1f7a27872e1f34f07a8a3/e97dc/002_server-middleware-app.webp 1410w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/ad03458fdaf1f7a27872e1f34f07a8a3/8ff5a/002_server-middleware-app.png 240w,
/static/ad03458fdaf1f7a27872e1f34f07a8a3/e85cb/002_server-middleware-app.png 480w,
/static/ad03458fdaf1f7a27872e1f34f07a8a3/d9199/002_server-middleware-app.png 960w,
/static/ad03458fdaf1f7a27872e1f34f07a8a3/45662/002_server-middleware-app.png 1410w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/ad03458fdaf1f7a27872e1f34f07a8a3/d9199/002_server-middleware-app.png&quot;
            alt=&quot;미들웨어가 중간에서 요청-응답 사이에 관여합니다&quot;
            title=&quot;미들웨어가 중간에서 요청-응답 사이에 관여합니다&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;미들웨어가 중간에서 요청-응답 사이에 관여합니다&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;음, 번역해보니 이런 내용이 있군요. 추가사항 몇 가지를 더 살펴보고 나서 구현체로 살펴봅시다.&lt;/p&gt;
&lt;h2 id=&quot;문자열-타입에-대해&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AC%B8%EC%9E%90%EC%97%B4-%ED%83%80%EC%9E%85%EC%97%90-%EB%8C%80%ED%95%B4&quot; aria-label=&quot;문자열 타입에 대해 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;문자열 타입에 대해&lt;/h2&gt;
&lt;p&gt;일반적으로 HTTP는 바이트를 처리합니다. 파이썬 3으로 들어서면서, 모든 &lt;code class=&quot;language-text&quot;&gt;str&lt;/code&gt; 타입은 유니코드로 처리됩니다[1]. 애플리케이션 단에서 인코딩/디코딩을 처리해야하며, 서버로부터 왔다갔다하는 타입은 &lt;strong&gt;반드시&lt;/strong&gt; &lt;code class=&quot;language-text&quot;&gt;str&lt;/code&gt; 아니면 &lt;code class=&quot;language-text&quot;&gt;bytes&lt;/code&gt; 여야 합니다. &lt;code class=&quot;language-text&quot;&gt;unicode&lt;/code&gt; 값이 되면 &lt;strong&gt;절대&lt;/strong&gt; 안 됩니다.&lt;/p&gt;
&lt;p&gt;추가로, status 값이나 response header값에 담기는 값은 &lt;code class=&quot;language-text&quot;&gt;start_response()&lt;/code&gt; Callable로 주고받는 데이터에 response 값을 준비하는 시점, 즉 &lt;code class=&quot;language-text&quot;&gt;write(body_data)&lt;/code&gt; Callable의 리턴값입니다. 이 때는 &lt;strong&gt;반드시&lt;/strong&gt; &lt;code class=&quot;language-text&quot;&gt;Latin-1&lt;/code&gt; 포맷(ISO/IEC 8859-1)으로 포매팅 해야합니다.&lt;/p&gt;
&lt;p&gt;따라서 WSGI 스펙에서는 “네이티브” 문자열, “Bytestring” 으로 정의합니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;네이티브 문자열
&lt;ul&gt;
&lt;li&gt;요청/응답의 헤더와 메타데이터로 처리하는 값을 의미합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;str&lt;/code&gt; 타입이어야 합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Bytestring은 요청/응답의 body값에 사용되는 값을 의미합니다.
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;bytes&lt;/code&gt; 타입이어야 합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;applicationframework-사이드&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#applicationframework-%EC%82%AC%EC%9D%B4%EB%93%9C&quot; aria-label=&quot;applicationframework 사이드 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Application/Framework 사이드&lt;/h2&gt;
&lt;p&gt;Application 단은 &lt;strong&gt;두 변수&lt;/strong&gt;를 받는 ‘호출 가능한’ 오브젝트입니다(파이썬 &lt;code class=&quot;language-text&quot;&gt;Callable&lt;/code&gt; 이란 뜻입니다). 실제 객체로서의 오브젝트가 아니라 &lt;code class=&quot;language-text&quot;&gt;__call__&lt;/code&gt; 메소드를 가지고있는 함수, 메소드, 클래스 모두가 될 수 있습니다. 서버단으로부터 오는 호출을 여러 번 계속해서 호출 받을 수 있도록 대비해야합니다.&lt;/p&gt;
&lt;p&gt;애플리케이션/프레임워크 단이라고 해서 실제로 이를 응용하여 개발하는 사람이 알 필요는 없습니다. 이걸 모르게 꽁꽁숨기는게 애플리케이션/프레임워크 사이드 개발자들의 목표죠.&lt;/p&gt;
&lt;p&gt;예시를 살펴봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AppClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot; 클래스를 사용한 구현체를 의미

    AppClass를 호출하는 것은 &quot;해당 객체&quot;를 리턴하는 것을 의미한다.
    이는, 사양에서 요구하는 &quot;앱 Callable&quot;의 iterable 리턴값이다.

    AppClass의 인스턴스를 앱 오브젝트로 대신 쓰려면,
    `__call__` 객체를 구현해야되고
    서버/게이트웨이 에서 쓸 인스턴스를 생성해야한다.

    &quot;&quot;&quot;&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# body 값은 UTF-8 인코딩을 할 수 있도록 해야한다.&lt;/span&gt;
    RES &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;wanna-say: s3ich4n rules! class&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;encode&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; environ&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; start_response&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;environ &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; environ
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;start &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; start_response

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__iter__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        status &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;200 OK&apos;&lt;/span&gt;
        response_headers &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Content-Type&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;text/plain&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Content-Length&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;RES&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;start&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;status&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; response_headers&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;RES&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;environ&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;dictionary 입니다. CGI 환경변수 비슷한 값이라고 합니다.&lt;/li&gt;
&lt;li&gt;자세한 스펙은 &lt;a href=&quot;https://peps.python.org/pep-3333/#environ-variables&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 링크&lt;/a&gt; 를 참고해 주십시오.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;response_header&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;List[Tuple(str, str), ...]&lt;/code&gt; 형식으로 HTTP 헤더값을 추가합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;status&lt;/code&gt; 서버를 통해 리턴해줄 HTTP 상태 코드를 의미합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;어떻게-쓰이나요&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%96%B4%EB%96%BB%EA%B2%8C-%EC%93%B0%EC%9D%B4%EB%82%98%EC%9A%94&quot; aria-label=&quot;어떻게 쓰이나요 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;어떻게 쓰이나요?&lt;/h3&gt;
&lt;p&gt;웹 앱/프레임워크는 데이터를 전달하기 전에 &lt;code class=&quot;language-text&quot;&gt;start_response()&lt;/code&gt; 를 반드시 호출해야 합니다.&lt;/p&gt;
&lt;h2 id=&quot;servergateway-사이드&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#servergateway-%EC%82%AC%EC%9D%B4%EB%93%9C&quot; aria-label=&quot;servergateway 사이드 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Server/Gateway 사이드&lt;/h2&gt;
&lt;p&gt;서버/게이트웨이는 HTTP 클라이언트로부터 수신한 각 요청에 대해 호출 가능한 애플리케이션을 &lt;strong&gt;한 번&lt;/strong&gt; 호출합니다. 이는 애플리케이션으로 향합니다. 예시로, 응용 프로그램 개체를 사용하는 함수로 구현된 간단한 CGI 게이트웨이(&lt;code class=&quot;language-text&quot;&gt;run_with_cgi()&lt;/code&gt;) 함수를 살펴봅시다.&lt;/p&gt;
&lt;p&gt;참고: 기본적으로 포착되지 않은 예외는 &lt;code class=&quot;language-text&quot;&gt;sys.stderr&lt;/code&gt;에 덤프되고 웹 서버에 의해 기록되기 때문에 이 간단한 예제는 오류 처리가 제한되어 있습니다.&lt;/p&gt;
&lt;p&gt;전체 코드는 &lt;a href=&quot;https://github.com/s3ich4n/wsgi_asgi/tree/main/wsgi1&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 곳&lt;/a&gt;의 &lt;code class=&quot;language-text&quot;&gt;server.py&lt;/code&gt; 파일에서 보실 수 있습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;run_with_cgi&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;application&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# environ = {k: unicode_to_wsgi(v) for k, v in os.environ.items()}&lt;/span&gt;
    environ &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;wsgi.input&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; sys&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;stdin&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;buffer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;wsgi.errors&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; sys&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;stderr&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
               &lt;span class=&quot;token string&quot;&gt;&apos;wsgi.version&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;wsgi.multithread&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
               &lt;span class=&quot;token string&quot;&gt;&apos;wsgi.multiprocess&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;wsgi.run_once&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; environ&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;HTTPS&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;off&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;on&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        environ&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;wsgi.url_scheme&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;https&apos;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        environ&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;wsgi.url_scheme&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;http&apos;&lt;/span&gt;

    headers_set &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    headers_sent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        out &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sys&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;stdout&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;buffer&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;not&lt;/span&gt; headers_set&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; AssertionError&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;write() before start_response()&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;not&lt;/span&gt; headers_sent&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;# Before the first output, send the stored headers&lt;/span&gt;
            status&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; response_headers &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; headers_sent&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; headers_set
            out&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;write&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;wsgi_to_bytes&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Status: %s\r\n&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; status&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; header &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; response_headers&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                out&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;write&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;wsgi_to_bytes&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;%s: %s\r\n&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; header&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            out&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;write&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;wsgi_to_bytes&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;\r\n&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        out&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;write&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        out&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;flush&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;start_response&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;status&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; response_headers&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; exc_info&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; exc_info&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; headers_sent&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                    &lt;span class=&quot;token comment&quot;&gt;# Re-raise original exception if headers sent&lt;/span&gt;
                    &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; exc_info&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;with_traceback&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;exc_info&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;finally&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
                exc_info &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;     &lt;span class=&quot;token comment&quot;&gt;# avoid dangling circular ref&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;elif&lt;/span&gt; headers_set&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; AssertionError&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Headers already set!&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        headers_set&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;status&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; response_headers&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;# Note: error checking on the headers should happen here,&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# *after* the headers are set.  That way, if an error&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# occurs, start_response can only be re-called with&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# exc_info set.&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; write

    &lt;span class=&quot;token comment&quot;&gt;# 앱 호출을 &quot;했다&quot; 고 가정하자.&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# iterable 객체가 리턴되고 이를 사용하는 것을 볼 수 있다&lt;/span&gt;
    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; application&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;environ&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; start_response&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; data &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; result&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; data&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;    &lt;span class=&quot;token comment&quot;&gt;# don&apos;t send headers until body appears&lt;/span&gt;
                write&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;not&lt;/span&gt; headers_sent&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            write&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# send headers now if body was empty&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;finally&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;hasattr&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;result&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;close&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            result&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;close&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;어떻게-쓰이나요-1&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%96%B4%EB%96%BB%EA%B2%8C-%EC%93%B0%EC%9D%B4%EB%82%98%EC%9A%94-1&quot; aria-label=&quot;어떻게 쓰이나요 1 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;어떻게 쓰이나요?&lt;/h3&gt;
&lt;p&gt;웹서버는 애플리케이션을 호출하는 것으로 프레임워크/앱에 디스패치 합니다.&lt;/p&gt;
&lt;p&gt;헤더를 만들고, 후술할 &lt;code class=&quot;language-text&quot;&gt;start_response()&lt;/code&gt;를 호출하는 것은 앱/프레임워크의 책임입니다. 그리고 &lt;code class=&quot;language-text&quot;&gt;start_response()&lt;/code&gt;가 리턴하는 &lt;code class=&quot;language-text&quot;&gt;iterable&lt;/code&gt; 값을 빌드합니다.&lt;/p&gt;
&lt;h2 id=&quot;미들웨어-양방향으로-작동하는-컴포넌트&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AF%B8%EB%93%A4%EC%9B%A8%EC%96%B4-%EC%96%91%EB%B0%A9%ED%96%A5%EC%9C%BC%EB%A1%9C-%EC%9E%91%EB%8F%99%ED%95%98%EB%8A%94-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8&quot; aria-label=&quot;미들웨어 양방향으로 작동하는 컴포넌트 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;미들웨어: 양방향으로 작동하는 컴포넌트&lt;/h2&gt;
&lt;p&gt;미들웨어는 서버-애플리케이션의 양방향으로 작용합니다. 미들웨어를 응용프로그램에 통합하기 위해서는, 미들웨어 구성요소가 응용 프로그램인 것 처럼 서버에 제공하고 미들웨어 구성요소가 서버인 것 처럼 응용프로그램을 호출하도록 구성합니다. 말하자면 요청-응답 사이에 넣고싶은 로직을, 미들웨어로 분리하고 요청-응답 사이에 끼워넣는다고 보면 될 것 같네요. 요청시 호출하는 순서, 응답시 호출하는 순서를 &lt;a href=&quot;https://en.wikipedia.org/wiki/Onion_model&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;마치 양파처럼 표현&lt;/a&gt;하여 적용합니다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/1ecc4e86c60ff30f1adbcbfce7e2adde/76157/003_wsgi_as_onion.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBBAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHVbXcPID//xAAbEAEAAQUBAAAAAAAAAAAAAAABAAIDEBESIv/aAAgBAQABBQJ9ylXDouHQT//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABoQAAICAwAAAAAAAAAAAAAAAAEQAEERIXH/2gAIAQEABj8CN1OI6OX/AP/EABsQAQACAwEBAAAAAAAAAAAAAAEAESExURBx/9oACAEBAAE/ISUJY21UIr4V8AWRpHZBxXmuQusk/9oADAMBAAIAAwAAABDjD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABwQAAIDAQADAAAAAAAAAAAAAAERACExQRBRYf/aAAgBAQABPxDVUNJAvi7BkCCgAGyr8ECKtJc1vt7FwAMKF1kJWvbn/9k=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/1ecc4e86c60ff30f1adbcbfce7e2adde/8ac56/003_wsgi_as_onion.webp 240w,
/static/1ecc4e86c60ff30f1adbcbfce7e2adde/d3be9/003_wsgi_as_onion.webp 480w,
/static/1ecc4e86c60ff30f1adbcbfce7e2adde/e46b2/003_wsgi_as_onion.webp 960w,
/static/1ecc4e86c60ff30f1adbcbfce7e2adde/f992d/003_wsgi_as_onion.webp 1440w,
/static/1ecc4e86c60ff30f1adbcbfce7e2adde/882b9/003_wsgi_as_onion.webp 1920w,
/static/1ecc4e86c60ff30f1adbcbfce7e2adde/4c3be/003_wsgi_as_onion.webp 2281w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/1ecc4e86c60ff30f1adbcbfce7e2adde/09b79/003_wsgi_as_onion.jpg 240w,
/static/1ecc4e86c60ff30f1adbcbfce7e2adde/7cc5e/003_wsgi_as_onion.jpg 480w,
/static/1ecc4e86c60ff30f1adbcbfce7e2adde/6a068/003_wsgi_as_onion.jpg 960w,
/static/1ecc4e86c60ff30f1adbcbfce7e2adde/644c5/003_wsgi_as_onion.jpg 1440w,
/static/1ecc4e86c60ff30f1adbcbfce7e2adde/0f98f/003_wsgi_as_onion.jpg 1920w,
/static/1ecc4e86c60ff30f1adbcbfce7e2adde/76157/003_wsgi_as_onion.jpg 2281w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/jpeg&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/1ecc4e86c60ff30f1adbcbfce7e2adde/6a068/003_wsgi_as_onion.jpg&quot;
            alt=&quot;이를 Onion model이라고도 부릅니다&quot;
            title=&quot;이를 Onion model이라고도 부릅니다&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;이를 Onion model이라고도 부릅니다&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;예시를 통해 함께 살펴보시죠.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; wsgiref&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;simple_server &lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; make_server


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Middleware1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; app&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;app &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; app

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__call__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; environ&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; start_response&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# 애플리케이션에 &quot;요청이&quot; 처리되기 전에,&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# 이 미들웨어를 통해 하고싶은 작업을 합니다.&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;before middleware 1 access&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;app&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;environ&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; start_response&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;# 애플리케이션이 처리하고 난 &quot;응답에&quot;,&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# 이 미들웨어를 통해 하고싶은 작업을 합니다.&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;after middleware 1 access&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; response


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Middleware2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; app&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;app &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; app

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__call__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; environ&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; start_response&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# 애플리케이션에 &quot;요청이&quot; 처리되기 전에,&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# 이 미들웨어를 통해 하고싶은 작업을 합니다.&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;before middleware 2 access&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;app&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;environ&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; start_response&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;# 애플리케이션이 처리하고 난 &quot;응답에&quot;,&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# 이 미들웨어를 통해 하고싶은 작업을 합니다.&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;after middleware 2 access&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; response


&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyApp&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__call__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; environ&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; start_response&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        status &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;200 OK&apos;&lt;/span&gt;
        headers &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Content-type&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;text/plain&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
        response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;b&apos;Hello, World!&apos;&lt;/span&gt;
        start_response&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;status&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; headers&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;response&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;


&lt;span class=&quot;token comment&quot;&gt;# 애플리케이션은 아래와 같이 돌도록 설정되었습니다.&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# 미들웨어 2가 가장 바깥쪽에서 요청값을 처리하고, 마지막에 응답값을 수정합니다&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# 미들웨어 1은 미들웨어 2를 거친 후의 요청값을 처리하고, 가장 처음 응답값을 수정합니다&lt;/span&gt;
app &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; MyApp&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
app &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Middleware1&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;app&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
app &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Middleware2&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;app&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 서버는 wsgiref에서 제공하는 makeserver를 사용합시다.&lt;/span&gt;
httpd &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; make_server&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;8800&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; app&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
httpd&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;serve_forever&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;해당 코드를 구동해본 예시는 아래와 같습니다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/27d3fbb341af172ca2f5df87e0b442f7/97806/004_example_of_multi_middlewares.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 57.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB2UlEQVQoz4WTW26kMBREWcpokjRgg3kYG5s2j36lQ2c+sv/NnBGQpJUZRfkoGWTfQ91bJipMj9KBqunJ6444NSTCksqWRFpqe6CfXgn9DR/mTxl3QdsztTmhzWldF0UmXKntkTwPyLwjERtQZI6nROO6C+P0yvP1jWm6UVWBXHmU8ghp2SUNcXpX5Mc/+H7G72d0c/4CfNzV9OOMdyeMHrH1gJItMjVkqUUKSyLa9Xy8Pluitp8x3QXTnimr6d7yO3Dfv5AVnl+/JQ9Piqe4ROSGTC0j0ezikjipSIVea6PKnSiagMi2L3xobTnW+P0zxh1o3YGiDGhzxLoTrTvTmAOq3FPpnroZ3x0ON2x3pW6OFOX4dYbvQN0eqfYz0r6QNFfSqkeUDbIwiMIjioDI/ebQDTO2u+D8M1qf/nPYhevq4jFu2Il21ZJ+Is2m5fzyLswGNPsXtL9sSRfD5wz/BS5pJsteuhV+p6hqJ6raoXKHlO0a/cc9XELZgGGF3wubb2SI+sMb43jF+TNlPSDVfr2PWRGIRUsYbhRV2BwK+6MiN16wdqIuB7SeKIsOlVlK5cnShr7fHH4A459aLseBuh3JVYfMPcnSctoghGUX11R6IFP3X/Inh38BNxd8Yg0rlmAAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/27d3fbb341af172ca2f5df87e0b442f7/8ac56/004_example_of_multi_middlewares.webp 240w,
/static/27d3fbb341af172ca2f5df87e0b442f7/d3be9/004_example_of_multi_middlewares.webp 480w,
/static/27d3fbb341af172ca2f5df87e0b442f7/e46b2/004_example_of_multi_middlewares.webp 960w,
/static/27d3fbb341af172ca2f5df87e0b442f7/f992d/004_example_of_multi_middlewares.webp 1440w,
/static/27d3fbb341af172ca2f5df87e0b442f7/882b9/004_example_of_multi_middlewares.webp 1920w,
/static/27d3fbb341af172ca2f5df87e0b442f7/93a20/004_example_of_multi_middlewares.webp 3538w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/27d3fbb341af172ca2f5df87e0b442f7/8ff5a/004_example_of_multi_middlewares.png 240w,
/static/27d3fbb341af172ca2f5df87e0b442f7/e85cb/004_example_of_multi_middlewares.png 480w,
/static/27d3fbb341af172ca2f5df87e0b442f7/d9199/004_example_of_multi_middlewares.png 960w,
/static/27d3fbb341af172ca2f5df87e0b442f7/07a9c/004_example_of_multi_middlewares.png 1440w,
/static/27d3fbb341af172ca2f5df87e0b442f7/29114/004_example_of_multi_middlewares.png 1920w,
/static/27d3fbb341af172ca2f5df87e0b442f7/97806/004_example_of_multi_middlewares.png 3538w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/27d3fbb341af172ca2f5df87e0b442f7/d9199/004_example_of_multi_middlewares.png&quot;
            alt=&quot;미들웨어 2-1 순으로 요청 전에 준비하고, 1-2 순으로 응답값에 작업합니다.&quot;
            title=&quot;미들웨어 2-1 순으로 요청 전에 준비하고, 1-2 순으로 응답값에 작업합니다.&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;미들웨어 2-1 순으로 요청 전에 준비하고, 1-2 순으로 응답값에 작업합니다.&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;h1 id=&quot;마무리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%88%EB%AC%B4%EB%A6%AC&quot; aria-label=&quot;마무리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;마무리&lt;/h1&gt;
&lt;p&gt;PEP 333 및 3333은 여기까지 살펴보고, 나머지는 실제 WSGI 구현체를 통해 다시 살펴보도록 하겠습니다. 이 후 ASGI까지 함께 살펴보도록 하겠습니다.&lt;/p&gt;
&lt;p&gt;긴 글 읽어주셔서 감사합니다.&lt;/p&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;References&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;[1] &lt;code class=&quot;language-text&quot;&gt;Callable&lt;/code&gt;객체: &lt;code class=&quot;language-text&quot;&gt;__call__()&lt;/code&gt; 메소드를 구현한 객체를 의미합니다.
&lt;ul&gt;
&lt;li&gt;구현은 알아서 하면 되지만, 호출할 때는 어떤 종류의 &lt;code class=&quot;language-text&quot;&gt;Callable&lt;/code&gt;이 호출되었는지 알지 모르게 해야합니다(종속성 제거를 위함).&lt;/li&gt;
&lt;li&gt;해당 콜러블은 자체검사되지 않습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;[2] 처음 PEP 333이 작성되던 시점에는 파이썬 2가 주력이었죠. 그 때는 &lt;code class=&quot;language-text&quot;&gt;str&lt;/code&gt; 타입이 &lt;code class=&quot;language-text&quot;&gt;ASCII&lt;/code&gt;만을 담을 수 있었다고 합니다. &lt;a href=&quot;https://sites.pitt.edu/~naraehan/python2/unicode.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 링크&lt;/a&gt;를 참고해주세요!&lt;/li&gt;
&lt;li&gt;[3] 그림 출처는 &lt;a href=&quot;https://lectureswww.readthedocs.io/5.web.server/wsgi.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 링크&lt;/a&gt;입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[클린 코드 스터디 (4): 주석]]></title><description><![CDATA[2023년 1월부터 시작한 클린 코드 독파 스터디 후, 매 모임 전 준비하는 게시글을 공유합니다. 이 글은 4장, 주석에 대해 설명합니다.]]></description><link>https://blog.s3ich4n.me/books/clean-code/2023-01-13-pt04</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/clean-code/2023-01-13-pt04</guid><pubDate>Fri, 13 Jan 2023 22:52:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;4-주석&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#4-%EC%A3%BC%EC%84%9D&quot; aria-label=&quot;4 주석 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4. 주석&lt;/h1&gt;
&lt;p&gt;잘 달린 주석은 정말 좋은데, 매번 업데이트되어야 하는 주석은 관리가 안 됩니다. 그런 주석은 &lt;em&gt;언젠간&lt;/em&gt; 거짓말을 “하게 됩니다”. 이를 경계해야 합니다. 그런데 저자의 의견은 너무나도 단호합니다:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;코드의 표현력이 풍부하면, 다시 말해 프로그래밍 언어를 치밀하게 사용하여 의도를 명확히 표현한다면, 주석은 &lt;em&gt;거의&lt;/em&gt; 필요없다 할 수 있다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;주석이 점점 거짓말을 하게되는 것은 어쩔 수 없습니다. 코드는 마치 정원처럼 변화하기 때문이지요. 주석까지 함께 신경써서 코드를 짜기는 너무나 어렵고, 한번이라도 놓친다면 주석과 동떨어진 코드가 완성됩니다. 코드만이 &lt;strong&gt;진실&lt;/strong&gt;을 말합니다.&lt;/p&gt;
&lt;p&gt;제 생각에는… &lt;strong&gt;주석을 쓴다면 끝까지 관리&lt;/strong&gt;해야하고 아래에서 살펴볼 “좋은 주석” 사용을 적극 권장하는게 좋지 않을까 합니다. 이런 코드를 지향해야지, 반드시 이렇게 “하라” 는 아니니까요.&lt;/p&gt;
&lt;h2 id=&quot;주석은-나쁜-코드를-보완하지-못한다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A3%BC%EC%84%9D%EC%9D%80-%EB%82%98%EC%81%9C-%EC%BD%94%EB%93%9C%EB%A5%BC-%EB%B3%B4%EC%99%84%ED%95%98%EC%A7%80-%EB%AA%BB%ED%95%9C%EB%8B%A4&quot; aria-label=&quot;주석은 나쁜 코드를 보완하지 못한다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;주석은 나쁜 코드를 보완하지 못한다&lt;/h2&gt;
&lt;p&gt;‘아 별론데…’ 하는 주석보단 차라리 그런 코드를 치우는게 훨씬 낫습니다. 예기치않으면 리팩토링 주석을 달거나 해야겠지요. 정말 최악의 수 겠지요…&lt;/p&gt;
&lt;h2 id=&quot;코드로-의도를-표현하자&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%BD%94%EB%93%9C%EB%A1%9C-%EC%9D%98%EB%8F%84%EB%A5%BC-%ED%91%9C%ED%98%84%ED%95%98%EC%9E%90&quot; aria-label=&quot;코드로 의도를 표현하자 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;코드로 의도를 표현하자&lt;/h2&gt;
&lt;p&gt;코드로 의도를 표현합시다. 코드도 보편적인 로직으로 표현합시다. 새로운 문법을 너무 사용하거나 할 필요는 없을 듯 합니다. 보수적으로 로직을 짜는 편이 좋을 듯 합니다.&lt;/p&gt;
&lt;h2 id=&quot;좋은-주석&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A2%8B%EC%9D%80-%EC%A3%BC%EC%84%9D&quot; aria-label=&quot;좋은 주석 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;좋은 주석&lt;/h2&gt;
&lt;p&gt;이런 주석들은 비교적 괜찮습니다.&lt;/p&gt;
&lt;h3 id=&quot;법적인-용도&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%B2%95%EC%A0%81%EC%9D%B8-%EC%9A%A9%EB%8F%84&quot; aria-label=&quot;법적인 용도 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;법적인 용도&lt;/h3&gt;
&lt;p&gt;저작권 관련 헤더용도의 주석&lt;/p&gt;
&lt;h3 id=&quot;정보제공용-주석&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A0%95%EB%B3%B4%EC%A0%9C%EA%B3%B5%EC%9A%A9-%EC%A3%BC%EC%84%9D&quot; aria-label=&quot;정보제공용 주석 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;정보제공용 주석&lt;/h3&gt;
&lt;p&gt;정말 기본적인 정보를 주석으로 쓰면 되겠습니다만, 함수 이름 자체가 정보인게 낫습니다.&lt;/p&gt;
&lt;p&gt;예를들어, 정규표현식 같은걸 주석으로 풀어주는 것도 좋겠다만, 더 나아가 클래스를 만들고 이를 처리하는 메소드(시각, 날짜를 변환)로 처리하는 편을 권장합니다. 그러면 아예 주석 자체가 필요없어지니까요.&lt;/p&gt;
&lt;h3 id=&quot;의도설명용-주석&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%98%EB%8F%84%EC%84%A4%EB%AA%85%EC%9A%A9-%EC%A3%BC%EC%84%9D&quot; aria-label=&quot;의도설명용 주석 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;의도설명용 주석&lt;/h3&gt;
&lt;p&gt;구현 의도를 설명하거나, 문제 해결에 사용한 로직을 풀어두는 주석. 저자의 의도가 드러납니다.&lt;/p&gt;
&lt;h3 id=&quot;의미를-명료하게-밝히는-주석&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%98%EB%AF%B8%EB%A5%BC-%EB%AA%85%EB%A3%8C%ED%95%98%EA%B2%8C-%EB%B0%9D%ED%9E%88%EB%8A%94-%EC%A3%BC%EC%84%9D&quot; aria-label=&quot;의미를 명료하게 밝히는 주석 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;의미를 명료하게 밝히는 주석&lt;/h3&gt;
&lt;p&gt;거의 안바뀌는 코드(표준 라이브러리, 변경할 수 없는 코드 등)를 설명하려고 주석을 써놓기. 하지만 이 방법보다 더 나은게 있나 살펴봅시다.&lt;/p&gt;
&lt;h3 id=&quot;결과를-경고하는-주석&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B2%B0%EA%B3%BC%EB%A5%BC-%EA%B2%BD%EA%B3%A0%ED%95%98%EB%8A%94-%EC%A3%BC%EC%84%9D&quot; aria-label=&quot;결과를 경고하는 주석 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;결과를 경고하는 주석&lt;/h3&gt;
&lt;p&gt;‘이거 잘못쓰면 안됩니다.’ ‘테스트 케이스를 꺼야합니다.’ 하고 경고하는 주석이 그 예시입니다.&lt;/p&gt;
&lt;h3 id=&quot;todo-주석&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#todo-%EC%A3%BC%EC%84%9D&quot; aria-label=&quot;todo 주석 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;TODO 주석&lt;/h3&gt;
&lt;p&gt;해당 링크를 참고해주세요. 모든 답변이 좋습니다. 저는 특히나 &lt;code class=&quot;language-text&quot;&gt;XXX&lt;/code&gt; 라는 주석 헤더가 FreeBSD에도 쓰였다는 점이 굉장히 인상적이었습니다.&lt;/p&gt;
&lt;h3 id=&quot;중요성-강조-주석&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A4%91%EC%9A%94%EC%84%B1-%EA%B0%95%EC%A1%B0-%EC%A3%BC%EC%84%9D&quot; aria-label=&quot;중요성 강조 주석 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;중요성 강조 주석&lt;/h3&gt;
&lt;p&gt;애매한걸 다시 설명해주는 주석.&lt;/p&gt;
&lt;h3 id=&quot;공개-api에서의-javadocs-혹은-유사한-도구&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B3%B5%EA%B0%9C-api%EC%97%90%EC%84%9C%EC%9D%98-javadocs-%ED%98%B9%EC%9D%80-%EC%9C%A0%EC%82%AC%ED%95%9C-%EB%8F%84%EA%B5%AC&quot; aria-label=&quot;공개 api에서의 javadocs 혹은 유사한 도구 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;공개 API에서의 Javadocs (혹은 유사한 도구)&lt;/h3&gt;
&lt;p&gt;파이썬에서는 Javadocs 같이 문서를 자동으로 생성해주는 도구로 Sphinx라거나 각종 도구가 많습니다. 그렇지만 이런 것들도 관리대상이 되기 때문에 여러모로 주의가 필요합니다…&lt;/p&gt;
&lt;h2 id=&quot;나쁜-주석&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%82%98%EC%81%9C-%EC%A3%BC%EC%84%9D&quot; aria-label=&quot;나쁜 주석 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;나쁜 주석&lt;/h2&gt;
&lt;p&gt;나쁜 주석에 대해 일부 동의하나, 현실적으로 작성할 수 밖에 없는 주석은 분명 있습니다. 이에대한 근본적인 이유를 먼저 설명드리고자 합니다.&lt;/p&gt;
&lt;p&gt;이 게시글을 보는 대부분의 사람은 한국인일 것입니다. 절대다수의 한국인에게 영어는 &lt;strong&gt;제 2 외국어&lt;/strong&gt;입니다. &lt;strong&gt;모국어&lt;/strong&gt;로 풀어진 설명은 외국어로 된 맥락이해의 속도차이가 날 수 밖에 없습니다[^1].&lt;/p&gt;
&lt;p&gt;불필요한 습관은 진실로 지양해야 합니다. 하지만 저는 제 생각과 다른 부분에 더 집중하여 기술하겠습니다.&lt;/p&gt;
&lt;h3 id=&quot;주절거리는-주석&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A3%BC%EC%A0%88%EA%B1%B0%EB%A6%AC%EB%8A%94-%EC%A3%BC%EC%84%9D&quot; aria-label=&quot;주절거리는 주석 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;주절거리는 주석&lt;/h3&gt;
&lt;p&gt;이른바 ‘설명이 덜 된 주석’입니다. 주석을 쓴 당사자는 무슨 뜻인지 알고 표현했는데, 알고봤더니 컨텍스트가 더 필요한 주석이지요. 다른 사람은 이를 이해하기 위해 다른 모듈을 뒤적여야합니다. 그러므로 이런 주석은 주의가 필요하죠.&lt;/p&gt;
&lt;h3 id=&quot;같은-이야기를-중복하는-주석&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B0%99%EC%9D%80-%EC%9D%B4%EC%95%BC%EA%B8%B0%EB%A5%BC-%EC%A4%91%EB%B3%B5%ED%95%98%EB%8A%94-%EC%A3%BC%EC%84%9D&quot; aria-label=&quot;같은 이야기를 중복하는 주석 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;같은 이야기를 중복하는 주석&lt;/h3&gt;
&lt;p&gt;저는 저자의 의견에 동의하지 않습니다. 무의미한 getter, setter 는 백번 양보해서 그럴 수 있다고 쳐도 내용 이해를 위해 어느정도는 필요하다고 생각합니다. 저자의 예시를 보자면, 메소드 내에 사용되는 간단한 영단어에도 이를 설명하는 “중복 주석”은 나쁘다고 합니다.&lt;/p&gt;
&lt;h3 id=&quot;오해할-여지가-있는-주석&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%98%A4%ED%95%B4%ED%95%A0-%EC%97%AC%EC%A7%80%EA%B0%80-%EC%9E%88%EB%8A%94-%EC%A3%BC%EC%84%9D&quot; aria-label=&quot;오해할 여지가 있는 주석 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;오해할 여지가 있는 주석&lt;/h3&gt;
&lt;p&gt;설명이 덜 된 주석은 프로그래머가 놓친 부분을 말해주지 못합니다. 이 경우는 디버깅 포인트를 캐치하기 어렵지요. 동료의 말을 믿고 ‘그런가보다’ 하다보면, 놓친 부분을 의심하지 않게 됩니다. 이것은 작업속도가 길어지는 원인이 될 수 있습니다.&lt;/p&gt;
&lt;h3 id=&quot;의무적으로-다는-주석&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%98%EB%AC%B4%EC%A0%81%EC%9C%BC%EB%A1%9C-%EB%8B%A4%EB%8A%94-%EC%A3%BC%EC%84%9D&quot; aria-label=&quot;의무적으로 다는 주석 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;의무적으로 다는 주석&lt;/h3&gt;
&lt;p&gt;제 생각과 상당부분 대치되는 주장이군요… ‘직관적으로 이해되는 메소드에 대해 주석을 달아둔다’ 에는 동의합니다만, 글쎄요.&lt;/p&gt;
&lt;h3 id=&quot;이력을-기록하는-주석&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%B4%EB%A0%A5%EC%9D%84-%EA%B8%B0%EB%A1%9D%ED%95%98%EB%8A%94-%EC%A3%BC%EC%84%9D&quot; aria-label=&quot;이력을 기록하는 주석 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;이력을 기록하는 주석&lt;/h3&gt;
&lt;p&gt;요즘 개발엔 어지간해선 VCS로 Git을 사용하시니, Git의 &lt;code class=&quot;language-text&quot;&gt;blame&lt;/code&gt; 을 적극 활용합시다. 여담이지만 SVN에도 &lt;code class=&quot;language-text&quot;&gt;blame&lt;/code&gt; 이 있군요… (&lt;a href=&quot;https://svnbook.red-bean.com/en/1.8/svn.ref.svn.c.blame.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;참고링크&lt;/a&gt;)&lt;/p&gt;
&lt;h3 id=&quot;있으나-마나-한-주석&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9E%88%EC%9C%BC%EB%82%98-%EB%A7%88%EB%82%98-%ED%95%9C-%EC%A3%BC%EC%84%9D&quot; aria-label=&quot;있으나 마나 한 주석 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;있으나 마나 한 주석&lt;/h3&gt;
&lt;p&gt;너무 뻔한말은 쓰지 맙시다.&lt;/p&gt;
&lt;p&gt;예외처리에 이게 뭐냐?! 이런 주석을 달지도 맙시다. 차라리 코드를 정리합시다.&lt;/p&gt;
&lt;h3 id=&quot;무서운-잡음&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AC%B4%EC%84%9C%EC%9A%B4-%EC%9E%A1%EC%9D%8C&quot; aria-label=&quot;무서운 잡음 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;무서운 잡음&lt;/h3&gt;
&lt;p&gt;docstring 형식으로 코드에 대한 주석을 남긴다면, 복붙 및 실제 작업할 때 한번 더 유심히 살펴봐야겠습니다.&lt;/p&gt;
&lt;h3 id=&quot;함수나-변수로-표현할-수-있다면-주석을-달지-마라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%95%A8%EC%88%98%EB%82%98-%EB%B3%80%EC%88%98%EB%A1%9C-%ED%91%9C%ED%98%84%ED%95%A0-%EC%88%98-%EC%9E%88%EB%8B%A4%EB%A9%B4-%EC%A3%BC%EC%84%9D%EC%9D%84-%EB%8B%AC%EC%A7%80-%EB%A7%88%EB%9D%BC&quot; aria-label=&quot;함수나 변수로 표현할 수 있다면 주석을 달지 마라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;함수나 변수로 표현할 수 있다면 주석을 달지 마라&lt;/h3&gt;
&lt;p&gt;이 부분이, ‘주석을 없애고 코드로서 표현하라’는 말인 것으로 보입니다. 이런식으로 로직을 풀어내는 것은 코드로 정보를 표현하는 것이니 충분히 의미있다고 봅니다.&lt;/p&gt;
&lt;h3 id=&quot;위치를-표시하는-주석&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9C%84%EC%B9%98%EB%A5%BC-%ED%91%9C%EC%8B%9C%ED%95%98%EB%8A%94-%EC%A3%BC%EC%84%9D&quot; aria-label=&quot;위치를 표시하는 주석 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;위치를 표시하는 주석&lt;/h3&gt;
&lt;p&gt;정말 필요한 위치의 배너가 아닌 이상, 별도의 파일로 분리하거나 최대한 쓰지 않는 방향으로 작성해야겠습니다.&lt;/p&gt;
&lt;h3 id=&quot;닫는-괄호에-다는-주석&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8B%AB%EB%8A%94-%EA%B4%84%ED%98%B8%EC%97%90-%EB%8B%A4%EB%8A%94-%EC%A3%BC%EC%84%9D&quot; aria-label=&quot;닫는 괄호에 다는 주석 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;닫는 괄호에 다는 주석&lt;/h3&gt;
&lt;p&gt;로직을 조금 더 간단하게 풀어봅시다. 혹은 특정 작업을 하는 함수로 더 빼봅시다.&lt;/p&gt;
&lt;h3 id=&quot;주석으로-처리한-코드&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A3%BC%EC%84%9D%EC%9C%BC%EB%A1%9C-%EC%B2%98%EB%A6%AC%ED%95%9C-%EC%BD%94%EB%93%9C&quot; aria-label=&quot;주석으로 처리한 코드 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;주석으로 처리한 코드&lt;/h3&gt;
&lt;p&gt;주석처리 하여 코드를 남기고 잡음을 남기지 말고 지웁시다. 이전 코드는 VCS에게 맡깁시다.&lt;/p&gt;
&lt;h3 id=&quot;html-주석&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#html-%EC%A3%BC%EC%84%9D&quot; aria-label=&quot;html 주석 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;HTML 주석&lt;/h3&gt;
&lt;p&gt;Javadoc, Sphinx같은 도구가 알아서 렌더링하게 만들어야합니다. 이런 주석은 넣으면 안되겠지요.&lt;/p&gt;
&lt;h3 id=&quot;전역-정보&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A0%84%EC%97%AD-%EC%A0%95%EB%B3%B4&quot; aria-label=&quot;전역 정보 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;전역 정보&lt;/h3&gt;
&lt;p&gt;코드 일부분에 시스템의 전반적인 정보를 쓰려고 하면 안 됩니다. 이런 주석을 중요하다고 남겨두었지만, 나중에 유지보수할 때 까먹을 수 있습니다. 그러면 뒤쳐진 정보가 주석으로 남겠죠.&lt;/p&gt;
&lt;h3 id=&quot;너무-많은-정보&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%84%88%EB%AC%B4-%EB%A7%8E%EC%9D%80-%EC%A0%95%EB%B3%B4&quot; aria-label=&quot;너무 많은 정보 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;너무 많은 정보&lt;/h3&gt;
&lt;p&gt;로직과 크게 관련없는 정보는 지양합시다. REST API를 설계하며 REST에 대한 논문링크를 단다거나, 이를 정리해서 올리거나 할 필요는 없지요.&lt;/p&gt;
&lt;h3 id=&quot;모호한-관계&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AA%A8%ED%98%B8%ED%95%9C-%EA%B4%80%EA%B3%84&quot; aria-label=&quot;모호한 관계 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;모호한 관계&lt;/h3&gt;
&lt;p&gt;주석과 코드는 서로 말하는 바가 같아야 합니다. 그렇지 않으면 주석이 잘못 말하고있는지, 코드가 잘못 말하고 있는지 판단할 수가 없습니다.&lt;/p&gt;
&lt;p&gt;[^1] : &lt;a href=&quot;https://www.cambridge.org/core/books/reading-in-a-second-language/D322203A13028A46CD1975578EFDA52C&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;모국어와 외국어 읽기에 대한 연구&lt;/a&gt;에 의하면, ’&lt;em&gt;기술적으로 글을 잘 읽기 위해서는 빠르고도 자동적인 단어 인지와 이해력을 높이기 위한 절과 구조의 빠른 인지를 필요로 한다.&lt;/em&gt;’ 라는 주장입니다. &lt;br /&gt;또한, 아래 논문들은 &lt;em&gt;다른 언어&lt;/em&gt;로 된 글 읽기는 질적으로 다른 지각과 과정 전략을 포함한다고 주장하는 연구입니다. &lt;a href=&quot;https://eric.ed.gov/?id=ED386947&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;참고 1&lt;/a&gt; , &lt;a href=&quot;https://www.jstor.org/stable/329674&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;참고 2&lt;/a&gt;  &lt;/p&gt;</content:encoded></item><item><title><![CDATA[클린 코드 스터디 (3): 함수]]></title><description><![CDATA[2023년 1월부터 시작한 클린 코드 독파 스터디 후, 매 모임 전 준비하는 게시글을 공유합니다. 이 글은 3장, 함수에 대해 설명합니다.]]></description><link>https://blog.s3ich4n.me/books/clean-code/2023-01-13-pt03</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/clean-code/2023-01-13-pt03</guid><pubDate>Fri, 13 Jan 2023 22:51:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;3-함수&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#3-%ED%95%A8%EC%88%98&quot; aria-label=&quot;3 함수 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3. 함수&lt;/h1&gt;
&lt;p&gt;프로그래밍 초창기에는 시스템을 루틴-서브루틴으로 나눴습니다. 포트란 시절에는 시스템을 프로그램, 하위 프로그램, 함수로 나눴습니다. 요즘에는 함수라는 개념만 주로 사용되지요. 이는 프로그래밍의 기본적인 단위로서 수십년간 자리잡았다는 반증이기도 합니다. 그렇다면 좋은 함수를 만들려면 어떻게 해야할지 살펴봅시다.&lt;/p&gt;
&lt;p&gt;예시코드를 보니 뭔가 긴~코드가 있습니다. 로직도 있고 depth(이하 ‘깊이’로 지칭)도 뒤죽박죽입니다. 나왔다 들어갔다 하면 까먹을 것 같습니다. 플래그도 자칫 잘못하다간 잘못 분기될 수도 있어보입니다. 추상화 레벨도 뒤죽박죽이고 코드도 길고 &lt;code class=&quot;language-text&quot;&gt;if&lt;/code&gt; 문도 요상하고 함수호출도 별로네요.&lt;/p&gt;
&lt;p&gt;보통 아래와 같이 손대면 로직이 간결해집니다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;함수 추출&lt;/li&gt;
&lt;li&gt;이름 변경&lt;/li&gt;
&lt;li&gt;구조변경&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;다시, 어떻게 바뀌었나 분석해보면 이젠 보입니다!&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;함수명: &lt;code class=&quot;language-text&quot;&gt;renderPageWithSetupsAndTeardowns&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;대강 하는듯한 일?
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;PageData&lt;/code&gt; 라는 값과 &lt;code class=&quot;language-text&quot;&gt;isSuite&lt;/code&gt; 라는 플래그가 있다.&lt;/li&gt;
&lt;li&gt;테스트페이지 테스트 중 각 구문에서 문제가 발생한다면 &lt;code class=&quot;language-text&quot;&gt;Exception&lt;/code&gt;을 일으킨다.
&lt;ul&gt;
&lt;li&gt;테스트 페이지의 새 컨텐츠를 셋업페이지에 추가해보고&lt;/li&gt;
&lt;li&gt;컨텐츠를 &lt;code class=&quot;language-text&quot;&gt;append&lt;/code&gt; 하고&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Teardown&lt;/code&gt; 해보고&lt;/li&gt;
&lt;li&gt;컨텐츠를 셋 해본다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;모든게 잘 됐으면 &lt;code class=&quot;language-text&quot;&gt;pageData&lt;/code&gt;의 &lt;code class=&quot;language-text&quot;&gt;getHtml&lt;/code&gt;이라는 함수의 리턴값을 준다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;그렇다면, 함수를 만드는 규칙을 살펴봅시다.&lt;/p&gt;
&lt;h2 id=&quot;작게-만드시오&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9E%91%EA%B2%8C-%EB%A7%8C%EB%93%9C%EC%8B%9C%EC%98%A4&quot; aria-label=&quot;작게 만드시오 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;작게 만드시오&lt;/h2&gt;
&lt;p&gt;함수의 철칙은 아래와 같습니다. 이는 지난 30년간 수많은 사람들의 경험에서 나온 말입니다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;함수는 &lt;strong&gt;한 가지만&lt;/strong&gt; 해야 한다.&lt;/li&gt;
&lt;li&gt;그 한가지를 &lt;strong&gt;잘 해야&lt;/strong&gt; 한다.&lt;/li&gt;
&lt;li&gt;그 한가지&lt;strong&gt;만을&lt;/strong&gt; 해야 한다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;p&gt;단일 ‘깊이’만 처리하는 함수라면 하나의 일 만을 하겠지요. 함수를 만든다는건, 로직을 처리하기 위한 덩어리를 모아두는 것이니 단일 ‘깊이’를 처리하도록 추상화 수준을 &lt;strong&gt;하나로&lt;/strong&gt; 나눠야합니다.&lt;/p&gt;
&lt;p&gt;이를 하기위한 쉬운 방법은, 특정 함수에서 의미있는 이름으로 다른 함수를 추출할 수 있다면, 그 함수는 여러 작업을 하는 셈입니다. (80년도에는 함수는 한 화면을 넘어가지 마라 라는 말도 있었다네요? (80*24 화면 기준…) 24라인을 넘기지 말라는 얘기…)&lt;/p&gt;
&lt;h3 id=&quot;함수-당-추상화-수준을-하나로-하자&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%95%A8%EC%88%98-%EB%8B%B9-%EC%B6%94%EC%83%81%ED%99%94-%EC%88%98%EC%A4%80%EC%9D%84-%ED%95%98%EB%82%98%EB%A1%9C-%ED%95%98%EC%9E%90&quot; aria-label=&quot;함수 당 추상화 수준을 하나로 하자 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;함수 당 추상화 수준을 하나로 하자&lt;/h3&gt;
&lt;p&gt;특정 함수의 ‘깊이’를 하나로 맞출 것을 권하는 것입니다. 근본 개념부터 세부사항까지, 모두 한 레벨에 두지 않고 함수화해서 나누면 지저분해 질 가능성이 줄어듭니다. 이를 유지하도록 작성해야, 다른 사람들이 그러지 않도록 할 수 있습니다. ‘깨진 창문을 가만히 두지 마세요’.&lt;/p&gt;
&lt;p&gt;이는 코드를 “내려가기” 규칙으로 읽고 쓰는 것이 좋다는 것을 자연스럽게 시사합니다. 위에서 아래로 이야기처럼 읽을 수 있는 코드가 좋다는 뜻입니다.&lt;/p&gt;
&lt;h2 id=&quot;switch-case&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#switch-case&quot; aria-label=&quot;switch case permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Switch case&lt;/h2&gt;
&lt;p&gt;if/else 가 길어지는 구문도 마찬가지입니다. 이런 코드는 작게 만들기 어렵습니다. 근본적으로 n가지 케이스를 동시에 처리한다는 점에서 저자의 생각과 반대로 갑니다. 저자는 4개의 근거를 들어서 이 함수를 비판합니다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;길다(유형이 길어짐에 따라 길어짐).&lt;/li&gt;
&lt;li&gt;‘한 가지’ 작업만 하는 함수가 아니다.&lt;/li&gt;
&lt;li&gt;SRP를 위반한다(코드를 변경할 이유가 여럿임).&lt;/li&gt;
&lt;li&gt;OCP를 위반한다(직원유형 추가에 따라 코드가 바뀜).&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이걸 &lt;a href=&quot;https://refactoring.guru/ko/design-patterns/abstract-factory&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;추상 팩토리&lt;/a&gt;로 풀어내면? → 일단 3, 4 는 해결됩니다. 내부적으로는 switch 문이 있지만, 다른 코드에 노출되지는 않으니 상관없지요. 물론 불가피한 경우도 생깁니다.&lt;/p&gt;
&lt;h2 id=&quot;서술적인-이름-쓰기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%84%9C%EC%88%A0%EC%A0%81%EC%9D%B8-%EC%9D%B4%EB%A6%84-%EC%93%B0%EA%B8%B0&quot; aria-label=&quot;서술적인 이름 쓰기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;서술적인 이름 쓰기&lt;/h2&gt;
&lt;p&gt;이름이 너무 길다고 불평하는 것 보다 차라리 이해하기 쉬운게 낫습니다. 짐작한 기능이 그대로 돌도록 이름을 짓는 편이 좋습니다. 일단 길면, 개선하기도 좋겠죠. 머릿속으로만 있던 설계가 일단 기술되었으니까요.&lt;/p&gt;
&lt;h2 id=&quot;함수-인수&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%95%A8%EC%88%98-%EC%9D%B8%EC%88%98&quot; aria-label=&quot;함수 인수 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;함수 인수&lt;/h2&gt;
&lt;p&gt;이상적인 인수 갯수는 없거나 하나만 있는 것이 좋다고 합니다.&lt;/p&gt;
&lt;p&gt;파라미터로 넘기는 값에 대해 다른 사람이 이해할 필요가 없도록 할 필요가 있는 것이 좋다는 것이 그 근거입니다.&lt;/p&gt;
&lt;p&gt;플래그 인수도 가급적이면 사용하지 않는 편이 좋다고 합니다. 차라리 두가지 함수로 나누는 것을 고려하길 권장합니다.&lt;/p&gt;
&lt;p&gt;인수가 많아지면, 차라리 독자적인 클래스로 빼고 그걸 왔다갔다 하는 방안도 고려해봄직 하다.&lt;/p&gt;
&lt;h2 id=&quot;사이드-이펙트-일으키지-않기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%82%AC%EC%9D%B4%EB%93%9C-%EC%9D%B4%ED%8E%99%ED%8A%B8-%EC%9D%BC%EC%9C%BC%ED%82%A4%EC%A7%80-%EC%95%8A%EA%B8%B0&quot; aria-label=&quot;사이드 이펙트 일으키지 않기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;사이드 이펙트 일으키지 않기&lt;/h2&gt;
&lt;p&gt;나는 “A”하는 함수다 라고 해놓고 뒤에서 “A-2”, “A-3”을 같이하거나 심지어는 “B”를 하는 케이스가 있다. 이런건 하면 안 된다!&lt;/p&gt;
&lt;p&gt;사이드 이펙트가 대체 뭔지 캐치하기도 어려울 뿐더러&lt;/p&gt;
&lt;h2 id=&quot;명령과-조회를-분리하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AA%85%EB%A0%B9%EA%B3%BC-%EC%A1%B0%ED%9A%8C%EB%A5%BC-%EB%B6%84%EB%A6%AC%ED%95%98%EA%B8%B0&quot; aria-label=&quot;명령과 조회를 분리하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;명령과 조회를 분리하기&lt;/h2&gt;
&lt;p&gt;누가 아래의 함수를 만들었다고 칩시다. 이름이 &lt;code class=&quot;language-text&quot;&gt;attribute&lt;/code&gt; 인 속성을 찾고 값을 value로 설정한 후, 성공하면 &lt;code class=&quot;language-text&quot;&gt;true&lt;/code&gt;를, 실패하면 &lt;code class=&quot;language-text&quot;&gt;false&lt;/code&gt;를 리턴합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; attribute&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;쓴다고 하면 이런식으로 쓰겠죠:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;java&quot;&gt;&lt;pre class=&quot;language-java&quot;&gt;&lt;code class=&quot;language-java&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;username&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;unclebob&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이런 식으로, 저 &lt;code class=&quot;language-text&quot;&gt;set()&lt;/code&gt;이 어떻게 동작할지 “모두” 알고 코드를 짜야하는 경우를 만들지 말라는 뜻입니다. “조회”와 “명령”이 혼재하고 있습니다. 이를 분리해야 할 필요가 있다는 뜻입니다.&lt;/p&gt;
&lt;p&gt;파이썬이라면 이런식으로 풀 수 있겠죠:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;hasattr&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;attr&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token builtin&quot;&gt;setattr&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;obj&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; attr&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# x.attr = value 과 같습니다&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;오류코드보다-예외-사용하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%98%A4%EB%A5%98%EC%BD%94%EB%93%9C%EB%B3%B4%EB%8B%A4-%EC%98%88%EC%99%B8-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0&quot; aria-label=&quot;오류코드보다 예외 사용하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;오류코드보다 예외 사용하기&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;최악: if/else 구문 속에 에러코드를 받고 그를 토대로 로직을 일일이 짜는것&lt;/li&gt;
&lt;li&gt;차악: 복잡한 try/catch를 어거지로 짜는 것&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;trycatch-블록-뽑아내기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#trycatch-%EB%B8%94%EB%A1%9D-%EB%BD%91%EC%95%84%EB%82%B4%EA%B8%B0&quot; aria-label=&quot;trycatch 블록 뽑아내기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;try/catch 블록 뽑아내기&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;별도의 함수로 정상/비정상 로직을 분리합니다.
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;try&lt;/code&gt; 블록에서 실행될 정상로직을 포진시킵니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;catch&lt;/code&gt; 구문에서 실행될 에러 로직을 분리합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;오류처리도-하나의-작업으로-생각하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%98%A4%EB%A5%98%EC%B2%98%EB%A6%AC%EB%8F%84-%ED%95%98%EB%82%98%EC%9D%98-%EC%9E%91%EC%97%85%EC%9C%BC%EB%A1%9C-%EC%83%9D%EA%B0%81%ED%95%98%EA%B8%B0&quot; aria-label=&quot;오류처리도 하나의 작업으로 생각하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;오류처리도 하나의 작업으로 생각하기&lt;/h3&gt;
&lt;p&gt;함수는 ‘한 가지’ 작업을 해야합니다. 마찬가지로, 오류 처리도 ‘한 가지’ 작업을 해야합니다.&lt;/p&gt;
&lt;h2 id=&quot;반복하지-마시오dry&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%B0%98%EB%B3%B5%ED%95%98%EC%A7%80-%EB%A7%88%EC%8B%9C%EC%98%A4dry&quot; aria-label=&quot;반복하지 마시오dry permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;반복하지 마시오(DRY)&lt;/h2&gt;
&lt;p&gt;반복되는 로직을 최소한으로 합시다. 반복되는 코드는 이런 단점을 가집니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;코드가 길어집니다.&lt;/li&gt;
&lt;li&gt;로직이 바뀌면 반복되는 로직을 모두 고쳐야합니다: 하나라도 놓치면 문제가 발생합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;구조적-프로그래밍&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B5%AC%EC%A1%B0%EC%A0%81-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D&quot; aria-label=&quot;구조적 프로그래밍 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;구조적 프로그래밍&lt;/h2&gt;
&lt;p&gt;“함수에 return 문은 하나여야한다.” 하는 원칙은 함수가 클 때 확실한 효용을 가져옵니다. 함수가 작을 때는 이를 최대한 존중하되 return 문으로 향하는 하나의 방법으로 귀결되도록 break, continue 를 쓰는 것이 나쁘지 않다고 생각합니다.&lt;/p&gt;
&lt;h2 id=&quot;다시-함수-짜는-방법에-대해-매우중요&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8B%A4%EC%8B%9C-%ED%95%A8%EC%88%98-%EC%A7%9C%EB%8A%94-%EB%B0%A9%EB%B2%95%EC%97%90-%EB%8C%80%ED%95%B4-%EB%A7%A4%EC%9A%B0%EC%A4%91%EC%9A%94&quot; aria-label=&quot;다시 함수 짜는 방법에 대해 매우중요 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;다시, 함수 짜는 방법에 대해… (매우중요)&lt;/h2&gt;
&lt;p&gt;저는 이런 방안을 통해 함수를 짜면 어떨까 하고 생각합니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;내가 원하는 로직을 머리속으로 구상하고 이에 대한 테스트 케이스를 생각해두자. (요것은 저의 방식입니다)&lt;/li&gt;
&lt;li&gt;이후 처음엔 어쨌거나 얼기설기 짜더라도 돌아가도록 만들고, 생각해둔 테스트 케이스를 모두 만족하는지 살펴보자.&lt;/li&gt;
&lt;li&gt;그 다음, 코드를 다듬고 함수를 만들고 이름을 바꾸고 중복을 제거하고 함수를 줄이고 순서를 바꾸고 클래스를 쪼개고… 하면서도 테스트 케이스가 모두 패스한다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이러면 위의 규칙을 최대한 준수하며 함수를 만들 수 있습니다. 습관이 되면, 처음부터 ‘어떻게 잘 짜면 되더라’ 도 할 수 있겠지요. &lt;strong&gt;처음부터 완벽하게&lt;/strong&gt; 될 수는 없으니, 계속해서 연습합시다.&lt;/p&gt;
&lt;h2 id=&quot;결론&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B2%B0%EB%A1%A0&quot; aria-label=&quot;결론 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;결론&lt;/h2&gt;
&lt;p&gt;‘요구사항 문서로 도출되는 명사와 동사를 클래스와 함수 후보로 고려하자’ 같은 소리를 하는게 절대 아닙니다!!!&lt;/p&gt;
&lt;p&gt;시스템을 구현할 프로그램으로 보지 않고 풀어나갈 이야기로 여겨서, 이를 도메인에 특화된 언어로 풀어나간다고 할 수 있겠습니다.&lt;/p&gt;
&lt;h2 id=&quot;찐막&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%B0%90%EB%A7%89&quot; aria-label=&quot;찐막 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;찐막&lt;/h2&gt;
&lt;p&gt;향로님의 &lt;a href=&quot;https://jojoldu.tistory.com/697?category=1140722&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;좋은 함수 만들기&lt;/a&gt; 시리즈도 함께 읽어보십시오.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[클린 코드 스터디 (2): 의미있는 코드]]></title><description><![CDATA[2023년 1월부터 시작한 클린 코드 독파 스터디 후, 매 모임 전 준비하는 게시글을 공유합니다. 이 글은 2장, 의미있는 코드에 대해 설명합니다.]]></description><link>https://blog.s3ich4n.me/books/clean-code/2023-01-06-pt01</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/clean-code/2023-01-06-pt01</guid><pubDate>Fri, 06 Jan 2023 22:59:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;2-의미있는-코드&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2-%EC%9D%98%EB%AF%B8%EC%9E%88%EB%8A%94-%EC%BD%94%EB%93%9C&quot; aria-label=&quot;2 의미있는 코드 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2. 의미있는 코드&lt;/h1&gt;
&lt;p&gt;의미있는 코드 이름을 붙입시다. 소프트웨어 세상 만사에 다 쓰이는게 이름이잖아요. 그러면 잘 지어봅시다.&lt;/p&gt;
&lt;h2 id=&quot;의도가-분명한-코드&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%98%EB%8F%84%EA%B0%80-%EB%B6%84%EB%AA%85%ED%95%9C-%EC%BD%94%EB%93%9C&quot; aria-label=&quot;의도가 분명한 코드 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;의도가 분명한 코드&lt;/h2&gt;
&lt;p&gt;변수, 메소드, 에서 의미가 드러나도록 생각해봅시다. 코드 맥락에 따라, 필요한 내용이 담겨있도록 하는 이름을 유도해봅시다.&lt;/p&gt;
&lt;h3 id=&quot;저의-생각-1&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A0%80%EC%9D%98-%EC%83%9D%EA%B0%81-1&quot; aria-label=&quot;저의 생각 1 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;저의 생각 (1)&lt;/h3&gt;
&lt;p&gt;인덱스용 &lt;code class=&quot;language-text&quot;&gt;i&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;j&lt;/code&gt; 도 가급적이면 &lt;code class=&quot;language-text&quot;&gt;idx&lt;/code&gt; 처럼 써서, &lt;code class=&quot;language-text&quot;&gt;foreach&lt;/code&gt; 형식의 구문에서도 이해할 수 있게 만들어야할 것입니다.&lt;/p&gt;
&lt;h3 id=&quot;저의-생각-2&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A0%80%EC%9D%98-%EC%83%9D%EA%B0%81-2&quot; aria-label=&quot;저의 생각 2 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;저의 생각 (2)&lt;/h3&gt;
&lt;p&gt;파이썬에선 매개변수 사용 시, 쓰도록 하고싶을 때, 아래와 같이 사용할 수 있습니다(&lt;a href=&quot;https://peps.python.org/pep-3102/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;PEP 3102&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;사용방법은 아래와 같습니다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;Python &lt;span class=&quot;token number&quot;&gt;3.7&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;.12&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; packaged by conda&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;forge &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;default&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; Oct &lt;span class=&quot;token number&quot;&gt;26&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2021&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;06&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;08&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
Type &lt;span class=&quot;token string&quot;&gt;&apos;copyright&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;credits&apos;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;license&apos;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; more information
IPython &lt;span class=&quot;token number&quot;&gt;7.34&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;.0&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; An enhanced Interactive Python&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt; Type &lt;span class=&quot;token string&quot;&gt;&apos;?&apos;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;help&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;

In &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
   &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;     body&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;     &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;     testarg&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;bool&lt;/span&gt;	&lt;span class=&quot;token comment&quot;&gt;# 쓸 거면 explicit 하게 호출하기 (PEP 3102)&lt;/span&gt;
   &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
   &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;     &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;body&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;     &lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;testarg&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;

In &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; test1&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;b&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;
TypeError                                 Traceback &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;most recent call last&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;ipython&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;b0d6e60260e3&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;module&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; test1&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;b&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

TypeError&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; test1&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; takes &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; positional argument but &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; were given

In &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; test1&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;b&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; testarg&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;b&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;

In &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; test1&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;b&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;testarg&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;
TypeError                                 Traceback &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;most recent call last&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;ipython&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;3f3364c4dbeb&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;module&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; test1&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;b&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;testarg&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

TypeError&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; test1&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; takes &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; positional argument but &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; were given

In &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; test1&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;b&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;testarg&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;b&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;

In &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; test1&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;b&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;sdafkjnerfg&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;
TypeError                                 Traceback &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;most recent call last&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;ipython&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;b65affa75eff&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;module&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; test1&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;b&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;sdafkjnerfg&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

TypeError&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; test1&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; got an unexpected keyword argument &lt;span class=&quot;token string&quot;&gt;&apos;sdafkjnerfg&apos;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;그릇된-정보를-피하라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B7%B8%EB%A6%87%EB%90%9C-%EC%A0%95%EB%B3%B4%EB%A5%BC-%ED%94%BC%ED%95%98%EB%9D%BC&quot; aria-label=&quot;그릇된 정보를 피하라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;그릇된 정보를 피하라&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;프로그래밍 업계 전반에서 널리 사용되는 용어, 개발중인 도메인에서 사용하고 있는 용어와 유사한 이름을 다른 뜻으로 사용하지 맙시다.&lt;/li&gt;
&lt;li&gt;유사한 개념은 유사한 표기법을 사용합시다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;의미-있게-구분하라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%98%EB%AF%B8-%EC%9E%88%EA%B2%8C-%EA%B5%AC%EB%B6%84%ED%95%98%EB%9D%BC&quot; aria-label=&quot;의미 있게 구분하라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;의미 있게 구분하라&lt;/h2&gt;
&lt;p&gt;아래 코드를 살펴봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;swap_coord&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    q1&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Coord&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    q2&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Coord&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot; 좌표계 Coord을 swap하는 코드다
    &quot;&quot;&quot;&lt;/span&gt;
    q1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; q2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; q2&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; q1&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;뜻은 알겠습니다만, &lt;code class=&quot;language-text&quot;&gt;src&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;dst&lt;/code&gt; 라고 작성하는게 보다 “명확”합니다. 그래도 나은코드를 만들려면? 하는 고민이 필요한 시기라고 할 수 있겠지요.&lt;/p&gt;
&lt;p&gt;예를들어 어떤 에러의 Traceback을 보는데, 이런식으로 나왔다고 가정해봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;
Exception                                 Traceback &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;most recent call last&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;ipython&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;9732aa3334c7&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;module&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; get_active_account&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;ipython&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;4703b8c01446&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; get_active_account&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get_active_account&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;     get_active_accounts&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;ipython&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;c779c718bd0e&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; get_active_accounts&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get_active_accounts&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;     get_active_accounts_info&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;ipython&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;154e7846498a&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; get_active_accounts_info&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get_active_accounts_info&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;     &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; Exception&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;!&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;기능을 쫓아갈 때도 보다 “명확한” 이름을 써야, 추후 디버깅하고 기능을 추가할 때도 보다 쫓아가기 쉽겠지요.&lt;/p&gt;
&lt;h2 id=&quot;발음하기-쉬운-이름을-쓰라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%B0%9C%EC%9D%8C%ED%95%98%EA%B8%B0-%EC%89%AC%EC%9A%B4-%EC%9D%B4%EB%A6%84%EC%9D%84-%EC%93%B0%EB%9D%BC&quot; aria-label=&quot;발음하기 쉬운 이름을 쓰라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;발음하기 쉬운 이름을 쓰라&lt;/h2&gt;
&lt;p&gt;한국에서 영어는 제2외국어니까 발음은 사실 그리 문제되지 않는다고 생각합니다. 다만 도메인을 풀 때 &lt;em&gt;공통적인 단어&lt;/em&gt;에 대한 논의는 필요하다고 생각합니다. 예를 들어, “구분”이라는 단어를 &lt;code class=&quot;language-text&quot;&gt;gubun&lt;/code&gt; 으로 공통적으로 사용할 수도 있을 것입니다. 다같이 프로그래밍을 하는것이니까요.&lt;/p&gt;
&lt;h2 id=&quot;검색하기-쉬운-이름을-사용하라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B2%80%EC%83%89%ED%95%98%EA%B8%B0-%EC%89%AC%EC%9A%B4-%EC%9D%B4%EB%A6%84%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EB%9D%BC&quot; aria-label=&quot;검색하기 쉬운 이름을 사용하라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;검색하기 쉬운 이름을 사용하라&lt;/h2&gt;
&lt;p&gt;수업 당 학생 수를 표기하기 위해 &lt;code class=&quot;language-text&quot;&gt;7&lt;/code&gt; 을 상수로 바로 쓰기보단 &lt;code class=&quot;language-text&quot;&gt;MAX_CLASSES_PER_STUDENT&lt;/code&gt; 같은 이름을 붙여서 쓰는편이 좋을 것입니다.&lt;/p&gt;
&lt;h2 id=&quot;인코딩을-피하라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%B8%EC%BD%94%EB%94%A9%EC%9D%84-%ED%94%BC%ED%95%98%EB%9D%BC&quot; aria-label=&quot;인코딩을 피하라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;인코딩을 피하라&lt;/h2&gt;
&lt;p&gt;Win32 API 프로그래밍에서 흔히 쓰이던 &lt;a href=&quot;https://en.wikipedia.org/wiki/Hungarian_notation&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;헝가리식 표기법&lt;/a&gt;이 특히 그랬지요. 요즘 강타입 언어들은 더 많은 타입을 지원하고, 컴파일 레벨에서도 이런 문제들을 잡을 수 있고, 클래스와 함수가 점차 작아지는 추세입니다. 파이썬이라도 &lt;code class=&quot;language-text&quot;&gt;mypy&lt;/code&gt; 나 적극적인 타입힌팅을 두는 식으로도 어느정도 대응은 되지요. 그리고 IDE 단에서도 타입에러를 감지합니다. 때에따라 쓸 수 있겠지만, 불필요하겠지요.&lt;/p&gt;
&lt;h3 id=&quot;인터페이스와-구현-클래스&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4%EC%99%80-%EA%B5%AC%ED%98%84-%ED%81%B4%EB%9E%98%EC%8A%A4&quot; aria-label=&quot;인터페이스와 구현 클래스 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;인터페이스와 구현 클래스?&lt;/h3&gt;
&lt;p&gt;팩토리 클래스와 구현체 클래스의 이름을 정한다면, 팩토리쪽을 추상화한 이름을 짓는편은 어떨까요? 구현체의 이름에 &lt;code class=&quot;language-text&quot;&gt;Impl&lt;/code&gt; 이라거나 &lt;code class=&quot;language-text&quot;&gt;I&lt;/code&gt; 접두사를 붙이거나 하기보단 어차피 어느 부모를 상속한건지 IDE로도 쫓아갈 수 있으니까요.&lt;/p&gt;
&lt;h2 id=&quot;자신의-기억력을-자랑하지-마라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9E%90%EC%8B%A0%EC%9D%98-%EA%B8%B0%EC%96%B5%EB%A0%A5%EC%9D%84-%EC%9E%90%EB%9E%91%ED%95%98%EC%A7%80-%EB%A7%88%EB%9D%BC&quot; aria-label=&quot;자신의 기억력을 자랑하지 마라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;자신의 기억력을 자랑하지 마라&lt;/h2&gt;
&lt;p&gt;나만 아는 이름을 하면 남과 함께 일하기 어려우니 자제해야 합니다. 남과 함께 일하기 좋은 변수명을 짓는 방안으로는 어떤게 있을까요?&lt;/p&gt;
&lt;h3 id=&quot;클래스-이름&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%81%B4%EB%9E%98%EC%8A%A4-%EC%9D%B4%EB%A6%84&quot; aria-label=&quot;클래스 이름 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;클래스 이름&lt;/h3&gt;
&lt;p&gt;동사 쓰지말고 명사/명사구로 씁시다.&lt;/p&gt;
&lt;h3 id=&quot;메소드-이름&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A9%94%EC%86%8C%EB%93%9C-%EC%9D%B4%EB%A6%84&quot; aria-label=&quot;메소드 이름 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;메소드 이름&lt;/h3&gt;
&lt;p&gt;동사/동사구로 씁시다. getter나 setter, 그외 요소들은 사용하는 언어의 특징을 따릅시다.&lt;/p&gt;
&lt;h3 id=&quot;특이한-이름은-지양할-것&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%8A%B9%EC%9D%B4%ED%95%9C-%EC%9D%B4%EB%A6%84%EC%9D%80-%EC%A7%80%EC%96%91%ED%95%A0-%EA%B2%83&quot; aria-label=&quot;특이한 이름은 지양할 것 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;특이한 이름은 지양할 것&lt;/h3&gt;
&lt;p&gt;그 당시에만 웃겨서 다시보면 노잼일거에요…&lt;/p&gt;
&lt;h3 id=&quot;한-개념에-한-단어만&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%95%9C-%EA%B0%9C%EB%85%90%EC%97%90-%ED%95%9C-%EB%8B%A8%EC%96%B4%EB%A7%8C&quot; aria-label=&quot;한 개념에 한 단어만 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;한 개념에 한 단어만&lt;/h3&gt;
&lt;p&gt;추상적 개념 하나에 단어 하나를 선택하고,이를 고수합시다. 일관성있게 유지해서 충분히 유추할 수 있는 코드를 짭시다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;동일한 결과를 기대하는 메소드라면 단일 이름을 씁시다. 클래스마다 &lt;code class=&quot;language-text&quot;&gt;fetch&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;retreive&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;get&lt;/code&gt; 과 같이 &lt;strong&gt;각각 다르게&lt;/strong&gt;쓰면 다른 코드를 쫓아가기 어렵습니다.&lt;/li&gt;
&lt;li&gt;동일 개념이라면 동일한 이름을 씁시다. 동일 코드 기반에 &lt;code class=&quot;language-text&quot;&gt;controller&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;manager&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;driver&lt;/code&gt; 등을 &lt;strong&gt;섞어 사용하면&lt;/strong&gt; 다른 코드를 이해하기 어렵습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;말장난을-하지-마라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%90%EC%9E%A5%EB%82%9C%EC%9D%84-%ED%95%98%EC%A7%80-%EB%A7%88%EB%9D%BC&quot; aria-label=&quot;말장난을 하지 마라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;말장난을 하지 마라&lt;/h2&gt;
&lt;p&gt;한 단어는 하나의 의미만을 가집시다. 더한다(add) 라는 개념을 확장하고 싶다면 insert나 append 같은 단어를 사용합시다. 코드를 훑어보더라도 이해하기 쉽도록 합시다.&lt;/p&gt;
&lt;h2 id=&quot;해법-영역에서-가져온-이름을-사용하라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%95%B4%EB%B2%95-%EC%98%81%EC%97%AD%EC%97%90%EC%84%9C-%EA%B0%80%EC%A0%B8%EC%98%A8-%EC%9D%B4%EB%A6%84%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EB%9D%BC&quot; aria-label=&quot;해법 영역에서 가져온 이름을 사용하라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;해법 영역에서 가져온 이름을 사용하라&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;모든&lt;/strong&gt; 이름을 도메인에서 따지는 말고, 기술이 주요한 개념이라면 기술이름을 응용하여 명명합시다. VISITOR 패턴을 썼다면 &lt;code class=&quot;language-text&quot;&gt;AccountVisitor&lt;/code&gt; 와 같은 이름을 쓰는것은 어떨까요?&lt;/p&gt;
&lt;h2 id=&quot;문제-영역에서-가져온-이름을-사용하라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AC%B8%EC%A0%9C-%EC%98%81%EC%97%AD%EC%97%90%EC%84%9C-%EA%B0%80%EC%A0%B8%EC%98%A8-%EC%9D%B4%EB%A6%84%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EB%9D%BC&quot; aria-label=&quot;문제 영역에서 가져온 이름을 사용하라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;문제 영역에서 가져온 이름을 사용하라&lt;/h2&gt;
&lt;p&gt;그게 아니라면 어지간한 이름은 도메인에서 따옵시다. 그러면 새로 오는 사람이더라도 관련 파트 사람에게 개념을 질문하여 빠른 해답을 끌어올 수 있을 것입니다.&lt;/p&gt;
&lt;h2 id=&quot;의미-있는-맥락을-추가하라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%98%EB%AF%B8-%EC%9E%88%EB%8A%94-%EB%A7%A5%EB%9D%BD%EC%9D%84-%EC%B6%94%EA%B0%80%ED%95%98%EB%9D%BC&quot; aria-label=&quot;의미 있는 맥락을 추가하라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;의미 있는 맥락을 추가하라&lt;/h2&gt;
&lt;p&gt;클래스, 메소드, 변수를 통해 로직의 컨텍스트를 유지하다보니, 메소드 하나에 너무 많은 개념이 들어가있나요? 도메인을 풀기 위한 주요 개념이라면 이를 객체화 해봅시다.&lt;/p&gt;
&lt;p&gt;객체끼리 메시지를 주고받을 수 있도록 하고 로직을 작게 분리하는 해결책은 어떨까요?&lt;/p&gt;
&lt;h2 id=&quot;불필요한-맥락을-없애라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%B6%88%ED%95%84%EC%9A%94%ED%95%9C-%EB%A7%A5%EB%9D%BD%EC%9D%84-%EC%97%86%EC%95%A0%EB%9D%BC&quot; aria-label=&quot;불필요한 맥락을 없애라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;불필요한 맥락을 없애라&lt;/h2&gt;
&lt;p&gt;너무 짧은 이름보다는 긴 이름이 좋습니다만, 의미가 분명한 이름이라면 짧게 가져가서 불필요한 맥락을 빼버립시다.&lt;/p&gt;
&lt;h2 id=&quot;마치면서&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%88%EC%B9%98%EB%A9%B4%EC%84%9C&quot; aria-label=&quot;마치면서 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;마치면서&lt;/h2&gt;
&lt;p&gt;좋은 이름은 기억에 오래 남고, 비슷한 이름은 익숙해지기 쉽습니다. 이런 노력을 기울여서 이름에 대한 프로그래머의 생각비율을 최소화 합시다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[클린 코드 스터디 (1): 깨끗한 코드]]></title><description><![CDATA[2023년 1월부터 시작한 클린 코드 독파 스터디 후, 매 모임 전 준비하는 게시글을 공유합니다. 이 글은 1장, 깨끗한 코드에 대해 알아봅니다.]]></description><link>https://blog.s3ich4n.me/books/clean-code/2023-01-06-pt01</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/clean-code/2023-01-06-pt01</guid><pubDate>Fri, 06 Jan 2023 22:51:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;1-깨끗한-코드&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1-%EA%B9%A8%EB%81%97%ED%95%9C-%EC%BD%94%EB%93%9C&quot; aria-label=&quot;1 깨끗한 코드 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1. 깨끗한 코드&lt;/h1&gt;
&lt;p&gt;ChatGPT로 기술 발전이 무섭게 발전하는 지금, 기계가 못하는 것을 할 수 있도록 하기 위해 이 책을 폈습니다. 우리는 기계보다 나은 코드를 짜도록 연마해야할 것입니다.&lt;/p&gt;
&lt;p&gt;코드는 요구사항을 표현하기 위한 도구이며, 각 요구사항을 표현하기 위한 언어 또한 늘어나겠지요. 막연한 요구사항을 구체화하고, 이를 잘 풀어내는 것은 (아직은) 인간이 할 수 있는 것입니다. 그런고로, 잘 풀어내는 방법을 배워봅시다.&lt;/p&gt;
&lt;p&gt;나쁜코드가 왜 좋지 않은지 이야기해봅시다. 이 글을 읽으시는 모든 분들은 ‘나쁜 코드를 어떻게 좋게 바꾸지?’ 하고 고민하던 때가 있었을 것입니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;급하다고 막 짠 코드로, ‘이거 돈다!’ 하는게 쌓이면 돌이킬 수 없습니다. 나중에 하자? &lt;strong&gt;나중은 없습니다.&lt;/strong&gt; 실용주의 프로그래머에도 이런 말이 나옵니다: ‘깨진 유리창을 가만 두지 마라’.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;이런 나쁜 코드가 쌓이면 팀 생산성이 떨어집니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;설령 기회를 얻어, 나쁜 코드를 고칠 기회가 오더라도 모두 고치기는 쉽지 않을 것입니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;나쁜 코드를 유도하는 &lt;strong&gt;나쁜 설계&lt;/strong&gt;를 유도하지 않도록 해야합니다. 좋은 설계에서 좋은 코드가 나올 수 있고, 좋은 코드를 유지하는 것 또한 좋은 설계의 일환입니다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;그런 의미로 코드를 잘 짜는 예술(Art)이 있다는 말에 어느정도 동의합니다. 아름다운 코드는 어떤 &lt;em&gt;감각&lt;/em&gt;이라고 합니다. 아니 코드에 무슨 미학이 있는것도 아니고? 하는 생각이 들었는데, 수퍼스타들의 말을 읽어보니 납득이 됐습니다.&lt;/p&gt;
&lt;h2 id=&quot;이-바닥-슈퍼스타들은&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%B4-%EB%B0%94%EB%8B%A5-%EC%8A%88%ED%8D%BC%EC%8A%A4%ED%83%80%EB%93%A4%EC%9D%80&quot; aria-label=&quot;이 바닥 슈퍼스타들은 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;이 바닥 슈퍼스타들은…&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Bjarne Stroustrup, (C++의 아버지)
&lt;ol&gt;
&lt;li&gt;우아하고 효율적인 코드&lt;/li&gt;
&lt;li&gt;의존성을 줄이라&lt;/li&gt;
&lt;li&gt;오류를 전략적으로 처리하라&lt;/li&gt;
&lt;li&gt;성능은 최적으로. 그렇다고 원칙없이 잘 돌아가는 코드를 짜면 안됨&lt;/li&gt;
&lt;li&gt;하나의 코드는 하나의 작동을 한다&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://zetawiki.com/wiki/%EA%B7%B8%EB%9E%98%EB%94%94_%EB%B6%80%EC%B9%98&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Grady Booch&lt;/a&gt; (Object Oriented Analysis and Design with Application](&lt;a href=&quot;https://product.kyobobook.co.kr/detail/S000006439884)%5B%5E1%5D%EC%9D%98&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://product.kyobobook.co.kr/detail/S000006439884)[^1]의&lt;/a&gt; 저자)
&lt;ol&gt;
&lt;li&gt;단순하고 직접적이다.&lt;/li&gt;
&lt;li&gt;잘 쓴 문장처럼 읽힌다.&lt;/li&gt;
&lt;li&gt;설계자의 의도가 바로 드러난다.&lt;/li&gt;
&lt;li&gt;명쾌한 추상화와 제어문으로 가득하다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Dave A. Thomas(aka. “Big” Dave Thomas) (OTI의 창립자이자 이클립스 전략의 Godfather)
&lt;ol&gt;
&lt;li&gt;안 짠 사람도 읽기 쉽고 고치기 쉽다.&lt;/li&gt;
&lt;li&gt;유닛 테스트부터 인수 테스트까지 다 있다.&lt;/li&gt;
&lt;li&gt;의미 있는 이름이 붙는다.&lt;/li&gt;
&lt;li&gt;코드를 통해 목적을 달성하는 방법은 명확한 하나만 제공된다.&lt;/li&gt;
&lt;li&gt;API는 concise하다.&lt;/li&gt;
&lt;li&gt;어떤 면에서는 문학적이다. 모든 정보를 코드로 풀 수 없기 때문이다. → 사람이 읽기 쉬운 코드라는 뜻&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Michale Feathers (&lt;a href=&quot;https://www.amazon.com/Working-Effectively-Legacy-Michael-Feathers/dp/0131177052&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Working Effectively with Legacy Code&lt;/a&gt;&lt;sup id=&quot;fnref-2&quot;&gt;&lt;a href=&quot;#fn-2&quot; class=&quot;footnote-ref&quot;&gt;2&lt;/a&gt;&lt;/sup&gt; 의 저자)
&lt;ol&gt;
&lt;li&gt;손댈 곳이 없어보이는 코드를 짜자&lt;/li&gt;
&lt;li&gt;주의깊게 보이는 코드&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Ron Jeffries (Extreme Programming Installed, Extreme Progreaaming Adventure in C#의 저자)
&lt;ol&gt;
&lt;li&gt;모든 테스트를 통과한다&lt;/li&gt;
&lt;li&gt;중복코드가 없다&lt;/li&gt;
&lt;li&gt;시스템 내 모든 설계 아이디어를 표현한다&lt;/li&gt;
&lt;li&gt;클래스, 메소드, 함수를 최소한으로 한다&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Ward Cunningham (위키의 창시자, 익스트림 프로그래밍의 공동 창시자, OO의 정신적 지주)
&lt;ol&gt;
&lt;li&gt;루틴대로 도는 코드 → 의도가 명확한 코드&lt;/li&gt;
&lt;li&gt;문제를 풀기위해 보이는 코드&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Robert C. Martin (aka. 밥 아저씨) (이 책의 저자)
&lt;ol&gt;
&lt;li&gt;앞으로의 내용은 책을 보면 알 것&lt;/li&gt;
&lt;li&gt;절대적인 것은 없으나, 상황에 맞는 기술과 기법을 익히길 바람&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;코드작성에-대한-태도&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%BD%94%EB%93%9C%EC%9E%91%EC%84%B1%EC%97%90-%EB%8C%80%ED%95%9C-%ED%83%9C%EB%8F%84&quot; aria-label=&quot;코드작성에 대한 태도 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;코드작성에 대한 태도&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Javadoc에는 &lt;code class=&quot;language-text&quot;&gt;@author&lt;/code&gt; 필드가 있습니다. 우리는 수차례 코드를 읽고 씁니다. 좋은 글을 쓰기 위한 작가로서의 책임감을 가질 필요가 있습니다.&lt;/li&gt;
&lt;li&gt;보이스카우트 규칙을 기억하세요.
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;‘캠프장은 처음 왔을 때보다 더 깨끗하게 하고 나갈 것.’&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;이는 ‘처음 왔을 때보다 &lt;em&gt;더 나은 세상&lt;/em&gt;을 만들고 떠나려 노력하라. (후략)’ 라는 말에서 나왔다네요. 낭만이 있습니다…&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;논외로&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%85%BC%EC%99%B8%EB%A1%9C&quot; aria-label=&quot;논외로 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;논외로&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://www.steveonstuff.com/2022/01/27/no-such-thing-as-clean-code&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;클린 코드 같은 건 없다!&lt;/a&gt; 하는 당찬 제목이 있던데, 읽어보면 이 말입니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;업계마다 원하는게 다르고, 그에 따라 간결한 코드를 짜는 방법은 &lt;em&gt;모두에게 다르게 적용됩니다&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;때에 맞는 기술을 잘 선택해야 &lt;em&gt;깨끗하다&lt;/em&gt; 할 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;원작자의 마지막 멘트로 이 글을 마무리합니다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;Hopefully I can convince you that you don’t really need clean code, you need &lt;code class=&quot;language-text&quot;&gt;_____&lt;/code&gt; code. It’s up to you to fill in that blank with words that describe what your project requires.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;footnotes&quot;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&quot;fn-2&quot;&gt;이 링크를 참조하십시오.  &lt;a href=&quot;#fnref-2&quot; class=&quot;footnote-backref&quot;&gt;↩&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content:encoded></item><item><title><![CDATA[Gatsby 블로그 이미지에 캡션을 추가하는 방법 (w/ gatsby-remark-images)]]></title><description><![CDATA[Gatsby 블로그 이미지에 캡션을 추가하는 방법에 대해 빠르게 설명드립니다.]]></description><link>https://blog.s3ich4n.me/tips/2023-01-04-gatsby-add-image-captions</link><guid isPermaLink="false">https://blog.s3ich4n.me/tips/2023-01-04-gatsby-add-image-captions</guid><pubDate>Wed, 04 Jan 2023 16:35:00 GMT</pubDate><content:encoded>&lt;p&gt;이 글은 &lt;code class=&quot;language-text&quot;&gt;gatsby-remark-images&lt;/code&gt; 를 사용하시는 분들 중, 그림에 캡션을 달고싶은 분들을 위한 글입니다.&lt;/p&gt;
&lt;h1 id=&quot;tldr&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#tldr&quot; aria-label=&quot;tldr permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;TL;DR&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://www.gatsbyjs.com/plugins/gatsby-remark-images/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;gatsby-remark-images&lt;/a&gt; 의 &lt;code class=&quot;language-text&quot;&gt;showCaptions&lt;/code&gt; 설정값으로 캡션을 사용할 수 있습니다.&lt;/li&gt;
&lt;li&gt;이는 &lt;code class=&quot;language-text&quot;&gt;gatsby-config.js&lt;/code&gt;(혹은 TS 파일) 파일에 있으며, &lt;code class=&quot;language-text&quot;&gt;options&lt;/code&gt; 값의 키-밸류를 추가해줌으로서 가능합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;설정방법&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%84%A4%EC%A0%95%EB%B0%A9%EB%B2%95&quot; aria-label=&quot;설정방법 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;설정방법&lt;/h1&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;gatsby-config.js&lt;/code&gt;(혹은 TS) 파일 내 플러그인 설정&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;javascript&quot;&gt;&lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// In your gatsby-config.js&lt;/span&gt;
&lt;span class=&quot;token literal-property property&quot;&gt;plugins&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
  &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;gatsby-plugin-sharp&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token literal-property property&quot;&gt;resolve&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;gatsby-transformer-remark&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token literal-property property&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token literal-property property&quot;&gt;plugins&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;token literal-property property&quot;&gt;resolve&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;gatsby-remark-images&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;token literal-property property&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;// 여기에 설정을 추가합니다!&lt;/span&gt;
            &lt;span class=&quot;token literal-property property&quot;&gt;maxWidth&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;590&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;options&lt;/code&gt; 오브젝트에 &lt;code class=&quot;language-text&quot;&gt;showCaptions: true&lt;/code&gt; 를 추가해줍니다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/d68475d82092758bb3e595b7b73d97aa/51ed8/01_code_example.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 47.08333333333333%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAACxKAAAsSgF3enRNAAABhElEQVQoz3WR23LaMBRF+ZhgLkmIQRdbkm3kKzYEkkBJpn3I///F6mBCmpb04czWnDla2ltnMJkqVBSjTEpiWrr1ntXqmcytkJGh3ZSsugLjEorSU9Y5vljStAUqcrTrkrrJkcoxmWoGZ6BBxSlZsmGzPdJtftBUO0LtuL2LOc18rfFEftM76+DiUNsMKUrSYk3bbKnrHWKeMp2aHhCMBMNA9Hqqm+HHObj0ZT/3B2hSlKj66HFseAgdC5EiRMb9LEZqi7EpSlukstgk7VVFFutSFtL84/ADeHKqrGO9PfT/2bZ7lMjwpccXCTZxxDahanKi2JH5Jd26JDZJ//B/gJaq2rHdvfH4eKSpn5iHKXLeMbtPGQYLhoH8jHyJf448kddAY4l1RdcdeH75yevbO1oscXqPT/YE45DRWFwtpo88Ewapzkv5CjRR3QNfDr84vr5T10/kfkusVkSqQyxyRpNr6ODuIULqv4HaOVzSoNQSpT1CLZHao7XvL83DnDDMGH8D/A2qKCl8YLIlawAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/d68475d82092758bb3e595b7b73d97aa/8ac56/01_code_example.webp 240w,
/static/d68475d82092758bb3e595b7b73d97aa/d3be9/01_code_example.webp 480w,
/static/d68475d82092758bb3e595b7b73d97aa/e46b2/01_code_example.webp 960w,
/static/d68475d82092758bb3e595b7b73d97aa/11b7f/01_code_example.webp 1021w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/d68475d82092758bb3e595b7b73d97aa/8ff5a/01_code_example.png 240w,
/static/d68475d82092758bb3e595b7b73d97aa/e85cb/01_code_example.png 480w,
/static/d68475d82092758bb3e595b7b73d97aa/d9199/01_code_example.png 960w,
/static/d68475d82092758bb3e595b7b73d97aa/51ed8/01_code_example.png 1021w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/d68475d82092758bb3e595b7b73d97aa/d9199/01_code_example.png&quot;
            alt=&quot;이런식으로 넣어주시면 됩니다. import this&quot;
            title=&quot;이런식으로 넣어주시면 됩니다. import this&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;이런식으로 넣어주시면 됩니다. import this&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;캡션은 마크다운 문법 중 이미지 로드 실패시 나오는 대체문구의 값이 쓰입니다. 아래 스크린샷과 같이 &lt;em&gt;이런식으로 넣어주시면 됩니다.&lt;/em&gt; 하는 것 처럼 나오죠. (아래 스크린샷은 캡션을 넣지 않았습니다!)&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/5e9974306bf62f9a26c92fa8afe12663/b3602/02_caption_test.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 70.41666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAECBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHMFlUD/8QAFRABAQAAAAAAAAAAAAAAAAAAASD/2gAIAQEAAQUCK//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABgQAQEBAQEAAAAAAAAAAAAAAAEAESEQ/9oACAEBAAE/IQZJnOTEq+f/2gAMAwEAAgADAAAAEJf/AP/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EAB0QAQACAgIDAAAAAAAAAAAAAAEAESExQVGBkaH/2gAIAQEAAT8QRVFvWeYlkA6WDPHhlgMnqbl+Rw1P/9k=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/5e9974306bf62f9a26c92fa8afe12663/8ac56/02_caption_test.webp 240w,
/static/5e9974306bf62f9a26c92fa8afe12663/d3be9/02_caption_test.webp 480w,
/static/5e9974306bf62f9a26c92fa8afe12663/e46b2/02_caption_test.webp 960w,
/static/5e9974306bf62f9a26c92fa8afe12663/f992d/02_caption_test.webp 1440w,
/static/5e9974306bf62f9a26c92fa8afe12663/a120e/02_caption_test.webp 1605w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/5e9974306bf62f9a26c92fa8afe12663/09b79/02_caption_test.jpg 240w,
/static/5e9974306bf62f9a26c92fa8afe12663/7cc5e/02_caption_test.jpg 480w,
/static/5e9974306bf62f9a26c92fa8afe12663/6a068/02_caption_test.jpg 960w,
/static/5e9974306bf62f9a26c92fa8afe12663/644c5/02_caption_test.jpg 1440w,
/static/5e9974306bf62f9a26c92fa8afe12663/b3602/02_caption_test.jpg 1605w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/jpeg&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/5e9974306bf62f9a26c92fa8afe12663/6a068/02_caption_test.jpg&quot;
            alt=&quot;02 caption test&quot;
            title=&quot;02 caption test&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;그 외에도, 캡션에 대해 마크다운 문법을 적용할 것인지에 대한 &lt;code class=&quot;language-text&quot;&gt;markdownCaptions&lt;/code&gt; 같은 옵션도 있습니다. 필요에 따라 적용하시면 될 듯 합니다.&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id=&quot;마무리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%88%EB%AC%B4%EB%A6%AC&quot; aria-label=&quot;마무리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;마무리&lt;/h1&gt;
&lt;p&gt;그 외에도 여러 옵션이 있습니다. 필요에 따라 플러그인 옵션을 제어하면 보다 입맛에 맞는 블로그 설정을 줄 수 있겠네요. 앞으로도 더 알고 쓰면 좋겠네요.&lt;/p&gt;
&lt;p&gt;짧은 글 읽어주셔서 감사합니다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[토탈 커맨더 입문기 (2) 반디집을 사용한 압축하기/압축풀기]]></title><description><![CDATA[OFM의 터줏대감 중 하나인 토탈 커맨더 입문기입니다. 반디집을 통해 압축하기/압축풀기를 하는 방법에 대해 살펴봅시다.]]></description><link>https://blog.s3ich4n.me/tips/2023-01-02-total-commander-101-pt02</link><guid isPermaLink="false">https://blog.s3ich4n.me/tips/2023-01-02-total-commander-101-pt02</guid><pubDate>Mon, 02 Jan 2023 13:07:29 GMT</pubDate><content:encoded>&lt;h1 id=&quot;토탈-커맨더에서-반디집-사용하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%86%A0%ED%83%88-%EC%BB%A4%EB%A7%A8%EB%8D%94%EC%97%90%EC%84%9C-%EB%B0%98%EB%94%94%EC%A7%91-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0&quot; aria-label=&quot;토탈 커맨더에서 반디집 사용하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;토탈 커맨더에서 반디집 사용하기&lt;/h1&gt;
&lt;p&gt;이 게시글은 토탈 커맨더에서 반디집을 사용하여 압축하기/압축풀기를 수행하는 내용에 대한 글입니다.&lt;/p&gt;
&lt;h2 id=&quot;요구사항&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9A%94%EA%B5%AC%EC%82%AC%ED%95%AD&quot; aria-label=&quot;요구사항 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;요구사항&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;반디집 설치 (&lt;code class=&quot;language-text&quot;&gt;%PATH%&lt;/code&gt; 값에 반디집을 추가하시길 바랍니다!)&lt;/li&gt;
&lt;li&gt;토탈 커맨더 설치&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;커스텀-단축키-설정하기-커스텀-명령-지정&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%BB%A4%EC%8A%A4%ED%85%80-%EB%8B%A8%EC%B6%95%ED%82%A4-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0-%EC%BB%A4%EC%8A%A4%ED%85%80-%EB%AA%85%EB%A0%B9-%EC%A7%80%EC%A0%95&quot; aria-label=&quot;커스텀 단축키 설정하기 커스텀 명령 지정 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;커스텀 단축키 설정하기: 커스텀 명령 지정&lt;/h2&gt;
&lt;p&gt;토탈 커맨더엔 없지만, 사용자가 임의로 지정한 명령을 단축키로 지정할 수도 있습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;상단 메뉴바의 &lt;code class=&quot;language-text&quot;&gt;환경설정 &gt;&gt; 옵션&lt;/code&gt;을 클릭합니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;기타&lt;/code&gt; 란으로 이동합니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;em&gt;단축키 재정의&lt;/em&gt; 를 통해 사용할 단축키를 지정해봅시다!&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;명령어가 먼저 등록되어 있는지부터 살펴봅시다. &lt;br/&gt;저는 &lt;code class=&quot;language-text&quot;&gt;F9&lt;/code&gt;/&lt;code class=&quot;language-text&quot;&gt;Shift + F9&lt;/code&gt;로 압축하기/압축풀기를 각각 지정하겠습니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;F9&lt;/code&gt; 부터 살펴볼까요? 현재는 아무 명령이 지정되어있지 않군요. 그렇다면 돋보기 버튼을 눌러 지정해봅시다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/31c90f12065accf6deddbcd404608dda/b3602/001-no-cmd-found.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 79.16666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAQABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAByYEB/8QAFRABAQAAAAAAAAAAAAAAAAAAIEH/2gAIAQEAAQUCp//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABgQAAIDAAAAAAAAAAAAAAAAAAAQARGR/9oACAEBAAE/IRKs1f/aAAwDAQACAAMAAAAQM8//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAZEAEAAwEBAAAAAAAAAAAAAAABABEhUWH/2gAIAQEAAT8QdV7MOTZe1oL4RWF8n//Z&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/31c90f12065accf6deddbcd404608dda/8ac56/001-no-cmd-found.webp 240w,
/static/31c90f12065accf6deddbcd404608dda/d3be9/001-no-cmd-found.webp 480w,
/static/31c90f12065accf6deddbcd404608dda/e46b2/001-no-cmd-found.webp 960w,
/static/31c90f12065accf6deddbcd404608dda/f992d/001-no-cmd-found.webp 1440w,
/static/31c90f12065accf6deddbcd404608dda/a120e/001-no-cmd-found.webp 1605w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/31c90f12065accf6deddbcd404608dda/09b79/001-no-cmd-found.jpg 240w,
/static/31c90f12065accf6deddbcd404608dda/7cc5e/001-no-cmd-found.jpg 480w,
/static/31c90f12065accf6deddbcd404608dda/6a068/001-no-cmd-found.jpg 960w,
/static/31c90f12065accf6deddbcd404608dda/644c5/001-no-cmd-found.jpg 1440w,
/static/31c90f12065accf6deddbcd404608dda/b3602/001-no-cmd-found.jpg 1605w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/jpeg&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/31c90f12065accf6deddbcd404608dda/6a068/001-no-cmd-found.jpg&quot;
            alt=&quot;커스텀 단축키를 지정해봅시다.&quot;
            title=&quot;커스텀 단축키를 지정해봅시다.&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;커스텀 단축키를 지정해봅시다.&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;이 명령은 커스텀 명령이므로 좌측 &lt;code class=&quot;language-text&quot;&gt;usercmd.ini&lt;/code&gt; 파일을 손봐야합니다. 아직 아무 커스텀 단축키를 지정하지 않으셨다면 아무 내용도 없을 것입니다. “새 명령” 버튼을 눌러 명령을 추가해봅시다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/2c79841b523bfa8ab9ce6c25438c0894/4e286/002-no-custom-cmd-found.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 57.91666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAcgIQf/EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEAAQUCX//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABoQAAMAAwEAAAAAAAAAAAAAAAABERBBYXH/2gAIAQEAAT8h1S8RfBujx//aAAwDAQACAAMAAAAQjP8A/8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQMBAT8QiP/EABYRAQEBAAAAAAAAAAAAAAAAAAARAf/aAAgBAgEBPxCrr//EABwQAAIBBQEAAAAAAAAAAAAAAAERABAhMVHwkf/aAAgBAQABPxBkYCyrh9mdBH14hVe9QADYU//Z&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/2c79841b523bfa8ab9ce6c25438c0894/8ac56/002-no-custom-cmd-found.webp 240w,
/static/2c79841b523bfa8ab9ce6c25438c0894/d3be9/002-no-custom-cmd-found.webp 480w,
/static/2c79841b523bfa8ab9ce6c25438c0894/e46b2/002-no-custom-cmd-found.webp 960w,
/static/2c79841b523bfa8ab9ce6c25438c0894/f992d/002-no-custom-cmd-found.webp 1440w,
/static/2c79841b523bfa8ab9ce6c25438c0894/b33b6/002-no-custom-cmd-found.webp 1582w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/2c79841b523bfa8ab9ce6c25438c0894/09b79/002-no-custom-cmd-found.jpg 240w,
/static/2c79841b523bfa8ab9ce6c25438c0894/7cc5e/002-no-custom-cmd-found.jpg 480w,
/static/2c79841b523bfa8ab9ce6c25438c0894/6a068/002-no-custom-cmd-found.jpg 960w,
/static/2c79841b523bfa8ab9ce6c25438c0894/644c5/002-no-custom-cmd-found.jpg 1440w,
/static/2c79841b523bfa8ab9ce6c25438c0894/4e286/002-no-custom-cmd-found.jpg 1582w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/jpeg&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/2c79841b523bfa8ab9ce6c25438c0894/6a068/002-no-custom-cmd-found.jpg&quot;
            alt=&quot;커스텀 명령은 여기 보관됩니다. 현재는 아무것도 없네요.&quot;
            title=&quot;커스텀 명령은 여기 보관됩니다. 현재는 아무것도 없네요.&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;커스텀 명령은 여기 보관됩니다. 현재는 아무것도 없네요.&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;압축하기 명령은 아래 내용을 입력합니다. &lt;br/&gt;&lt;br/&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;카테고리&lt;/th&gt;
&lt;th&gt;입력값&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;명령어&lt;/td&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;bandizip.exe&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;매개변수&lt;/td&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;c %p\pack.zip %P%S&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;툴팁&lt;/td&gt;
&lt;td&gt;해당 명령에 대한 톨팁값을 입력하시면 됩니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/53e55db587f9f9621b9a21c4d928fff1/8b46b/003-zip.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 41.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAByYAH/8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQABBQJ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAGhAAAgIDAAAAAAAAAAAAAAAAAREAECExYf/aAAgBAQABPyFvs0civ//aAAwDAQACAAMAAAAQcA//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAZEAEAAwEBAAAAAAAAAAAAAAABABEhcVH/2gAIAQEAAT8QVbHohhoeMb5P/9k=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/53e55db587f9f9621b9a21c4d928fff1/8ac56/003-zip.webp 240w,
/static/53e55db587f9f9621b9a21c4d928fff1/d3be9/003-zip.webp 480w,
/static/53e55db587f9f9621b9a21c4d928fff1/e46b2/003-zip.webp 960w,
/static/53e55db587f9f9621b9a21c4d928fff1/f37ae/003-zip.webp 1330w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/53e55db587f9f9621b9a21c4d928fff1/09b79/003-zip.jpg 240w,
/static/53e55db587f9f9621b9a21c4d928fff1/7cc5e/003-zip.jpg 480w,
/static/53e55db587f9f9621b9a21c4d928fff1/6a068/003-zip.jpg 960w,
/static/53e55db587f9f9621b9a21c4d928fff1/8b46b/003-zip.jpg 1330w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/jpeg&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/53e55db587f9f9621b9a21c4d928fff1/6a068/003-zip.jpg&quot;
            alt=&quot;압축하기 명령을 지정해봅시다.&quot;
            title=&quot;압축하기 명령을 지정해봅시다.&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;압축하기 명령을 지정해봅시다.&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;압축하기 커스텀 명령을 지정 후 설정을 완료해줍시다!&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/679fb2ffb04485f26bc4fb6318182d8b/d7177/004-01-compress.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 79.16666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAQABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAByYEB/8QAFRABAQAAAAAAAAAAAAAAAAAAIEH/2gAIAQEAAQUCp//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABcQAAMBAAAAAAAAAAAAAAAAAAAQEQH/2gAIAQEAAT8hGqlX/9oADAMBAAIAAwAAABAzz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABsQAQACAgMAAAAAAAAAAAAAAAEAESExEFGB/9oACAEBAAE/EHLtWbY4va0F7oi+n2XP/9k=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/679fb2ffb04485f26bc4fb6318182d8b/8ac56/004-01-compress.webp 240w,
/static/679fb2ffb04485f26bc4fb6318182d8b/d3be9/004-01-compress.webp 480w,
/static/679fb2ffb04485f26bc4fb6318182d8b/e46b2/004-01-compress.webp 960w,
/static/679fb2ffb04485f26bc4fb6318182d8b/78301/004-01-compress.webp 1282w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/679fb2ffb04485f26bc4fb6318182d8b/09b79/004-01-compress.jpg 240w,
/static/679fb2ffb04485f26bc4fb6318182d8b/7cc5e/004-01-compress.jpg 480w,
/static/679fb2ffb04485f26bc4fb6318182d8b/6a068/004-01-compress.jpg 960w,
/static/679fb2ffb04485f26bc4fb6318182d8b/d7177/004-01-compress.jpg 1282w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/jpeg&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/679fb2ffb04485f26bc4fb6318182d8b/6a068/004-01-compress.jpg&quot;
            alt=&quot;압축하기 명령 지정 완료&quot;
            title=&quot;압축하기 명령 지정 완료&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;압축하기 명령 지정 완료&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;압축 풀기 명령은 아래 내용을 입력합니다. &lt;br/&gt;&lt;br/&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;카테고리&lt;/th&gt;
&lt;th&gt;입력값&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;명령어&lt;/td&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;bandizip.exe&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;매개변수&lt;/td&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;bx -target:name -o:%P %P%N&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;툴팁&lt;/td&gt;
&lt;td&gt;해당 명령에 대한 톨팁값을 입력하시면 됩니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/2df8f9f4eaa2ed66e7bb2d67041e2f22/8b46b/003-2-unzip.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 41.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAIABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAByYAH/8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQABBQJ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAEP/aAAgBAQAGPwJ//8QAGRAAAgMBAAAAAAAAAAAAAAAAETEAARBh/9oACAEBAAE/ISexOs//2gAMAwEAAgADAAAAEHAP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhAAAgIDAAAAAAAAAAAAAAAAAAERIVFxgf/aAAgBAQABPxBtKukK004Y50f/2Q==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/2df8f9f4eaa2ed66e7bb2d67041e2f22/8ac56/003-2-unzip.webp 240w,
/static/2df8f9f4eaa2ed66e7bb2d67041e2f22/d3be9/003-2-unzip.webp 480w,
/static/2df8f9f4eaa2ed66e7bb2d67041e2f22/e46b2/003-2-unzip.webp 960w,
/static/2df8f9f4eaa2ed66e7bb2d67041e2f22/f37ae/003-2-unzip.webp 1330w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/2df8f9f4eaa2ed66e7bb2d67041e2f22/09b79/003-2-unzip.jpg 240w,
/static/2df8f9f4eaa2ed66e7bb2d67041e2f22/7cc5e/003-2-unzip.jpg 480w,
/static/2df8f9f4eaa2ed66e7bb2d67041e2f22/6a068/003-2-unzip.jpg 960w,
/static/2df8f9f4eaa2ed66e7bb2d67041e2f22/8b46b/003-2-unzip.jpg 1330w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/jpeg&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/2df8f9f4eaa2ed66e7bb2d67041e2f22/6a068/003-2-unzip.jpg&quot;
            alt=&quot;압축풀기 명령을 지정해봅시다.&quot;
            title=&quot;압축풀기 명령을 지정해봅시다.&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;압축풀기 명령을 지정해봅시다.&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;압축풀기 커스텀 명령을 지정 후 설정을 완료해줍시다!&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/79cfcbdf6f1adec340714976a965363c/d7177/004-02-uncompress.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 79.16666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAQABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAByYEUf//EABUQAQEAAAAAAAAAAAAAAAAAACBB/9oACAEBAAEFAqf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAXEAADAQAAAAAAAAAAAAAAAAAAEBEB/9oACAEBAAE/IRqpV//aAAwDAQACAAMAAAAQMw//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAcEAEAAgIDAQAAAAAAAAAAAAABABEhMRBhcZH/2gAIAQEAAT8Qcu1Ztji9rQXuiePsXqf/2Q==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/79cfcbdf6f1adec340714976a965363c/8ac56/004-02-uncompress.webp 240w,
/static/79cfcbdf6f1adec340714976a965363c/d3be9/004-02-uncompress.webp 480w,
/static/79cfcbdf6f1adec340714976a965363c/e46b2/004-02-uncompress.webp 960w,
/static/79cfcbdf6f1adec340714976a965363c/78301/004-02-uncompress.webp 1282w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/79cfcbdf6f1adec340714976a965363c/09b79/004-02-uncompress.jpg 240w,
/static/79cfcbdf6f1adec340714976a965363c/7cc5e/004-02-uncompress.jpg 480w,
/static/79cfcbdf6f1adec340714976a965363c/6a068/004-02-uncompress.jpg 960w,
/static/79cfcbdf6f1adec340714976a965363c/d7177/004-02-uncompress.jpg 1282w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/jpeg&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/79cfcbdf6f1adec340714976a965363c/6a068/004-02-uncompress.jpg&quot;
            alt=&quot;압축풀기 명령 지정 완료&quot;
            title=&quot;압축풀기 명령 지정 완료&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;압축풀기 명령 지정 완료&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;토탈-커맨더에서-압축하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%86%A0%ED%83%88-%EC%BB%A4%EB%A7%A8%EB%8D%94%EC%97%90%EC%84%9C-%EC%95%95%EC%B6%95%ED%95%98%EA%B8%B0&quot; aria-label=&quot;토탈 커맨더에서 압축하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;토탈 커맨더에서 압축하기&lt;/h2&gt;
&lt;p&gt;단축키 커스텀에서 지정한 단축키로 압축을 해봅시다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;압축할 파일을 &lt;code class=&quot;language-text&quot;&gt;Spacebar&lt;/code&gt;로 선택합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;F9&lt;/code&gt;를 눌러 압축을 수행합니다.&lt;/li&gt;
&lt;li&gt;압축이 완료되었습니다. 파일명은 &lt;code class=&quot;language-text&quot;&gt;pack.zip&lt;/code&gt; 입니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/2d74024f7e9725b43ee27f476bc8ad1c/a2267/005-01-zip-cmd.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 72.91666666666666%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAQFAf/EABQBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAZ7SzwSTBf/EABkQAAIDAQAAAAAAAAAAAAAAAAIDARAUE//aAAgBAQABBQJY9CyzSWSk9xV//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAHRAAAQMFAQAAAAAAAAAAAAAAAQAQEQISITIzkf/aAAgBAQAGPwKMBbUtcBK5j1v/xAAaEAEAAgMBAAAAAAAAAAAAAAABABEhMVGx/9oACAEBAAE/IXY6LzHb6SzkcBxqmKHWKn//2gAMAwEAAgADAAAAEAzP/8QAFxEAAwEAAAAAAAAAAAAAAAAAARARQf/aAAgBAwEBPxA3F//EABURAQEAAAAAAAAAAAAAAAAAABAh/9oACAECAQE/EKf/xAAfEAACAgAHAQAAAAAAAAAAAAABEQAhMUFRYXGB0aH/2gAIAQEAAT8QO2QEza7cwIW0LCt8hyF7h2kTcIFryEoSixeR5//Z&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/2d74024f7e9725b43ee27f476bc8ad1c/8ac56/005-01-zip-cmd.webp 240w,
/static/2d74024f7e9725b43ee27f476bc8ad1c/d3be9/005-01-zip-cmd.webp 480w,
/static/2d74024f7e9725b43ee27f476bc8ad1c/e46b2/005-01-zip-cmd.webp 960w,
/static/2d74024f7e9725b43ee27f476bc8ad1c/f992d/005-01-zip-cmd.webp 1440w,
/static/2d74024f7e9725b43ee27f476bc8ad1c/882b9/005-01-zip-cmd.webp 1920w,
/static/2d74024f7e9725b43ee27f476bc8ad1c/f9fc3/005-01-zip-cmd.webp 2170w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/2d74024f7e9725b43ee27f476bc8ad1c/09b79/005-01-zip-cmd.jpg 240w,
/static/2d74024f7e9725b43ee27f476bc8ad1c/7cc5e/005-01-zip-cmd.jpg 480w,
/static/2d74024f7e9725b43ee27f476bc8ad1c/6a068/005-01-zip-cmd.jpg 960w,
/static/2d74024f7e9725b43ee27f476bc8ad1c/644c5/005-01-zip-cmd.jpg 1440w,
/static/2d74024f7e9725b43ee27f476bc8ad1c/0f98f/005-01-zip-cmd.jpg 1920w,
/static/2d74024f7e9725b43ee27f476bc8ad1c/a2267/005-01-zip-cmd.jpg 2170w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/jpeg&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/2d74024f7e9725b43ee27f476bc8ad1c/6a068/005-01-zip-cmd.jpg&quot;
            alt=&quot;005 01 zip cmd&quot;
            title=&quot;005 01 zip cmd&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h2 id=&quot;토탈-커맨더에서-압축풀기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%86%A0%ED%83%88-%EC%BB%A4%EB%A7%A8%EB%8D%94%EC%97%90%EC%84%9C-%EC%95%95%EC%B6%95%ED%92%80%EA%B8%B0&quot; aria-label=&quot;토탈 커맨더에서 압축풀기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;토탈 커맨더에서 압축풀기&lt;/h2&gt;
&lt;p&gt;마찬가지로 단축키 커스텀에서 지정한 단축키로 압축을 풀어봅시다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;압축할 파일을 &lt;code class=&quot;language-text&quot;&gt;Spacebar&lt;/code&gt;로 선택합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Shift + F9&lt;/code&gt;를 눌러 압축해제를 수행합니다.&lt;/li&gt;
&lt;li&gt;압축파일 이름으로 디렉토리를 생성하여 압축 해제를 수행하였습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/e78776b3a692228334bebf1a49550d13/cf98e/005-02-unzip-cmd.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 73.75%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAUBAgME/8QAFAEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABX7U7QUEC/wD/xAAaEAEAAwADAAAAAAAAAAAAAAABAgMEABAT/9oACAEBAAEFAq4Ni5pnWe3xk7BOf//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABwQAAEEAwEAAAAAAAAAAAAAAAEAEBESEyKRof/aAAgBAQAGPwIgQp16xNbIjF63/8QAGRAAAwEBAQAAAAAAAAAAAAAAAAERIUFR/9oACAEBAAE/IUM4V1wQcUhV4Ia6KSmdFUEP/9oADAMBAAIAAwAAABBcz//EABcRAAMBAAAAAAAAAAAAAAAAAAEQEUH/2gAIAQMBAT8QNxf/xAAVEQEBAAAAAAAAAAAAAAAAAAAQIf/aAAgBAgEBPxCn/8QAHRAAAgICAwEAAAAAAAAAAAAAAREAITFRQWFxsf/aAAgBAQABPxB2d0I4SlYEjP5NSj2ANhxxW3iAYw4FKYWoDQn/2Q==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/e78776b3a692228334bebf1a49550d13/8ac56/005-02-unzip-cmd.webp 240w,
/static/e78776b3a692228334bebf1a49550d13/d3be9/005-02-unzip-cmd.webp 480w,
/static/e78776b3a692228334bebf1a49550d13/e46b2/005-02-unzip-cmd.webp 960w,
/static/e78776b3a692228334bebf1a49550d13/f992d/005-02-unzip-cmd.webp 1440w,
/static/e78776b3a692228334bebf1a49550d13/882b9/005-02-unzip-cmd.webp 1920w,
/static/e78776b3a692228334bebf1a49550d13/376b4/005-02-unzip-cmd.webp 2150w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/e78776b3a692228334bebf1a49550d13/09b79/005-02-unzip-cmd.jpg 240w,
/static/e78776b3a692228334bebf1a49550d13/7cc5e/005-02-unzip-cmd.jpg 480w,
/static/e78776b3a692228334bebf1a49550d13/6a068/005-02-unzip-cmd.jpg 960w,
/static/e78776b3a692228334bebf1a49550d13/644c5/005-02-unzip-cmd.jpg 1440w,
/static/e78776b3a692228334bebf1a49550d13/0f98f/005-02-unzip-cmd.jpg 1920w,
/static/e78776b3a692228334bebf1a49550d13/cf98e/005-02-unzip-cmd.jpg 2150w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/jpeg&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/e78776b3a692228334bebf1a49550d13/6a068/005-02-unzip-cmd.jpg&quot;
            alt=&quot;005 02 unzip cmd&quot;
            title=&quot;005 02 unzip cmd&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&quot;사실은&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%82%AC%EC%8B%A4%EC%9D%80&quot; aria-label=&quot;사실은 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;사실은…&lt;/h3&gt;
&lt;p&gt;압축폴더 안을 들어가서 &lt;code class=&quot;language-text&quot;&gt;Spacebar&lt;/code&gt;로 선택하여 &lt;code class=&quot;language-text&quot;&gt;F6&lt;/code&gt;을 수행하는 것으로도 압축을 풀 수는 있습니다만, 반디집을 사용해야할 필요가 있다면 이런 방법이 있음을 말씀드립니다!&lt;/p&gt;
&lt;h2 id=&quot;이거-안돼요&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%B4%EA%B1%B0-%EC%95%88%EB%8F%BC%EC%9A%94&quot; aria-label=&quot;이거 안돼요 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;이거 안돼요&lt;/h2&gt;
&lt;p&gt;막상 만들고 나니 아래 기능들이 없었습니다…&lt;/p&gt;
&lt;h3 id=&quot;파일-이름이-packzip-으로-고정이에요&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%8C%8C%EC%9D%BC-%EC%9D%B4%EB%A6%84%EC%9D%B4-packzip-%EC%9C%BC%EB%A1%9C-%EA%B3%A0%EC%A0%95%EC%9D%B4%EC%97%90%EC%9A%94&quot; aria-label=&quot;파일 이름이 packzip 으로 고정이에요 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;파일 이름이 &lt;code class=&quot;language-text&quot;&gt;pack.zip&lt;/code&gt; 으로 고정이에요&lt;/h3&gt;
&lt;p&gt;사용자 입력값을 받는 부분을 찾지못하여, 현재는 파일 압축 시 이름을 &lt;code class=&quot;language-text&quot;&gt;pack.zip&lt;/code&gt;으로 고정할 수 밖에 없었습니다. 추후 방법을 알아온다면 업데이트 하도록 하겠습니다.&lt;/p&gt;
&lt;p&gt;반디집 파라미터 및 토탈 커맨더의 기능을 조금 더 찾아본다면 가능할 것 같다는 생각이 드네요!&lt;/p&gt;
&lt;h3 id=&quot;암호걸린-파일은-어떻게-푸나요&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%95%94%ED%98%B8%EA%B1%B8%EB%A6%B0-%ED%8C%8C%EC%9D%BC%EC%9D%80-%EC%96%B4%EB%96%BB%EA%B2%8C-%ED%91%B8%EB%82%98%EC%9A%94&quot; aria-label=&quot;암호걸린 파일은 어떻게 푸나요 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;암호걸린 파일은 어떻게 푸나요?&lt;/h3&gt;
&lt;p&gt;사용자 입력값을 받을 수 있다면, 추가 커맨드를 주거나 해서 압축해제가 가능할 것으로 보입니다. 추후 방법을 알아온다면 업데이트 하도록 하겠습니다.&lt;/p&gt;
&lt;h2 id=&quot;마무리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%88%EB%AC%B4%EB%A6%AC&quot; aria-label=&quot;마무리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;마무리&lt;/h2&gt;
&lt;p&gt;그래도 커스텀 하니까 정말 제 도구처럼 애착이 붙는 것 같기도 하네요!&lt;/p&gt;
&lt;p&gt;다음번엔 보다 재밌는 주제를 소개할 수 있었으면 좋겠습니다. 감사합니다.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;참고링크&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://kr.bandisoft.com/bandizip/help/parameter/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;반디집 파라미터&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[토탈 커맨더 입문기 (1) 기본기]]></title><description><![CDATA[OFM의 터줏대감 중 하나인 토탈 커맨더 입문기입니다. 기본적인 사용법에 대해 알아봅시다.]]></description><link>https://blog.s3ich4n.me/tips/2022-12-30-total-commander-101-pt01</link><guid isPermaLink="false">https://blog.s3ich4n.me/tips/2022-12-30-total-commander-101-pt01</guid><pubDate>Fri, 30 Dec 2022 11:43:07 GMT</pubDate><content:encoded>&lt;h1 id=&quot;토탈-커맨더-써보기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%86%A0%ED%83%88-%EC%BB%A4%EB%A7%A8%EB%8D%94-%EC%8D%A8%EB%B3%B4%EA%B8%B0&quot; aria-label=&quot;토탈 커맨더 써보기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;토탈 커맨더 써보기&lt;/h1&gt;
&lt;h2 id=&quot;토탈-커맨더란&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%86%A0%ED%83%88-%EC%BB%A4%EB%A7%A8%EB%8D%94%EB%9E%80&quot; aria-label=&quot;토탈 커맨더란 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;토탈 커맨더란?&lt;/h2&gt;
&lt;p&gt;30년 가량의 유구한 전통을 가진 윈도우즈 유틸리티입니다. 현재까지도 무려 Windows 3.1 버전부터 지원을 하는 식입니다. 충분히 닉값하지요. GNU/Linux 진영의 GUI 버전으로는 &lt;a href=&quot;https://doublecmd.sourceforge.io/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Double Commander&lt;/a&gt;가 있고, CLI 버전으로는 &lt;a href=&quot;https://midnight-commander.org/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Midnight Commander&lt;/a&gt;가 있습니다. 터미널의 편의성에, 생각합니다.&lt;/p&gt;
&lt;p&gt;참고) 이런류의 파일 관리 프로그램을 &lt;a href=&quot;https://en.wikipedia.org/wiki/File_manager#Orthodox_file_managers&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Orthodox File Managers&lt;/a&gt;(abbr. OFM) 라고 일컫습니다. OFM에 대한 내용은 &lt;a href=&quot;https://softpanorama.org/OFM/index.shtml&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 글&lt;/a&gt;을 읽어보는 것을 추천합니다.&lt;/p&gt;
&lt;h2 id=&quot;기왕-쓰기로-했다면-잘-써보자구요&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B8%B0%EC%99%95-%EC%93%B0%EA%B8%B0%EB%A1%9C-%ED%96%88%EB%8B%A4%EB%A9%B4-%EC%9E%98-%EC%8D%A8%EB%B3%B4%EC%9E%90%EA%B5%AC%EC%9A%94&quot; aria-label=&quot;기왕 쓰기로 했다면 잘 써보자구요 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;기왕 쓰기로 했다면 잘 써보자구요&lt;/h2&gt;
&lt;p&gt;既来之, 则安之 라는 말이 있습니다. 기왕 쓰기로 했으면, 마음 굳히고 잘 해보자 라는 뜻이죠. 기왕 토탈 커맨더를 써보기로 했다면, OFM을 통해 아끼는 시간이 상당해지길 바랍니다. 이 글을 읽으시는 여러분들께도 마찬가지이길 바랍니다! &lt;a href=&quot;https://softpanorama.org/Articles/introduction_to_orthodox_file_managers.shtml#Recommendations_for_Users&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 글&lt;/a&gt;을 읽고 입문에 대한 방향성이 정해지길 바랍니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;OFM을 잘 쓰려면 꾸준한 연습이 필요합니다. 마치 악기를 다루는 것 처럼 꾸준히 사용해야 합니다.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://dictionary.cambridge.org/dictionary/english/log-book&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;로그북&lt;/a&gt;을 읽어봅시다. 처음에 무슨 표현인가 했더니, 사용설명서나 도움말 같은 느낌이더군요.
&lt;ol&gt;
&lt;li&gt;토탈 커맨더의 도움말은 &lt;code class=&quot;language-text&quot;&gt;F1&lt;/code&gt; 이다!&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;나만의 단축키를 익힙시다
&lt;ol&gt;
&lt;li&gt;토탈 커맨더의 기본 단축키 내용은 &lt;code class=&quot;language-text&quot;&gt;도움말 &gt;&gt; 단축키&lt;/code&gt; 를 차례로 클릭해서 확인할 수 있습니다.&lt;/li&gt;
&lt;li&gt;검색 후 필요한 내용을 찾고, 단축키를 바꿔봅시다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;(더 나아가서) 나만의 키보드 매크로와 유저 메뉴까지 만들어봅시다
&lt;ol&gt;
&lt;li&gt;이건 나중에 다뤄봅시다&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;OFM 유저 포럼이 있다면 “꼭” 들러봅시다!
&lt;ol&gt;
&lt;li&gt;선대 사람들이 묻고답한 내용들이 피가되고 살이될 수 있습니다&lt;/li&gt;
&lt;li&gt;당장 아래에서 소개할 커스텀 단축키 내용도, &lt;a href=&quot;https://ghisler.ch/board/viewtopic.php?t=3809&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;거의 20년된&lt;/a&gt; 답변에서 답을 얻었습니다!&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;주요-동작-익히기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A3%BC%EC%9A%94-%EB%8F%99%EC%9E%91-%EC%9D%B5%ED%9E%88%EA%B8%B0&quot; aria-label=&quot;주요 동작 익히기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;주요 동작 익히기&lt;/h2&gt;
&lt;p&gt;메인 화면에서?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;메인화면은 항상 좌측/우측으로 나누어져 있습니다. 좌측 → 우측, 우측 → 좌측으로 이동할 수 있습니다.&lt;/li&gt;
&lt;li&gt;마우스를 안 씁니다!&lt;/li&gt;
&lt;li&gt;앞으로 “이동한다” 라는 뜻은 반대쪽 탭으로 옮김을 일컫습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;주요 동작&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;파일/폴더 선택하기 → &lt;code class=&quot;language-text&quot;&gt;Spacebar&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;하나 뿐 아니라 여러개를 선택할 수 있습니다.&lt;/li&gt;
&lt;li&gt;옮기기
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;F6&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;폴더 즐겨찾기 → &lt;code class=&quot;language-text&quot;&gt;Ctrl + D&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;폴더 즐겨찾기 찾아가기&lt;/li&gt;
&lt;li&gt;폴더 즐겨찾기 등록하기 (&lt;code class=&quot;language-text&quot;&gt;A&lt;/code&gt; 입력)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;탭에서 선택한 하위 디렉토리를 반대쪽 탭에서 띄우기 (&lt;code class=&quot;language-text&quot;&gt;Ctrl + Shift + →&lt;/code&gt; 혹은 &lt;code class=&quot;language-text&quot;&gt;Ctrl + Shift + ←&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;이전 디렉토리로 돌아가기 (&lt;code class=&quot;language-text&quot;&gt;Alt + ←&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;파일 내용 보기 → &lt;code class=&quot;language-text&quot;&gt;F3&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;파일 내용 수정하기 → &lt;code class=&quot;language-text&quot;&gt;F4&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;지정한 프로그램을 이용하여 파일을 수정하게 할 수도 있습니다. 아래 탭에서 살펴보시죠.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;현재 디렉토리를 탐색기(File Explorer)에서 보기
&lt;ul&gt;
&lt;li&gt;(해당 디렉토리 선택 후) &lt;code class=&quot;language-text&quot;&gt;Ctrl + Enter&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;(현재 디렉토리 보기)&lt;code class=&quot;language-text&quot;&gt;.&lt;/code&gt; 입력 후 엔터&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;파일 비교하기
&lt;ul&gt;
&lt;li&gt;
&lt;ol&gt;
&lt;li&gt;양쪽 탭의 파일을 &lt;code class=&quot;language-text&quot;&gt;Spacebar&lt;/code&gt;로 선택&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;파일 &gt;&gt; 내용으로 비교&lt;/code&gt; 클릭 후 비교&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;하지만 이렇게 일일이 하기엔 번거롭기 때문에, 커스텀 단축키를 만들어 봅시다!&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;파일-수정-시-내가-지정한-프로그램으로-수정하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%8C%8C%EC%9D%BC-%EC%88%98%EC%A0%95-%EC%8B%9C-%EB%82%B4%EA%B0%80-%EC%A7%80%EC%A0%95%ED%95%9C-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%A8%EC%9C%BC%EB%A1%9C-%EC%88%98%EC%A0%95%ED%95%98%EA%B8%B0&quot; aria-label=&quot;파일 수정 시 내가 지정한 프로그램으로 수정하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;파일 수정 시, 내가 지정한 프로그램으로 수정하기&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;상단 메뉴바의 &lt;code class=&quot;language-text&quot;&gt;환경설정 &gt;&gt; 옵션&lt;/code&gt;을 클릭합니다&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;동작 &gt;&gt; 보기/편집&lt;/code&gt; 란으로 이동합니다&lt;/li&gt;
&lt;li&gt;&lt;em&gt;F4로 실행되는 편집 프로그램&lt;/em&gt; 을 지정합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/2caa7e254b13d0b8e871f8401071e778/99aeb/01_edit_via_vscode.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 79.16666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAQABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAByYEB/8QAFRABAQAAAAAAAAAAAAAAAAAAIEH/2gAIAQEAAQUCp//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABgQAAIDAAAAAAAAAAAAAAAAAAEQEUFh/9oACAEBAAE/ITqXb//aAAwDAQACAAMAAAAQA8//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAaEAEAAwEBAQAAAAAAAAAAAAABABEhMRCh/9oACAEBAAE/EDrH1HtTYNpUuPbvfP/Z&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/2caa7e254b13d0b8e871f8401071e778/8ac56/01_edit_via_vscode.webp 240w,
/static/2caa7e254b13d0b8e871f8401071e778/d3be9/01_edit_via_vscode.webp 480w,
/static/2caa7e254b13d0b8e871f8401071e778/e46b2/01_edit_via_vscode.webp 960w,
/static/2caa7e254b13d0b8e871f8401071e778/26255/01_edit_via_vscode.webp 1284w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/2caa7e254b13d0b8e871f8401071e778/09b79/01_edit_via_vscode.jpg 240w,
/static/2caa7e254b13d0b8e871f8401071e778/7cc5e/01_edit_via_vscode.jpg 480w,
/static/2caa7e254b13d0b8e871f8401071e778/6a068/01_edit_via_vscode.jpg 960w,
/static/2caa7e254b13d0b8e871f8401071e778/99aeb/01_edit_via_vscode.jpg 1284w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/jpeg&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/2caa7e254b13d0b8e871f8401071e778/6a068/01_edit_via_vscode.jpg&quot;
            alt=&quot;vscode를 편집프로그램으로 지정합니다.&quot;
            title=&quot;vscode를 편집프로그램으로 지정합니다.&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;vscode를 편집프로그램으로 지정합니다.&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;참고) 저는 &lt;a href=&quot;https://code.visualstudio.com/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;vscode&lt;/a&gt;를 사용하고, 설치 시 &lt;code class=&quot;language-text&quot;&gt;%PATH%&lt;/code&gt; 경로에 등록하여서 &lt;code class=&quot;language-text&quot;&gt;code&lt;/code&gt; 만 기재하였습니다! 추가하는 방법은 &lt;a href=&quot;https://code.visualstudio.com/docs/setup/windows&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 링크&lt;/a&gt;를 참고해 주세요.&lt;/p&gt;
&lt;h3 id=&quot;커스텀-단축키-만들기-토탈-커맨더-명령-지정&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%BB%A4%EC%8A%A4%ED%85%80-%EB%8B%A8%EC%B6%95%ED%82%A4-%EB%A7%8C%EB%93%A4%EA%B8%B0-%ED%86%A0%ED%83%88-%EC%BB%A4%EB%A7%A8%EB%8D%94-%EB%AA%85%EB%A0%B9-%EC%A7%80%EC%A0%95&quot; aria-label=&quot;커스텀 단축키 만들기 토탈 커맨더 명령 지정 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;커스텀 단축키 만들기: 토탈 커맨더 명령 지정&lt;/h3&gt;
&lt;p&gt;토탈 커맨더에 존재하는 명령을 단축키로 지정할 수도 있습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;상단 메뉴바의 &lt;code class=&quot;language-text&quot;&gt;환경설정 &gt;&gt; 옵션&lt;/code&gt;을 클릭합니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;기타&lt;/code&gt; 란으로 이동합니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;em&gt;단축키 재정의&lt;/em&gt; 를 통해 사용할 단축키를 지정해봅시다!&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;명령어가 먼저 등록되어 있는지부터 살펴봅시다. 저는 &lt;code class=&quot;language-text&quot;&gt;Ctrl + Y&lt;/code&gt;로 지정하겠습니다.&lt;/li&gt;
&lt;li&gt;아무 명령이 지정되어있지 않군요. 그렇다면 돋보기 버튼을 눌러 지정해봅시다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/f30e44bbd7976e549e3b426141b39484/99aeb/02-1_find_command_no_cmd_found.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 79.16666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAQABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAByYEB/8QAFRABAQAAAAAAAAAAAAAAAAAAIEH/2gAIAQEAAQUCp//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABcQAAMBAAAAAAAAAAAAAAAAAAAQEQH/2gAIAQEAAT8hGqlX/9oADAMBAAIAAwAAABATz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABsQAQACAgMAAAAAAAAAAAAAAAEAIRFREDFh/9oACAEBAAE/EG3lWdq4urgvRFO5nyf/2Q==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/f30e44bbd7976e549e3b426141b39484/8ac56/02-1_find_command_no_cmd_found.webp 240w,
/static/f30e44bbd7976e549e3b426141b39484/d3be9/02-1_find_command_no_cmd_found.webp 480w,
/static/f30e44bbd7976e549e3b426141b39484/e46b2/02-1_find_command_no_cmd_found.webp 960w,
/static/f30e44bbd7976e549e3b426141b39484/26255/02-1_find_command_no_cmd_found.webp 1284w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/f30e44bbd7976e549e3b426141b39484/09b79/02-1_find_command_no_cmd_found.jpg 240w,
/static/f30e44bbd7976e549e3b426141b39484/7cc5e/02-1_find_command_no_cmd_found.jpg 480w,
/static/f30e44bbd7976e549e3b426141b39484/6a068/02-1_find_command_no_cmd_found.jpg 960w,
/static/f30e44bbd7976e549e3b426141b39484/99aeb/02-1_find_command_no_cmd_found.jpg 1284w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/jpeg&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/f30e44bbd7976e549e3b426141b39484/6a068/02-1_find_command_no_cmd_found.jpg&quot;
            alt=&quot;이제 이 단축키는 제 겁니다&quot;
            title=&quot;이제 이 단축키는 제 겁니다&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;이제 이 단축키는 제 겁니다&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;두 파일을 비교하는 명령은 &lt;code class=&quot;language-text&quot;&gt;cm_CompareFilesByContent&lt;/code&gt; 입니다. (&lt;a href=&quot;https://ghisler.ch/board/viewtopic.php?t=3809&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;참고링크&lt;/a&gt;)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/5a5c6993b13dfc7a02cb200c913b58a1/de280/02-2_find_command_done.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 57.91666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAQAF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAckhGI//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAEFAl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAZEAACAwEAAAAAAAAAAAAAAAABEQAQIWH/2gAIAQEAAT8heDBHwR8o1//aAAwDAQACAAMAAAAQHD//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAwEBPxCI/8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQIBAT8Qqv/EABsQAQACAgMAAAAAAAAAAAAAAAEAERAhMWFx/9oACAEBAAE/EGuyXdp3GzDwnIQU4//Z&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/5a5c6993b13dfc7a02cb200c913b58a1/8ac56/02-2_find_command_done.webp 240w,
/static/5a5c6993b13dfc7a02cb200c913b58a1/d3be9/02-2_find_command_done.webp 480w,
/static/5a5c6993b13dfc7a02cb200c913b58a1/e46b2/02-2_find_command_done.webp 960w,
/static/5a5c6993b13dfc7a02cb200c913b58a1/f992d/02-2_find_command_done.webp 1440w,
/static/5a5c6993b13dfc7a02cb200c913b58a1/65131/02-2_find_command_done.webp 1586w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/5a5c6993b13dfc7a02cb200c913b58a1/09b79/02-2_find_command_done.jpg 240w,
/static/5a5c6993b13dfc7a02cb200c913b58a1/7cc5e/02-2_find_command_done.jpg 480w,
/static/5a5c6993b13dfc7a02cb200c913b58a1/6a068/02-2_find_command_done.jpg 960w,
/static/5a5c6993b13dfc7a02cb200c913b58a1/644c5/02-2_find_command_done.jpg 1440w,
/static/5a5c6993b13dfc7a02cb200c913b58a1/de280/02-2_find_command_done.jpg 1586w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/jpeg&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/5a5c6993b13dfc7a02cb200c913b58a1/6a068/02-2_find_command_done.jpg&quot;
            alt=&quot;설정을 완료합시다.&quot;
            title=&quot;설정을 완료합시다.&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;설정을 완료합시다.&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;초록 체크버튼을 눌러 단축키를 지정합니다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/b1615abf3a046611cd25153b873fcdf9/d7177/03-1_compare_before.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 79.16666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAQABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAByYEB/8QAFRABAQAAAAAAAAAAAAAAAAAAIEH/2gAIAQEAAQUCp//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABgQAAMBAQAAAAAAAAAAAAAAAAABEBEx/9oACAEBAAE/IX0OabP/2gAMAwEAAgADAAAAELPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGxABAQACAwEAAAAAAAAAAAAAAREAIRAxQVH/2gAIAQEAAT8Q2s3O2uF1UC/MVJvFvkz/2Q==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/b1615abf3a046611cd25153b873fcdf9/8ac56/03-1_compare_before.webp 240w,
/static/b1615abf3a046611cd25153b873fcdf9/d3be9/03-1_compare_before.webp 480w,
/static/b1615abf3a046611cd25153b873fcdf9/e46b2/03-1_compare_before.webp 960w,
/static/b1615abf3a046611cd25153b873fcdf9/78301/03-1_compare_before.webp 1282w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/b1615abf3a046611cd25153b873fcdf9/09b79/03-1_compare_before.jpg 240w,
/static/b1615abf3a046611cd25153b873fcdf9/7cc5e/03-1_compare_before.jpg 480w,
/static/b1615abf3a046611cd25153b873fcdf9/6a068/03-1_compare_before.jpg 960w,
/static/b1615abf3a046611cd25153b873fcdf9/d7177/03-1_compare_before.jpg 1282w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/jpeg&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/b1615abf3a046611cd25153b873fcdf9/6a068/03-1_compare_before.jpg&quot;
            alt=&quot;03 1 compare before&quot;
            title=&quot;03 1 compare before&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;그러면 빨갛게 변합니다. 단축키 지정을 완료했습니다!&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/249b80fc83d017716fedc343e6f9e8a5/d7177/03-2_setting_command_done.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 79.16666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAQABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAByYEB/8QAFRABAQAAAAAAAAAAAAAAAAAAIEH/2gAIAQEAAQUCp//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABcQAAMBAAAAAAAAAAAAAAAAAAAQEQH/2gAIAQEAAT8hGqlX/9oADAMBAAIAAwAAABATz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABoQAAMBAAMAAAAAAAAAAAAAAAABESEQMVH/2gAIAQEAAT8QevXTtnG23Er4htJpT//Z&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/249b80fc83d017716fedc343e6f9e8a5/8ac56/03-2_setting_command_done.webp 240w,
/static/249b80fc83d017716fedc343e6f9e8a5/d3be9/03-2_setting_command_done.webp 480w,
/static/249b80fc83d017716fedc343e6f9e8a5/e46b2/03-2_setting_command_done.webp 960w,
/static/249b80fc83d017716fedc343e6f9e8a5/78301/03-2_setting_command_done.webp 1282w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/249b80fc83d017716fedc343e6f9e8a5/09b79/03-2_setting_command_done.jpg 240w,
/static/249b80fc83d017716fedc343e6f9e8a5/7cc5e/03-2_setting_command_done.jpg 480w,
/static/249b80fc83d017716fedc343e6f9e8a5/6a068/03-2_setting_command_done.jpg 960w,
/static/249b80fc83d017716fedc343e6f9e8a5/d7177/03-2_setting_command_done.jpg 1282w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/jpeg&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/249b80fc83d017716fedc343e6f9e8a5/6a068/03-2_setting_command_done.jpg&quot;
            alt=&quot;03 2 setting command done&quot;
            title=&quot;03 2 setting command done&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h4 id=&quot;직접-해봅시다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A7%81%EC%A0%91-%ED%95%B4%EB%B4%85%EC%8B%9C%EB%8B%A4&quot; aria-label=&quot;직접 해봅시다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;직접 해봅시다!&lt;/h4&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Ctrl + Y&lt;/code&gt; 를 눌러, 두 파일을 비교해봅시다! 아래와 같은 창이 뜨며 비교한다면 성공입니다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/0d98d4a1b6e30993056402fe125bda41/25339/04_compare_done.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 49.16666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAByFCVj//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEAAQUCX//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABgQAQADAQAAAAAAAAAAAAAAAAEAEBFh/9oACAEBAAE/IV2bykon/9oADAMBAAIAAwAAABBjD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABsQAQEBAAIDAAAAAAAAAAAAAAERADFBUXGh/9oACAEBAAE/EKqhdMke8I9fcF4NDwYE4N//2Q==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/0d98d4a1b6e30993056402fe125bda41/8ac56/04_compare_done.webp 240w,
/static/0d98d4a1b6e30993056402fe125bda41/d3be9/04_compare_done.webp 480w,
/static/0d98d4a1b6e30993056402fe125bda41/e46b2/04_compare_done.webp 960w,
/static/0d98d4a1b6e30993056402fe125bda41/f992d/04_compare_done.webp 1440w,
/static/0d98d4a1b6e30993056402fe125bda41/de45f/04_compare_done.webp 1664w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/0d98d4a1b6e30993056402fe125bda41/09b79/04_compare_done.jpg 240w,
/static/0d98d4a1b6e30993056402fe125bda41/7cc5e/04_compare_done.jpg 480w,
/static/0d98d4a1b6e30993056402fe125bda41/6a068/04_compare_done.jpg 960w,
/static/0d98d4a1b6e30993056402fe125bda41/644c5/04_compare_done.jpg 1440w,
/static/0d98d4a1b6e30993056402fe125bda41/25339/04_compare_done.jpg 1664w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/jpeg&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/0d98d4a1b6e30993056402fe125bda41/6a068/04_compare_done.jpg&quot;
            alt=&quot;두 파일을 성공적으로 비교하였습니다.&quot;
            title=&quot;두 파일을 성공적으로 비교하였습니다.&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;두 파일을 성공적으로 비교하였습니다.&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;토탈-커맨더-로그&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%86%A0%ED%83%88-%EC%BB%A4%EB%A7%A8%EB%8D%94-%EB%A1%9C%EA%B7%B8&quot; aria-label=&quot;토탈 커맨더 로그 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;토탈 커맨더 로그&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;%TEMP%&lt;/code&gt; 에 저장됩니다.&lt;/li&gt;
&lt;li&gt;성공한 커맨드에 대해서는 로그가 남는데, 실패한 커맨드(E.g., 잘못 입력한 명령 등)는 로그가 안 남더라구요.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;마무리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%88%EB%AC%B4%EB%A6%AC&quot; aria-label=&quot;마무리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;마무리&lt;/h2&gt;
&lt;p&gt;이 정도만 해도 제가 쓰는 완전 기본적인 내용은 소개가 된 듯 합니다. 향후에도 괜찮은 내용이 있다면 소개드리겠습니다. 봐주셔서 감사합니다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[[CloudNet@] 테라폼 스터디 9주차 - Working with Multiple Providers]]></title><description><![CDATA[Terraform을 통해 다양한 프로바이더에 대한 배포, 멀티 계정 활용 등에 대한 기본을 학습해봅시다.]]></description><link>https://blog.s3ich4n.me/devlog/terraform/2022-12-13-cloudneta-terraform-101-pt09</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/terraform/2022-12-13-cloudneta-terraform-101-pt09</guid><pubDate>Mon, 12 Dec 2022 05:50:00 GMT</pubDate><content:encoded>&lt;p&gt;이 내용은 CloudNet@ 에서 진행하는 테라폼 기초 입문 스터디에 대한 연재글입니다.&lt;/p&gt;
&lt;p&gt;스터디에서 사용하는 교재는 &lt;a href=&quot;http://www.yes24.com/Product/Goods/101511312&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Terraform Up &amp;#x26; Running 2nd Edition&lt;/a&gt; 입니다.&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id=&quot;prerequisites&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#prerequisites&quot; aria-label=&quot;prerequisites permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Prerequisites&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;테라폼을 처음 배우면서 함께 살펴봐도 좋을 듯 합니다&lt;/li&gt;
&lt;li&gt;하지만, 제 8장을 이해하고 오신다면 보다 더 낫겠습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;본문&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%B3%B8%EB%AC%B8&quot; aria-label=&quot;본문 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;본문&lt;/h1&gt;
&lt;p&gt;현재까지의 테라폼 코드는 모두 이 코드가 들어가 있었습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;provider &quot;aws&quot; {
  region = &quot;us-east-2&quot;
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;그렇지만, 필요에 따라 MS Azure나 GCP를 사용한다면 어떻게 해야할까요? 다른 리전이나 여러 리전을 선택할 수는 있을까요? 혹은 계정별로 권한을 분리하여 작업하려면 어떻게 해야할까요? 프로바이더 블록에 대해 다시 한번 살펴봅시다.&lt;/p&gt;
&lt;h2 id=&quot;provider-deep-dive&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#provider-deep-dive&quot; aria-label=&quot;provider deep dive permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Provider deep-dive&lt;/h2&gt;
&lt;p&gt;프로바이더를 알기 전, 테라폼 코어와 프로바이더에 대해 간략히 살펴봅시다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;core&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;테라폼 바이너리입니다.&lt;/li&gt;
&lt;li&gt;모든 플랫폼에서 사용되는 테라폼의 모든 기본 기능을 제공합니다.&lt;/li&gt;
&lt;li&gt;명령줄 인터페이스(예: 계획, 적용 등), Terraform 코드(HCL)용 파서 및 해석기, 리소스 및 데이터 소스에서 종속성 그래프를 작성하는 기능, 상태 파일을 읽고 쓰는 논리 등입니다.&lt;/li&gt;
&lt;li&gt;내부적인 코드는 Go로 작성되었으며 HashiCorp에서 관리하는 GitHub 저장소에 있습니다. (오픈소스입니다!)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;provider&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;테라폼 코어를 위한 플러그인입니다.&lt;/li&gt;
&lt;li&gt;각 플러그인은 AWS, Azure, GCP 등 외부 플랫폼과 통신합니다. 초기에는 HashiCorp 측에서 프로바이더를 만들었지만, 지금은 메인 프로바이더의 경우 각 회사에서 직접 프로바이더를 관리합니다.&lt;/li&gt;
&lt;li&gt;각 프로바이더는 특정 접두사를 할당하고, 해당 접두사를 포함하는 하나 이상의 리소스 및 데이터 소스를 표현합니다.
&lt;ul&gt;
&lt;li&gt;E.g., &lt;code class=&quot;language-text&quot;&gt;aws_&lt;/code&gt; prefix: &lt;code class=&quot;language-text&quot;&gt;aws_instance&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;aws_autoscaling_group&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;aws_ami&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;E.g., &lt;code class=&quot;language-text&quot;&gt;azurerm_&lt;/code&gt; prefix: &lt;code class=&quot;language-text&quot;&gt;azurerm_virtual_machine&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;azurerm_virtual_machine_scale_set&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;azurerm_image&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Terraform 코어는 RPC(원격 프로시저 호출)를 통해 플러그인과 통신하며 해당 플러그인은 차례로 아래 그림과 같이 네트워크를 통해(예: HTTP 호출을 통해) 해당 플랫폼과 통신합니다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/c561771300765fd3d3253fbb88a9f75e/9ecec/09_001.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 52.5%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAgAEBf/EABUBAQEAAAAAAAAAAAAAAAAAAAEA/9oADAMBAAIQAxAAAAHsHSAEqf/EABgQAQEBAQEAAAAAAAAAAAAAAAECEhEA/9oACAEBAAEFAtuSmpjvPIZiQn//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAgEBPwFn/8QAGhAAAgIDAAAAAAAAAAAAAAAAAAEQERIhMv/aAAgBAQAGPwJvGh6OWoqP/8QAGhABAAMBAQEAAAAAAAAAAAAAAQARIUEQUf/aAAgBAQABPyFtjr9SOdlOCRrejr5aUyYAn//aAAwDAQACAAMAAAAQPw//xAAYEQACAwAAAAAAAAAAAAAAAAAAAREhMf/aAAgBAwEBPxC0S3p//8QAGBEBAQEBAQAAAAAAAAAAAAAAAREAIbH/2gAIAQIBAT8QAtnuADhN/8QAGxABAAMBAAMAAAAAAAAAAAAAAQARITFBUWH/2gAIAQEAAT8QtujZ0R24wvHnqMVu2Gr9iCIxXiHBSFiq23V2f//Z&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/c561771300765fd3d3253fbb88a9f75e/8ac56/09_001.webp 240w,
/static/c561771300765fd3d3253fbb88a9f75e/d3be9/09_001.webp 480w,
/static/c561771300765fd3d3253fbb88a9f75e/e46b2/09_001.webp 960w,
/static/c561771300765fd3d3253fbb88a9f75e/c139f/09_001.webp 1050w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/c561771300765fd3d3253fbb88a9f75e/09b79/09_001.jpg 240w,
/static/c561771300765fd3d3253fbb88a9f75e/7cc5e/09_001.jpg 480w,
/static/c561771300765fd3d3253fbb88a9f75e/6a068/09_001.jpg 960w,
/static/c561771300765fd3d3253fbb88a9f75e/9ecec/09_001.jpg 1050w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/jpeg&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/c561771300765fd3d3253fbb88a9f75e/6a068/09_001.jpg&quot;
            alt=&quot;09_001&quot;
            title=&quot;09_001&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;09_001&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;단독-프로바이더-사용방안&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8B%A8%EB%8F%85-%ED%94%84%EB%A1%9C%EB%B0%94%EC%9D%B4%EB%8D%94-%EC%82%AC%EC%9A%A9%EB%B0%A9%EC%95%88&quot; aria-label=&quot;단독 프로바이더 사용방안 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;단독 프로바이더 사용방안&lt;/h2&gt;
&lt;p&gt;단독 프로바이더를 통해 작업하는 방안에 대해 살펴보겠습니다. 기존까지 사용하던 프로바이더를 정확히 알아봅시다.&lt;/p&gt;
&lt;p&gt;프로바이더를 선언하고 &lt;code class=&quot;language-text&quot;&gt;terraform init&lt;/code&gt; 을 하면, 프로바이더 코드를 자동으로 다운로드 받습니다.&lt;/p&gt;
&lt;p&gt;이런 코드에 대해 만들고&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;provider&lt;span class=&quot;token type variable&quot;&gt; &quot;aws&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;region&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;us-east-2&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;…이어서 &lt;code class=&quot;language-text&quot;&gt;terraform init&lt;/code&gt;을 하면, 이런 식이지요.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;terraform init

Initializing provider plugins&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;.
- Finding hashicorp/aws versions matching &lt;span class=&quot;token string&quot;&gt;&quot;4.19.0&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;.
- Installing hashicorp/aws v4.19.0&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;.
- Installed hashicorp/aws v4.19.0 &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;signed by HashiCorp&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;프로바이더를 보다 상세하게 설정하고싶다면 어떻게 해야할까요?&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;terraform&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;required_providers&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &amp;lt;LOCAL_NAME&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;source&lt;/span&gt;  &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&amp;lt;URL&gt;&quot;&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;version&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&amp;lt;VERSION&gt;&quot;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;지난 장에서 살펴보았던 &lt;code class=&quot;language-text&quot;&gt;require_providers&lt;/code&gt; 블록을 사용합니다. 보다 자세하게 살펴보죠.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;&amp;lt;LOCAL_NAME&gt;&lt;/code&gt; : provider 가 사용할 local name 이며, 각 provider 에서 유일한 이름이여야 합니다. 드문 경우 지만 만약 두 프로바이더가 http 경로를 중복 사용 시, 로컬 이름으로 구별 할 수 있습니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;&amp;lt;URL&gt;&lt;/code&gt; : 해당 provider 다운로드 URL 이며, 형식은 &lt;code class=&quot;language-text&quot;&gt;[&amp;lt;HOSTNAME&gt;/]&amp;lt;NAMESPACE&gt;/&amp;lt;TYPE&gt;&lt;/code&gt; 입니다.
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;HOSTNAME&lt;/code&gt;: 프로바이더를 배포하는 테라폼 레지스트리의 호스트 이름입니다. 생략 시 테라폼 공개 레지스트리를 가리킵니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;NAMESPACE&lt;/code&gt;: 조직 네임스페이스 입니다(일반적으로 회사 이름).&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;TYPE&lt;/code&gt;: 프로바이더가 관리하는 플랫폼의 이름입니다(일반적으로 TYPE는 기본 로컬 이름).
&lt;ul&gt;
&lt;li&gt;E.g.,
&lt;ul&gt;
&lt;li&gt;aws 프로바이더 전체 URL) &lt;strong&gt;registry.terraform.io/hashicorp/aws&lt;/strong&gt; → 생략 표현이 가능합니다! &lt;strong&gt;hashicorp/aws&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;&amp;lt;VERSION&gt;&lt;/code&gt;: 버전 조건입니다. 예를 들어 &lt;code class=&quot;language-text&quot;&gt;4.19.0&lt;/code&gt; 처럼 특정 버전을 지정하거나, &lt;code class=&quot;language-text&quot;&gt;&gt; 4.0 , &amp;lt; 4.3&lt;/code&gt; 처럼 버전 범위를 지정할 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;아래 코드는 AWS 4.x 프로바이더 버전 설치를 지정하는 코드의 예시입니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;terraform {
  required_providers {
    aws = {
      source  = &quot;hashicorp/aws&quot;
      version = &quot;~&gt; 4.0&quot;
    }
  }
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이제야 각종 오픈소스들에서 이렇게 쓰는 이유를 알겠군요. 프로바이더 블록만 단독으로 쓰기보다는, 이 편이 더 좋은 듯 합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;terraform&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;required_providers&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;aws&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;source&lt;/span&gt;  &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;hashicorp/aws&quot;&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;version&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;~&gt; 4.0&quot;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;동일-프로바이더에서-여러-복사본을-사용하는-방안&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8F%99%EC%9D%BC-%ED%94%84%EB%A1%9C%EB%B0%94%EC%9D%B4%EB%8D%94%EC%97%90%EC%84%9C-%EC%97%AC%EB%9F%AC-%EB%B3%B5%EC%82%AC%EB%B3%B8%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%EB%B0%A9%EC%95%88&quot; aria-label=&quot;동일 프로바이더에서 여러 복사본을 사용하는 방안 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;동일 프로바이더에서 여러 복사본을 사용하는 방안&lt;/h2&gt;
&lt;p&gt;동일 프로바이더에서 여러 리전을 작업하거나, 여러 계정을 통해 작업하는 방안에 대해 살펴봅시다.&lt;/p&gt;
&lt;h3 id=&quot;여러-aws-리전에-대해-작업하는-방안&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%97%AC%EB%9F%AC-aws-%EB%A6%AC%EC%A0%84%EC%97%90-%EB%8C%80%ED%95%B4-%EC%9E%91%EC%97%85%ED%95%98%EB%8A%94-%EB%B0%A9%EC%95%88&quot; aria-label=&quot;여러 aws 리전에 대해 작업하는 방안 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;여러 AWS 리전에 대해 작업하는 방안&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;chapter09/examples01&lt;/code&gt;의 파일들을 살펴보고, 각 세부문단 별로 명령을 내려 결과를 살펴봅시다.&lt;/p&gt;
&lt;h4 id=&quot;멀티리전-배포-1-테스트&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A9%80%ED%8B%B0%EB%A6%AC%EC%A0%84-%EB%B0%B0%ED%8F%AC-1-%ED%85%8C%EC%8A%A4%ED%8A%B8&quot; aria-label=&quot;멀티리전 배포 1 테스트 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;멀티리전 배포 (1), 테스트&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; chapter09/examples01/01_multi_region

&lt;span class=&quot;token comment&quot;&gt;# init &amp;amp; plan &amp;amp; apply&lt;/span&gt;
tfenv use &lt;span class=&quot;token number&quot;&gt;1.2&lt;/span&gt;.3
terraform init
terraform plan &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt; terraform apply -auto-approve
Outputs:
region_1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;us-east-2&quot;&lt;/span&gt;
region_2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;us-west-1&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&quot;멀티리전-배포-2-ec2-배포-관련&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A9%80%ED%8B%B0%EB%A6%AC%EC%A0%84-%EB%B0%B0%ED%8F%AC-2-ec2-%EB%B0%B0%ED%8F%AC-%EA%B4%80%EB%A0%A8&quot; aria-label=&quot;멀티리전 배포 2 ec2 배포 관련 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;멀티리전 배포 (2), EC2 배포 관련&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# [터미널1] us-east-2&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; aws ec2 describe-instances &lt;span class=&quot;token parameter variable&quot;&gt;--region&lt;/span&gt; us-east-2 &lt;span class=&quot;token parameter variable&quot;&gt;--query&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Reservations[*].Instances[*].{PublicIPAdd:PublicIpAddress,InstanceName:Tags[?Key==&apos;Name&apos;]|[0].Value,Status:State.Name}&quot;&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;--filters&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;Name&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;instance-state-name,Values&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;running &lt;span class=&quot;token parameter variable&quot;&gt;--output&lt;/span&gt; text &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;------------------------------&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sleep&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;done&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# [터미널2] us-west-1&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; aws ec2 describe-instances &lt;span class=&quot;token parameter variable&quot;&gt;--region&lt;/span&gt; us-west-1  &lt;span class=&quot;token parameter variable&quot;&gt;--query&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Reservations[*].Instances[*].{PublicIPAdd:PublicIpAddress,InstanceName:Tags[?Key==&apos;Name&apos;]|[0].Value,Status:State.Name}&quot;&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;--filters&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;Name&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;instance-state-name,Values&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;running &lt;span class=&quot;token parameter variable&quot;&gt;--output&lt;/span&gt; text &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;------------------------------&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sleep&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;done&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 작업 경로로 이동&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; chapter09/examples01/02_multi_region_ec2

&lt;span class=&quot;token comment&quot;&gt;# init &amp;amp; plan &amp;amp; apply&lt;/span&gt;
terraform init
terraform plan &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; terraform apply -auto-approve
Outputs:

instance_region_1_az &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;us-east-2c&quot;&lt;/span&gt;
instance_region_2_az &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;us-west-1c&quot;&lt;/span&gt;
region_1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;us-east-2&quot;&lt;/span&gt;
region_2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;us-west-1&quot;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 삭제 : 아래 RDS 배포 후 데이터 INSERT 등 실습 후 삭제해도 됨&lt;/span&gt;
terraform destroy -auto-approve&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&quot;멀티리전-배포-3-primary-rds의-replica-rds를-다른-리전에-배포-시&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A9%80%ED%8B%B0%EB%A6%AC%EC%A0%84-%EB%B0%B0%ED%8F%AC-3-primary-rds%EC%9D%98-replica-rds%EB%A5%BC-%EB%8B%A4%EB%A5%B8-%EB%A6%AC%EC%A0%84%EC%97%90-%EB%B0%B0%ED%8F%AC-%EC%8B%9C&quot; aria-label=&quot;멀티리전 배포 3 primary rds의 replica rds를 다른 리전에 배포 시 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;멀티리전 배포 (3), Primary RDS의 Replica RDS를 다른 리전에 배포 시&lt;/h4&gt;
&lt;p&gt;참고사항: Primary RDS 는 &lt;code class=&quot;language-text&quot;&gt;backup_retention_period&lt;/code&gt; 설정이 &lt;code class=&quot;language-text&quot;&gt;0&lt;/code&gt;보다 커야 되며, &lt;code class=&quot;language-text&quot;&gt;replicate_source_db&lt;/code&gt; ARN 설정 시 replica RDS 입니다. - &lt;a href=&quot;https://github.com/brikis98/terraform-up-and-running-code/blob/3rd-edition/code/terraform/07-working-with-multiple-providers/modules/data-stores/mysql/variables.tf&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;참고 링크&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# [터미널1] us-east-2&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; aws rds describe-db-instances &lt;span class=&quot;token parameter variable&quot;&gt;--region&lt;/span&gt; us-east-2 &lt;span class=&quot;token parameter variable&quot;&gt;--query&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;*[].[Endpoint.Address,Endpoint.Port,MasterUsername]&quot;&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;--output&lt;/span&gt; text  &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;------------------------------&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sleep&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;done&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# [터미널2] us-west-1&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; aws rds describe-db-instances &lt;span class=&quot;token parameter variable&quot;&gt;--region&lt;/span&gt; us-west-1 &lt;span class=&quot;token parameter variable&quot;&gt;--query&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;*[].[Endpoint.Address,Endpoint.Port,MasterUsername]&quot;&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;--output&lt;/span&gt; text  &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;------------------------------&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sleep&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;done&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 환경변수에 지정&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;TF_VAR_db_username&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;cloudneta&apos;&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;TF_VAR_db_password&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;cloudnetaQ!&apos;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 이동&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; chapter09/examples01/03_multi_region_rds_with_replica

&lt;span class=&quot;token comment&quot;&gt;# main.tf 에 백엔드 부분 수정&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;vi&lt;/span&gt; main.tf
  backend &lt;span class=&quot;token string&quot;&gt;&quot;s3&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# This backend configuration is filled in automatically at test time by Terratest. If you wish to run this example&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# manually, uncomment and fill in the config below.&lt;/span&gt;
    bucket         &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ex9-t101-tfstate&quot;&lt;/span&gt;
    key            &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;prod/data-stores/mysql/terraform.tfstate&quot;&lt;/span&gt;
    region         &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;us-east-2&quot;&lt;/span&gt;
    dynamodb_table &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ex9-t101-locks&quot;&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# encrypt        = true&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 초기화 및 검증 : 환경변수 적용 확인&lt;/span&gt;
terraform init
terraform plan

&lt;span class=&quot;token comment&quot;&gt;# 배포 : 총 25분 정도 소요 (8분 후 primary 완료, 이후 16분 후 replica 생성 및 동기화 완료)&lt;/span&gt;
terraform apply -auto-approve
terraform output
aws s3 &lt;span class=&quot;token function&quot;&gt;ls&lt;/span&gt; s3://&lt;span class=&quot;token variable&quot;&gt;$TF_VAR_bucket_name&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;--recursive&lt;/span&gt; --human-readable &lt;span class=&quot;token parameter variable&quot;&gt;--summarize&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# (옵션) Primary RDS에 데이터 INSERT 후 Replica RDS에 복제되는지 확인 해볼것&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 삭제 6분 정도 소요&lt;/span&gt;
terraform destroy -auto-approve

&lt;span class=&quot;token comment&quot;&gt;# S3/DynamoDB 삭제&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; ~/terraform-up-and-running-code/code/terraform/03-terraform-state/file-layout-example/global/s3
terraform destroy -auto-approve&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&quot;주의사항&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A3%BC%EC%9D%98%EC%82%AC%ED%95%AD&quot; aria-label=&quot;주의사항 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;주의사항&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;Warning 1 : Multiregion is hard, 프로덕션 수준의 멀티 리전은 &lt;strong&gt;어렵습니다&lt;/strong&gt;!
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Active-Active&lt;/strong&gt; 멀티 리전 서비스를 위한 ‘&lt;strong&gt;지역간 지연 시간, 고유 ID, 최종 일관성&lt;/strong&gt;’ 등 여러가지 고려사항이 많아서 쉽지 않습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Warning 2 : Use aliases sparingly, Alias 를 빈번하게 사용하지 맙시다!
&lt;ul&gt;
&lt;li&gt;별칭을 사용하여 두 리전에 배포하는 단일 테라폼 모듈은 한 리전이 다운 시, plan 과 apply 시도가 실패합니다.&lt;/li&gt;
&lt;li&gt;프로덕션 환경은 멀티 리전의 별칭을 사용하는 것보다는, 3장에서 설명한 것 처럼 &lt;strong&gt;환경&lt;/strong&gt;을 완전히 &lt;strong&gt;격리&lt;/strong&gt;해야 합니다. 이를 통해 영향도를 최소화 할 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;여러-aws-계정에-대해-작업하는-방안&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%97%AC%EB%9F%AC-aws-%EA%B3%84%EC%A0%95%EC%97%90-%EB%8C%80%ED%95%B4-%EC%9E%91%EC%97%85%ED%95%98%EB%8A%94-%EB%B0%A9%EC%95%88&quot; aria-label=&quot;여러 aws 계정에 대해 작업하는 방안 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;여러 AWS 계정에 대해 작업하는 방안&lt;/h3&gt;
&lt;p&gt;배우기에 앞서, 멀티 계정을 사용하는 이유에 대해 알아봅시다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Isolation (aka. compartmentalization)
&lt;ul&gt;
&lt;li&gt;Staging 과 Prod 간 다른 계정을 사용함으로써 각자에게 끼치는 영향을 최소화합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Authentication and authorization
&lt;ul&gt;
&lt;li&gt;다중 계정에 따른 인증과 권한 분리로 각자에게 끼치는 영향을 최소화합니다(예를 들면 권한을 잘못 부여 시)&lt;/li&gt;
&lt;li&gt;계정 별 세분화된 권한으로 접근통제가 가능합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Auditing and reporting
&lt;ul&gt;
&lt;li&gt;모든 환경과 계정의 변경 사항 및 감사 추적이 가능합니다.&lt;/li&gt;
&lt;li&gt;이를 통해 규정 준수와 이상 징후 감시를 할 수 있고 비용 추적등에 용이해집니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&quot;사전작업&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%82%AC%EC%A0%84%EC%9E%91%EC%97%85&quot; aria-label=&quot;사전작업 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;사전작업&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;AWS Organizaions 설정 및 계정 초대를 실시합니다.
&lt;ol&gt;
&lt;li&gt;이 때, 그룹 하의 계정을 2개 만듭시다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;AWS IAM 정책과 산하에 속한 계정을 설정합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&quot;실습&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%8B%A4%EC%8A%B5&quot; aria-label=&quot;실습 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;실습&lt;/h4&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;chapter09/examples02&lt;/code&gt; 의 파일들을 살펴보고, 아래 명령으로 결과를 살펴봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# 이동&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; chapter09/examples02

&lt;span class=&quot;token comment&quot;&gt;# IAM Role ARN 지정&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#export TF_VAR_child_iam_role_arn=&apos;arn:aws:iam::&amp;lt;자신의 두 번째 혹은 세 번째 계정 Account ID&gt;:role/&amp;lt;해당 계정의 IAM Role 이름&gt;&apos;&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;TF_VAR_child_iam_role_arn&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;arn:aws:iam::REDACTED_CHILD:role/role-name-unknown&apos;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 배포 확인&lt;/span&gt;
terraform init
terraform plan &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; terraform apply -auto-approve
Outputs:
child_account_id &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;REDACTED_CHILD&quot;&lt;/span&gt;
parent_account_id &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;REDACTED_PARENTS&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&quot;주의-사항&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A3%BC%EC%9D%98-%EC%82%AC%ED%95%AD&quot; aria-label=&quot;주의 사항 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;주의 사항&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;Warning 1 : Cross-account IAM roles are double opt-in
&lt;ul&gt;
&lt;li&gt;교차 계정 역할 동작을 위해서 2개의 계정에서 모두 &lt;strong&gt;권한 등 설정&lt;/strong&gt;이 필요합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Warning 2 : Use aliases sparingly Alias 를 빈번하게 사용하지 맙시다!
&lt;ul&gt;
&lt;li&gt;영향도 최소를 위해서 계정 간 분리를 하는 것을 권장합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;여러-프로바이더에서-작업하는-방안-추후-업로드&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%97%AC%EB%9F%AC-%ED%94%84%EB%A1%9C%EB%B0%94%EC%9D%B4%EB%8D%94%EC%97%90%EC%84%9C-%EC%9E%91%EC%97%85%ED%95%98%EB%8A%94-%EB%B0%A9%EC%95%88-%EC%B6%94%ED%9B%84-%EC%97%85%EB%A1%9C%EB%93%9C&quot; aria-label=&quot;여러 프로바이더에서 작업하는 방안 추후 업로드 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;여러 프로바이더에서 작업하는 방안 (추후 업로드!)&lt;/h2&gt;
&lt;h1 id=&quot;lessons-learned&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#lessons-learned&quot; aria-label=&quot;lessons learned permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Lessons Learned&lt;/h1&gt;
&lt;p&gt;제 9장에서는 아래의 내용을 반드시 기억하셨으면 좋겠습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;provider 블록에 대해 보다 더 깊게 살펴보았습니다.&lt;/li&gt;
&lt;li&gt;계정별, 여러 프로바이더 별, 여러 리전 별 배포 또한 가능함을 살펴보았습니다.&lt;/li&gt;
&lt;li&gt;도커와 쿠버네티스 실습환경에 대한 내용은 곧 업데이트 하겠습니다!&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이것으로 제 9장을 마칩니다. 긴 글 읽어주셔서 감사합니다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[[CloudNet@] 테라폼 스터디 8주차 - 프로덕션 수준의 테라폼 코드]]></title><description><![CDATA[Terraform을 프로덕션 레벨 정도로 사용하려면 어느정도는 할 수 있어야하고, 어떤걸 살펴봐야 할까요? 이 포스팅에서는 그 부분을 공부해보았습니다.]]></description><link>https://blog.s3ich4n.me/devlog/terraform/2022-12-12-cloudneta-terraform-101-pt08</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/terraform/2022-12-12-cloudneta-terraform-101-pt08</guid><pubDate>Mon, 12 Dec 2022 04:43:39 GMT</pubDate><content:encoded>&lt;p&gt;이 내용은 &lt;a href=&quot;https://www.notion.so/gasidaseo/CloudNet-Blog-c9dfa44a27ff431dafdd2edacc8a1863&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;CloudNet@&lt;/a&gt; 에서 진행하는 테라폼 기초 입문 스터디에 대한 연재글입니다.&lt;/p&gt;
&lt;p&gt;스터디에서 사용하는 교재는 &lt;a href=&quot;http://www.yes24.com/Product/Goods/101511312&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Terraform Up &amp;#x26; Running 2nd Edition&lt;/a&gt; 입니다.&lt;/p&gt;
&lt;h1 id=&quot;prerequisites&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#prerequisites&quot; aria-label=&quot;prerequisites permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Prerequisites&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;아무래도 기존 내용을 모두 학습해야 하겠죠.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.yes24.com/Product/Goods/11681152&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;클린 코드&lt;/a&gt;를 읽고 오시면 더욱 좋습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;본문&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%B3%B8%EB%AC%B8&quot; aria-label=&quot;본문 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;본문&lt;/h1&gt;
&lt;h2 id=&quot;프로덕션-레벨의-인프라-by-production-grade-infrastructure&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%94%84%EB%A1%9C%EB%8D%95%EC%85%98-%EB%A0%88%EB%B2%A8%EC%9D%98-%EC%9D%B8%ED%94%84%EB%9D%BC-by-production-grade-infrastructure&quot; aria-label=&quot;프로덕션 레벨의 인프라 by production grade infrastructure permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;프로덕션 레벨의 인프라 (By production-grade Infrastructure)&lt;/h2&gt;
&lt;p&gt;저자의 프로덕션 레벨의 인프라 정의는 아래 요소들이 모두 잘 갖추어져있고, 이중화/장애대응까지 완벽히 되어있음을 말합니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;서버&lt;/li&gt;
&lt;li&gt;데이터 저장소&lt;/li&gt;
&lt;li&gt;로드 밸런서&lt;/li&gt;
&lt;li&gt;보안 기능&lt;/li&gt;
&lt;li&gt;모니터링/경고 도구&lt;/li&gt;
&lt;li&gt;파이프라인 구축&lt;/li&gt;
&lt;li&gt;비즈니스 운영에 필요한 기타 모든 도구&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;아울러, 저자는 프로덕션 수준의 인프라를 만드는 프로젝트에 소요되는 대략적인 시간을 아래 정도가 걸린다고 산정하였습니다.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;인프라 유형&lt;/th&gt;
&lt;th&gt;예&lt;/th&gt;
&lt;th&gt;예상 소요 시간&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;관리형 서비스 Managed service&lt;/td&gt;
&lt;td&gt;Amazon RDS&lt;/td&gt;
&lt;td&gt;1~2주&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;스스로 관리하는 분산 시스템 (상태 비저장) Self-managed distributed system (stateless)&lt;/td&gt;
&lt;td&gt;Node.js 앱이 실행되는 ASG 클러스터&lt;/td&gt;
&lt;td&gt;2~4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;스스로 관리하는 분산 시스템 (상태 저장) Self-managed distributed system (stateful)&lt;/td&gt;
&lt;td&gt;Amazon Elasticsearch cluster&lt;/td&gt;
&lt;td&gt;2~4개월&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;전체 아키텍처 Entire architecture&lt;/td&gt;
&lt;td&gt;애플리케이션, 데이터 저장소, 로드 밸런서, 모니터링 등&lt;/td&gt;
&lt;td&gt;6~36개월&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;저는 아직 프로덕션 경험이 없지만, 개인적으로 만들고싶은 서비스를 구축한다면 관리형 서비스 ~ self managed 분산 시스템(stateless) 까지는 헤메면서 2주는 쓸 것 같습니다. 전체 아키텍처를 모두 구성하는데 길면 3년이 걸린다고 하니, 역시나 쉬운길은 아니네요. 그런데, 왜 이렇게 오래 걸리는걸까요?&lt;/p&gt;
&lt;h2 id=&quot;프로덕션-수준의-인프라-구축에-시간이-오래-걸리는-이유&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%94%84%EB%A1%9C%EB%8D%95%EC%85%98-%EC%88%98%EC%A4%80%EC%9D%98-%EC%9D%B8%ED%94%84%EB%9D%BC-%EA%B5%AC%EC%B6%95%EC%97%90-%EC%8B%9C%EA%B0%84%EC%9D%B4-%EC%98%A4%EB%9E%98-%EA%B1%B8%EB%A6%AC%EB%8A%94-%EC%9D%B4%EC%9C%A0&quot; aria-label=&quot;프로덕션 수준의 인프라 구축에 시간이 오래 걸리는 이유 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;프로덕션 수준의 인프라 구축에 시간이 오래 걸리는 이유&lt;/h2&gt;
&lt;p&gt;DevOps 프로젝트는 다른 유형의 소프트웨어 프로젝트보다 더 시간이 소요될 수 있습니다. 아래에서 이야기되는 사항들이 그 이유입니다.&lt;/p&gt;
&lt;h3 id=&quot;호프스태터의-법칙hofstadters-law&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%98%B8%ED%94%84%EC%8A%A4%ED%83%9C%ED%84%B0%EC%9D%98-%EB%B2%95%EC%B9%99hofstadters-law&quot; aria-label=&quot;호프스태터의 법칙hofstadters law permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;호프스태터의 법칙(Hofstadter’s Law)&lt;/h3&gt;
&lt;p&gt;호프스태터의 법칙은 일을 마치는데 더 오랜 시간이 걸리는 현상을 의미합니다. 일정보다 늦어질 것을 미리 예상했다 하더라도 여전히 일정보다 늦어진다는 것이죠. 아래와 같은 말로 언급되는 경우가 많습니다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;호프스태터의 법칙: 일은 항상 예상시간 보다 더 오래 걸린다. 호프스태터의 법칙을 고려했다고 하더라도…&lt;/p&gt;
&lt;p&gt;Hofstadter’s Law: It always takes longer than you expect, even when you take into account Hofstadter’s Law.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;데브옵스-산업은-초창기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8D%B0%EB%B8%8C%EC%98%B5%EC%8A%A4-%EC%82%B0%EC%97%85%EC%9D%80-%EC%B4%88%EC%B0%BD%EA%B8%B0&quot; aria-label=&quot;데브옵스 산업은 초창기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;데브옵스 산업은 초창기&lt;/h3&gt;
&lt;p&gt;저자는 이를 “아직 석기시대에 있다”(…the industry is still in its infancy) 라고 표하였습니다. 클라우드 컴퓨팅, IaC, DevOps, 컨테이너 기술의 출현과 발전속도가 매우 빠르고 성숙하는 단계에 있다고 하였기 떄문입니다.&lt;/p&gt;
&lt;h3 id=&quot;데브옵스는-야크-털깎기-현상에-취약&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8D%B0%EB%B8%8C%EC%98%B5%EC%8A%A4%EB%8A%94-%EC%95%BC%ED%81%AC-%ED%84%B8%EA%B9%8E%EA%B8%B0-%ED%98%84%EC%83%81%EC%97%90-%EC%B7%A8%EC%95%BD&quot; aria-label=&quot;데브옵스는 야크 털깎기 현상에 취약 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;데브옵스는 “야크 털깎기” 현상에 취약&lt;/h3&gt;
&lt;p&gt;야크 털깎기는 목적을 이루기 위해 본래 목적과 전혀 상관없어 보이는 일들을 계속 해오고, 종국에는 그것을 이루는 행동을 말합니다.&lt;/p&gt;
&lt;p&gt;극단적인 예시를 하나 보시죠. &lt;a href=&quot;https://scholar.google.com/citations?user=t0yrrzQAAAAJ&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;도널드 커누스&lt;/a&gt;처럼 업계 부동의 원탑인 사람이라면, 책 쓰다가 디지털 조판 시스템이 답답해서 TeX를 &lt;em&gt;자신이 직접 만든&lt;/em&gt; 프로그래밍 언어로 완성함과 동시에 폰트도 만들고, 폰트의 그래픽스를 정의하기 위한 언어도 만들고, 장치종속을 풀기위해 포맷까지 만들었다고 하지요. (책을 쓰는데 10년이 걸렸다고 합니다. 그 책은 다름아닌 &lt;a href=&quot;https://www-cs-faculty.stanford.edu/~knuth/taocp.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;TAOCP&lt;/a&gt; 입니다.)&lt;/p&gt;
&lt;p&gt;누구나 그럴 수는 없음을 압니다. 그리고 회사는 정해진 기한과 목표물이 있지요. 저는 이를 &lt;em&gt;삽질&lt;/em&gt; 이라고 배웠습니다. 독자 여러분들도 생각해보면 ‘이런 개념이 이렇게 불리는구나’ 하셨을 것이란 생각이 드네요.&lt;/p&gt;
&lt;p&gt;앞서말했듯, 업계가 아직 태동기에 있으니 더더욱 그럴 수 밖에 없으리라는 것이 저자의 의견입니다.&lt;/p&gt;
&lt;h3 id=&quot;수행해야하는-체크리스트가-매우-많음&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%88%98%ED%96%89%ED%95%B4%EC%95%BC%ED%95%98%EB%8A%94-%EC%B2%B4%ED%81%AC%EB%A6%AC%EC%8A%A4%ED%8A%B8%EA%B0%80-%EB%A7%A4%EC%9A%B0-%EB%A7%8E%EC%9D%8C&quot; aria-label=&quot;수행해야하는 체크리스트가 매우 많음 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;수행해야하는 체크리스트가 매우 많음&lt;/h3&gt;
&lt;p&gt;대다수 개발자가 체크 리스트에 있는 대부분의 항목을 알지 못하기 때문에, 프로젝트를 평가할 때 중요하고 시간이 많이 걸리는 세부 사항을 잊어버립니다. 체크리스트는 아래와 같습니다:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;작업&lt;/th&gt;
&lt;th&gt;설명&lt;/th&gt;
&lt;th&gt;사용가능 도구&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;설치&lt;br /&gt;(Install)&lt;/td&gt;
&lt;td&gt;소프트웨어 바이너리, 필요 종속성 설치&lt;/td&gt;
&lt;td&gt;Bash, Chef, Ansible, Puppet&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;설정&lt;br /&gt;(Configure)&lt;/td&gt;
&lt;td&gt;포트 설정, TLS 인증서, 서비스 디스커버리, 리더/팔로워 복제 등의 소프트웨어 설정&lt;/td&gt;
&lt;td&gt;Bash, Chef, Ansible, Puppet&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;프로비전&lt;br /&gt;(Provision)&lt;/td&gt;
&lt;td&gt;서버, 로드 밸런서, 네트워크, 방화벽, IAM 권한 설정 등의 인프라 제공&lt;/td&gt;
&lt;td&gt;Terraform, CloudFormation&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;배포&lt;br /&gt;(Deploy)&lt;/td&gt;
&lt;td&gt;인프라 상위의 서비스 배포&lt;br /&gt;중단시간 없이 업데이트 롤아웃&lt;br /&gt;블루-그린, 카나리 배포 등&lt;/td&gt;
&lt;td&gt;Terraform, CloudFormation, k8s, ECS&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;고가용성&lt;br /&gt;(High Availability)&lt;/td&gt;
&lt;td&gt;프로세스, 서버, 서비스, 데이터 센터, 리전 등의 장애에 대비&lt;/td&gt;
&lt;td&gt;멀티 데이터센터, 멀티 리전, 복제, 오토스케일링, 로드밸런싱&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;확장성&lt;br /&gt;(Scailability)&lt;/td&gt;
&lt;td&gt;요청량에 따른 스케일 업/아웃&lt;br /&gt;수평적 확장(더 많은 서버), 수직적 확장(더 큰 용량)&lt;/td&gt;
&lt;td&gt;오토스케일링, 복제, 샤딩, 캐싱, 분할정복&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;성능&lt;br /&gt;(Performance)&lt;/td&gt;
&lt;td&gt;CPU, 메모리, 디스크, 네트워크, GPU 용량 최적화&lt;br /&gt;쿼리 튜닝, 벤치마킹, 테스트, 프로파일링&lt;/td&gt;
&lt;td&gt;Dynatrace, valgrind, VisualVM, ab, JMeter&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;네트워킹&lt;br /&gt;(Networking)&lt;/td&gt;
&lt;td&gt;정적·동적 IP 설정, 포트, 서비스 디스커버리, 방화벽, DNS, SSH 접속, VPN 연결&lt;/td&gt;
&lt;td&gt;VPC, 방화벽, 라우터, DNS Registers, OpenVPN&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;보안&lt;br /&gt;(Security)&lt;/td&gt;
&lt;td&gt;TLS를 통한 통신 중 데이터 암호화, 디스크 암호화, 인증, 인가, 보안 관리, 서버 하드닝&lt;/td&gt;
&lt;td&gt;ACM, Let’s Encrypt, KMS, Cognito, Vault, CIS&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;성능지표&lt;br /&gt;(Metrics)&lt;/td&gt;
&lt;td&gt;가용성, 비즈니스, 애플리케이션, 서버, 이벤트, 추적, 알람에 대한 메트릭&lt;/td&gt;
&lt;td&gt;CloudWatch, Datadog, New Relic, Honeycomb&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;로그&lt;br /&gt;(Logs)&lt;/td&gt;
&lt;td&gt;로그 순환, 중앙으로 데이터 수집&lt;/td&gt;
&lt;td&gt;CloudWatch Logs, ELK, Sumo Logic, Papertrail&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;백업 및 복구&lt;br /&gt;(Backup and Restore)&lt;/td&gt;
&lt;td&gt;DB, 캐시, 기타 데이터를 일정에 따라 백업&lt;br /&gt;리전 별, 계정 별 복제&lt;/td&gt;
&lt;td&gt;RDS, ElastiCache, 복제&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;비용 최적화&lt;br /&gt;(Cost Optimization)&lt;/td&gt;
&lt;td&gt;적절한 인스턴스 유형 선택, 스팟 혹은 예약 인스턴스 사용, 오토스케일링, 사용하지 않는 리소스 정리&lt;/td&gt;
&lt;td&gt;오토스케일링, 스팟 인스턴스, 예약 인스턴스&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;문서화&lt;br /&gt;(Documentation)&lt;/td&gt;
&lt;td&gt;코드, 아키텍처, 모든 내용을 문서화&lt;br /&gt;장애 대응 내용 정리(Postmortem)&lt;/td&gt;
&lt;td&gt;README, 각종 위키, Slack&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;테스트&lt;br /&gt;(Tests)&lt;/td&gt;
&lt;td&gt;인프라 코드를 테스트 자동화&lt;br /&gt;항상 테스트 후 배포&lt;/td&gt;
&lt;td&gt;Terratest, inspec, serverspec, kitchen-terraform&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;와 세상에 이렇게나 많습니다! 그런데…&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;서버나 로드밸런서가 다운된다면 어떻게 될까요? 데이터 센터에 문제가 생긴다면 어떻게 될까요?&lt;/li&gt;
&lt;li&gt;VPC를 위시로 한 네트워킹 작업 또한 정말 어렵습니다. 그뿐일까요, VPN, Service Discovery, SSH Access 등 정말 많습니다!&lt;/li&gt;
&lt;li&gt;그렇지만, 프로젝트 계획 및 시간 예측에서 배제되는 경우가 많습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;즉, 이러한 연유로 인해 프로젝트 계획 및 시간 예측이 너무나 어렵습니다.&lt;/p&gt;
&lt;h2 id=&quot;프로덕션-수준의-인프라-모듈&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%94%84%EB%A1%9C%EB%8D%95%EC%85%98-%EC%88%98%EC%A4%80%EC%9D%98-%EC%9D%B8%ED%94%84%EB%9D%BC-%EB%AA%A8%EB%93%88&quot; aria-label=&quot;프로덕션 수준의 인프라 모듈 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;프로덕션 수준의 인프라 모듈&lt;/h2&gt;
&lt;p&gt;그렇다면 프로덕션 레벨의 테라폼 코드는 어떤 것들이 필요한지 살펴보겠습니다. 테라폼 코드는 &lt;strong&gt;재사용 가능한 모듈&lt;/strong&gt; 단위로 작성하는 것이 좋습니다. 이에 대한 모범사례를 살펴봅시다. 다룰 주제는 아래와 같습니다.&lt;/p&gt;
&lt;h3 id=&quot;소형-모듈을-써야하는-이유&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%86%8C%ED%98%95-%EB%AA%A8%EB%93%88%EC%9D%84-%EC%8D%A8%EC%95%BC%ED%95%98%EB%8A%94-%EC%9D%B4%EC%9C%A0&quot; aria-label=&quot;소형 모듈을 써야하는 이유 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;소형 모듈을 써야하는 이유&lt;/h3&gt;
&lt;p&gt;3장에서 학습했던 상태 파일 격리에서 알아본 것과 같이, 모든 인프라 환경은 단일파일, 단일 모듈로 정의해서는 좋지 않은 수준이 아니라 &lt;strong&gt;유해&lt;/strong&gt; 한 것으로 간주합니다. 아래의 이유로 인해 그렇습니다.&lt;/p&gt;
&lt;h4 id=&quot;대형모듈을-썼을-떄의-문제점&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8C%80%ED%98%95%EB%AA%A8%EB%93%88%EC%9D%84-%EC%8D%BC%EC%9D%84-%EB%96%84%EC%9D%98-%EB%AC%B8%EC%A0%9C%EC%A0%90&quot; aria-label=&quot;대형모듈을 썼을 떄의 문제점 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;대형모듈을 썼을 떄의 문제점&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;속도가 느림(slow): 모든 인프라가 하나의 모듈에 정의되어 있으면 명령 실행 시 오래 걸립니다. &lt;code class=&quot;language-text&quot;&gt;terraform plan&lt;/code&gt; 구동 시 20분 걸리기도 합니다.&lt;/li&gt;
&lt;li&gt;안전하지 않음(insecure): 모든 인프라가 하나의 모듈에 정의되어 있으면, 어떤 것을 변경 시 모든 액세스 권한을 사용하게 됩니다.
&lt;ul&gt;
&lt;li&gt;따라서 모든 사용자에게 관리자 권한을 부여하게 되지요.&lt;/li&gt;
&lt;li&gt;이는 최소 권한 원칙(principle of least privilege) 에 위배됩니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;위험성이 높음(risky): 예를 들어 스테이징 환경에서 프런트엔드 앱을 변경 시 오타나 잘못된 명령으로 프로덕션 데이터베이스를 삭제하는 대참사가 발생할 수 있습니다…&lt;/li&gt;
&lt;li&gt;이해하기 어려움(understand) : 한 곳에 코드가 많을수록 한 사람이 모든 것을 이해하기가 더 어려워집니다.&lt;/li&gt;
&lt;li&gt;리뷰하기 어려움(review) : 수집 줄의 코드로 구성된 모듈을 리뷰하는 것은 쉽지만, 수천 줄의 코드로 구성된 모듈을 리뷰하는 것은 거의 불가능입니다.
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;terraform plan&lt;/code&gt; 실행 시 오래 거리고, plan 명령의 출력이 수천 줄이며 아무도 코드를 읽으려 하지 않을겁니다.&lt;/li&gt;
&lt;li&gt;예를들어, 이 경우 데이터베이스가 삭제될 것임을 나타내는 빨간색 코드가 있더라도 누구 하나 발견하지 못할 수도 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;테스트하기 어려움(test) : 인프라 코드 테스트하기 매우 힘들어집니다! 다음 장에서 살펴보도록 하겠습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;따라서, 이런 이유로 인해 소형 모듈을 사용하는 편이 보다 좋은 코드가 되겠습니다.&lt;/p&gt;
&lt;h4 id=&quot;소형-모듈을-사용하는-방안&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%86%8C%ED%98%95-%EB%AA%A8%EB%93%88%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%EB%B0%A9%EC%95%88&quot; aria-label=&quot;소형 모듈을 사용하는 방안 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;소형 모듈을 사용하는 방안&lt;/h4&gt;
&lt;p&gt;소형 모듈로 내용을 줄여보기 전에 클린코드에 나오는 격언 중 하나를 소개하면 좋은 대목인 것 같군요.&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;함수의 첫 번째 규칙은 작아야한다는 것.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;함수의 두 번째 규칙은, 그보다 더 작아야한다는 것.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;p&gt;예시로 한번 살펴보겠습니다.&lt;/p&gt;
&lt;p&gt;이런 아키텍처의 코드가 단 한줄뿐이라면… 그것은 코드 스멜입니다! 코드 스멜은 더 큰 문제를 일으키기 쉬운 코드지요. 저는 냄새나는 코드라고 부릅니다.&lt;/p&gt;
&lt;p&gt;기존 예시라면, 지난 7장에서 살펴본 ASG, ALB, 헬로월드 앱을 각각의 소형 모듈로 나누어봅시다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;./media/01_examples-of-complicated-aws-architecture.jpg&quot; alt=&quot;examples-of-complicated-aws-architecture&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;합성-가능한-모듈&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%95%A9%EC%84%B1-%EA%B0%80%EB%8A%A5%ED%95%9C-%EB%AA%A8%EB%93%88&quot; aria-label=&quot;합성 가능한 모듈 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;합성 가능한 모듈&lt;/h3&gt;
&lt;p&gt;여기서부턴 코드확인이 필요합니다. &lt;code class=&quot;language-text&quot;&gt;chapter08&lt;/code&gt; 디렉토리를 확인해주세요. 경로는 &lt;a href=&quot;https://github.com/s3ich4n/terraform-study-101/tree/main/chapter08&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;여기&lt;/a&gt; 입니다. 베이스코드는 7장에서 작성한 코드입니다.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;재사용 가능하고 합성 가능한 모듈&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;외부에서 상태를 읽는 대신 입력 매개 변수를 통해 전달하고, 외부에 상태를 쓰는 대신 출력 매개 변수를 통해 계산 결과를 반환합니다.&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;모든 것을 입력 변수를 통해 전달하고 모든 것을 출력 변수를 통해 반환하며 간단한 모듈들을 결합해 더 복잡한 모듈을 만들수 있다.&lt;/li&gt;
&lt;li&gt;실제 사용 시에는 더 나은 합성과 재사용을 위해 아래 실습 내용 보다 모듈을 더욱 세분화해야 할 수도 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;그러면, 코드 리팩토링을 진행해볼까요.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;기존 &lt;code class=&quot;language-text&quot;&gt;webserver-cluster&lt;/code&gt;는 하드코딩 되어있었고, 이를 아래와 같이 재작성합니다.
&lt;ol&gt;
&lt;li&gt;variables 별도 분리를 통한 서브넷, 타겟 그룹명, 헬스체크 타입, &lt;code class=&quot;language-text&quot;&gt;user_data&lt;/code&gt; 변경 가능하도록 수정
&lt;ol&gt;
&lt;li&gt;유연한 변경이 가능하도록 작성&lt;/li&gt;
&lt;li&gt;기본 서브넷이 아니라, 개별 VPC, 서브넷으로 사용가능&lt;/li&gt;
&lt;li&gt;타겟 그룹명, 헬스체크 타입 변수로 ASG를 로드 밸런서와 통합&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;출력변수 추가
&lt;ol&gt;
&lt;li&gt;output 변수를 통해&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;테스트-가능한-모듈&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%85%8C%EC%8A%A4%ED%8A%B8-%EA%B0%80%EB%8A%A5%ED%95%9C-%EB%AA%A8%EB%93%88&quot; aria-label=&quot;테스트 가능한 모듈 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;테스트 가능한 모듈&lt;/h3&gt;
&lt;p&gt;수정한 코드를 직접 구동해봅시다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;asg-rolling-deploy&lt;/code&gt; 모듈을 사용하여, 크기 1인 ASG를 배포하는 코드를 봅시다.&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;terraform&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;required_version&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&gt;= 1.0.0, &amp;lt; 2.0.0&quot;&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;required_providers&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;aws&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;source&lt;/span&gt;  &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;hashicorp/aws&quot;&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;version&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;~&gt; 4.0&quot;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;provider&lt;span class=&quot;token type variable&quot;&gt; &quot;aws&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;region&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;us-east-2&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 모듈을 사용하여, 상기 리팩토링을 통해 수정한 내용을 쉽게 배포할 수 있게 되었습니다!&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# 개인적으로는, 모듈 직전의 코드를 직접 쳐봐야 모듈화를 할 수 있는 통찰이 생기고,&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# 이를 통해 프로비저닝 및 배포를 테라폼으로 할 수 있다고 생각합니다.&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;module&lt;span class=&quot;token type variable&quot;&gt; &quot;asg&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;source&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;../../modules/cluster/asg-rolling-deploy&quot;&lt;/span&gt;

  &lt;span class=&quot;token property&quot;&gt;cluster_name&lt;/span&gt;  &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; var.cluster_name

  &lt;span class=&quot;token property&quot;&gt;ami&lt;/span&gt;           &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; data.aws_ami.ubuntu.id
  &lt;span class=&quot;token property&quot;&gt;instance_type&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;t2.micro&quot;&lt;/span&gt;

  &lt;span class=&quot;token property&quot;&gt;min_size&lt;/span&gt;           &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;max_size&lt;/span&gt;           &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;enable_autoscaling&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;

  &lt;span class=&quot;token property&quot;&gt;subnet_ids&lt;/span&gt;        &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; data.aws_subnets.default.ids
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;data &lt;span class=&quot;token type variable&quot;&gt;&quot;aws_vpc&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;default&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;data &lt;span class=&quot;token type variable&quot;&gt;&quot;aws_subnets&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;default&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;filter&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;name&lt;/span&gt;   &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;vpc-id&quot;&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;values&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;data.aws_vpc.default.id&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;data &lt;span class=&quot;token type variable&quot;&gt;&quot;aws_ami&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ubuntu&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;most_recent&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;owners&lt;/span&gt;      &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;099720109477&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# Canonical&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;filter&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;name&lt;/span&gt;   &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;name&quot;&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;values&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;ubuntu/images/hvm-ssd/ubuntu-focal-20.04-amd64-server-*&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;배포 및 확인은 아래 코드로 진행하면 됩니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# [터미널1] RDS 생성 모니터링&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; aws rds describe-db-instances &lt;span class=&quot;token parameter variable&quot;&gt;--query&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;*[].[Endpoint.Address,Endpoint.Port,MasterUsername]&quot;&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;--output&lt;/span&gt; text  &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;------------------------------&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sleep&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;done&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# RDS 배포&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; chapter08/examples01/small-modules/examples/mysql

&lt;span class=&quot;token comment&quot;&gt;# 환경변수에 지정&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;TF_VAR_db_username&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;cloudneta&apos;&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;TF_VAR_db_password&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;cloudnetaQ!&apos;&lt;/span&gt;

terraform init &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; terraform plan
terraform apply -auto-approve

&lt;span class=&quot;token comment&quot;&gt;# [터미널2]&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; aws ec2 describe-instances &lt;span class=&quot;token parameter variable&quot;&gt;--query&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Reservations[*].Instances[*].{PublicIPAdd:PublicIpAddress,InstanceName:Tags[?Key==&apos;Name&apos;]|[0].Value,Status:State.Name}&quot;&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;--filters&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;Name&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;instance-state-name,Values&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;running &lt;span class=&quot;token parameter variable&quot;&gt;--output&lt;/span&gt; text &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;------------------------------&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sleep&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;done&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 배포&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; chapter08/examples01/small-modules/examples/asg
terraform init
terraform plan
terraform apply -auto-approve

&lt;span class=&quot;token comment&quot;&gt;# ALB 배포&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; chapter08/examples01/small-modules/examples/alb
terraform init &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; terraform plan
terraform apply -auto-approve

&lt;span class=&quot;token comment&quot;&gt;# ALB DNS주소로 curl 접속 확인&lt;/span&gt;
&lt;span class=&quot;token assign-left variable&quot;&gt;ALBDNS&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;terraform output &lt;span class=&quot;token parameter variable&quot;&gt;-raw&lt;/span&gt; alb_dns_name&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;curl&lt;/span&gt; --connect-timeout &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;  http://&lt;span class=&quot;token variable&quot;&gt;$ALBDNS&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;------------------------------&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sleep&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;done&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;curl&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-s&lt;/span&gt; http://&lt;span class=&quot;token variable&quot;&gt;$ALBDNS&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;릴리즈-가능한-모듈버저닝&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A6%B4%EB%A6%AC%EC%A6%88-%EA%B0%80%EB%8A%A5%ED%95%9C-%EB%AA%A8%EB%93%88%EB%B2%84%EC%A0%80%EB%8B%9D&quot; aria-label=&quot;릴리즈 가능한 모듈버저닝 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;릴리즈 가능한 모듈(버저닝)&lt;/h3&gt;
&lt;h4 id=&quot;validations&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#validations&quot; aria-label=&quot;validations permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Validations&lt;/h4&gt;
&lt;p&gt;테라폼 0.13부터 등장한 validation blocks 은 입력 변수를 체크할 수 있습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;variable&lt;span class=&quot;token type variable&quot;&gt; &quot;instance_type&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;description&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;The type of EC2 Instances to run (e.g. t2.micro)&quot;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;type&lt;/span&gt;        &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; string

  &lt;span class=&quot;token comment&quot;&gt;# t2.micro 혹은 t3.micro만 사용할 수 있도록 체크하는 로직입니다!&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;validation&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;condition&lt;/span&gt;     &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; contains(&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;t2.micro&quot;&lt;/span&gt;, &lt;span class=&quot;token string&quot;&gt;&quot;t3.micro&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;, var.instance_type)
    &lt;span class=&quot;token property&quot;&gt;error_message&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Only free tier is allowed: t2.micro | t3.micro.&quot;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;만일 validation에 실패한다면, 아래와 같은 에러 메시지를 리턴하게 됩니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;$ terraform apply -var &lt;span class=&quot;token property&quot;&gt;instance_type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;m4.large&quot;&lt;/span&gt;
│ Error: Invalid value for variable
│
│   on main.tf line &lt;span class=&quot;token number&quot;&gt;17&lt;/span&gt;:
│    &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;: &lt;span class=&quot;token keyword&quot;&gt;variable&lt;span class=&quot;token type variable&quot;&gt; &quot;instance_type&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
│     ├────────────────
│     │ var.instance_type is &lt;span class=&quot;token string&quot;&gt;&quot;m4.large&quot;&lt;/span&gt;
│
│ Only free tier is allowed: t2.micro | t3.micro.
│
│ This was checked by the validation rule at main.tf:&lt;span class=&quot;token number&quot;&gt;21&lt;/span&gt;,&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;-&lt;span class=&quot;token number&quot;&gt;13.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&quot;versioned-modules&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#versioned-modules&quot; aria-label=&quot;versioned modules permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Versioned Modules&lt;/h4&gt;
&lt;p&gt;인프라 코드는 오늘 실행하든 3년후에 실행하든 동일한 결과를 얻을 수 있어야 합니다. 테라폼 코어, 프로바이더 및 버전을 명시하여 이를 가능하게 합니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;모듈 버저닝&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;테라폼 코어(&lt;code class=&quot;language-text&quot;&gt;core&lt;/code&gt;를 의미): 테라폼 실행파일 버전을 &lt;code class=&quot;language-text&quot;&gt;required_version&lt;/code&gt; 이란 값으로 명시합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;terraform&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# Require any 1.x version of Terraform&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;required_version&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&gt;= 1.0.0, &amp;lt; 2.0.0&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 프로덕션은 완전히 구체적인 버전을 지칭하는 것이 좋습니다.&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;terraform&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# Require any 1.x version of Terraform&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;required_version&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;1.2.3&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;프로바이더 버전: 프로바이더 버전 또한 &lt;code class=&quot;language-text&quot;&gt;require_providers&lt;/code&gt; 블록으로 명시합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;terraform&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;required_version&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&gt;= 1.0.0, &amp;lt; 2.0.0&quot;&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;required_providers&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;aws&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;source&lt;/span&gt;  &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;hashicorp/aws&quot;&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;version&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;~&gt; 4.0&quot;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;모듈 버전: 모듈 자체의 버전 명시를 의미합니다. 이는 테라폼 코드일테니 Semantic version 관리 및 Git의 &lt;code class=&quot;language-text&quot;&gt;tag&lt;/code&gt;를 사용하는 방법이 있겠습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;테라폼-모듈-그-외의-것들은-추가예정&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%85%8C%EB%9D%BC%ED%8F%BC-%EB%AA%A8%EB%93%88-%EA%B7%B8-%EC%99%B8%EC%9D%98-%EA%B2%83%EB%93%A4%EC%9D%80-%EC%B6%94%EA%B0%80%EC%98%88%EC%A0%95&quot; aria-label=&quot;테라폼 모듈 그 외의 것들은 추가예정 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;테라폼 모듈 그 외의 것들은? (추가예정)&lt;/h3&gt;
&lt;p&gt;아래 사항들이 있습니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Provisioners&lt;/li&gt;
&lt;li&gt;Provisioners with null_resource&lt;/li&gt;
&lt;li&gt;External data source&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;lessons-learned&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#lessons-learned&quot; aria-label=&quot;lessons learned permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Lessons Learned&lt;/h1&gt;
&lt;p&gt;제 8장에서는 아래의 내용을 반드시 기억하셨으면 좋겠습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;DevOps 파트 또한 깊고 어렵고, “삽질”이 많습니다. 쉽지 않은 파트이며 항상 감사히 생각해야겠습니다.&lt;/li&gt;
&lt;li&gt;프로덕션 레벨에서 성공적으로 구동하기 까지는 정말 어렵고 힘든 길임을 이해했습니다.&lt;/li&gt;
&lt;li&gt;테라폼 코드를 프로덕션 레벨에서 사용하는 예시를 통해 &lt;strong&gt;재사용 가능한 모듈&lt;/strong&gt; 단위의 사용을 학습했습니다.
&lt;ol&gt;
&lt;li&gt;작고, 테스트 가능하고 합성 가능한 모듈을 작성해야 합니다.&lt;/li&gt;
&lt;li&gt;버전을 명시화하여 언제든 동일한 결과를 얻을 수 있어야 합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이것으로 제 8장을 마칩니다. 긴 글 읽어주셔서 감사합니다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[[CloudNet@] 테라폼 스터디 7주차 - 총복습]]></title><description><![CDATA[여태 스터디를 하며 배웠던 부분에 대한 one-point lesson을 해봅시다.]]></description><link>https://blog.s3ich4n.me/devlog/terraform/2022-12-10-cloudneta-terraform-101-pt07</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/terraform/2022-12-10-cloudneta-terraform-101-pt07</guid><pubDate>Sat, 10 Dec 2022 19:34:00 GMT</pubDate><content:encoded>&lt;p&gt;이 내용은 &lt;a href=&quot;https://www.notion.so/gasidaseo/CloudNet-Blog-c9dfa44a27ff431dafdd2edacc8a1863&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;CloudNet@&lt;/a&gt; 에서 진행하는 테라폼 기초 입문 스터디에 대한 연재글입니다.&lt;/p&gt;
&lt;p&gt;스터디에서 사용하는 교재는 &lt;a href=&quot;http://www.yes24.com/Product/Goods/101511312&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Terraform Up &amp;#x26; Running 2nd Edition&lt;/a&gt; 입니다.&lt;/p&gt;
&lt;h1 id=&quot;prerequisites&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#prerequisites&quot; aria-label=&quot;prerequisites permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Prerequisites&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;따로 없습니다. 어차피 처음부터 다시 밟아갈거에요.&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;본문&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%B3%B8%EB%AC%B8&quot; aria-label=&quot;본문 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;본문&lt;/h1&gt;
&lt;p&gt;이번 장은, 1장부터 6장까지의 내용을 리와인드하는 장으로 하기로 하였습니다. 중간 스터디를 하면서도 복습했지만 스터디 모임이 한 주 쉬어가며 문서화를 하여 개념을 스스로 정리해야겠다 싶었습니다.&lt;/p&gt;
&lt;h2 id=&quot;테라폼-복습&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%85%8C%EB%9D%BC%ED%8F%BC-%EB%B3%B5%EC%8A%B5&quot; aria-label=&quot;테라폼 복습 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;테라폼 복습&lt;/h2&gt;
&lt;h3 id=&quot;아키텍처&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98&quot; aria-label=&quot;아키텍처 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;아키텍처&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;전과 크게 다르지 않습니다!&lt;/li&gt;
&lt;li&gt;ALB, ASG, EC2 구성대로 진행합니다.&lt;/li&gt;
&lt;li&gt;staging, production 환경을 나눕니다.&lt;/li&gt;
&lt;li&gt;모듈을 활용하여 무중단 업그레이드를 진행합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;도구-안내&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8F%84%EA%B5%AC-%EC%95%88%EB%82%B4&quot; aria-label=&quot;도구 안내 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;도구 안내&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;tfenv&lt;/code&gt; 를 통한 테라폼 버전관리를 수행해봅시다. 저는 리눅스 환경에서 실습을 진행하므로, 공식 repository에 작성된 Manual 설치대로 진행하겠습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# ${HOME}/.tfenv에 관련 내용 설치&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; clone &lt;span class=&quot;token parameter variable&quot;&gt;--depth&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; https://github.com/tfutils/tfenv.git ~/.tfenv

&lt;span class=&quot;token comment&quot;&gt;# 사용하고있는 쉘에 따라 ${PATH} 추가.&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# 저는 zsh을 사용하고 있습니다.&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# 해당명령 수행 후 쉘을 종료하고 다시 켜주세요.&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;export PATH=$PATH:$HOME/.tfenv/bin&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&gt;&lt;/span&gt; ~/.zshrc

&lt;span class=&quot;token comment&quot;&gt;# 설치 가능 버전 확인&lt;/span&gt;
tfenv list-remote &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;head&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;1.4&lt;/span&gt;.0-alpha20221109
&lt;span class=&quot;token number&quot;&gt;1.3&lt;/span&gt;.6
&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;.

&lt;span class=&quot;token comment&quot;&gt;# 현재 설치된 버전 확인&lt;/span&gt;
tfenv list
No versions available. Please &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; one with: tfenv &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 특정 버전 설치&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#(옵션) export TFENV_ARCH=arm64  # mac Apple silicon M1/M2&lt;/span&gt;
tfenv &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1.2&lt;/span&gt;.3
tfenv list

&lt;span class=&quot;token comment&quot;&gt;# 특정 버전 사용&lt;/span&gt;
tfenv use &lt;span class=&quot;token number&quot;&gt;1.2&lt;/span&gt;.3
Switching default version to v1.2.3
Default version &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;when not overridden by .terraform-version or TFENV_TERRAFORM_VERSION&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; is now: &lt;span class=&quot;token number&quot;&gt;1.2&lt;/span&gt;.3

&lt;span class=&quot;token comment&quot;&gt;# 테라폼 버전 확인&lt;/span&gt;
terraform version
on linux_amd64&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;자격증명-리전-변경&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9E%90%EA%B2%A9%EC%A6%9D%EB%AA%85-%EB%A6%AC%EC%A0%84-%EB%B3%80%EA%B2%BD&quot; aria-label=&quot;자격증명 리전 변경 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;자격증명 리전 변경&lt;/h3&gt;
&lt;p&gt;오하이오 리전(&lt;code class=&quot;language-text&quot;&gt;us-east-2&lt;/code&gt;)으로 변경합시다.&lt;/p&gt;
&lt;p&gt;저는 direnv를 사용하고 있으므로, 작업이 필요한 하부 워킹디렉토리에 &lt;code class=&quot;language-text&quot;&gt;.envrc&lt;/code&gt; 파일을 생성 후 &lt;code class=&quot;language-text&quot;&gt;AWS_DEFAULT_REGION&lt;/code&gt; 을 오하이오 리전으로 변경하여 사용하였습니다. 아래 커맨드로 바꾸고, 확인해봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# AWS_DEFAULT_REGION 수정&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;vi&lt;/span&gt; .envrc

&lt;span class=&quot;token comment&quot;&gt;# direnv 내의 추가/수정된 .envrc 파일을 사용합시다.&lt;/span&gt;
direnv allow

&lt;span class=&quot;token comment&quot;&gt;# 반영여부 확인&lt;/span&gt;
aws configure list
      Name                    Value             Type    Location
      ----                    -----             ----    --------
   profile                &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;not set&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;             None    None
access_key     ************REDACTED              &lt;span class=&quot;token function&quot;&gt;env&lt;/span&gt;
secret_key     ************REDACTED              &lt;span class=&quot;token function&quot;&gt;env&lt;/span&gt;
    region                us-east-2              &lt;span class=&quot;token function&quot;&gt;env&lt;/span&gt;    &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;AWS_REGION&apos;&lt;/span&gt;, &lt;span class=&quot;token string&quot;&gt;&apos;AWS_DEFAULT_REGION&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;코드-분석&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%BD%94%EB%93%9C-%EB%B6%84%EC%84%9D&quot; aria-label=&quot;코드 분석 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;코드 분석&lt;/h2&gt;
&lt;p&gt;먼저, 영문 개정 3판의 코드를 클론합시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; clone https://github.com/brikis98/terraform-up-and-running-code.git
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; terraform-up-and-running/code/terraform&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;테라폼-문법-분석파트&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%85%8C%EB%9D%BC%ED%8F%BC-%EB%AC%B8%EB%B2%95-%EB%B6%84%EC%84%9D%ED%8C%8C%ED%8A%B8&quot; aria-label=&quot;테라폼 문법 분석파트 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;테라폼 문법 분석파트&lt;/h3&gt;
&lt;p&gt;테라폼 교재 예시의 가장 기본입니다. 위에서 설명드린 아키텍처에 작성된 내용을 코드로 배포하는 것이 주요 내용인지라, 해당 내용을 이해하고 넘어가야 다음 진도를 이해하며 넘어가실 수 있습니다!&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;(신규) 테라폼 구동 버전과 프로바이더의 버전을 기재하였습니다.
&lt;ol&gt;
&lt;li&gt;이 부분은 버전 명시 및 프로바이더에 대한 명확한 기재를 의미합니다.&lt;/li&gt;
&lt;li&gt;향후 리팩토링을 수행하며, 관련 중요성에 대해 다시 말씀드리겠습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;구동할 EC2 이미지를 찾고, 임의의 유저 데이터를 추가해두었습니다.&lt;/li&gt;
&lt;li&gt;기본 VPC에 서브넷을 생성하고, 시큐리티 그룹을 설정하였습니다.&lt;/li&gt;
&lt;li&gt;ALB 설정이 존재합니다&lt;/li&gt;
&lt;li&gt;ASG 설정이 존재합니다&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;아래 명령으로 구동을 진행할 수 있습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# [터미널2]&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; 02-intro-to-terraform-syntax/webserver-cluster
&lt;span class=&quot;token function&quot;&gt;cat&lt;/span&gt; main.tf variables.tf

&lt;span class=&quot;token comment&quot;&gt;# 배포&lt;/span&gt;
terraform init
terraform plan
terraform apply -auto-approve

&lt;span class=&quot;token comment&quot;&gt;# 배포 완료 후 ALB 접속 확인&lt;/span&gt;
&lt;span class=&quot;token assign-left variable&quot;&gt;ALBDNS&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;terraform output &lt;span class=&quot;token parameter variable&quot;&gt;-raw&lt;/span&gt; alb_dns_name&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;curl&lt;/span&gt; --connect-timeout &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;  http://&lt;span class=&quot;token variable&quot;&gt;$ALBDNS&lt;/span&gt;/ &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;------------------------------&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sleep&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;done&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 삭제&lt;/span&gt;
terraform destroy -auto-approve
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; ~/terraform-up-and-running-code/code/terraform&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;테라폼-state-파트&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%85%8C%EB%9D%BC%ED%8F%BC-state-%ED%8C%8C%ED%8A%B8&quot; aria-label=&quot;테라폼 state 파트 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;테라폼 state 파트&lt;/h3&gt;
&lt;p&gt;이 장에서는, &lt;code class=&quot;language-text&quot;&gt;.tfstate&lt;/code&gt; 파일이나 폴더구조 관리에 대해 배웠습니다. 관리를 제대로 하지 않았을 때의 리스크는 &lt;a href=&quot;https://charity.wtf/2016/03/30/terraform-vpc-and-why-you-want-a-tfstate-file-per-env/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 링크&lt;/a&gt;를 다시 봅시다…&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;S3, DynamoDB와 RDS(MySQL)을 통해, &lt;code class=&quot;language-text&quot;&gt;.tfstate&lt;/code&gt; 파일에 대한 관리를 진행합니다.
&lt;ol&gt;
&lt;li&gt;RDS에 .tfstate 내용을 백업하고, S3에 읽기 전용 파일로 다른 서비스들이 “읽을 수 있도록” 준비합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;스테이징/프로덕션 파트의 RDS를 배포하여, 서비스가 구동됨을 확인합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;아래 명령으로 구동을 진행할 수 있습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;S3/DynamoDB 구동관련 설정&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# 환경변수에 지정&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;TF_VAR_bucket_name&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;ex07-tfstate
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;TF_VAR_table_name&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;ex07-t101-locks
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;TF_VAR_bucket_name&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;ex07-t101-tfstate
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;TF_VAR_table_name&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;ex07-t101-locks

&lt;span class=&quot;token comment&quot;&gt;# 환경변수 확인&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; TF_VAR_

&lt;span class=&quot;token comment&quot;&gt;# (옵션) 환경변수 지정 삭제&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;unset&lt;/span&gt; TF_VAR_bucket_name
&lt;span class=&quot;token builtin class-name&quot;&gt;unset&lt;/span&gt; TF_VAR_table_name&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;S3/DynamoDB 배포하기&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; 03-terraform-state/file-layout-example/global/s3
&lt;span class=&quot;token function&quot;&gt;cat&lt;/span&gt; main.tf variables.tf

&lt;span class=&quot;token comment&quot;&gt;# 초기화 및 검증 : 환경변수 적용 확인&lt;/span&gt;
terraform init &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; terraform plan

&lt;span class=&quot;token comment&quot;&gt;# 배포&lt;/span&gt;
terraform apply -auto-approve

&lt;span class=&quot;token comment&quot;&gt;# 확인&lt;/span&gt;
aws s3 &lt;span class=&quot;token function&quot;&gt;ls&lt;/span&gt;
aws dynamodb list-tables &lt;span class=&quot;token parameter variable&quot;&gt;--output&lt;/span&gt; text

&lt;span class=&quot;token comment&quot;&gt;# 이동&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;/&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;RDS 배포하기&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# [터미널1] RDS 생성 모니터링&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; aws rds describe-db-instances &lt;span class=&quot;token parameter variable&quot;&gt;--query&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;*[].[Endpoint.Address,Endpoint.Port,MasterUsername]&quot;&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;--output&lt;/span&gt; text  &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;------------------------------&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sleep&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;done&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# [터미널2]&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; stage/data-stores/mysql
&lt;span class=&quot;token function&quot;&gt;cat&lt;/span&gt; main.tf variables.tf

&lt;span class=&quot;token comment&quot;&gt;# 환경변수에 지정&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;TF_VAR_db_username&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;cloudneta&apos;&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;TF_VAR_db_password&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;cloudnetaQ!&apos;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 환경변수 확인&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; TF_VAR_

&lt;span class=&quot;token comment&quot;&gt;# main.tf 에 백엔드 부분 수정&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;vi&lt;/span&gt; main.tf
  backend &lt;span class=&quot;token string&quot;&gt;&quot;s3&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# This backend configuration is filled in automatically at test time by Terratest. If you wish to run this example&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# manually, uncomment and fill in the config below.&lt;/span&gt;
    bucket         &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ex07-tfstate&quot;&lt;/span&gt;
    key            &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;stage/data-stores/mysql/terraform.tfstate&quot;&lt;/span&gt;
    region         &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;us-east-2&quot;&lt;/span&gt;
    dynamodb_table &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ex07-t101-locks&quot;&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# encrypt        = true&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 초기화 및 검증 : 환경변수 적용 확인&lt;/span&gt;
terraform init &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; terraform plan

&lt;span class=&quot;token comment&quot;&gt;# 배포 : RDS는 생성 시 6분 정도 시간 소요&lt;/span&gt;
terraform apply -auto-approve
terraform output
aws s3 &lt;span class=&quot;token function&quot;&gt;ls&lt;/span&gt; s3://&lt;span class=&quot;token variable&quot;&gt;$TF_VAR_bucket_name&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;--recursive&lt;/span&gt; --human-readable &lt;span class=&quot;token parameter variable&quot;&gt;--summarize&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 이동&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;/&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;(상기 과정을 마쳐야 할 수 있습니다!) 웹서버 클러스터 배포하기&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; services/webserver-cluster
&lt;span class=&quot;token function&quot;&gt;cat&lt;/span&gt; main.tf variables.tf

&lt;span class=&quot;token comment&quot;&gt;# 환경변수에 지정&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;TF_VAR_db_remote_state_bucket&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$TF_VAR_bucket_name&lt;/span&gt;                       &lt;span class=&quot;token comment&quot;&gt;# description = &quot;The name of the S3 bucket used for the database&apos;s remote state storage&quot;&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;TF_VAR_db_remote_state_key&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;stage/data-stores/mysql/terraform.tfstate&apos;&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# description = &quot;The name of the key in the S3 bucket used for the database&apos;s remote state storage&quot;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 환경변수 확인&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; TF_VAR_

&lt;span class=&quot;token comment&quot;&gt;# 초기화 및 검증 : 환경변수 적용 확인&lt;/span&gt;
terraform init &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; terraform plan

&lt;span class=&quot;token comment&quot;&gt;# 배포&lt;/span&gt;
terraform apply -auto-approve

&lt;span class=&quot;token comment&quot;&gt;# ALB DNS주소로 curl 접속 확인&lt;/span&gt;
&lt;span class=&quot;token assign-left variable&quot;&gt;ALBDNS&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;terraform output &lt;span class=&quot;token parameter variable&quot;&gt;-raw&lt;/span&gt; alb_dns_name&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;curl&lt;/span&gt; --connect-timeout &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;  http://&lt;span class=&quot;token variable&quot;&gt;$ALBDNS&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;------------------------------&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sleep&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;done&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;curl&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-s&lt;/span&gt; http://&lt;span class=&quot;token variable&quot;&gt;$ALBDNS&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 삭제&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# 각 폴더에서 리소스 삭제&lt;/span&gt;
stage/services/webserver-cluster$ terraform destroy -auto-approve
stage/data-stores/mysql$ terraform destroy -auto-approve
global/s3$ terraform destroy -auto-approve

&lt;span class=&quot;token comment&quot;&gt;# 이동&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; ~/terraform-up-and-running-code/code/terraform&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;테라폼-모듈-파트&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%85%8C%EB%9D%BC%ED%8F%BC-%EB%AA%A8%EB%93%88-%ED%8C%8C%ED%8A%B8&quot; aria-label=&quot;테라폼 모듈 파트 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;테라폼 모듈 파트&lt;/h3&gt;
&lt;p&gt;테라폼 state 파트에서 작성해본 내용들을 모듈화하여, 보다 효율적인 테라폼 코드를 작성해봅시다. 코드 재사용, 여러 테라폼 리소스를 논리적 그룹으로 묶을 수 있습니다. 논리적으로 구상할 수 있다는 것은 우리의 사고대로 코드들을 재배합할 수 있다는 이야기지요.&lt;/p&gt;
&lt;p&gt;여기서는 웹서버 내용에 대해서만 아직 모듈로 묶어두었고, 8장에서 ALB, ASG, EC2가 묶여있는 부분을 해제해봅시다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;상기 내용과 동일합니다!&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;S3/DynamoDB 구동관련 설정&lt;/li&gt;
&lt;li&gt;S3/DynamoDB 배포하기&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Staging RDS 배포하기&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# [터미널1] RDS 생성 모니터링&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; aws rds describe-db-instances &lt;span class=&quot;token parameter variable&quot;&gt;--query&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;*[].[Endpoint.Address,Endpoint.Port,MasterUsername]&quot;&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;--output&lt;/span&gt; text  &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;------------------------------&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sleep&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;done&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# [터미널2]&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; 04-terraform-module/module-example/stage/data-stores/mysql
&lt;span class=&quot;token function&quot;&gt;cat&lt;/span&gt; main.tf variables.tf

&lt;span class=&quot;token comment&quot;&gt;# 환경변수에 지정&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;TF_VAR_db_username&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;cloudneta&apos;&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;TF_VAR_db_password&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;cloudnetaQ!&apos;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 환경변수 확인&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; TF_VAR_

&lt;span class=&quot;token comment&quot;&gt;# main.tf 에 백엔드 부분 수정&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;vi&lt;/span&gt; main.tf
  backend &lt;span class=&quot;token string&quot;&gt;&quot;s3&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# This backend configuration is filled in automatically at test time by Terratest. If you wish to run this example&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# manually, uncomment and fill in the config below.&lt;/span&gt;
    bucket         &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ex07-tfstate&quot;&lt;/span&gt;
    key            &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;stage/data-stores/mysql/terraform.tfstate&quot;&lt;/span&gt;
    region         &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;us-east-2&quot;&lt;/span&gt;
    dynamodb_table &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ex07-t101-locks&quot;&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# encrypt        = true&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 초기화 및 검증 : 환경변수 적용 확인&lt;/span&gt;
terraform init &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; terraform plan

&lt;span class=&quot;token comment&quot;&gt;# 배포 : RDS는 생성 시 6분 정도 시간 소요&lt;/span&gt;
terraform apply -auto-approve
terraform output
aws s3 &lt;span class=&quot;token function&quot;&gt;ls&lt;/span&gt; s3://&lt;span class=&quot;token variable&quot;&gt;$TF_VAR_bucket_name&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;--recursive&lt;/span&gt; --human-readable &lt;span class=&quot;token parameter variable&quot;&gt;--summarize&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 이동&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;/&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;/&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;(상기 과정을 마쳐야 할 수 있습니다!) Staging 웹서버 클러스터 배포하기&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; services/webserver-cluster
&lt;span class=&quot;token function&quot;&gt;cat&lt;/span&gt; main.tf variables.tf

&lt;span class=&quot;token comment&quot;&gt;# 환경변수에 지정&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;TF_VAR_db_remote_state_bucket&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$TF_VAR_bucket_name&lt;/span&gt;                       &lt;span class=&quot;token comment&quot;&gt;# description = &quot;The name of the S3 bucket used for the database&apos;s remote state storage&quot;&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;TF_VAR_db_remote_state_key&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;stage/data-stores/mysql/terraform.tfstate&apos;&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# description = &quot;The name of the key in the S3 bucket used for the database&apos;s remote state storage&quot;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 환경변수 확인&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; TF_VAR_

&lt;span class=&quot;token comment&quot;&gt;# 초기화 및 검증 : 환경변수 적용 확인&lt;/span&gt;
terraform init &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; terraform plan

&lt;span class=&quot;token comment&quot;&gt;# 배포&lt;/span&gt;
terraform apply -auto-approve

&lt;span class=&quot;token comment&quot;&gt;# ALB DNS주소로 curl 접속 확인&lt;/span&gt;
&lt;span class=&quot;token assign-left variable&quot;&gt;ALBDNS&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;terraform output &lt;span class=&quot;token parameter variable&quot;&gt;-raw&lt;/span&gt; alb_dns_name&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;curl&lt;/span&gt; --connect-timeout &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;  http://&lt;span class=&quot;token variable&quot;&gt;$ALBDNS&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;------------------------------&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sleep&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;done&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;curl&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-s&lt;/span&gt; http://&lt;span class=&quot;token variable&quot;&gt;$ALBDNS&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 삭제&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# 각 폴더에서 리소스 삭제&lt;/span&gt;
stage/services/webserver-cluster$ terraform destroy -auto-approve
stage/data-stores/mysql$ terraform destroy -auto-approve
03-terraform-state/file-layout-example/global/s3$ terraform destroy -auto-approve &lt;span class=&quot;token comment&quot;&gt;# 아래 Production 실습을 이어서 할 경우에는 실습 완료 후 삭제 할 것&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 이동&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; ~/terraform-up-and-running-code/code/terraform&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;cf. Production 배포는 &lt;code class=&quot;language-text&quot;&gt;04-terraform-module/module-example&lt;/code&gt; 의 prod 디렉토리의 RDS와 웹서버 클러스터를 배포하면 됩니다.&lt;/p&gt;
&lt;h3 id=&quot;tips-and-tricks-무중단-배포-관련&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#tips-and-tricks-%EB%AC%B4%EC%A4%91%EB%8B%A8-%EB%B0%B0%ED%8F%AC-%EA%B4%80%EB%A0%A8&quot; aria-label=&quot;tips and tricks 무중단 배포 관련 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;tips and tricks: 무중단 배포 관련&lt;/h3&gt;
&lt;p&gt;무중단 배포(zero-downtime deployment)의 경우, 수정된 테라폼 코드나 환경변수를 사용하여 &lt;code class=&quot;language-text&quot;&gt;terraform apply&lt;/code&gt; 를 하면 끝입니다. 배포과정은 상기 내용과 동일하지만, 모듈을 활용하여 배포하는 단계가 다릅니다. 여기서는 배포가 “어떻게” 되는지를 살펴보겠습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;상기 내용과 동일합니다!
&lt;ul&gt;
&lt;li&gt;S3/DynamoDB 구동관련 설정&lt;/li&gt;
&lt;li&gt;S3/DynamoDB 배포하기&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Staging RDS 배포하기&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# [터미널1] RDS 생성 모니터링&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; aws rds describe-db-instances &lt;span class=&quot;token parameter variable&quot;&gt;--query&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;*[].[Endpoint.Address,Endpoint.Port,MasterUsername]&quot;&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;--output&lt;/span&gt; text  &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;------------------------------&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sleep&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;done&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# [터미널2]&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; 05-tips-and-tricks/module-example/stage/data-stores/mysql
&lt;span class=&quot;token function&quot;&gt;cat&lt;/span&gt; main.tf variables.tf

&lt;span class=&quot;token comment&quot;&gt;# 환경변수에 지정&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;TF_VAR_db_username&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;cloudneta&apos;&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;TF_VAR_db_password&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;cloudnetaQ!&apos;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 환경변수 확인&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; TF_VAR_

&lt;span class=&quot;token comment&quot;&gt;# main.tf 에 백엔드 부분 수정&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;vi&lt;/span&gt; main.tf
  backend &lt;span class=&quot;token string&quot;&gt;&quot;s3&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# This backend configuration is filled in automatically at test time by Terratest. If you wish to run this example&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# manually, uncomment and fill in the config below.&lt;/span&gt;
    bucket         &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ex07-tfstate&quot;&lt;/span&gt;
    key            &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;stage/data-stores/mysql/terraform.tfstate&quot;&lt;/span&gt;
    region         &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;us-east-2&quot;&lt;/span&gt;
    dynamodb_table &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ex07-t101-locks&quot;&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# encrypt        = true&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 초기화 및 검증 : 환경변수 적용 확인&lt;/span&gt;
terraform init &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; terraform plan

&lt;span class=&quot;token comment&quot;&gt;# 배포 : RDS는 생성 시 6분 정도 시간 소요&lt;/span&gt;
terraform apply -auto-approve
terraform output
aws s3 &lt;span class=&quot;token function&quot;&gt;ls&lt;/span&gt; s3://&lt;span class=&quot;token variable&quot;&gt;$TF_VAR_bucket_name&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;--recursive&lt;/span&gt; --human-readable &lt;span class=&quot;token parameter variable&quot;&gt;--summarize&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 이동&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;/&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;/&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;(상기 과정을 마쳐야 할 수 있습니다!) Staging 웹서버 배포 후 &lt;strong&gt;무중단 배포 진행&lt;/strong&gt;하기&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; services/webserver-cluster
&lt;span class=&quot;token function&quot;&gt;cat&lt;/span&gt; main.tf variables.tf

&lt;span class=&quot;token comment&quot;&gt;# 환경변수에 지정&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;TF_VAR_db_remote_state_bucket&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$TF_VAR_bucket_name&lt;/span&gt;                       &lt;span class=&quot;token comment&quot;&gt;# description = &quot;The name of the S3 bucket used for the database&apos;s remote state storage&quot;&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;TF_VAR_db_remote_state_key&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;stage/data-stores/mysql/terraform.tfstate&apos;&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# description = &quot;The name of the key in the S3 bucket used for the database&apos;s remote state storage&quot;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 환경변수 확인&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; TF_VAR_

&lt;span class=&quot;token comment&quot;&gt;# 초기화 및 검증 : 환경변수 적용 확인&lt;/span&gt;
terraform init &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; terraform plan &lt;span class=&quot;token parameter variable&quot;&gt;-var&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;server_text&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Old server text&apos;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 배포&lt;/span&gt;
terraform apply -auto-approve &lt;span class=&quot;token parameter variable&quot;&gt;-var&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;server_text&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Old server text&apos;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# ALB DNS주소로 curl 접속 확인&lt;/span&gt;
&lt;span class=&quot;token assign-left variable&quot;&gt;ALBDNS&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;terraform output &lt;span class=&quot;token parameter variable&quot;&gt;-raw&lt;/span&gt; alb_dns_name&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;curl&lt;/span&gt; --connect-timeout &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;  http://&lt;span class=&quot;token variable&quot;&gt;$ALBDNS&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;------------------------------&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sleep&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;done&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;curl&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-s&lt;/span&gt; http://&lt;span class=&quot;token variable&quot;&gt;$ALBDNS&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# [터미널1]&lt;/span&gt;
&lt;span class=&quot;token assign-left variable&quot;&gt;ALBDNS&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;직접입력&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;curl&lt;/span&gt; --connect-timeout &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;  http://&lt;span class=&quot;token variable&quot;&gt;$ALBDNS&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;------------------------------&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;date&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sleep&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;done&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# [터미널2]&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; aws ec2 describe-instances &lt;span class=&quot;token parameter variable&quot;&gt;--query&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Reservations[*].Instances[*].{PublicIPAdd:PublicIpAddress,InstanceName:Tags[?Key==&apos;Name&apos;]|[0].Value,Status:State.Name}&quot;&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;--filters&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;Name&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;instance-state-name,Values&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;running &lt;span class=&quot;token parameter variable&quot;&gt;--output&lt;/span&gt; text &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;------------------------------&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sleep&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;done&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 무중단 업그레이드 배포 : 환경변수 수정 적용 &gt;&gt; 오토스케일링그룹 2개중 기존 그룹은 5분 정도 후에 EC2가 삭제됨(오래 걸리니 맘 편히 기다리자)&lt;/span&gt;
terraform plan &lt;span class=&quot;token parameter variable&quot;&gt;-var&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;server_text&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;NEW server text&apos;&lt;/span&gt;
terraform apply -auto-approve &lt;span class=&quot;token parameter variable&quot;&gt;-var&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;server_text&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;NEW server text&apos;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 삭제&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# 각 폴더에서 리소스 삭제&lt;/span&gt;
stage/services/webserver-cluster$ terraform destroy -auto-approve
stage/data-stores/mysql$ terraform destroy -auto-approve
03-terraform-state/file-layout-example/global/s3$ terraform destroy -auto-approve

&lt;span class=&quot;token comment&quot;&gt;# 이동&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; ~/terraform-up-and-running-code/code/terraform&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id=&quot;lessons-learned&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#lessons-learned&quot; aria-label=&quot;lessons learned permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Lessons Learned&lt;/h1&gt;
&lt;p&gt;제 7장에서는 아래의 내용을 반드시 기억하셨으면 좋겠습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;테라폼을 사용하였을 때의 확실한 이점을 이해했습니다.&lt;/li&gt;
&lt;li&gt;예시의 내용이 &lt;em&gt;정확히&lt;/em&gt; 어떻게 되는지 이해할 수 있었습니다.&lt;/li&gt;
&lt;li&gt;향후 자신의 프로젝트나, 회사의 인프라 관리 코드들을 보고 이해할 수 있게 되었습니다.&lt;/li&gt;
&lt;li&gt;향후 나올 8장의 내용 이해 및 실제 프로덕션 레벨에서의 일부를 가정하여, 학습할 수 있게 되었습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이것으로 제 7장을 마칩니다. 긴 글 읽어주셔서 감사합니다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[[CloudNet@] 테라폼 스터디 6주차 - Managing Secrets with Terraform]]></title><description><![CDATA[Terraform을 사용하며 인프라 프로비저닝 및 배포 시, 민감정보에 대해 관리하는 방안에 대해 작성하였습니다.]]></description><link>https://blog.s3ich4n.me/devlog/terraform/2022-11-27-cloudneta-terraform-101-pt06</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/terraform/2022-11-27-cloudneta-terraform-101-pt06</guid><pubDate>Sun, 27 Nov 2022 22:19:00 GMT</pubDate><content:encoded>&lt;p&gt;이 내용은 &lt;a href=&quot;https://www.notion.so/gasidaseo/CloudNet-Blog-c9dfa44a27ff431dafdd2edacc8a1863&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;CloudNet@&lt;/a&gt; 에서 진행하는 테라폼 기초 입문 스터디에 대한 연재글입니다.&lt;/p&gt;
&lt;p&gt;스터디에서 사용하는 교재는 &lt;a href=&quot;http://www.yes24.com/Product/Goods/101511312&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Terraform Up &amp;#x26; Running 2nd Edition&lt;/a&gt; 입니다.&lt;/p&gt;
&lt;p&gt;특히 이 장은, &lt;a href=&quot;https://www.oreilly.com/library/view/terraform-up-and/9781098116736/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Terraform Up &amp;#x26; Running 3rd Edition&lt;/a&gt; 의 Managing Secrets with Terraform 장을 참고하여 학습하였습니다.&lt;/p&gt;
&lt;h1 id=&quot;prerequisites&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#prerequisites&quot; aria-label=&quot;prerequisites permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Prerequisites&lt;/h1&gt;
&lt;p&gt;따로 있지 않습니다!&lt;/p&gt;
&lt;p&gt;아래에서 6주차 스터디 내용을 공유합니다.&lt;/p&gt;
&lt;p&gt;Terraform Up &amp;#x26; Learning 3rd Edition 의 6장 내용을 다루고 있습니다.&lt;/p&gt;
&lt;h1 id=&quot;본문&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%B3%B8%EB%AC%B8&quot; aria-label=&quot;본문 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;본문&lt;/h1&gt;
&lt;p&gt;비밀번호를 누구든 알 수 없게 하면 안 된다는 것은 상식이지만, 방법을 모르면 사실상 비밀번호를 노출시키는 것과 다름 없기 때문에, 이를 관리하는 도구를 사용해야합니다. 이러한 이유로, 민감정보 값들은 프로비저닝 될 때 안전하게 관리 될 필요가 있습니다.&lt;/p&gt;
&lt;p&gt;민감정보는 아래 값들을 의미합니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;DB 암호&lt;/li&gt;
&lt;li&gt;API 키&lt;/li&gt;
&lt;li&gt;TLS 인증서&lt;/li&gt;
&lt;li&gt;SSH 키&lt;/li&gt;
&lt;li&gt;GPG 키&lt;/li&gt;
&lt;li&gt;등등..&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;암호-관리에-대하여&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%95%94%ED%98%B8-%EA%B4%80%EB%A6%AC%EC%97%90-%EB%8C%80%ED%95%98%EC%97%AC&quot; aria-label=&quot;암호 관리에 대하여 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;암호 관리에 대하여&lt;/h2&gt;
&lt;p&gt;프로비저닝을 할 때 민감정보에 대한 절대적 법칙이 있습니다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;민감 정보를 &lt;strong&gt;절대 평문으로&lt;/strong&gt; 쓰지 맙시다.&lt;/li&gt;
&lt;li&gt;1번을 명심하십시오.&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;p&gt;예를들어 이런 코드가 있다고 할까요?&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;resource &lt;span class=&quot;token type variable&quot;&gt;&quot;aws_db_instance&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;example&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;identifier_prefix&lt;/span&gt;   &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;terraform-up-and-running&quot;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;engine&lt;/span&gt;              &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;mysql&quot;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;allocated_storage&lt;/span&gt;   &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;instance_class&lt;/span&gt;      &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;db.t2.micro&quot;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;skip_final_snapshot&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;db_name&lt;/span&gt;             &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; var.db_name

  &lt;span class=&quot;token comment&quot;&gt;# 절대로!!! 이러면!!! 안됩니다!!!!!!!!!!!!!!&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;username&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;admin&quot;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;password&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;password&quot;&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# 절대로!!! 이러면!!! 안됩니다!!!!!!!!!!!!!! 진짜로!!!!&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;VCS (E.g., Git)에 이런 코드가 있다면, &lt;strong&gt;누구든지&lt;/strong&gt;간에 AWS에 프로비저닝된 MySQL에 접근할 수 있습니다!&lt;/p&gt;
&lt;p&gt;만일 이 코드를 누군가가 클론한다면, 다른 사람의 로컬에 ID/PW 정보가 저장될 수도 있겠죠. 그렇다면 ID/PW 에 대한 접근, 사용에 대한 통제 및 감사조차 할 수 없게 됩니다.&lt;/p&gt;
&lt;p&gt;암호 관리 도구는 바로 이런 &lt;strong&gt;치명적인&lt;/strong&gt; 부분 때문에 필연적으로 사용해야 하는 것입니다.&lt;/p&gt;
&lt;h2 id=&quot;암호-관리-도구에-대하여&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%95%94%ED%98%B8-%EA%B4%80%EB%A6%AC-%EB%8F%84%EA%B5%AC%EC%97%90-%EB%8C%80%ED%95%98%EC%97%AC&quot; aria-label=&quot;암호 관리 도구에 대하여 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;암호 관리 도구에 대하여&lt;/h2&gt;
&lt;p&gt;그렇다면 암호 관리 도구에 대한 필요성을 이해했으니, 암호 관리 도구에 저장되는 값과 암호관리 도구의 저장방식 및 암호관리 도구에 대한 접근 방식에 대해 살펴봅시다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;The types of secrets you store&lt;/code&gt; : 3가지 유형에 따라 관리 방식의 차이가 있습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Personal secrets&lt;/code&gt;: 개인 소유 암호 (내 웹사이트 접근 암호, SSH 키, 등…)
&lt;ul&gt;
&lt;li&gt;이런 암호들은 개별 서비스들을 잘 쓰거나 하는 편이 좋겠지요(예시는 후술합니다!)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Customer secrets&lt;/code&gt;: 고객 소유 암호 (고객의 개인정보, 고객의 이름/암호 등…)
&lt;ul&gt;
&lt;li&gt;이런 암호들은 해싱 알고리즘을 사용해야겠지요.&lt;/li&gt;
&lt;li&gt;Django 3.2 버전으로로 치자면, &lt;a href=&quot;https://docs.djangoproject.com/en/3.2/topics/auth/passwords/#how-django-stores-passwords&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;PBKDF2 SHA256으로 해시를 &lt;code class=&quot;language-text&quot;&gt;260,000&lt;/code&gt;번 취한 값을 암호로 쓰는 것&lt;/a&gt; 처럼요(&lt;a href=&quot;https://github.com/django/django/commit/f2187a227f7a3c80282658e699ae9b04023724e5&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;출처&lt;/a&gt;).&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Infrastructure secrets&lt;/code&gt;: 인프라 관련 암호 (DB 암호, API 키값, 등…)
&lt;ol&gt;
&lt;li&gt;이런 암호들은 암/복호화 알고리즘을 사용하는 편이 좋겠지요.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;The way you store secrets&lt;/code&gt; : 2가지 암호 저장 방식이 있습니다. 파일 기반 암호 저장이냐, 중앙 집중식 암호 저장이냐의 차이지요.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;File-based secret stores&lt;/code&gt; (파일기반의 암호 저장)
&lt;ol&gt;
&lt;li&gt;민감 정보를 암호화 후 저장하기 때문에 암호화 관련 키 관리가 중요합니다.&lt;/li&gt;
&lt;li&gt;AWS KMS, GCP KMS 혹은 PGP Key를 이용하는 케이스가 있겠군요.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Centralized secret stores&lt;/code&gt; (중앙화된 암호 저장)
&lt;ol&gt;
&lt;li&gt;일반적으로 데이터베이스(MySQL, Psql, DynamoDB 등)에 비밀번호를 암호화하여 저장합니다.&lt;/li&gt;
&lt;li&gt;암호화 키는 서비스 자체 혹은 클라우드 KMS(Key Management Service)를 사용합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;The Interface you use to access secrets&lt;/code&gt;: 암호관리 툴은 아래와 같이 사용할 수 있습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;API&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;CLI&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;UI&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;The Comparison of secret manegement tools&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;이러한 특성들을 가지고, 다양한 비밀번호 관리 도구를 살펴봅시다.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;Types of secrets&lt;/th&gt;
&lt;th&gt;Secret Storage&lt;/th&gt;
&lt;th&gt;Secret Interface&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;HashiCorp Vault&lt;/td&gt;
&lt;td&gt;Infrastructure&lt;/td&gt;
&lt;td&gt;Centralized service&lt;/td&gt;
&lt;td&gt;UI, API, CLI&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;AWS Secrets Manager&lt;/td&gt;
&lt;td&gt;Infrastructure&lt;/td&gt;
&lt;td&gt;Centralized service&lt;/td&gt;
&lt;td&gt;UI, API, CLI&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;GCP Secrets Manager&lt;/td&gt;
&lt;td&gt;Infrastructure&lt;/td&gt;
&lt;td&gt;Centralized service&lt;/td&gt;
&lt;td&gt;UI, API, CLI&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Azure Key Vault&lt;/td&gt;
&lt;td&gt;Infrastructure&lt;/td&gt;
&lt;td&gt;Centralized service&lt;/td&gt;
&lt;td&gt;UI, API, CLI&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Confidant&lt;/td&gt;
&lt;td&gt;Infrastructure&lt;/td&gt;
&lt;td&gt;Centralized service&lt;/td&gt;
&lt;td&gt;UI, API, CLI&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Keywhiz&lt;/td&gt;
&lt;td&gt;Infrastructure&lt;/td&gt;
&lt;td&gt;Centralized service&lt;/td&gt;
&lt;td&gt;API, CLI&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;sops&lt;/td&gt;
&lt;td&gt;Infrastructure&lt;/td&gt;
&lt;td&gt;Files&lt;/td&gt;
&lt;td&gt;CLI&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;git-secret&lt;/td&gt;
&lt;td&gt;Infrastructure&lt;/td&gt;
&lt;td&gt;Files&lt;/td&gt;
&lt;td&gt;CLI&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1Password&lt;/td&gt;
&lt;td&gt;Personal&lt;/td&gt;
&lt;td&gt;Centralized service&lt;/td&gt;
&lt;td&gt;UI, API, CLI&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;LastPass&lt;/td&gt;
&lt;td&gt;Personal&lt;/td&gt;
&lt;td&gt;Centralized service&lt;/td&gt;
&lt;td&gt;UI, API, CLI&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Bitwarden&lt;/td&gt;
&lt;td&gt;Personal&lt;/td&gt;
&lt;td&gt;Centralized service&lt;/td&gt;
&lt;td&gt;UI, API, CLI&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;KeePass&lt;/td&gt;
&lt;td&gt;Personal&lt;/td&gt;
&lt;td&gt;Files&lt;/td&gt;
&lt;td&gt;UI, CLI&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Keychain (macOS)&lt;/td&gt;
&lt;td&gt;Personal&lt;/td&gt;
&lt;td&gt;Files&lt;/td&gt;
&lt;td&gt;UI, CLI&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Credential Manager (Windows)&lt;/td&gt;
&lt;td&gt;Personal&lt;/td&gt;
&lt;td&gt;Files&lt;/td&gt;
&lt;td&gt;UI, CLI&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;pass&lt;/td&gt;
&lt;td&gt;Personal&lt;/td&gt;
&lt;td&gt;Files&lt;/td&gt;
&lt;td&gt;CLI&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Active Directory&lt;/td&gt;
&lt;td&gt;Customer&lt;/td&gt;
&lt;td&gt;Centralized service&lt;/td&gt;
&lt;td&gt;UI, API, CLI&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Auth0&lt;/td&gt;
&lt;td&gt;Customer&lt;/td&gt;
&lt;td&gt;Centralized service&lt;/td&gt;
&lt;td&gt;UI, API, CLI&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Okta&lt;/td&gt;
&lt;td&gt;Customer&lt;/td&gt;
&lt;td&gt;Centralized service&lt;/td&gt;
&lt;td&gt;UI, API, CLI&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;OneLogin&lt;/td&gt;
&lt;td&gt;Customer&lt;/td&gt;
&lt;td&gt;Centralized service&lt;/td&gt;
&lt;td&gt;UI, API, CLI&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Ping&lt;/td&gt;
&lt;td&gt;Customer&lt;/td&gt;
&lt;td&gt;Centralized service&lt;/td&gt;
&lt;td&gt;UI, API, CLI&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;AWS Cognito&lt;/td&gt;
&lt;td&gt;Customer&lt;/td&gt;
&lt;td&gt;Centralized service&lt;/td&gt;
&lt;td&gt;UI, API, CLI&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;secret-management-tools-w-terraform&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#secret-management-tools-w-terraform&quot; aria-label=&quot;secret management tools w terraform permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Secret Management tools w/ Terraform&lt;/h2&gt;
&lt;p&gt;테라폼에서는 어느 시점에서 인증정보들이 노출될 수 있을까요? 바로 아래와 같은 지점에서 암호값이 노출될 수 있습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Provider 기재 시 노출 (E.g., 프로바이더 인증 정보 등)&lt;/li&gt;
&lt;li&gt;Resources and data sources 기재 시 노출(E.g., DB 암호 등)&lt;/li&gt;
&lt;li&gt;State file and plan files (상태 파일, 플랜 파일 자체에 민감정보가 노출)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;위의 리스트들에 대한 내용들을 아래에서 하나씩 살펴봅시다. 이 내용에 대한 에시코드는 &lt;code class=&quot;language-text&quot;&gt;chapter06/exercises/01_providers&lt;/code&gt; 에 있습니다. 링크는 &lt;a href=&quot;&quot;&gt;여기&lt;/a&gt;를 클릭해주세요.&lt;/p&gt;
&lt;h3 id=&quot;provider-기재-시-암호값을-관리하는-방안&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#provider-%EA%B8%B0%EC%9E%AC-%EC%8B%9C-%EC%95%94%ED%98%B8%EA%B0%92%EC%9D%84-%EA%B4%80%EB%A6%AC%ED%95%98%EB%8A%94-%EB%B0%A9%EC%95%88&quot; aria-label=&quot;provider 기재 시 암호값을 관리하는 방안 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Provider 기재 시 암호값을 관리하는 방안&lt;/h3&gt;
&lt;h4 id=&quot;프로바이더에서-노출&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%94%84%EB%A1%9C%EB%B0%94%EC%9D%B4%EB%8D%94%EC%97%90%EC%84%9C-%EB%85%B8%EC%B6%9C&quot; aria-label=&quot;프로바이더에서 노출 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;프로바이더에서 노출&lt;/h4&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;provider&lt;/code&gt; 선언 시 IAM 자격증명 정보를 노출하면 절대 안됩니다! 당장 인식할 수 있는 단점은 두가지입니다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;자격증명 정보가 바로 노출됩니다!&lt;/li&gt;
&lt;li&gt;하나의 자격증명만 사용할 수 있습니다!&lt;/li&gt;
&lt;/ol&gt;
&lt;h5 id=&quot;환경변수를-사용하면&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%99%98%EA%B2%BD%EB%B3%80%EC%88%98%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EB%A9%B4&quot; aria-label=&quot;환경변수를 사용하면 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;환경변수를 사용하면?&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;장점
&lt;ul&gt;
&lt;li&gt;자격증명 정보를 노출하지는 않습니다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;단점
&lt;ul&gt;
&lt;li&gt;여전히 PC에 평문으로 저장되어있습니다&lt;/li&gt;
&lt;li&gt;단독 자격증명만 사용할 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&quot;유저의-민감정보-유출-방지-방법&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9C%A0%EC%A0%80%EC%9D%98-%EB%AF%BC%EA%B0%90%EC%A0%95%EB%B3%B4-%EC%9C%A0%EC%B6%9C-%EB%B0%A9%EC%A7%80-%EB%B0%A9%EB%B2%95&quot; aria-label=&quot;유저의 민감정보 유출 방지 방법 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;유저의 민감정보 유출 방지 방법&lt;/h5&gt;
&lt;p&gt;여러 서비스들을 사용할 수 있습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;1Password/LastPass 등의 서비스 구매 후 사용&lt;/li&gt;
&lt;li&gt;aws-vault 사용: &lt;a href=&quot;https://github.com/99designs/aws-vault&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Github&lt;/a&gt; &lt;a href=&quot;https://www.44bits.io/ko/post/securing-aws-credentials-with-aws-vault&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;44bits 소개글&lt;/a&gt;을 참고바랍니다!&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;사용 예시&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# mac 설치&lt;/span&gt;
brew &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;--cask&lt;/span&gt; aws-vault

&lt;span class=&quot;token comment&quot;&gt;# 윈도우 설치&lt;/span&gt;
choco &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; aws-vault  &lt;span class=&quot;token comment&quot;&gt;# 윈도우 Chocolatey&lt;/span&gt;
scoop &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; aws-vault  &lt;span class=&quot;token comment&quot;&gt;# 윈도우 Scoop&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 버전 확인&lt;/span&gt;
aws-vault &lt;span class=&quot;token parameter variable&quot;&gt;--version&lt;/span&gt;
v6.6.0

&lt;span class=&quot;token comment&quot;&gt;# 설정&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#aws-vault add &amp;lt;PROFILE_NAME&gt;&lt;/span&gt;
aws-vault &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt; t101
Enter Access Key Id: &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;YOUR_ACCESS_KEY_ID&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
Enter Secret Key: &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;YOUR_SECRET_ACCESS_KEY&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 확인&lt;/span&gt;
aws-vault &lt;span class=&quot;token function&quot;&gt;ls&lt;/span&gt;
Profile                  Credentials              Sessions
&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;                  &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;              &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;
default                  -                        -
t101                     t101                     -

&lt;span class=&quot;token comment&quot;&gt;# 사용&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#aws-vault exec &amp;lt;PROFILE&gt; -- &amp;lt;COMMAND&gt;&lt;/span&gt;
aws-vault &lt;span class=&quot;token builtin class-name&quot;&gt;exec&lt;/span&gt; t101 -- aws s3 &lt;span class=&quot;token function&quot;&gt;ls&lt;/span&gt;
aws-vault &lt;span class=&quot;token builtin class-name&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;--debug&lt;/span&gt; t101 -- aws s3 &lt;span class=&quot;token function&quot;&gt;ls&lt;/span&gt;

aws-vault &lt;span class=&quot;token builtin class-name&quot;&gt;exec&lt;/span&gt; t101 -- terraform plan
aws-vault &lt;span class=&quot;token builtin class-name&quot;&gt;exec&lt;/span&gt; t101 -- terraform apply&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;aws-vault&lt;/code&gt; 를 사용하신다면, &lt;code class=&quot;language-text&quot;&gt;~/.aws/credentials&lt;/code&gt; 파일은 지우는게 좋습니다.&lt;/p&gt;
&lt;h5 id=&quot;기계의-민감정보-유출-방지-방법&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B8%B0%EA%B3%84%EC%9D%98-%EB%AF%BC%EA%B0%90%EC%A0%95%EB%B3%B4-%EC%9C%A0%EC%B6%9C-%EB%B0%A9%EC%A7%80-%EB%B0%A9%EB%B2%95&quot; aria-label=&quot;기계의 민감정보 유출 방지 방법 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;기계의 민감정보 유출 방지 방법&lt;/h5&gt;
&lt;p&gt;프로덕션 레벨에서의 CI/CD 워크플로우 내용은 9장에서 살펴봅니다. 현재는 간단히 어떻게 사용되는지 정도만을 소개합니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;[Providers] CircleCI as a CI server, with stored secrets : CI/CD 플랫폼인 CircleCI 를 통해 테라폼 코드를 실행한다고 가정&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;영구자격증명은 IAM 룰과 다름에 주의합니다! 해당 단점을 없애기 위해 2번 예시를 살펴봅시다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[Providers] EC2 Instance running Jenkins as a CI server, with IAM roles 실습 : EC2에 Jenkins 설치 후 CI서버로 테라폼 코드를 실행한다고 가정 시 IAM roles 활용 - &lt;a href=&quot;https://github.com/brikis98/terraform-up-and-running-code/tree/master/code/terraform/06-managing-secrets-with-terraform/ec2-iam-role&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;링크&lt;/a&gt; (&lt;code class=&quot;language-text&quot;&gt;chapter06/example01&lt;/code&gt; 디렉토리를 참고바랍니다)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;[Providers] GitHub Actions as a CI server, with OIDC : Github Actions 은 직접 자격 증명과 OIDC Open ID Connect 지원 (가장 발전되고 이해하면 훨씬 좋은 개념!)&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;OAuth 2.0를 기반으로 한 발전형 통신이 OIDC(OpenID Connect)입니다. 이걸 사용해서 인증을 수행하는 예시를 살펴봅시다. (cf. OAuth 2.0에 대해 모르신다면 생활코딩의 &lt;a href=&quot;https://www.youtube.com/playlist?list=PLuHgQVnccGMA4guyznDlykFJh28_R08Q-&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;OAuth 2.0 역할&lt;/a&gt; 플레이리스트를 통해 공부하시는 것을 추천드립니다)&lt;/p&gt;
&lt;h3 id=&quot;resource-data-source-기재-시-암호값을-관리하는-방안&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#resource-data-source-%EA%B8%B0%EC%9E%AC-%EC%8B%9C-%EC%95%94%ED%98%B8%EA%B0%92%EC%9D%84-%EA%B4%80%EB%A6%AC%ED%95%98%EB%8A%94-%EB%B0%A9%EC%95%88&quot; aria-label=&quot;resource data source 기재 시 암호값을 관리하는 방안 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Resource, Data source 기재 시 암호값을 관리하는 방안&lt;/h3&gt;
&lt;p&gt;마찬가지로, 리소스나 데이터소스 배포시에도 민감정보를 노출하면 절대 안됩니다! 이를 보완하기 위한 방법은 3가지가 있겠습니다.&lt;/p&gt;
&lt;p&gt;이 내용에 대한 에시코드는 &lt;code class=&quot;language-text&quot;&gt;chapter06/exercises/02_resources_and_data_sources&lt;/code&gt; 에 있습니다. 링크는 &lt;a href=&quot;&quot;&gt;여기&lt;/a&gt;를 클릭해주세요.&lt;/p&gt;
&lt;h5 id=&quot;환경변수를-통한-민감정보-유출-방지&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%99%98%EA%B2%BD%EB%B3%80%EC%88%98%EB%A5%BC-%ED%86%B5%ED%95%9C-%EB%AF%BC%EA%B0%90%EC%A0%95%EB%B3%B4-%EC%9C%A0%EC%B6%9C-%EB%B0%A9%EC%A7%80&quot; aria-label=&quot;환경변수를 통한 민감정보 유출 방지 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;환경변수를 통한 민감정보 유출 방지&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;장점
&lt;ul&gt;
&lt;li&gt;모든 언어에서 환경변수에 관련 값을 넣어 쓸 수 있습니다&lt;/li&gt;
&lt;li&gt;비용이 들지 않습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;단점
&lt;ul&gt;
&lt;li&gt;팀원 모두가 환경변수를 수동으로 공유해야 합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&quot;암호화된-파일을-통한-민감정보-유출-방지&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%95%94%ED%98%B8%ED%99%94%EB%90%9C-%ED%8C%8C%EC%9D%BC%EC%9D%84-%ED%86%B5%ED%95%9C-%EB%AF%BC%EA%B0%90%EC%A0%95%EB%B3%B4-%EC%9C%A0%EC%B6%9C-%EB%B0%A9%EC%A7%80&quot; aria-label=&quot;암호화된 파일을 통한 민감정보 유출 방지 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;암호화된 파일을 통한 민감정보 유출 방지&lt;/h5&gt;
&lt;p&gt;암호를 파일에 저장 후 버전 관리 → &lt;strong&gt;암호화 키&lt;/strong&gt;를 클라우드 공급자 KMS를 통해 안전하게 저장 혹은 PGP 키 사용&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;AWS KMS란?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;암호화는 키를 사용해 평문을 암호문으로 변환하는 프로세스다&lt;/li&gt;
&lt;li&gt;동일한 키를 사용해 암호문을 평문으로 변환할 수 있는데, 이를 복호화라고 한다&lt;/li&gt;
&lt;li&gt;AWS 키 관리 서비스 &lt;strong&gt;KMS&lt;/strong&gt;는 공유 하드웨어 보안 모듈HSM 을 사용하면서 &lt;strong&gt;암호화키&lt;/strong&gt;를 &lt;strong&gt;생성&lt;/strong&gt;하고 &lt;strong&gt;관리&lt;/strong&gt;할 수 있게 도와준다&lt;/li&gt;
&lt;li&gt;CloudHSM은 AWS 내에서 암호화키를 관리할 수 있지만 보안 강화를 위해 전용 HSM을 사용할 수 있는 서비스다&lt;/li&gt;
&lt;li&gt;용어 변경 참고 : 기존 Customer Master Key (&lt;strong&gt;CMK&lt;/strong&gt;) → AWS &lt;strong&gt;KMS key&lt;/strong&gt; 혹은 &lt;strong&gt;KMS key&lt;/strong&gt; 로 변경 - &lt;a href=&quot;https://docs.aws.amazon.com/kms/latest/developerguide/dochistory.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;링크&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;ALIAS_SUFFIX&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;s3ich4n
aws kms create-alias --alias-name alias/&lt;span class=&quot;token variable&quot;&gt;$ALIAS_SUFFIX&lt;/span&gt; --target-key-id &lt;span class=&quot;token variable&quot;&gt;$KEY_ID&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# KMS(구 CMK)로 평문을 암호화해보기&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Hello 123123&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; secret.txt
aws kms encrypt --key-id alias/&lt;span class=&quot;token variable&quot;&gt;$ALIAS_SUFFIX&lt;/span&gt; --cli-binary-format raw-in-base64-out &lt;span class=&quot;token parameter variable&quot;&gt;--plaintext&lt;/span&gt; file://secret.txt &lt;span class=&quot;token parameter variable&quot;&gt;--output&lt;/span&gt; text &lt;span class=&quot;token parameter variable&quot;&gt;--query&lt;/span&gt; CiphertextBlob &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; base64 &lt;span class=&quot;token parameter variable&quot;&gt;--decode&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; secret.txt.encrypted


aws kms decrypt --ciphertext-blob fileb://secret.txt.encrypted &lt;span class=&quot;token parameter variable&quot;&gt;--output&lt;/span&gt; text &lt;span class=&quot;token parameter variable&quot;&gt;--query&lt;/span&gt; Plaintext &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; base64 &lt;span class=&quot;token parameter variable&quot;&gt;--decode&lt;/span&gt;
Hello &lt;span class=&quot;token number&quot;&gt;123123&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h5 id=&quot;중앙-집중식-비밀-저장소-서비스-사용을-통한-민감정보-유출-방지&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A4%91%EC%95%99-%EC%A7%91%EC%A4%91%EC%8B%9D-%EB%B9%84%EB%B0%80-%EC%A0%80%EC%9E%A5%EC%86%8C-%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%82%AC%EC%9A%A9%EC%9D%84-%ED%86%B5%ED%95%9C-%EB%AF%BC%EA%B0%90%EC%A0%95%EB%B3%B4-%EC%9C%A0%EC%B6%9C-%EB%B0%A9%EC%A7%80&quot; aria-label=&quot;중앙 집중식 비밀 저장소 서비스 사용을 통한 민감정보 유출 방지 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;중앙 집중식 비밀 저장소 서비스 사용을 통한 민감정보 유출 방지&lt;/h5&gt;
&lt;p&gt;중앙 집중식 비밀 저장소 서비스 사용 - AWS Secrets Manager, Google Secret Manager 등이 있지요.&lt;/p&gt;
&lt;h3 id=&quot;state-file-plan-file-을-관리하는-방안&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#state-file-plan-file-%EC%9D%84-%EA%B4%80%EB%A6%AC%ED%95%98%EB%8A%94-%EB%B0%A9%EC%95%88&quot; aria-label=&quot;state file plan file 을 관리하는 방안 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;State file, Plan file 을 관리하는 방안&lt;/h3&gt;
&lt;p&gt;plan 파일안에는 모든 정보가 평문으로 저장되어있습니다. 따라서 두가지 방안을 반드시 사용할 것을 권장합니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;백엔드 저장소에 저장하는 시점에 암호화&lt;/li&gt;
&lt;li&gt;백엔드 액세스에 대한 접근 통제&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;lessons-learned&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#lessons-learned&quot; aria-label=&quot;lessons learned permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Lessons Learned&lt;/h1&gt;
&lt;p&gt;제 6장에서는 아래의 내용을 반드시 기억하셨으면 좋겠습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;암호 관리의 중요성은 더 이상 말할 필요가 없겠습니다.&lt;/li&gt;
&lt;li&gt;암호 관리 도구들은 어떤 목적을 가지고 있으며, 어떤 내용들이 있는지 살펴보았습니다.&lt;/li&gt;
&lt;li&gt;암호관리는 목적에 맞게 처리하는 것이 중요합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이것으로 제 6장을 마칩니다. 긴 글 읽어주셔서 감사합니다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[[CloudNet@] 테라폼 스터디 5주차 - Terraform의 반복문과 조건문 (2) - 조건문]]></title><description><![CDATA[Terraform의 타입과 값이 어떻게 쓰이는지 알고있다는 가정 하에, 반복문과 조건문을 사용하여 로직을 표현하는 방법을 담았습니다. 그 중, 조건문을 살펴봅시다.]]></description><link>https://blog.s3ich4n.me/devlog/terraform/2022-11-19-cloudneta-terraform-101-pt05-2</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/terraform/2022-11-19-cloudneta-terraform-101-pt05-2</guid><pubDate>Sat, 19 Nov 2022 23:52:57 GMT</pubDate><content:encoded>&lt;p&gt;이 내용은 CloudNet@ 에서 진행하는 테라폼 기초 입문 스터디에 대한 연재글입니다.&lt;/p&gt;
&lt;p&gt;스터디에서 사용하는 교재는 &lt;a href=&quot;http://www.yes24.com/Product/Goods/101511312&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Terraform Up &amp;#x26; Running 2nd Edition&lt;/a&gt; 입니다.&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id=&quot;prerequisites&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#prerequisites&quot; aria-label=&quot;prerequisites permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Prerequisites&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://developer.hashicorp.com/terraform/language/expressions/types&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Terraform: Types and Values&lt;/a&gt; 공식문서
&lt;ul&gt;
&lt;li&gt;타입과 값에는 어떤 것들이 사용될 수 있는지 확인해봅시다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;count&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;for_each&lt;/code&gt; 는 &lt;code class=&quot;language-text&quot;&gt;resource&lt;/code&gt; 내에서 사용될 수 있습니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;for&lt;/code&gt; 표현식은 복잡한 타입을 또다른 복잡한 타입으로 변환하는데 쓰입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;아래에서 5주차 스터디 내용을 공유합니다.&lt;/p&gt;
&lt;p&gt;교재의 5장 내용을 다루고 있습니다.&lt;/p&gt;
&lt;h1 id=&quot;본문&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%B3%B8%EB%AC%B8&quot; aria-label=&quot;본문 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;본문&lt;/h1&gt;
&lt;p&gt;테라폼을 통해 마치 프로그램을 작성하듯 코드를 작성할 수 있습니다. 이번 챕터에서는 아래의 내용을 학습할 예정입니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;반복문, 조건문 사용방법
&lt;ul&gt;
&lt;li&gt;여기서는 조건문에 대해 설명합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;무중단 배포에 필요한 요소들 사용방법&lt;/li&gt;
&lt;li&gt;주의사항&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;조건문&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A1%B0%EA%B1%B4%EB%AC%B8&quot; aria-label=&quot;조건문 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;조건문&lt;/h2&gt;
&lt;p&gt;테라폼이 제공하는 조건문은 아래와 같이 구성되어 있습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;count&lt;/code&gt; 매개변수를 이용하여 사용: 조건부 리소스에서 사용&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;for_each&lt;/code&gt; 와 &lt;code class=&quot;language-text&quot;&gt;for&lt;/code&gt; 표현식: 리소스 내의 조건부 리소스, 인라인 블록에 사용&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;if&lt;/code&gt; 문자열 지시자: 문자열 내의 조건문에 사용&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;count-매개변수&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#count-%EB%A7%A4%EA%B0%9C%EB%B3%80%EC%88%98&quot; aria-label=&quot;count 매개변수 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;count&lt;/code&gt; 매개변수&lt;/h3&gt;
&lt;p&gt;앞서 살펴보았듯, &lt;code class=&quot;language-text&quot;&gt;count&lt;/code&gt; 매개변수를 사용하면 반복문을 사용할 수 있습니다. 이를 응용하여 조건문 작업 또한 수행할 수 있습니다.&lt;/p&gt;
&lt;h4 id=&quot;count-매개변수를-사용한-if-구문&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#count-%EB%A7%A4%EA%B0%9C%EB%B3%80%EC%88%98%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%9C-if-%EA%B5%AC%EB%AC%B8&quot; aria-label=&quot;count 매개변수를 사용한 if 구문 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;count&lt;/code&gt; 매개변수를 사용한 &lt;code class=&quot;language-text&quot;&gt;if&lt;/code&gt; 구문&lt;/h4&gt;
&lt;p&gt;일부 사용자들에게는 모듈을 생성하고, 나머지 사용자에게는 생성해주지 않기 위해선 &lt;strong&gt;분기 처리&lt;/strong&gt;를 수행합니다.&lt;/p&gt;
&lt;p&gt;이를 위해서는 Boolean 입력 변수를 변수값으로 추가해주고, 아래와같은 조건 표현식(conditional expression)을 추가합니다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;variable&lt;span class=&quot;token type variable&quot;&gt; &quot;enable_autoscaling&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;description&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;If set to true, enable auto scaling&quot;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;type&lt;/span&gt;        &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; bool
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&amp;lt;CONDITION&gt; ? &amp;lt;TRUE_VAL&gt; : &amp;lt;FALSE_VAL&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;CONDITION&lt;/code&gt;: boolean 판단 조건을 기재합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;TRUE_VAL&lt;/code&gt;: 판단 조건이 참일 때의 결과값입니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;FALSE_VAL&lt;/code&gt;: 판단 조건이 거짓일 때의 결과값입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;상기 조건을 조합하면 아래값처럼 &lt;code class=&quot;language-text&quot;&gt;webserver-cluster&lt;/code&gt; 모듈을 업데이트 할 수 있지요.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;resource &lt;span class=&quot;token type variable&quot;&gt;&quot;aws_autoscaling_schedule&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;scale_out_during_business_hours&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# enable_autoscaling 값이 참/거짓일 때에 따라 auto scaling을 허용/불허할 수 있습니다.&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; var.enable_autoscaling ? &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; : &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;

  &lt;span class=&quot;token property&quot;&gt;scheduled_action_name&lt;/span&gt;  &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token type variable&quot;&gt;cluster_name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;-scale-out-during-business-hours&quot;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;min_size&lt;/span&gt;               &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;max_size&lt;/span&gt;               &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;desired_capacity&lt;/span&gt;       &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;recurrence&lt;/span&gt;             &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;0 9 * * *&quot;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# 이 값은 cron 양식을 따릅니다!&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;autoscaling_group_name&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; aws_autoscaling_group.example.name
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;resource &lt;span class=&quot;token type variable&quot;&gt;&quot;aws_autoscaling_schedule&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;scale_in_at_night&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; var.enable_autoscaling ? &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; : &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;

  &lt;span class=&quot;token property&quot;&gt;scheduled_action_name&lt;/span&gt;  &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token type variable&quot;&gt;cluster_name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;-scale-in-at-night&quot;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;min_size&lt;/span&gt;               &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;max_size&lt;/span&gt;               &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;desired_capacity&lt;/span&gt;       &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;recurrence&lt;/span&gt;             &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;0 17 * * *&quot;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;autoscaling_group_name&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; aws_autoscaling_group.example.name
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이러한 조건을 staging 서버에서는 &lt;code class=&quot;language-text&quot;&gt;false&lt;/code&gt;로, production 서버에서는 &lt;code class=&quot;language-text&quot;&gt;true&lt;/code&gt; 로 두기 위해선 아래와 같이 사용하면 됩니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;staging 서버의 &lt;code class=&quot;language-text&quot;&gt;main.tf&lt;/code&gt; 파일에서는?&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;span class=&quot;token type variable&quot;&gt; &quot;webserver_cluster&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;source&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;../../../../modules/services/webserver-cluster&quot;&lt;/span&gt;

  &lt;span class=&quot;token property&quot;&gt;cluster_name&lt;/span&gt;           &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;webservers-stage&quot;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;db_remote_state_bucket&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;(YOUR_BUCKET_NAME)&quot;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;db_remote_state_key&lt;/span&gt;    &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;stage/data-stores/mysql/terraform.tfstate&quot;&lt;/span&gt;

  &lt;span class=&quot;token property&quot;&gt;instance_type&lt;/span&gt;        &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;t2.micro&quot;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;min_size&lt;/span&gt;             &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;max_size&lt;/span&gt;             &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# boolean 타입이므로, 해당 값을 지정해서, 설정이 구동되게 지정해줄 수 있습니다.&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;enable_autoscaling&lt;/span&gt;   &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;production 서버의 &lt;code class=&quot;language-text&quot;&gt;main.tf&lt;/code&gt; 파일에서는?&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;span class=&quot;token type variable&quot;&gt; &quot;webserver_cluster&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;source&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;../../../../modules/services/webserver-cluster&quot;&lt;/span&gt;

  &lt;span class=&quot;token property&quot;&gt;cluster_name&lt;/span&gt;           &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;webservers-prod&quot;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;db_remote_state_bucket&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;(YOUR_BUCKET_NAME)&quot;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;db_remote_state_key&lt;/span&gt;    &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;prod/data-stores/mysql/terraform.tfstate&quot;&lt;/span&gt;

  &lt;span class=&quot;token property&quot;&gt;instance_type&lt;/span&gt;        &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;m4.large&quot;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;min_size&lt;/span&gt;             &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;max_size&lt;/span&gt;             &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# boolean 타입이므로, 해당 값을 지정해서, 설정이 구동되게 지정해줄 수 있습니다.&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;enable_autoscaling&lt;/span&gt;   &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;

  &lt;span class=&quot;token property&quot;&gt;custom_tags&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;Owner&lt;/span&gt;     &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;team-foo&quot;&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;ManagedBy&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;terraform&quot;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&quot;count-매개변수를-사용한-if-else-구문&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#count-%EB%A7%A4%EA%B0%9C%EB%B3%80%EC%88%98%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%9C-if-else-%EA%B5%AC%EB%AC%B8&quot; aria-label=&quot;count 매개변수를 사용한 if else 구문 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;count&lt;/code&gt; 매개변수를 사용한 &lt;code class=&quot;language-text&quot;&gt;if-else&lt;/code&gt; 구문&lt;/h4&gt;
&lt;p&gt;특정 IAM 사용자에게 CloudWatch에 대한 액세스 권한을 부여하는 예시로 살펴보겠습니다. 이 파일은 별도의 정책관련 테라폼 파일로 만들면 되겠지요. (&lt;code class=&quot;language-text&quot;&gt;s3ich4n&lt;/code&gt;이란 유저에 대해 권한을 부여해보죠)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;읽기 권한만 부여하기 위한 예시값 (&lt;code class=&quot;language-text&quot;&gt;iam_read_only.tf&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;resource &lt;span class=&quot;token type variable&quot;&gt;&quot;aws_iam_policy&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;cloudwatch_read_only&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;name&lt;/span&gt;   &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;cloudwatch-read-only&quot;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;policy&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; data.aws_iam_policy_document.cloudwatch_read_only.json
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;data &lt;span class=&quot;token type variable&quot;&gt;&quot;aws_iam_policy_document&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;cloudwatch_read_only&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;statement&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;effect&lt;/span&gt;    &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Allow&quot;&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# cloudwatch의 일부 기능들(read 파트)에 대해서만 권한을 허용하였습니다.&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;actions&lt;/span&gt;   &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
      &lt;span class=&quot;token string&quot;&gt;&quot;cloudwatch:Describe*&quot;&lt;/span&gt;,
      &lt;span class=&quot;token string&quot;&gt;&quot;cloudwatch:Get*&quot;&lt;/span&gt;,
      &lt;span class=&quot;token string&quot;&gt;&quot;cloudwatch:List*&quot;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;resources&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;*&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;읽기/쓰기 권한을 부여하기 위한 예시값(&lt;code class=&quot;language-text&quot;&gt;iam_rw.tf&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;resource &lt;span class=&quot;token type variable&quot;&gt;&quot;aws_iam_policy&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;cloudwatch_full_access&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;name&lt;/span&gt;   &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;cloudwatch-full-access&quot;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;policy&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; data.aws_iam_policy_document.cloudwatch_full_access.json
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;data &lt;span class=&quot;token type variable&quot;&gt;&quot;aws_iam_policy_document&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;cloudwatch_full_access&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;statement&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;effect&lt;/span&gt;    &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Allow&quot;&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# cloudwatch의 전체 기능에 대해 권한을 허용하였습니다.&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;actions&lt;/span&gt;   &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;cloudwatch:*&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;resources&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;*&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;give_s3ich4n_cloudwatch_full_access&lt;/code&gt; 이라는 변수값에 기반하여, 리소스를 어떻게 적용할지 살펴봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;variable&lt;span class=&quot;token type variable&quot;&gt; &quot;give_s3ich4n_cloudwatch_full_access&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;description&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;If true, s3ich4n gets full access to CloudWatch&quot;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;type&lt;/span&gt;        &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; bool
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;리소스 생성 시, 동작수행을 위해 &lt;code class=&quot;language-text&quot;&gt;count&lt;/code&gt; 매개변수와 조건 표현식을 모두 사용해봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;resource &lt;span class=&quot;token type variable&quot;&gt;&quot;aws_iam_user_policy_attachment&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;neo_cloudwatch_full_access&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; var.give_neo_cloudwatch_full_access ? &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; : &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;

  &lt;span class=&quot;token property&quot;&gt;user&lt;/span&gt;       &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; aws_iam_user.example&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;.name
  &lt;span class=&quot;token property&quot;&gt;policy_arn&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; aws_iam_policy.cloudwatch_full_access.arn
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;resource &lt;span class=&quot;token type variable&quot;&gt;&quot;aws_iam_user_policy_attachment&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;neo_cloudwatch_read_only&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; var.give_neo_cloudwatch_full_access ? &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; : &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;

  &lt;span class=&quot;token property&quot;&gt;user&lt;/span&gt;       &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; aws_iam_user.example&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;.name
  &lt;span class=&quot;token property&quot;&gt;policy_arn&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; aws_iam_policy.cloudwatch_read_only.arn
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;위 코드에는 2개의 &lt;code class=&quot;language-text&quot;&gt;aws_iam_user_policy_attachment&lt;/code&gt; 리소스가 포함되어 있습니다.&lt;/li&gt;
&lt;li&gt;윗 부분은 전체 액세스 권한을 첨부하는 if절 이고, 아래는 읽기 전용 권한을 첨부하는 else 절입니다.&lt;/li&gt;
&lt;li&gt;위 접근 방식은 테라폼 코드가 if 나 else 절을 알필요가 없습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;for_each-와-for-표현식&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#for_each-%EC%99%80-for-%ED%91%9C%ED%98%84%EC%8B%9D&quot; aria-label=&quot;for_each 와 for 표현식 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;for_each&lt;/code&gt; 와 &lt;code class=&quot;language-text&quot;&gt;for&lt;/code&gt; 표현식&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;for_each&lt;/code&gt; 표현식을 빈 컬렉션으로 전달하면, 0개의 리소스 또는 0개의 인라인 블록을 생성합니다. 비어있지 않은 컬렉션을 전달하면 하나 이상의 리소스 또는 인라인 블록을 만듭니다.&lt;/p&gt;
&lt;p&gt;이를 표현하기 위해서는 조건부로 어떻게 표현할까요? &lt;code class=&quot;language-text&quot;&gt;for_each&lt;/code&gt; 표현식과 &lt;code class=&quot;language-text&quot;&gt;for&lt;/code&gt; 표현식을 결합하여 사용할 수 있습니다. 예시값을 살펴보시지요.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;dynamic &lt;span class=&quot;token string&quot;&gt;&quot;tag&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;for_each&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    	for key, value in var.custom_tags:
    	&lt;span class=&quot;token property&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&gt; upper(value)
    	if key !&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Name&quot;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;content&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    	&lt;span class=&quot;token property&quot;&gt;key&lt;/span&gt;                 &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; tag.key
    	&lt;span class=&quot;token property&quot;&gt;value&lt;/span&gt;               &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; tag.value
    	&lt;span class=&quot;token property&quot;&gt;propagate_at_launch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;중첩된 &lt;code class=&quot;language-text&quot;&gt;for&lt;/code&gt; 표현식은 일관성을 위해 &lt;code class=&quot;language-text&quot;&gt;var.custom_tags&lt;/code&gt; 를 반복하며 각 값을 대문자로 변환하고 모듈이 이미 자체 &lt;code class=&quot;language-text&quot;&gt;Name&lt;/code&gt; 태그를 설정했으므로, &lt;code class=&quot;language-text&quot;&gt;for&lt;/code&gt; 표현식의 조건을 사용하여 &lt;code class=&quot;language-text&quot;&gt;key&lt;/code&gt; 집합을 &lt;code class=&quot;language-text&quot;&gt;Name&lt;/code&gt; 으로 필터링합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;for&lt;/code&gt; 표현식에서 값을 필터링하여 임의 조건부 논리를 구현할 수 있습니다.&lt;/li&gt;
&lt;li&gt;리소스의 복사본을 여러 개 만들 때는 count 보다 for_each 를 사용하는 것이 더 낫지만,
&lt;ul&gt;
&lt;li&gt;조건 논리의 경우 비어 있지 않은 컬렉션에 for_each 를 설정하는 것보다 count 를 &lt;code class=&quot;language-text&quot;&gt;0&lt;/code&gt; 또는 &lt;code class=&quot;language-text&quot;&gt;1&lt;/code&gt;로 설정하는 것이 간단합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;즉, &lt;strong&gt;리소스를 조건부로 생성&lt;/strong&gt;할 때는 &lt;strong&gt;count&lt;/strong&gt; 를 사용할 수 있지만, &lt;strong&gt;그 외 모든 유형의 반복문 또는 조건문&lt;/strong&gt;에는 &lt;strong&gt;for_each&lt;/strong&gt; 를 사용합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;if-문자열-지시자&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#if-%EB%AC%B8%EC%9E%90%EC%97%B4-%EC%A7%80%EC%8B%9C%EC%9E%90&quot; aria-label=&quot;if 문자열 지시자 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;if&lt;/code&gt; 문자열 지시자&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;if&lt;/code&gt; 문자열 지시자를 살펴봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# if 구문의 사용방법 입니다.&lt;/span&gt;
%&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;if &amp;lt;CONDITION&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&amp;lt;TRUEVAL&gt;%&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;endif&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# if-else 구문의 사용방법입니다.&lt;/span&gt;
%&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; for &amp;lt;INDEX&gt;, &amp;lt;ITEM&gt; in &amp;lt;COLLECTION&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&amp;lt;BODY&gt;%&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;if &amp;lt;EXPRESSION&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;%&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; else &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&amp;lt;FALSEVAL&gt;%&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; endif &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;%&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; endfor &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;COLLECTION: 반복할 리스트, 맵. 말 그대로 반복 가능한 컬렉션을 의미합니다.&lt;/li&gt;
&lt;li&gt;INDEX: 이터레이션 시의 인덱스값을 표현합니다.&lt;/li&gt;
&lt;li&gt;ITEM: 각 항목에 할당할 로컬 변수의 이름입니다.&lt;/li&gt;
&lt;li&gt;BODY: ITEM을 참조할 수 있는 각각의 반복을 렌더링하는 대상입니다.&lt;/li&gt;
&lt;li&gt;EXPRESSION: 참/거짓을 판별하는 조건입니다.&lt;/li&gt;
&lt;li&gt;TRUEVAL: 참일 때 반복문을 통해 추가할 값입니다.&lt;/li&gt;
&lt;li&gt;FALSEVAL: 거짓일 때 반복문을 통해 추가할 값입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/brikis98/terraform-up-and-running-code/blob/master/code/terraform/05-tips-and-tricks/loops-and-if-statements/live/global/string-directives/main.tf&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;예시&lt;/a&gt;를 보면서 함께 살펴봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;variable&lt;span class=&quot;token type variable&quot;&gt; &quot;names&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;description&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;A list of names&quot;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;type&lt;/span&gt;        &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; list(string)
  &lt;span class=&quot;token property&quot;&gt;default&lt;/span&gt;     &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;alice&quot;&lt;/span&gt;, &lt;span class=&quot;token string&quot;&gt;&quot;bob&quot;&lt;/span&gt;, &lt;span class=&quot;token string&quot;&gt;&quot;charlie&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# if 구문을 사용하는 방법입니다.&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;output&lt;span class=&quot;token type variable&quot;&gt; &quot;for_directive_index_if&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token heredoc string&quot;&gt;&amp;lt;&amp;lt;EOF
%{ for i, name in var.names }
  ${name}%{ if i &amp;lt; length(var.names) - 1 }, %{ endif }
%{ endfor }
EOF&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 마지막 `,` 문자에 대해 strip을 할 수도 있습니다.&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;output&lt;span class=&quot;token type variable&quot;&gt; &quot;for_directive_index_if_strip&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token heredoc string&quot;&gt;&amp;lt;&amp;lt;EOF
%{~ for i, name in var.names ~}
${name}%{ if i &amp;lt; length(var.names) - 1 }, %{ endif }
%{~ endfor ~}
EOF&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 마지막 `,` 문자에 대해 strip을 할 수도 있습니다.&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;output&lt;span class=&quot;token type variable&quot;&gt; &quot;for_directive_index_if_else_strip&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token heredoc string&quot;&gt;&amp;lt;&amp;lt;EOF
%{~ for i, name in var.names ~}
${name}%{ if i &amp;lt; length(var.names) - 1 }, %{ else }.%{ endif }
%{~ endfor ~}
EOF&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;terraform init &amp;amp;&amp;amp; terraform apply&lt;/code&gt;를 수행하면 아래와 같은 결과값을 보실 수 있습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ terraform init &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; terraform apply

&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

Apply complete&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt; Resources: &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; added, &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; changed, &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; destroyed.

Outputs:

for_directive_index_if &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;EOT

  alice,

  bob,

  charlie


EOT&lt;/span&gt;
for_directive_index_if_else_strip &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;alice, bob, charlie.&quot;&lt;/span&gt;
for_directive_index_if_strip &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;alice, bob, charlie&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id=&quot;lessons-learned&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#lessons-learned&quot; aria-label=&quot;lessons learned permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Lessons Learned&lt;/h1&gt;
&lt;p&gt;제 5장에서는 아래의 내용을 반드시 기억하셨으면 좋겠습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;(중요!) Prerequisite를 반드시 읽어주세요. 테라폼의 타입과 값에 대한 내용은 알고있어야 앞으로의 진행이 수월할 것입니다!&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;프로그래밍 언어처럼 다루려면, 어떤 타입과 값을 사용할 수 있는지는 기본적으로 알아야 하기 때문입니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;조건문의 사용방법과 주의사항에 대해 배웠습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이것으로 제 5장, 조건문 설명을 마칩니다. 긴 글 읽어주셔서 감사합니다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[[CloudNet@] 테라폼 스터디 5주차 - Terraform의 반복문과 조건문 (1) - 반복문]]></title><description><![CDATA[Terraform의 타입과 값이 어떻게 쓰이는지 알고있다는 가정 하에, 반복문과 조건문을 사용하여 로직을 표현하는 방법을 담았습니다. 그 중, 반복문을 먼저 살펴봅시다.]]></description><link>https://blog.s3ich4n.me/devlog/terraform/2022-11-19-cloudneta-terraform-101-pt05-1</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/terraform/2022-11-19-cloudneta-terraform-101-pt05-1</guid><pubDate>Wed, 16 Nov 2022 03:37:57 GMT</pubDate><content:encoded>&lt;p&gt;이 내용은 CloudNet@ 에서 진행하는 테라폼 기초 입문 스터디에 대한 연재글입니다.&lt;/p&gt;
&lt;p&gt;스터디에서 사용하는 교재는 &lt;a href=&quot;http://www.yes24.com/Product/Goods/101511312&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Terraform Up &amp;#x26; Running 2nd Edition&lt;/a&gt; 입니다.&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id=&quot;prerequisites&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#prerequisites&quot; aria-label=&quot;prerequisites permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Prerequisites&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://developer.hashicorp.com/terraform/language/expressions/types&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Terraform: Types and Values&lt;/a&gt; 공식문서
&lt;ul&gt;
&lt;li&gt;타입과 값에는 어떤 것들이 사용될 수 있는지 확인해봅시다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;count&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;for_each&lt;/code&gt; 는 &lt;code class=&quot;language-text&quot;&gt;resource&lt;/code&gt; 내에서 사용될 수 있습니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;for&lt;/code&gt; 표현식은 복잡한 타입을 또다른 복잡한 타입으로 변환하는데 쓰입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;아래에서 5주차 스터디 내용을 공유합니다.&lt;/p&gt;
&lt;p&gt;교재의 5장 내용을 다루고 있습니다.&lt;/p&gt;
&lt;h1 id=&quot;본문&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%B3%B8%EB%AC%B8&quot; aria-label=&quot;본문 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;본문&lt;/h1&gt;
&lt;p&gt;테라폼을 통해 마치 프로그램을 작성하듯 코드를 작성할 수 있습니다. 이번 챕터에서는 아래의 내용을 학습할 예정입니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;반복, 조건문 사용방법&lt;/li&gt;
&lt;li&gt;무중단 배포에 필요한 요소들 사용방법&lt;/li&gt;
&lt;li&gt;주의사항&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;반복문&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%B0%98%EB%B3%B5%EB%AC%B8&quot; aria-label=&quot;반복문 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;반복문&lt;/h2&gt;
&lt;p&gt;테라폼이 제공하는 반복문 구성은 아래와 같습니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;count&lt;/code&gt; 구문&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;for_each&lt;/code&gt; 표현식&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;for&lt;/code&gt; 표현식&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;for&lt;/code&gt; 문자열 지시어&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;count-구문&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#count-%EA%B5%AC%EB%AC%B8&quot; aria-label=&quot;count 구문 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;count&lt;/code&gt; 구문&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;count&lt;/code&gt; 구문을 사용한 반복에 대해 살펴봅시다.&lt;/p&gt;
&lt;h4 id=&quot;count-구문을-사용한-반복문-1&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#count-%EA%B5%AC%EB%AC%B8%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%9C-%EB%B0%98%EB%B3%B5%EB%AC%B8-1&quot; aria-label=&quot;count 구문을 사용한 반복문 1 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;count&lt;/code&gt; 구문을 사용한 반복문 (1)&lt;/h4&gt;
&lt;p&gt;IAM 사용자를 3명 생성하는 예시로 살펴보겠습니다. 리소스는 &lt;a href=&quot;https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;aws_iam_user&lt;/code&gt;&lt;/a&gt; 를 사용합니다. &lt;code class=&quot;language-text&quot;&gt;name&lt;/code&gt; 필드는 Required 입니다.&lt;/p&gt;
&lt;p&gt;전체 예시코드는 &lt;code class=&quot;language-text&quot;&gt;chapter05/example01/count/index&lt;/code&gt; 디렉토리를 살펴봐주세요.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;iam.tf&lt;/code&gt; 파일 전체&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;provider&lt;span class=&quot;token type variable&quot;&gt; &quot;aws&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;region&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ap-northeast-2&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;resource &lt;span class=&quot;token type variable&quot;&gt;&quot;aws_iam_user&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ch05-iam&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# 0부터 시작, 3번 반복합니다.&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;name&lt;/span&gt;  &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;s3ich4n.&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token type variable&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;이 경우, 0부터 시작, 2까지 반복하는 인덱스 값을 추가합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;name&lt;/code&gt; 값에 인덱스를 사용하지 않는다면, 3명의 IAM 사용자 이름 &lt;strong&gt;중복&lt;/strong&gt;으로 오류가 발생합니다. 따라서, 반복문의 인덱스값을 사용하여 각 사용자에게 고유한 이름을 사용하도록 코드를 작성하였습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;예시를 구동해봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;`$ terraform init

Initializing the backend&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;.

Initializing provider plugins&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;.
- Finding latest version of hashicorp/aws&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;.
- Installed hashicorp/aws v4.39.0 &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;signed by HashiCorp&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

Terraform has created a lock &lt;span class=&quot;token function&quot;&gt;file&lt;/span&gt; .terraform.lock.hcl to record the provider
selections it made above. Include this &lt;span class=&quot;token function&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; your version control repository
so that Terraform can guarantee to &lt;span class=&quot;token function&quot;&gt;make&lt;/span&gt; the same selections by default when
you run &lt;span class=&quot;token string&quot;&gt;&quot;terraform init&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; the future.

Terraform has been successfully initialized&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;중략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

$ terraform apply

Terraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  &lt;span class=&quot;token comment&quot;&gt;# aws_iam_user.ch05-iam[0] will be created&lt;/span&gt;
  + resource &lt;span class=&quot;token string&quot;&gt;&quot;aws_iam_user&quot;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ch05-iam&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      + name          &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;s3ich4n.0&quot;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;# aws_iam_user.ch05-iam[1] will be created&lt;/span&gt;
  + resource &lt;span class=&quot;token string&quot;&gt;&quot;aws_iam_user&quot;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ch05-iam&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      + name          &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;s3ich4n.1&quot;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;# aws_iam_user.ch05-iam[2] will be created&lt;/span&gt;
  + resource &lt;span class=&quot;token string&quot;&gt;&quot;aws_iam_user&quot;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ch05-iam&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      + name          &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;s3ich4n.2&quot;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

Plan: &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; to add, &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; to change, &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; to destroy.

Do you want to perform these actions?
  Terraform will perform the actions described above.
  Only &lt;span class=&quot;token string&quot;&gt;&apos;yes&apos;&lt;/span&gt; will be accepted to approve.

  Enter a value: &lt;span class=&quot;token function&quot;&gt;yes&lt;/span&gt;

aws_iam_user.ch05-iam&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;: Creating&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;.
aws_iam_user.ch05-iam&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;: Creating&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;.
aws_iam_user.ch05-iam&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;: Creating&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;.
aws_iam_user.ch05-iam&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;: Creation complete after 1s &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;id&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;s3ich4n.1&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
aws_iam_user.ch05-iam&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;: Creation complete after 1s &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;id&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;s3ich4n.2&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
aws_iam_user.ch05-iam&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;: Creation complete after 1s &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;id&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;s3ich4n.0&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

Apply complete&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt; Resources: &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; added, &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; changed, &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; destroyed.

&lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# 반복문 구동을 확인했습니다. 삭제합시다.&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
$ terraform destroy -auto-approve

aws_iam_user.ch05-iam&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;: Refreshing state&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;. &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;id&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;s3ich4n.2&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
aws_iam_user.ch05-iam&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;: Refreshing state&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;. &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;id&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;s3ich4n.0&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
aws_iam_user.ch05-iam&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;: Refreshing state&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;. &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;id&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;s3ich4n.1&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

Terraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:
  - destroy

Terraform will perform the following actions:

  &lt;span class=&quot;token comment&quot;&gt;# aws_iam_user.ch05-iam[0] will be destroyed&lt;/span&gt;
  - resource &lt;span class=&quot;token string&quot;&gt;&quot;aws_iam_user&quot;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ch05-iam&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;# aws_iam_user.ch05-iam[1] will be destroyed&lt;/span&gt;
  - resource &lt;span class=&quot;token string&quot;&gt;&quot;aws_iam_user&quot;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ch05-iam&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;# aws_iam_user.ch05-iam[2] will be destroyed&lt;/span&gt;
  - resource &lt;span class=&quot;token string&quot;&gt;&quot;aws_iam_user&quot;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ch05-iam&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

Plan: &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; to add, &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; to change, &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; to destroy.
aws_iam_user.ch05-iam&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;: Destroying&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;. &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;id&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;s3ich4n.2&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
aws_iam_user.ch05-iam&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;: Destroying&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;. &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;id&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;s3ich4n.0&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
aws_iam_user.ch05-iam&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;: Destroying&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;. &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;id&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;s3ich4n.1&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
aws_iam_user.ch05-iam&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;: Destruction complete after 1s
aws_iam_user.ch05-iam&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;: Destruction complete after 1s
aws_iam_user.ch05-iam&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;: Destruction complete after 1s

Destroy complete&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt; Resources: &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; destroyed.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;0부터 2까지 반복되어 유저 이름에 값이 붙은 것을 확인할 수 있습니다.&lt;/p&gt;
&lt;h4 id=&quot;count-구문을-사용한-반복문-2&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#count-%EA%B5%AC%EB%AC%B8%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%9C-%EB%B0%98%EB%B3%B5%EB%AC%B8-2&quot; aria-label=&quot;count 구문을 사용한 반복문 2 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;count&lt;/code&gt; 구문을 사용한 반복문 (2)&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;(스포) 위험한 코드입니다! 잘못쓰기 쉬우니, 아래 주의사항을 반드시 보세요!&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;마찬가지로, IAM 사용자를 3명 생성하는 예시로 살펴보겠습니다. 리소스는 &lt;a href=&quot;https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;aws_iam_user&lt;/code&gt;&lt;/a&gt; 를 사용합니다. &lt;code class=&quot;language-text&quot;&gt;name&lt;/code&gt; 필드는 Required 입니다.&lt;/p&gt;
&lt;p&gt;전체 예시코드는 &lt;code class=&quot;language-text&quot;&gt;chapter05/example01/count/list_and_default&lt;/code&gt; 디렉토리를 살펴봐주세요.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;variables.tf&lt;/code&gt; 파일&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;variable&lt;span class=&quot;token type variable&quot;&gt; &quot;user_names&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;description&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Create IAM users with these names&quot;&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# 문자열을 담는 &quot;리스트&quot; 타입입니다.&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;type&lt;/span&gt;        &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; list(string)
  &lt;span class=&quot;token property&quot;&gt;default&lt;/span&gt;     &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;alice&quot;&lt;/span&gt;, &lt;span class=&quot;token string&quot;&gt;&quot;bob&quot;&lt;/span&gt;, &lt;span class=&quot;token string&quot;&gt;&quot;charlie&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;iam.tf&lt;/code&gt; 파일&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;provider&lt;span class=&quot;token type variable&quot;&gt; &quot;aws&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;region&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ap-northeast-2&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;resource &lt;span class=&quot;token type variable&quot;&gt;&quot;aws_iam_user&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ch05-ex01-count&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# 이런 식으로, user_names내 리스트 값의 길이를 알 수 있지요.&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; length(var.user_names)
  &lt;span class=&quot;token property&quot;&gt;name&lt;/span&gt;  &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; var.user_names&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;count.index&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;outputs.tf&lt;/code&gt; 파일&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;output&lt;span class=&quot;token type variable&quot;&gt; &quot;first_arn&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# 첫번째 값을 가져옵니다.&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;value&lt;/span&gt;       &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; aws_iam_user.ch05-ex01-count&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;.arn
  &lt;span class=&quot;token property&quot;&gt;description&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;The ARN for the first user&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;output&lt;span class=&quot;token type variable&quot;&gt; &quot;all_arns&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# 전체 값을 가져오는건 이렇게 사용합니다.&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;value&lt;/span&gt;       &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; aws_iam_user.ch05-ex01-count&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;*&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;.arn
  &lt;span class=&quot;token property&quot;&gt;description&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;The ARNs for all users&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;어떤 코드인지 개념을 살펴봅시다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;테라폼에서는 &lt;code class=&quot;language-text&quot;&gt;count&lt;/code&gt; 와 함께 배열 조회 구문과 &lt;a href=&quot;https://developer.hashicorp.com/terraform/language/functions/length&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;length&lt;/code&gt; 함수&lt;/a&gt; 를 사용해서 반복을 할 수 있습니다.
&lt;ul&gt;
&lt;li&gt;배열 조회 구문
&lt;ul&gt;
&lt;li&gt;ARRAY[&lt;INDEX&gt;]&lt;/li&gt;
&lt;li&gt;E.g., var.user_names 의 인덱스 &lt;code class=&quot;language-text&quot;&gt;0&lt;/code&gt;에서 요소를 찾는 방법: &lt;code class=&quot;language-text&quot;&gt;ch05-ex01-count[0]&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;전체 값을 가져오는 방법: &lt;code class=&quot;language-text&quot;&gt;ch05-ex01-count[*]&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;length (내장) 함수
&lt;ul&gt;
&lt;li&gt;length(&lt;ARRAY&gt;)&lt;/li&gt;
&lt;li&gt;주어진 ARRAY 의 항목 수를 반환하는 함수. 문자열 및 맵을 대상으로도 동작합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이 예제를 스스로 &lt;code class=&quot;language-text&quot;&gt;terraform init &amp;amp;&amp;amp; terraform apply -auto-approve&lt;/code&gt; 해보시기 바랍니다.
(&lt;code class=&quot;language-text&quot;&gt;-auto-approve&lt;/code&gt; 플래그는, 자동으로 프로비저닝하라는 키워드입니다.)&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ terraform init &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; terraform apply -auto-approve

Terraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  &lt;span class=&quot;token comment&quot;&gt;# aws_iam_user.ch05-ex01-count[0] will be created&lt;/span&gt;
  + resource &lt;span class=&quot;token string&quot;&gt;&quot;aws_iam_user&quot;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ch05-ex01-count&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      + name          &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;alice&quot;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;# aws_iam_user.ch05-ex01-count[1] will be created&lt;/span&gt;
  + resource &lt;span class=&quot;token string&quot;&gt;&quot;aws_iam_user&quot;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ch05-ex01-count&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      + name          &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;bob&quot;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;# aws_iam_user.ch05-ex01-count[2] will be created&lt;/span&gt;
  + resource &lt;span class=&quot;token string&quot;&gt;&quot;aws_iam_user&quot;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ch05-ex01-count&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      + name          &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;charlie&quot;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

Plan: &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; to add, &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; to change, &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; to destroy.

&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

Apply complete&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt; Resources: &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; added, &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; changed, &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; destroyed.

Outputs:

all_arns &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
  &lt;span class=&quot;token string&quot;&gt;&quot;arn:aws:iam::240962124292:user/alice&quot;&lt;/span&gt;,
  &lt;span class=&quot;token string&quot;&gt;&quot;arn:aws:iam::240962124292:user/bob&quot;&lt;/span&gt;,
  &lt;span class=&quot;token string&quot;&gt;&quot;arn:aws:iam::240962124292:user/charlie&quot;&lt;/span&gt;,
&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
first_arn &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;arn:aws:iam::240962124292:user/alice&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&quot;count-를-사용한-반복문의-제약사항&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#count-%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%9C-%EB%B0%98%EB%B3%B5%EB%AC%B8%EC%9D%98-%EC%A0%9C%EC%95%BD%EC%82%AC%ED%95%AD&quot; aria-label=&quot;count 를 사용한 반복문의 제약사항 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;count&lt;/code&gt; 를 사용한 반복문의 제약사항&lt;/h4&gt;
&lt;p&gt;위의 예제를 통해 계정을 만들고, 아래의 예시를 통해 제약사항을 살펴봅시다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;전체 리소스를 반복할 수는 있지만 리소스 내에서 인라인 블록을 반복할 수는 없습니다. 아래 예시로 살펴봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;resource &lt;span class=&quot;token type variable&quot;&gt;&quot;aws_autoscaling_group&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;example&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;launch_configuration&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; aws_launch_configuration.example.name
  &lt;span class=&quot;token property&quot;&gt;vpc_zone_identifier&lt;/span&gt;  &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; data.aws_subnets.default.ids
  &lt;span class=&quot;token property&quot;&gt;target_group_arns&lt;/span&gt;    &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;aws_lb_target_group.asg.arn&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;health_check_type&lt;/span&gt;    &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ELB&quot;&lt;/span&gt;

  &lt;span class=&quot;token property&quot;&gt;min_size&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; var.min_size
  &lt;span class=&quot;token property&quot;&gt;max_size&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; var.max_size

  &lt;span class=&quot;token keyword&quot;&gt;tag&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;key&lt;/span&gt;                 &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Name&quot;&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;value&lt;/span&gt;               &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; var.cluster_name
    &lt;span class=&quot;token property&quot;&gt;propagate_at_launch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;각각의 tag 를 사용하려면 &lt;code class=&quot;language-text&quot;&gt;key&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;value&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;propagate_at_launch&lt;/code&gt; 에 대한 값으로 새 인라인 블록을 만들어야 합니다.&lt;/li&gt;
&lt;li&gt;따라서 &lt;code class=&quot;language-text&quot;&gt;count&lt;/code&gt; 구문을 사용해서 이러한 태그를 반복하여 동적인 인라인 &lt;code class=&quot;language-text&quot;&gt;tag&lt;/code&gt; 블록을 생성하려고 시도할 수도 있지만, 인라인 블록 내에서는 count 사용은 지원하지 않습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;코드 재사용시 &lt;strong&gt;치명적인&lt;/strong&gt; 문제가 있습니다. 아래 예시로 살펴봅시다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;variables.tf&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;variable&lt;span class=&quot;token type variable&quot;&gt; &quot;user_names&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;description&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Create IAM users with these names&quot;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;type&lt;/span&gt;        &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; list(string)
  &lt;span class=&quot;token property&quot;&gt;default&lt;/span&gt;     &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;alice&quot;&lt;/span&gt;, &lt;span class=&quot;token string&quot;&gt;&quot;charlie&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;배열의 중간에 항목을 제거하면 모든 항목이 1칸씩 앞으로 당겨질 것입니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;테라폼은 인덱스 번호를 리소스 식별자로 봅니다. 따라서, ‘인덱스 1에서는 계정을 만들고, 인덱스2에서는 버킷을 삭제한다’라고 해석합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ terraform plan

aws_iam_user.ch05-ex01-count&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;: Refreshing state&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;. &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;id&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;charlie&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
aws_iam_user.ch05-ex01-count&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;: Refreshing state&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;. &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;id&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;bob&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
aws_iam_user.ch05-ex01-count&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;: Refreshing state&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;. &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;id&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;alice&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

Note: Objects have changed outside of Terraform

Terraform detected the following changes made outside of Terraform since the last &lt;span class=&quot;token string&quot;&gt;&quot;terraform apply&quot;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;which&lt;/span&gt; may have affected this plan:

  &lt;span class=&quot;token comment&quot;&gt;# aws_iam_user.ch05-ex01-count[0] has changed&lt;/span&gt;
  ~ resource &lt;span class=&quot;token string&quot;&gt;&quot;aws_iam_user&quot;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ch05-ex01-count&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token function&quot;&gt;id&lt;/span&gt;            &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;alice&quot;&lt;/span&gt;
        name          &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;alice&quot;&lt;/span&gt;
      + tags          &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# (5 unchanged attributes hidden)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;# aws_iam_user.ch05-ex01-count[1] has changed&lt;/span&gt;
  ~ resource &lt;span class=&quot;token string&quot;&gt;&quot;aws_iam_user&quot;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ch05-ex01-count&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token function&quot;&gt;id&lt;/span&gt;            &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;bob&quot;&lt;/span&gt;
        name          &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;bob&quot;&lt;/span&gt;
      + tags          &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# (5 unchanged attributes hidden)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;# aws_iam_user.ch05-ex01-count[2] has changed&lt;/span&gt;
  ~ resource &lt;span class=&quot;token string&quot;&gt;&quot;aws_iam_user&quot;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ch05-ex01-count&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token function&quot;&gt;id&lt;/span&gt;            &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;charlie&quot;&lt;/span&gt;
        name          &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;charlie&quot;&lt;/span&gt;
      + tags          &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# (5 unchanged attributes hidden)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;


&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;plan 경고문은 생략. 현재 테라폼 코드로는 이런 식으로 프로비저닝 될 것이다 하는 내용이 써져있습니다.&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

Terraform will perform the following actions:

  &lt;span class=&quot;token comment&quot;&gt;# aws_iam_user.ch05-ex01-count[1] will be updated in-place&lt;/span&gt;
  ~ resource &lt;span class=&quot;token string&quot;&gt;&quot;aws_iam_user&quot;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ch05-ex01-count&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token function&quot;&gt;id&lt;/span&gt;            &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;bob&quot;&lt;/span&gt;
      ~ name          &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;bob&quot;&lt;/span&gt; -&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;charlie&quot;&lt;/span&gt;
        tags          &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# (5 unchanged attributes hidden)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;# aws_iam_user.ch05-ex01-count[2] will be destroyed&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# (because index [2] is out of range for count)&lt;/span&gt;
  - resource &lt;span class=&quot;token string&quot;&gt;&quot;aws_iam_user&quot;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ch05-ex01-count&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      - arn           &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;arn:aws:iam::240962124292:user/charlie&quot;&lt;/span&gt; -&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; null
      - force_destroy &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt; -&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; null
      - &lt;span class=&quot;token function&quot;&gt;id&lt;/span&gt;            &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;charlie&quot;&lt;/span&gt; -&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; null
      - name          &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;charlie&quot;&lt;/span&gt; -&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; null
      - path          &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;/&quot;&lt;/span&gt; -&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; null
      - tags          &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; -&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; null
      - tags_all      &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; -&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; null
      - unique_id     &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;AIDATQGTWHICFTYJYIOOQ&quot;&lt;/span&gt; -&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; null
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

Plan: &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; to add, &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; to change, &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; to destroy.

Changes to Outputs:
  ~ all_arns &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# (1 unchanged element hidden)&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;arn:aws:iam::240962124292:user/bob&quot;&lt;/span&gt;,
      - &lt;span class=&quot;token string&quot;&gt;&quot;arn:aws:iam::240962124292:user/charlie&quot;&lt;/span&gt;,
    &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;count&lt;/code&gt; 사용 시 목록 중간 항목을 제거하면 테라폼은 해당 항목 뒤에 있는 &lt;strong&gt;모든 리소스를 삭제&lt;/strong&gt;한 다음 해당 리소스를 처음부터 다시 만듭니다… 😱😱&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;for_each-표현식&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#for_each-%ED%91%9C%ED%98%84%EC%8B%9D&quot; aria-label=&quot;for_each 표현식 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;for_each&lt;/code&gt; 표현식&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;for_each&lt;/code&gt; 표현식을 이용한 반복문을 사용해봅시다. 먼저 &lt;code class=&quot;language-text&quot;&gt;for_each&lt;/code&gt; 표현식에 대해 알아봅시다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;for_each&lt;/code&gt; 구문은 테라폼 문법에 정의된 &lt;code class=&quot;language-text&quot;&gt;meta-argument &lt;/code&gt; 입니다. 모듈, 모든 리소스 타입에 응용될 수 있습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;list&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;set&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;map&lt;/code&gt;을 사용하여 전체 리소스의 복사본, 리소스 내 인라인 블록의 복사본, 모듈의 복사본을 만들 수 있습니다. 문법은 아래와 같습니다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;resource &lt;span class=&quot;token string&quot;&gt;&quot;&amp;lt;PROVIDER&gt;_&amp;lt;TYPE&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&amp;lt;NAME&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;for_each&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &amp;lt;COLLECTION&gt;

  &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;CONFIG ...&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;COLLECTION: 루프를 처리할 set, map 을 의미&lt;/li&gt;
&lt;li&gt;CONFIG: 리소스와 관련된 하나이상의 인수
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;each.key&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;each.value&lt;/code&gt; 로 키/밸류에 접근할 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;for_each-표현식을-이용한-예시-1&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#for_each-%ED%91%9C%ED%98%84%EC%8B%9D%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%98%88%EC%8B%9C-1&quot; aria-label=&quot;for_each 표현식을 이용한 예시 1 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;for_each&lt;/code&gt; 표현식을 이용한 예시 (1)&lt;/h4&gt;
&lt;p&gt;전체 예시코드는 &lt;code class=&quot;language-text&quot;&gt;chapter05/example01/for_each&lt;/code&gt; 디렉토리를 살펴봐주세요.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;iam.tf&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;provider&lt;span class=&quot;token type variable&quot;&gt; &quot;aws&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;region&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ap-northeast-2&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;resource &lt;span class=&quot;token type variable&quot;&gt;&quot;aws_iam_user&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ch05-foreach&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;for_each&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; toset(var.user_names)
  &lt;span class=&quot;token property&quot;&gt;name&lt;/span&gt;     &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; each.value
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;variables.tf&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;variable&lt;span class=&quot;token type variable&quot;&gt; &quot;user_names&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;description&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Create IAM users with these names&quot;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;type&lt;/span&gt;        &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; list(string)
  &lt;span class=&quot;token property&quot;&gt;default&lt;/span&gt;     &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;alice&quot;&lt;/span&gt;, &lt;span class=&quot;token string&quot;&gt;&quot;bob&quot;&lt;/span&gt;, &lt;span class=&quot;token string&quot;&gt;&quot;charlie&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;outputs.tf&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;output&lt;span class=&quot;token type variable&quot;&gt; &quot;all_users&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; aws_iam_user.ch05-foreach
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;terraform init &amp;amp;&amp;amp; terraform apply -auto-approve&lt;/code&gt; 를 통해, output에 나오는 &lt;code class=&quot;language-text&quot;&gt;for_each&lt;/code&gt; 는 어떤식인지 살펴봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ terraform init

&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

$ terraform apply -auto-approve

Terraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  &lt;span class=&quot;token comment&quot;&gt;# aws_iam_user.ch05-foreach[&quot;alice&quot;] will be created&lt;/span&gt;
  + resource &lt;span class=&quot;token string&quot;&gt;&quot;aws_iam_user&quot;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ch05-foreach&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      + name          &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;alice&quot;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;# aws_iam_user.ch05-foreach[&quot;bob&quot;] will be created&lt;/span&gt;
  + resource &lt;span class=&quot;token string&quot;&gt;&quot;aws_iam_user&quot;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ch05-foreach&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      + name          &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;bob&quot;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;# aws_iam_user.ch05-foreach[&quot;charlie&quot;] will be created&lt;/span&gt;
  + resource &lt;span class=&quot;token string&quot;&gt;&quot;aws_iam_user&quot;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ch05-foreach&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      + name          &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;charlie&quot;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

Plan: &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; to add, &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; to change, &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; to destroy.

Changes to Outputs:
  + all_users &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      + alice   &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
          + name                 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;alice&quot;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
      + bob     &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
          + name                 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;bob&quot;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
      + charlie &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
          + name                 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;charlie&quot;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

Apply complete&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt; Resources: &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; added, &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; changed, &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; destroyed.

Outputs:

all_users &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token string&quot;&gt;&quot;alice&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;arn&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;arn:aws:iam::REDACTED:user/alice&quot;&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;force_destroy&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;id&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;alice&quot;&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;name&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;alice&quot;&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;path&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;/&quot;&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;permissions_boundary&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; tostring&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;null&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;tags&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; tomap&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;null&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; /* of string */
    &lt;span class=&quot;token string&quot;&gt;&quot;tags_all&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; tomap&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;unique_id&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;REDACTED&quot;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token string&quot;&gt;&quot;bob&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;arn&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;arn:aws:iam::REDACTED:user/bob&quot;&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;force_destroy&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;id&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;bob&quot;&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;name&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;bob&quot;&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;path&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;/&quot;&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;permissions_boundary&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; tostring&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;null&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;tags&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; tomap&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;null&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; /* of string */
    &lt;span class=&quot;token string&quot;&gt;&quot;tags_all&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; tomap&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;unique_id&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;REDACTED&quot;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token string&quot;&gt;&quot;charlie&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;arn&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;arn:aws:iam::REDACTED:user/charlie&quot;&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;force_destroy&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;id&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;charlie&quot;&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;name&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;charlie&quot;&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;path&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;/&quot;&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;permissions_boundary&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; tostring&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;null&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;tags&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; tomap&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;null&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; /* of string */
    &lt;span class=&quot;token string&quot;&gt;&quot;tags_all&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; tomap&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;unique_id&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;REDACTED&quot;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;all_users&lt;/code&gt; 출력 변수가 &lt;code class=&quot;language-text&quot;&gt;for_each&lt;/code&gt; 의 키, 즉 사용자 이름을 키로 가지며 값이 해당 리소스의 전체 출력인 맵을 포함합니다.&lt;/p&gt;
&lt;h4 id=&quot;for_each-표현식을-이용한-예시-2-인라인-블록&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#for_each-%ED%91%9C%ED%98%84%EC%8B%9D%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%98%88%EC%8B%9C-2-%EC%9D%B8%EB%9D%BC%EC%9D%B8-%EB%B8%94%EB%A1%9D&quot; aria-label=&quot;for_each 표현식을 이용한 예시 2 인라인 블록 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;for_each 표현식을 이용한 예시 (2): 인라인 블록&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://developer.hashicorp.com/terraform/tutorials/configuration-language/for-each&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;해당 링크&lt;/a&gt;의 예시를 참조하였습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;for-표현식&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#for-%ED%91%9C%ED%98%84%EC%8B%9D&quot; aria-label=&quot;for 표현식 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;for&lt;/code&gt; 표현식&lt;/h3&gt;
&lt;p&gt;복잡한 타입을 또다른 복잡한 타입으로 변환하는데 쓰입니다. &lt;code class=&quot;language-text&quot;&gt;for&lt;/code&gt; 표현식은 아래와 같이 사용합니다. (&lt;a href=&quot;https://developer.hashicorp.com/terraform/language/expressions/for&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;공식링크&lt;/a&gt;)&lt;/p&gt;
&lt;h4 id=&quot;for-표현식을-이용한-예시-1-컨테이너에-값을-추가하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#for-%ED%91%9C%ED%98%84%EC%8B%9D%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%98%88%EC%8B%9C-1-%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88%EC%97%90-%EA%B0%92%EC%9D%84-%EC%B6%94%EA%B0%80%ED%95%98%EA%B8%B0&quot; aria-label=&quot;for 표현식을 이용한 예시 1 컨테이너에 값을 추가하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;for&lt;/code&gt; 표현식을 이용한 예시 (1): 컨테이너에 값을 추가하기&lt;/h4&gt;
&lt;p&gt;list 내의 모든 이름을 대문자로 변환하는 예제를 통해 알아봅시다. 사용은 아래와 같이 할 수 있습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# 결과를 list 형식으로 리턴합니다.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;for &amp;lt;ITEM&gt; in &amp;lt;LIST&gt; : &amp;lt;OUTPUT&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;for &amp;lt;ITEM&gt; in &amp;lt;LIST&gt; : &amp;lt;OUTPUT&gt; if &amp;lt;EXPRESSION&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# 조건문 절에서 다시 살펴봅시다!&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 결과를 map 형식으로 리턴합니다.&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;for &amp;lt;ITEM&gt; in &amp;lt;LIST&gt; : &amp;lt;OUTPUT_KEY&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&gt; &amp;lt;OUTPUT_VALUE&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;for &amp;lt;ITEM&gt; in &amp;lt;LIST&gt; : &amp;lt;OUTPUT_KEY&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&gt; &amp;lt;OUTPUT_VALUE&gt; if &amp;lt;EXPRESSION&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# 조건문 절에서 다시 살펴봅시다!&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;LIST: 반복할 리스트&lt;/li&gt;
&lt;li&gt;ITEM: LIST의 각 항목에 할당할 변수의 이름&lt;/li&gt;
&lt;li&gt;OUTPUT: ITEM을 변환한 표현식&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;if&lt;/code&gt; 구문(optional): 조건(&lt;code class=&quot;language-text&quot;&gt;&amp;lt;EXPRESSION&gt;&lt;/code&gt;)에 맞으면 값을 추가&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;variable&lt;span class=&quot;token type variable&quot;&gt; &quot;names&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;description&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;A list of names&quot;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;type&lt;/span&gt;        &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; list(string)
  &lt;span class=&quot;token property&quot;&gt;default&lt;/span&gt;     &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;alice&quot;&lt;/span&gt;, &lt;span class=&quot;token string&quot;&gt;&quot;bob&quot;&lt;/span&gt;, &lt;span class=&quot;token string&quot;&gt;&quot;charlie&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;output&lt;span class=&quot;token type variable&quot;&gt; &quot;upper_names&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# names 안의 값에 대해 반복을 진행하며, 결과로는 upper(이름)의 값이 들어갑니다.&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;for name in var.names : upper(name)&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;output&lt;span class=&quot;token type variable&quot;&gt; &quot;short_upper_names&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# 조건을 기재할 수도 있습니다.&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;for name in var.names : upper(name) if length(name) &amp;lt; &lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;variable&lt;span class=&quot;token type variable&quot;&gt; &quot;prize_level&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;description&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;map&quot;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;type&lt;/span&gt;        &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; map(string)
  &lt;span class=&quot;token property&quot;&gt;default&lt;/span&gt;     &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;alice&lt;/span&gt;     &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;#1&quot;&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;bob&lt;/span&gt;       &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;#2&quot;&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;charlie&lt;/span&gt;   &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;#3&quot;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;output&lt;span class=&quot;token type variable&quot;&gt; &quot;prize_status&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# prize_status의 value는 키, 밸류 쌍을 꺼낸 문자열을 리턴할 수 있습니다.&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;for name, role in var.prize_level : &lt;span class=&quot;token string&quot;&gt;&quot;\&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt; goes to \&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;role&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt; prize&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;output&lt;span class=&quot;token type variable&quot;&gt; &quot;upper_prize_status&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# name, role에 해당하는 map을 리턴할 수도 있습니다.&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;for name, role in var.prize_level : upper(name) &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&gt; upper(role)&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&quot;for-표현식을-이용한-예시-2-문자열로-리턴하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#for-%ED%91%9C%ED%98%84%EC%8B%9D%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%98%88%EC%8B%9C-2-%EB%AC%B8%EC%9E%90%EC%97%B4%EB%A1%9C-%EB%A6%AC%ED%84%B4%ED%95%98%EA%B8%B0&quot; aria-label=&quot;for 표현식을 이용한 예시 2 문자열로 리턴하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;for&lt;/code&gt; 표현식을 이용한 예시 (2): 문자열로 리턴하기&lt;/h4&gt;
&lt;p&gt;앞서서 문자열 내에서 테라폼 코드를 참조하는 보간법 예시는 사용해본 적이 있습니다. &lt;code class=&quot;language-text&quot;&gt;&quot;Hello, ${var.name}!&quot;&lt;/code&gt; 과 같은 방식으로요.&lt;/p&gt;
&lt;p&gt;문자열 지시자를 사용하면, 문자열 보간처럼 &lt;code class=&quot;language-text&quot;&gt;for&lt;/code&gt; 반복문, &lt;code class=&quot;language-text&quot;&gt;if&lt;/code&gt; 제어문에서도 사용할 수 있습니다. 어떻게 사용하는지 살펴봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# 반복문의 기본입니다.&lt;/span&gt;
%&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; for &amp;lt;ITEM&gt; in &amp;lt;COLLECTION&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&amp;lt;BODY&gt;%&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; endfor &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 인덱스를 추가할 수도 있습니다.&lt;/span&gt;
%&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; for &amp;lt;INDEX&gt;, &amp;lt;ITEM&gt; in &amp;lt;COLLECTION&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&amp;lt;BODY&gt;%&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; endfor &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;COLLECTION: 반복할 리스트, 맵. 말 그대로 반복 가능한 컬렉션을 의미합니다.&lt;/li&gt;
&lt;li&gt;ITEM: 각 항목에 할당할 로컬 변수의 이름입니다.&lt;/li&gt;
&lt;li&gt;BODY: ITEM을 참조할 수 있는 각각의 반복을 렌더링하는 대상입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/brikis98/terraform-up-and-running-code/blob/master/code/terraform/05-tips-and-tricks/loops-and-if-statements/live/global/string-directives/main.tf&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;예시&lt;/a&gt;를 보면서 함께 살펴봅시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;variable&lt;span class=&quot;token type variable&quot;&gt; &quot;names&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;description&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;A list of names&quot;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;type&lt;/span&gt;        &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; list(string)
  &lt;span class=&quot;token property&quot;&gt;default&lt;/span&gt;     &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;alice&quot;&lt;/span&gt;, &lt;span class=&quot;token string&quot;&gt;&quot;bob&quot;&lt;/span&gt;, &lt;span class=&quot;token string&quot;&gt;&quot;charlie&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;output&lt;span class=&quot;token type variable&quot;&gt; &quot;for_directive&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# 끝의 endfor directive가 붙는다는 점을 제외하면 쉽게 이해할 수 있을 듯 합니다.&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;%{ for name in var.names }&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;, %{ endfor }&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;output&lt;span class=&quot;token type variable&quot;&gt; &quot;for_directive_index&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# 파이썬의 enumerate() 을 쓰듯 사용할 수도 있군요!&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;%{ for i, name in var.names }(&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;) &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;, %{ endfor }&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;terraform init &amp;amp;&amp;amp; terraform apply&lt;/code&gt;를 수행하면 아래와 같은 결과값을 보실 수 있습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ terraform init &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; terraform apply

&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

Apply complete&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt; Resources: &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; added, &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; changed, &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; destroyed.

Outputs:

for_directive &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;alice, bob, charlie, &quot;&lt;/span&gt;
for_directive_index &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;(0) alice, (1) bob, (2) charlie, &quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id=&quot;lessons-learned&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#lessons-learned&quot; aria-label=&quot;lessons learned permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Lessons Learned&lt;/h1&gt;
&lt;p&gt;제 5장에서는 아래의 내용을 반드시 기억하셨으면 좋겠습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;(중요!) Prerequisite에서, 테라폼의 타입과 값에 대한 내용은 이미 알고있어야 하는 주요한 내용이라고 봅니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;프로그래밍 언어처럼 다루려면, 어떤 타입과 값을 사용할 수 있는지는 기본적으로 알아야 하기 때문입니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;반복문의 사용방법과 주의사항에 대해 배웠습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;조건문의 사용방법과 주의사항에 대해 배웠습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이것으로 제 5장, 반복문 설명을 마칩니다. 긴 글 읽어주셔서 감사합니다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[[CloudNet@] 테라폼 스터디 4주차 - Terraform의 module에 대하여]]></title><description><![CDATA[Terraform의 module 에 대한 소개와, 어떻게 활용하는지, 그리고 주의사항과 모듈 버전관리에 대한 내용을 담았습니다.]]></description><link>https://blog.s3ich4n.me/devlog/terraform/2022-11-10-cloudneta-terraform-101-pt04</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/terraform/2022-11-10-cloudneta-terraform-101-pt04</guid><pubDate>Thu, 10 Nov 2022 04:11:57 GMT</pubDate><content:encoded>&lt;p&gt;이 내용은 CloudNet@ 에서 진행하는 테라폼 기초 입문 스터디에 대한 연재글입니다.&lt;/p&gt;
&lt;p&gt;스터디에서 사용하는 교재는 &lt;a href=&quot;http://www.yes24.com/Product/Goods/101511312&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Terraform Up &amp;#x26; Running 2nd Edition&lt;/a&gt; 입니다.&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id=&quot;prerequisites&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#prerequisites&quot; aria-label=&quot;prerequisites permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Prerequisites&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;학습용 링크를 공유합니다.
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=yWhwZpzJ3no&amp;#x26;t=2504s&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;(당근페이) 박병진님 - 확장 가능한 테라폼 코드 관리를 위한 원칙&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;테라폼의-모듈에-대하여&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%85%8C%EB%9D%BC%ED%8F%BC%EC%9D%98-%EB%AA%A8%EB%93%88%EC%97%90-%EB%8C%80%ED%95%98%EC%97%AC&quot; aria-label=&quot;테라폼의 모듈에 대하여 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;테라폼의 모듈에 대하여&lt;/h1&gt;
&lt;p&gt;테라폼의 모듈이 등장하게 된 배경에 대해 살펴보고, 주의사항은 어떤 것이 있는지 알아봅시다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;모듈은, 둘 이상의 환경에서 코드 재사용, 여러 테라폼 리소스를 하나의 논리적 그룹으로 관리하기 위해 사용합니다.
&lt;ul&gt;
&lt;li&gt;E.g., 스테이징, 프로덕션 환경에서 공통적으로 사용되는 코드를 &lt;code class=&quot;language-text&quot;&gt;modules&lt;/code&gt; 같은 디렉토리에 빼고, 파일경로를 참조하여 사용하는 것이 바로 그 방안입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;테라폼의 모듈은 아래와 같이 분류됩니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Root module&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;모든 Terraform 구성에는 기본 작업 디렉토리 의 파일에 정의된 리소스로 구성된 &lt;em&gt;루트 모듈&lt;/em&gt; 이라고 하는 하나 이상의 모듈 이 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Child module&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Terraform 모듈(일반적으로 구성의 루트 모듈)은 다른 모듈을 &lt;em&gt;호출&lt;/em&gt; 하여 해당 리소스를 구성에 포함할 수 있습니다. 다른 모듈에 의해 호출된 모듈을 종종 &lt;em&gt;자식 모듈이라고 합니다.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;자식 모듈은 동일한 구성 내에서 여러 번 호출할 수 있으며 여러 구성에서 동일한 자식 모듈을 사용할 수 있습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Published module&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;로컬 파일 시스템의 모듈 외에도 Terraform은 공개 또는 비공개 레지스트리에서 모듈을 로드할 수 있습니다. 이렇게 하면 다른 사람이 사용할 수 있도록 모듈을 게시하고 다른 사람이 게시한 모듈을 사용할 수 있습니다.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://registry.terraform.io/browse/modules&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Terraform Registry&lt;/a&gt;에서 가져오거나, Terraform Cloud, Terraform Enterprise 같은 서비스를 사용하여 참조할 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;그렇다면 테라폼 모듈을 가져오는 소스는 어떤 것이 있을까요?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;로컬경로&lt;/li&gt;
&lt;li&gt;Terraform Registry&lt;/li&gt;
&lt;li&gt;GitHub&lt;/li&gt;
&lt;li&gt;Bitbucket&lt;/li&gt;
&lt;li&gt;GCS buckets, S3 buckets&lt;/li&gt;
&lt;li&gt;Terraform Registry
&lt;ul&gt;
&lt;li&gt;하시코프에서 공식적으로 운영하는 테라폼 프로바이더 및 모듈 저장소, 공개된 모듈을 쉽게 활용 가능합니다.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/terraform-aws-modules&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;[Github] terraform-aws-modules&lt;/a&gt; : 하시코프 ambassador 중 한 명인 Anton Babenko 가 리드, 가장 인기 있는 AWS 테라폼 모듈을 관리하는 Github 조직입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;모듈-기본&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AA%A8%EB%93%88-%EA%B8%B0%EB%B3%B8&quot; aria-label=&quot;모듈 기본 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;모듈 기본&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;폴더에 있는 모든 테라폼 구성파일은 모듈입니다.&lt;/li&gt;
&lt;li&gt;현재 작업 디렉토리의 모듈은 루트 모듈이라고 부릅니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;모듈을 사용하기 위한 구문은 아래와 같습니다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;span class=&quot;token type variable&quot;&gt; &quot;&amp;lt;NAME&gt;&quot; &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;source&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&amp;lt;SOURCE&gt;&quot;&lt;/span&gt;

  &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;CONFIG ...&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;NAME&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;테라폼 코드 전체에서 참조하기 위해 사용하는 &lt;strong&gt;식별자&lt;/strong&gt;입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;SOURCE&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;modules/services/webserver-cluster&lt;/code&gt; 와 같은 모듈 코드를 찾을 수 있는 &lt;strong&gt;경로&lt;/strong&gt;입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;CONFIG&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;그 모듈과 관련된 특정한 하나 이상의 인수로 구성됩니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;모듈을 적용하거나 source 파라미터를 수정하는 경우 반드시 &lt;code class=&quot;language-text&quot;&gt;terrraform init&lt;/code&gt; 명령 실행이 필요합니다.&lt;/p&gt;
&lt;p&gt;다시말해 &lt;code class=&quot;language-text&quot;&gt;init&lt;/code&gt; 명령어 하나로 손쉽게 프로바이더와 모듈을 다운로드하고 백엔드를 구성할 수 있습니다.&lt;/p&gt;
&lt;h2 id=&quot;모듈의-입력값&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AA%A8%EB%93%88%EC%9D%98-%EC%9E%85%EB%A0%A5%EA%B0%92&quot; aria-label=&quot;모듈의 입력값 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;모듈의 입력값&lt;/h2&gt;
&lt;h2 id=&quot;모듈과-지역변수&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AA%A8%EB%93%88%EA%B3%BC-%EC%A7%80%EC%97%AD%EB%B3%80%EC%88%98&quot; aria-label=&quot;모듈과 지역변수 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;모듈과 지역변수&lt;/h2&gt;
&lt;h2 id=&quot;모듈과-출력&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AA%A8%EB%93%88%EA%B3%BC-%EC%B6%9C%EB%A0%A5&quot; aria-label=&quot;모듈과 출력 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;모듈과 출력&lt;/h2&gt;
&lt;h2 id=&quot;모듈-사용-시-주의사항&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AA%A8%EB%93%88-%EC%82%AC%EC%9A%A9-%EC%8B%9C-%EC%A3%BC%EC%9D%98%EC%82%AC%ED%95%AD&quot; aria-label=&quot;모듈 사용 시 주의사항 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;모듈 사용 시 주의사항&lt;/h2&gt;
&lt;p&gt;모듈을 사용할 때, 아래의 주의사항에 대해 참고해주세요.&lt;/p&gt;
&lt;h3 id=&quot;파일-경로-file-paths-인라인-블록-inline-blocks에-대하여&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%8C%8C%EC%9D%BC-%EA%B2%BD%EB%A1%9C-file-paths-%EC%9D%B8%EB%9D%BC%EC%9D%B8-%EB%B8%94%EB%A1%9D-inline-blocks%EC%97%90-%EB%8C%80%ED%95%98%EC%97%AC&quot; aria-label=&quot;파일 경로 file paths 인라인 블록 inline blocks에 대하여 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;파일 경로 File paths, 인라인 블록 Inline blocks에 대하여&lt;/h3&gt;
&lt;p&gt;파일 경로(File paths)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;루트 모듈에서 file 함수 사용은 가능하지만, 별도의 폴더에 정의된 모듈에서 file 함수를 사용하기 위해서 경로 참조 path reference 표현식이 필요합니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;path.module&lt;/code&gt; : 표현식이 정의된 모듈의 파일 시스템 경로를 반환&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;path.root&lt;/code&gt; : 루트 모듈의 파일 시스템 경로를 반환&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;path.cwd&lt;/code&gt; : 현재 작업 중인 디렉터리의 파일 시스템 경로를 반환&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;사용자 데이터 스크립트의 경우 모듈 자체에 상대 경로가 필요하므로 &lt;code class=&quot;language-text&quot;&gt;modules/services/webserver-cluster/main.tf&lt;/code&gt; 의 &lt;code class=&quot;language-text&quot;&gt;templatefile&lt;/code&gt; 데이터소스에서 &lt;code class=&quot;language-text&quot;&gt;path.module&lt;/code&gt; 사용&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;인라인 블록(Inline blocks)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;일부 테라폼 리소스는 인라인 블록 또는 별도의 리소스(권장)로 정의 할 수 있습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;다만 인라인 블록으로 규칙을 정의한 경우에는 코드가 작동하지 &lt;strong&gt;않습니다!&lt;/strong&gt;. 아래와 같은 유사한 리소스를 사용하면 그런 문제가 발생할 수 있습니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;aws_security_group&lt;/code&gt; 과 &lt;code class=&quot;language-text&quot;&gt;aws_security_group_rule&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;aws_route_table&lt;/code&gt; 과 &lt;code class=&quot;language-text&quot;&gt;aws_route&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;aws_network_acl&lt;/code&gt; 과 &lt;code class=&quot;language-text&quot;&gt;aws_network_acl_rule&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;등등…&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;(스터디 중 논의) 이런 값들은 일일이 코드로 작성하는 편이 좀 더 변화에 유연하다고 하는 지적이 있었습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;모듈-버전관리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AA%A8%EB%93%88-%EB%B2%84%EC%A0%84%EA%B4%80%EB%A6%AC&quot; aria-label=&quot;모듈 버전관리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;모듈 버전관리&lt;/h2&gt;
&lt;p&gt;모듈에 대한 버전관리를 통해, 특정 환경(스테이징, 프로덕션 등)별로 보다 세부적인 관리를 진행하는 방안에 대해 소개합니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;여러 Repository를 통해 관리하는 전략을 소개하고자 합니다.
&lt;ul&gt;
&lt;li&gt;테라폼 모듈로 분리하고자 하는 로직은 별도의 Git repository를 생성하고, Git의 tag 기능을 활용하여 버저닝을 수행합니다.&lt;/li&gt;
&lt;li&gt;인프라를 관리하는 Git Repository에서는 아래 방안을 사용합니다.
&lt;ul&gt;
&lt;li&gt;상기 테라폼 모듈 로직에 대해 submodule로 추가하고, 스테이징/프로덕션에 대하여 tag에 기재한 버전을 사용합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;lessons-learned&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#lessons-learned&quot; aria-label=&quot;lessons learned permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Lessons Learned&lt;/h1&gt;
&lt;p&gt;제 4장에서는 아래의 내용을 반드시 기억하셨으면 좋겠습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;테라폼의 모듈 사용으로 인해, 코드 재사용과 여러 테라폼 리소스에 대한 논리적 관리를 꾀할 수 있습니다.&lt;/li&gt;
&lt;li&gt;모듈 사용법을 읽고, 반복되는 내용을 어떻게 효과적으로 제어하는지 알아볼 수 있습니다.&lt;/li&gt;
&lt;li&gt;특히 주요 주의사항과 모듈 버전관리 전략에 대해 읽고, 모듈 사용시 의도치 않은 실수를 하지 않도록 대비할 수 있습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이것으로 제 4장을 마칩니다. 긴 글 읽어주셔서 감사합니다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[[CloudNet@] 테라폼 스터디 3주차 - Terraform 상태 격리방안]]></title><description><![CDATA[Terraform 의 상태값에 대한 격리 방안에 대한 내용을 담고있습니다. 아울러 속성값 참고와 내장 함수에 대한 설명을 함께 추가하였습니다.]]></description><link>https://blog.s3ich4n.me/devlog/terraform/2022-11-03-cloudneta-terraform-101-pt03</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/terraform/2022-11-03-cloudneta-terraform-101-pt03</guid><pubDate>Thu, 03 Nov 2022 21:09:10 GMT</pubDate><content:encoded>&lt;p&gt;이 내용은 CloudNet@ 에서 진행하는 테라폼 기초 입문 스터디에 대한 연재글입니다.&lt;/p&gt;
&lt;p&gt;스터디에서 사용하는 교재는 Terraform Up &amp;#x26; Running 2nd Edition 입니다.&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id=&quot;prerequisites&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#prerequisites&quot; aria-label=&quot;prerequisites permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Prerequisites&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.aws.amazon.com/ko_kr/AmazonS3/latest/userguide/Welcome.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;AWS S3&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;오브젝트를 버킷 단위로 저장하는 클라우드 스토리지&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;AWS DynamoDB
&lt;ul&gt;
&lt;li&gt;AWS에서 제공하는 NoSQL 데이터베이스 서버&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;(스포!) 원격지에 테라폼의 “상태”를 기록하기 위해 사용합니다!&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;아래에서 3주차 스터디 내용을 공유합니다.&lt;/p&gt;
&lt;p&gt;교재의 3장을 다룹니다.&lt;/p&gt;
&lt;h1 id=&quot;들어가며&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0&quot; aria-label=&quot;들어가며 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;들어가며…&lt;/h1&gt;
&lt;p&gt;테라폼의 상태 관리에 대해 정리하고자 합니다. 왜 상태관리를 해야하는지, 어떤방안이 있으며 어떤식으로 작성하면 좋은지 작성합니다.&lt;/p&gt;
&lt;h2 id=&quot;테라폼-상태관리의-필요성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%85%8C%EB%9D%BC%ED%8F%BC-%EC%83%81%ED%83%9C%EA%B4%80%EB%A6%AC%EC%9D%98-%ED%95%84%EC%9A%94%EC%84%B1&quot; aria-label=&quot;테라폼 상태관리의 필요성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;테라폼 상태관리의 필요성&lt;/h2&gt;
&lt;p&gt;테라폼은 기본적으로 생성한 인프라에 대한 정보를 상태파일에 기록합니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;terraform.tfstate&lt;/code&gt; 파일로 기록됩니다.&lt;/li&gt;
&lt;li&gt;상태 파일은 프라이빗 API 임에 유의합니다!
&lt;ul&gt;
&lt;li&gt;배포할 때 마다 테라폼이 알아서 작성하는 파일입니다. &lt;strong&gt;임의로 건들여서는 안됩니다&lt;/strong&gt;!&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;본격적으로 테라폼을 도입하고, 코드를 작성/배포하다 보면 자연스럽게 여러 사람들이 작업하겠지요. 그렇다면 자연스레 아래와 같은 요구사항이 발생할 수 있습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;상태파일 저장을 위한 &lt;em&gt;“공유 스토리지”&lt;/em&gt; 사용 필요&lt;/li&gt;
&lt;li&gt;상태파일 잠금(Locking)이 필요
&lt;ul&gt;
&lt;li&gt;한번에 한 명령만 실행; 경쟁 상태(&lt;em&gt;race condition&lt;/em&gt;) 방지 필요&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;상태파일을 격리가 필요
&lt;ul&gt;
&lt;li&gt;개발환경, 테스트환경, 스테이징 환경, 프로덕션 환경 등이 잘 분리되어있어야 함&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;테라폼-상태-공유-방법&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%85%8C%EB%9D%BC%ED%8F%BC-%EC%83%81%ED%83%9C-%EA%B3%B5%EC%9C%A0-%EB%B0%A9%EB%B2%95&quot; aria-label=&quot;테라폼 상태 공유 방법 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;테라폼 상태 공유 방법&lt;/h2&gt;
&lt;p&gt;운영, 프로덕션 레벨에서 팀 단위로 인프라 구성 코드를 공유하는 방법은 여러가지가 있습니다.&lt;/p&gt;
&lt;h3 id=&quot;git-등의-vcs를-이용하면&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#git-%EB%93%B1%EC%9D%98-vcs%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%98%EB%A9%B4&quot; aria-label=&quot;git 등의 vcs를 이용하면 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Git 등의 VCS를 이용하면?&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;push/pull 시 실수로 파일을 빼먹거나 해서 문제가 발생할 수 있습니다.
&lt;ul&gt;
&lt;li&gt;버그를 잡은 코드가 다시 들어가거나&lt;/li&gt;
&lt;li&gt;그로인해 인프라가 복제되거나, 사라지거나… :scream:&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;락을 걸 수 없음(&lt;code class=&quot;language-text&quot;&gt;terraform apply&lt;/code&gt; 에 대한 락을 의미)
&lt;ul&gt;
&lt;li&gt;한번 한 명령만 실행할 수 없습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;시크릿 파일 관리가 곤란함
&lt;ul&gt;
&lt;li&gt;테라폼의 모든 데이터는 평문으로 쓰임&lt;/li&gt;
&lt;li&gt;주요 기밀정보가 &lt;strong&gt;평문으로 기록&lt;/strong&gt;됩니다! :scream:&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이런 문제를 해결하기 위해선, 원격 백엔드를 사용합니다. 1장에서 배운 “backend”의 저장공간을 원격 저장소로 설정하는 것을 의미합니다.&lt;/p&gt;
&lt;h3 id=&quot;테라폼의-원격-백엔드-를-사용하면&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%85%8C%EB%9D%BC%ED%8F%BC%EC%9D%98-%EC%9B%90%EA%B2%A9-%EB%B0%B1%EC%97%94%EB%93%9C-%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EB%A9%B4&quot; aria-label=&quot;테라폼의 원격 백엔드 를 사용하면 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;테라폼의 원격 백엔드 를 사용하면?&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;.tfstate&lt;/code&gt; 파일을 원격지에 두고 관리할 수 있습니다.
&lt;ul&gt;
&lt;li&gt;AWS S3
&lt;ul&gt;
&lt;li&gt;GCP 클라우드 스토리지&lt;/li&gt;
&lt;li&gt;Azure storage&lt;/li&gt;
&lt;li&gt;HashiCorp 사의
&lt;ul&gt;
&lt;li&gt;Terraform Cloud (비싸고 좋고 추천받음)&lt;/li&gt;
&lt;li&gt;Terraform Pro&lt;/li&gt;
&lt;li&gt;Terraform Enterprise&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;etc.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;본 교재에서는 AWS S3와 DynamoDB의 결합을 이용하여 소개합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;테라폼-상태-관리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%85%8C%EB%9D%BC%ED%8F%BC-%EC%83%81%ED%83%9C-%EA%B4%80%EB%A6%AC&quot; aria-label=&quot;테라폼 상태 관리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;테라폼 상태 관리&lt;/h1&gt;
&lt;p&gt;그렇다면, 원격 백엔드를 활용한 상태관리를 살펴봅시다.&lt;/p&gt;
&lt;p&gt;제 3장의 예시를 보면 dev, staging 환경을 S3, DynamoDB로 분리하긴 했지만, 상태파일 자체가 단일인 상황은 막을 수 없습니다. 따라서, 책에서는 상태 격리에 대해서는 두가지 접근법을 함께 사용하기를 제안합니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;테라폼의 &lt;code class=&quot;language-text&quot;&gt;Workspace&lt;/code&gt; (이하 워크스페이스) 라는 개념&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;복수개의/분리된/이름이 지정된 워크스페이스를 사용하여 상태파일을 격리합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;분리된 파일 레이아웃 지정&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;개발환경, 스테이징 환경, 실제 프로덕션 환경(!)에 대한 분리를 통해 실수를 방지할 수 있습니다.&lt;/li&gt;
&lt;li&gt;디렉토리 구조를 통한 분리를 의미합니다.
&lt;ul&gt;
&lt;li&gt;[예습!] 이는 모듈화 및 테라폼 내의 &lt;code class=&quot;language-text&quot;&gt;function&lt;/code&gt; 기능과도 밀접한 영향을 가집니다. 필요한 사항에 대해서는 프로그램을 작성하거나 모듈화를 잘 하여 반복되는 코드를 없애자는 것이 주요 골자죠.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;상태관리-1-workspace-설정&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%83%81%ED%83%9C%EA%B4%80%EB%A6%AC-1-workspace-%EC%84%A4%EC%A0%95&quot; aria-label=&quot;상태관리 1 workspace 설정 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;상태관리 (1): Workspace 설정&lt;/h2&gt;
&lt;p&gt;그렇다면, 상태관리를 가능하게 하는 방법 중 하나인 &lt;code class=&quot;language-text&quot;&gt;Workspace&lt;/code&gt;를 알아봅시다.&lt;/p&gt;
&lt;p&gt;테라폼은 기본적으로 &lt;code class=&quot;language-text&quot;&gt;default&lt;/code&gt; 라는 워크스페이스를 사용합니다. 새 작업공간을 만들기 위해서는 &lt;code class=&quot;language-text&quot;&gt;terraform workspace&lt;/code&gt; 커맨드를 사용합니다.&lt;/p&gt;
&lt;p&gt;그렇다면 워크스페이스를 변경하는 것은 어떤 의미를 가질까요?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;다른 작업 공간으로 전환&lt;/strong&gt;하는 것은 &lt;strong&gt;상태 파일이 저장된 경로를 변경&lt;/strong&gt;하는 것과 같습니다.&lt;/li&gt;
&lt;li&gt;작업 공간은 코드 리팩토링을 시도하는 것 같이 이미 &lt;strong&gt;배포되어 있는 인프라에 영향을 주지 않고 테라폼 모듈을 테스트&lt;/strong&gt; 할 때 유용합니다.&lt;/li&gt;
&lt;li&gt;다시말해, 새로운 작업 공간을 생성하여 완전히 &lt;strong&gt;동일한 인프라의 복사본을 배포&lt;/strong&gt;할 수 있지만 상태 정보는 별도의 파일에 저장합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;상술하였듯, 워크스페이스 지정&lt;strong&gt;만&lt;/strong&gt;으로는 문제를 해결할 수 없습니다. 후술할 파일 레이아웃을 함께 지정하여 작업하는 것이 권장됩니다. 어떤 이유로 인해 워크스페이스 만을 사용할 수 없는지 아래에서 설명하겠습니다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;먼저, 모든 작업 공간의 상태 파일은 동일한 백엔드(예. 동일한 S3 버킷)에 저장합니다. 모든 작업 공간이 동일한 인증과 접근 통제를 사용합니다.
&lt;ul&gt;
&lt;li&gt;E.g., 테스트 환경과 프로덕션 환경이 다른 백엔드를 사용하는 경우, 백엔드에 다른 보안 수준의 통제 설정을 수행하는 것은 불가능합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;코드나 터미널에 현재 작업 공간에 대한 정보가 표시 되지 않습니다. 코드 탐색 시 한 작업 공간에 배치된 모듈은 다른 모든 작업 공간에 배치된 모듈과 동일합니다.
&lt;ul&gt;
&lt;li&gt;이로 인해 인프라를 제대로 파악하기 어려워 유지 관리가 어렵게 됩니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;위 두 항목의 결합된 문제가 발생 할 수 있음. 예를 들면 테스트 환경이 아닌 프로덕션 환경에서 &lt;code class=&quot;language-text&quot;&gt;terraform destroy&lt;/code&gt; &lt;strong&gt;명령을 실행&lt;/strong&gt; 할 수 있습니다… :scream_cat:
&lt;ul&gt;
&lt;li&gt;검증과 운영 환경이 동일한 인증 매커니즘을 사용하기 때문에 위 오류에서 보호할 방법이 없습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;따라서 &lt;strong&gt;파일 레이아웃&lt;/strong&gt;을 이용한 격리를 함께 사용할 것을 권장합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;상태관리-2-파일-레이아웃을-이용한-구성파일-격리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%83%81%ED%83%9C%EA%B4%80%EB%A6%AC-2-%ED%8C%8C%EC%9D%BC-%EB%A0%88%EC%9D%B4%EC%95%84%EC%9B%83%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EA%B5%AC%EC%84%B1%ED%8C%8C%EC%9D%BC-%EA%B2%A9%EB%A6%AC&quot; aria-label=&quot;상태관리 2 파일 레이아웃을 이용한 구성파일 격리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;상태관리 (2): 파일 레이아웃을 이용한 구성파일 격리&lt;/h2&gt;
&lt;p&gt;상태관리 방법 중 또다른 하나는 파일 레이아웃을 잡는 것입니다. 핵심은 아래와 같습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;테라폼 프로젝트를 생성하고, 파일레이아웃을 잡습니다.
&lt;ul&gt;
&lt;li&gt;각 구성파일을 분리된 폴더에 넣습니다(E.g., staging, production, etc.).&lt;/li&gt;
&lt;li&gt;필요에 따라 디렉토리 별로에 서로 다른 백엔드 환경을 구성합니다(E.g., S3 버킷 백엔드의 AWS 계정분리).&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;예시를 위해, 아래와 같은 구조를 가진다고 하죠.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;.
├── global
│   └── s3
│       ├── main.tf
│       └── outputs.tf
├── mgmt
│   ├── services
│   └── vpc
├── prod
│   ├── services
│   └── vpc
└── stage
    ├── data-stores
    │   └── mysql
    │       ├── main-vpgsg.tf
    │       ├── main.tf
    │       ├── outputs.tf
    │       ├── terraform.tfstate
    │       └── variables.tf
    └── services
        └── webserver-cluster
            ├── main.tf
            └── user-data.sh&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;최상위 폴더&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;stage&lt;/strong&gt; : 테스트 환경과 같은 사전 프로덕션 워크로드 workload 환경&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;prod&lt;/strong&gt; : 사용자용 맵 같은 프로덕션 워크로드 환경&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;mgmt&lt;/strong&gt; : 베스천 호스트(Bastion Host), 젠킨스(Jenkins) 와 같은 데브옵스 도구 환경&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;global&lt;/strong&gt; : S3, IAM과 같이 모든 환경에서 사용되는 리소스를 배치&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;각 환경별 구성 요소&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;vpc&lt;/strong&gt; : 해당 환경을 위한 네트워크 토폴로지&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;services&lt;/strong&gt; : 해당 환경에서 서비스되는 애플리케이션, 각 앱은 자체 폴더에 위치하여 다른 앱과 분리&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;data-storage&lt;/strong&gt; : 해당 환경 별 데이터 저장소. 각 데이터 저장소 역시 자체 폴더에 위치하여 다른 데이터 저장소와 분리&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;명명 규칙 naming conventions (예시)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;variables.tf&lt;/strong&gt; : 입력 변수&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;outputs.tf&lt;/strong&gt; : 출력 변수&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;main-xxx.tf&lt;/strong&gt; : 리소스 → 개별 테라폼 파일 규모가 커지면 특정 기능을 기준으로 &lt;strong&gt;별도 파일&lt;/strong&gt;로 분리
&lt;ul&gt;
&lt;li&gt;E.g., main-iam.tf, main-s3.tf 등&lt;/li&gt;
&lt;li&gt;후에 배울 &lt;strong&gt;모듈&lt;/strong&gt; 단위로 나눌 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;dependencies.tf&lt;/strong&gt; : 데이터 소스&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;providers.tf&lt;/strong&gt; : 공급자&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;상태관리-예제-1&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%83%81%ED%83%9C%EA%B4%80%EB%A6%AC-%EC%98%88%EC%A0%9C-1&quot; aria-label=&quot;상태관리 예제 1 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;상태관리 예제 (1)&lt;/h1&gt;
&lt;p&gt;이 문단에서는 ELB, ASG, 그리고 RDS가 구축된 환경을 만들고, 이에 대해 디렉토리 구조를 아래와 같이 작성하여 실습하도록 하겠습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;├── global
│   └── s3
│       ├── main.tf
│       └── outputs.tf
└── stage
    ├── data-stores
    │   └── mysql
    │       ├── main-vpgsg.tf
    │       ├── main.tf
    │       ├── outputs.tf
    │       └── variables.tf
    └── services
        └── webserver-cluster
            ├── main.tf
            └── user-data.sh&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;코드의 위치는 아래와 같습니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/s3ich4n/terraform-study-101/tree/main/chapter03/example03-file-layout&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://github.com/s3ich4n/terraform-study-101/tree/main/chapter03/example03-file-layout&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;rds-생성-도중-배울-요소&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#rds-%EC%83%9D%EC%84%B1-%EB%8F%84%EC%A4%91-%EB%B0%B0%EC%9A%B8-%EC%9A%94%EC%86%8C&quot; aria-label=&quot;rds 생성 도중 배울 요소 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;RDS 생성 도중 배울 요소&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;리소스에 전달해야 되는 매개변수 중 &lt;strong&gt;패스워드&lt;/strong&gt; 처럼 &lt;strong&gt;민감정보&lt;/strong&gt;는 코드에 직접 &lt;strong&gt;평문 입력을 하는 대신 전달 할 수 있는 방안&lt;/strong&gt;을 모색해야 합니다. 방법은 아래와 같습니다.
&lt;ul&gt;
&lt;li&gt;다양한 &lt;strong&gt;시크릿 저장소를 활용&lt;/strong&gt;
E.g.,
AWS Secret Manager, AWS SSM Parameter
GCP KMS 와 KMS Secrets
Azure Key Vault 와 Vault Secret, etc.
&lt;ul&gt;
&lt;li&gt;최소한의 일만 하는 계정을 만들기: 분리와 역할, 필요하면 추가
&lt;ul&gt;
&lt;li&gt;스테이징: 스테이징 프로비저닝에 필요한 AWS 서비스 일부만 허용&lt;/li&gt;
&lt;li&gt;프로덕션: 상기 내용과 마찬가지(권한은 모두 막고, 필요한 단편적인 기능만을 허용하여 넓혀가는 것이 좋습니다.)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;테라폼 &lt;strong&gt;외부에서 환경 변수&lt;/strong&gt;를 통해 시크릿 값을 테라폼에 전달
(테스트나 빠르게 개발할 때만 쓰고, 현업에선 &lt;strong&gt;절대&lt;/strong&gt; 사용하지 맙시다!)
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;export TF_VAR_db_password=&quot;(YOUR_DB_PASSWORD)&quot;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;혹은 &lt;code class=&quot;language-text&quot;&gt;direnv&lt;/code&gt; 의 &lt;code class=&quot;language-text&quot;&gt;.envrc&lt;/code&gt; 파일에 상기 명령과 같은 환경변수를 넣어놓고 사용합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;웹-서버-클러스터-배포-중-배울-요소&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9B%B9-%EC%84%9C%EB%B2%84-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EB%B0%B0%ED%8F%AC-%EC%A4%91-%EB%B0%B0%EC%9A%B8-%EC%9A%94%EC%86%8C&quot; aria-label=&quot;웹 서버 클러스터 배포 중 배울 요소 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;웹 서버 클러스터 배포 중 배울 요소&lt;/h2&gt;
&lt;p&gt;웹 서버 클러스터를 배포하며 &lt;code class=&quot;language-text&quot;&gt;terraform_remote_state&lt;/code&gt; 라는 값과, 테라폼의 내장 함수(build-in function)에 대해 살펴봅시다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;백엔드에 상태 파일(위에서 살펴본 RDS 정보)를 읽어서 웹 서버 클러스터 구성을 합니다. 이 때 변환 데이터는 읽기 전용입니다.&lt;/li&gt;
&lt;li&gt;모든 데이터베이스의 출력 변수는 상태 파일에 저장되며 아래와 같은 형식의 속성 참조를 이용해 &lt;code class=&quot;language-text&quot;&gt;terraform_remote_state&lt;/code&gt; 데이터 소스에서 읽을 수 있으며, 그 양식은 아래와 같습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;data.terraform_remote_state.&amp;lt;NAME&gt;.outputs.&amp;lt;ATTRIBUTE&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;E.g., &lt;code class=&quot;language-text&quot;&gt;terraform_remote_state&lt;/code&gt; 데이터 소스에서 데이터베이스 주소와 포트 정보를 가져와서 HTTP 응답에 정보를 노출&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;user_data &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;EOF
#!/bin/bash
echo &quot;Hello, World&quot; &gt;&gt; index.html
echo &quot;&lt;span class=&quot;token variable&quot;&gt;${data.terraform_remote_state.db.outputs.address}&lt;/span&gt;&quot; &gt;&gt; index.html
echo &quot;&lt;span class=&quot;token variable&quot;&gt;${data.terraform_remote_state.db.outputs.port}&lt;/span&gt;&quot; &gt;&gt; index.html
nohup busybox httpd -f -p &lt;span class=&quot;token variable&quot;&gt;${var.server_port}&lt;/span&gt; &amp;amp;
EOF&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;사용자 데이터 스크립트&lt;/strong&gt;가 길어지면 인라인으로 정의가 복잡해집니다. 이럴 때는 관련 코드를 외부화하는 것이 코드의 복잡도를 떨어뜨리는 방법입니다. 테라폼의 &lt;strong&gt;내장 함수&lt;/strong&gt;와 &lt;code class=&quot;language-text&quot;&gt;template_file&lt;/code&gt; 라는 데이터 소스를 사용해봅시다.&lt;/li&gt;
&lt;li&gt;테라폼에는 표현식을 사용하여 실행할 수 있는 여러 &lt;strong&gt;내장 함수&lt;/strong&gt;(built-in functions)들이 있습니다. 함수 사용법은 아래와 같습니다.
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://developer.hashicorp.com/terraform/language/functions&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;내장 함수에 대한 링크&lt;/a&gt;를 참고하셔서, 필요한 내장 함수가 있는지 확인해보시고 적재적소에 사용합시다.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Reinventing_the_wheel&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;바퀴를 두번 만들 필요는 없지요!&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;function_name()&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;E.g., &lt;a href=&quot;https://developer.hashicorp.com/terraform/language/functions/format&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;format&lt;/code&gt;&lt;/a&gt; 함수는 아래 처럼 사용합니다. 문자열 FMT의 &lt;code class=&quot;language-text&quot;&gt;sprintf&lt;/code&gt; 구문에 따라 &lt;code class=&quot;language-text&quot;&gt;ARGS&lt;/code&gt; 인수를 형식화하는 호출방식입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;format(&amp;lt;FMT&gt;, &amp;lt;ARGS&gt;, ...)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;내장 함수는 테라폼 콘솔을 실행 후, 대화형 콘솔을 사용해서 질의한 결과를 바로 확인하는 것으로 디버깅할 수 있습니다.&lt;/li&gt;
&lt;li&gt;테라폼 콘솔은 &lt;strong&gt;읽기 전용&lt;/strong&gt;입니다. 실수로 인프라나 상태가 변경되지 않습니다. 안심하세요!&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# 참고: 테라폼 콘솔 사용에 관하여&lt;/span&gt;
terraform console
&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; format&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;%.3f&quot;&lt;/span&gt;, &lt;span class=&quot;token number&quot;&gt;3.14159265359&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token string&quot;&gt;&quot;3.142&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;그 외에도 테라폼에는 문자열, 숫자, 리스트, 맵 등을 조작하는 데 사용할 수 있는 많은 내장 함수가 존재합니다. 예시에서는 &lt;a href=&quot;https://developer.hashicorp.com/terraform/language/functions/templatefile&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;templatefile&lt;/code&gt;&lt;/a&gt; 함수를 살펴봅시다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;templatefile&lt;/code&gt; 함수는 PATH 에서 파일을 읽고 그 내용을 문자열로 반환합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;templatefile(&amp;lt;PATH&gt;, &amp;lt;VARS&gt;)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;E.g., 스크립트 파일을 넣고 stage/services/webserver-cluster/user-data.sh 파일을 넣고 문자열로 내용을 읽을 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token shebang important&quot;&gt;#!/bin/bash&lt;/span&gt;

&lt;span class=&quot;token function&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; index.html &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;EOF
&amp;lt;h1&gt;Hello, World&amp;lt;/h1&gt;
&amp;lt;p&gt;DB address: &lt;span class=&quot;token variable&quot;&gt;${db_address}&lt;/span&gt;&amp;lt;/p&gt;
&amp;lt;p&gt;DB port: &lt;span class=&quot;token variable&quot;&gt;${db_port}&lt;/span&gt;&amp;lt;/p&gt;
EOF&lt;/span&gt;

&lt;span class=&quot;token function&quot;&gt;nohup&lt;/span&gt; busybox httpd &lt;span class=&quot;token parameter variable&quot;&gt;-f&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-p&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;${server_port}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;사용자 데이터 스크립트에 동적인 데이터는 참조와 보간을 활용. 아래는 ASG 코드 예시&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;templatefile&lt;/code&gt; 데이터 소스의 vars 맵에 있는 변수만 사용 가능&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;resource &lt;span class=&quot;token string&quot;&gt;&quot;aws_launch_configuration&quot;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;example&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  image_id        &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ami-0fb653ca2d3203ac1&quot;&lt;/span&gt;
  instance_type   &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;t2.micro&quot;&lt;/span&gt;
  security_groups &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;aws_security_group.instance.id&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;# Render the User Data script as a template&lt;/span&gt;
  user_data &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; templatefile&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;user-data.sh&quot;&lt;/span&gt;, &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    server_port &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; var.server_port
    db_address  &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; data.terraform_remote_state.db.outputs.address
    db_port     &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; data.terraform_remote_state.db.outputs.port
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;# Required when using a launch configuration with an auto scaling group.&lt;/span&gt;
  lifecycle &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    create_before_destroy &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id=&quot;lessons-learned&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#lessons-learned&quot; aria-label=&quot;lessons learned permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Lessons Learned&lt;/h1&gt;
&lt;p&gt;제 3장에서는 아래의 내용을 반드시 기억하셨으면 좋겠습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;테라폼 파일을 다수의 사람과 함께 관리할 때 상태관리는 선택이 아닌 필수입니다.
&lt;ol&gt;
&lt;li&gt;워크스페이스 설정을 수행합니다.&lt;/li&gt;
&lt;li&gt;파일 레이아웃을 함께 잡아, 실수를 최대한으로 줄입시다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;민감정보는 시크릿 저장소와 같은 서비스를 활용합시다.&lt;/li&gt;
&lt;li&gt;속성 참조와 내장함수를 통해, 코드반복을 대폭축소합시다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;tips-and-tricks&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#tips-and-tricks&quot; aria-label=&quot;tips and tricks permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Tips and tricks&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;테라폼 코드도 컨벤션이 있습니다!
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://developer.hashicorp.com/terraform/language/syntax/style&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;테라폼 컨벤션&lt;/a&gt;에 대한 이해를 하고, lint 도 할 수 있다는 말이겠군요.&lt;/li&gt;
&lt;li&gt;그렇다면 pre-commit hook 도 당연히 있을겁니다.&lt;/li&gt;
&lt;li&gt;그렇다면 테스트에도 쓰일 수 있겠군요.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이것으로 제 3장을 마칩니다. 긴 글 읽어주셔서 감사합니다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[[CloudNet@] 테라폼 스터디 2주차 - Terraform 을 통한 VPC, ALB, ASG 배포 실습]]></title><description><![CDATA[Terraform 코드를 통해 VPC 구성과 ALB, ASG 설정을 작성하고, 데이터 소스 블록에 대해 학습합니다.]]></description><link>https://blog.s3ich4n.me/devlog/terraform/2022-10-27-cloudneta-terraform-101-pt02</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/terraform/2022-10-27-cloudneta-terraform-101-pt02</guid><pubDate>Thu, 27 Oct 2022 18:11:00 GMT</pubDate><content:encoded>&lt;p&gt;이 내용은 CloudNet@ 에서 진행하는 테라폼 기초 입문 스터디에 대한 연재글입니다.&lt;/p&gt;
&lt;p&gt;스터디에서 사용하는 교재는 Terraform Up &amp;#x26; Running 2nd Edition 입니다.&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&quot;prerequisites&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#prerequisites&quot; aria-label=&quot;prerequisites permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Prerequisites&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;AWS의 VPC 환경에 대한 이해
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=FeYagEibtPE&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;[추천!] AWS 강의실 YouTube 채널의 VPC 강의&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.aws.amazon.com/ko_kr/vpc/latest/userguide/what-is-amazon-vpc.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Amazon VPC란 무엇인가? (위의 강의를 읽으신 후 일독하시면 크게 도움이 됩니다)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/s3ich4n/terraform-study-101/blob/main/chapter01/exercises/challenge01/README.md&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;제가 1주차 도전과제에 대해 공부하며, 요약한 게시글&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;도전과제 내용: AWS VPC에 대해 IaC화 후 EC2 웹서버를 추가하여 프로비저닝하기&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;아래에서 2주차 스터디 내용을 공유합니다.&lt;/p&gt;
&lt;p&gt;교재의 2장 중, 코드내용 중 VPC 환경을 만들고 ASG/ELB 구축을 테라폼으로 진행합니다. 이와 함께 상태관리에 대해 다룹니다.&lt;/p&gt;
&lt;h2 id=&quot;vpc-환경-구축&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#vpc-%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%B6%95&quot; aria-label=&quot;vpc 환경 구축 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;VPC 환경 구축&lt;/h2&gt;
&lt;p&gt;아래 도식의 환경을 코드로 구성합니다:&lt;/p&gt;
&lt;p&gt;예시코드는 아래 경로를 참고해 주세요.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/s3ich4n/terraform-study-101/tree/main/chapter02/exercises/required01&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://github.com/s3ich4n/terraform-study-101/tree/main/chapter02/exercises/required01&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;코드에 대한 설명은 다음과 같습니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;required01_vpc.tf&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;프로바이더, VPC를 정의하여, VPC 환경을 작성하였습니다.&lt;/li&gt;
&lt;li&gt;서브넷을 나누었습니다.&lt;/li&gt;
&lt;li&gt;인터넷 게이트웨이를 통해 외부 통신을 사용하도록 하였습니다.&lt;/li&gt;
&lt;li&gt;라우팅 테이블을 통해 서브넷에서 어떤 라우팅 테이블을 타고 트래픽이 흐를 것인지 작성하였습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;required01_sg.tf&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;시큐리티 그룹을 정의하여, 인터넷 게이트웨이를 통한 ingress, egress 포트를 기재하였습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;required01_ec.tf&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;데이터 소스 블록(하단 참고)을 사용하여, AMI(AWS에서 관리하는 머신 이미지) 정보를 가져와 어떻게 사용할 것인지 코드로 작성했습니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;aws_instance&lt;/code&gt; 선언 시, &lt;code class=&quot;language-text&quot;&gt;ami&lt;/code&gt; config을 수정하며 상기 데이터 소스 블록의 값을 사용했습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;데이터-소스-블록이란&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%86%8C%EC%8A%A4-%EB%B8%94%EB%A1%9D%EC%9D%B4%EB%9E%80&quot; aria-label=&quot;데이터 소스 블록이란 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;데이터 소스 블록이란?&lt;/h2&gt;
&lt;p&gt;예시코드에 있는 내용 중, &lt;code class=&quot;language-text&quot;&gt;data&lt;/code&gt; 로 시작하는 구문은, 데이터 소스 블록을 의미합니다. 이는 아래와 같습니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;테라폼을 실행할 때 마다 provider 별로 가져온 읽기 전용 정보를 의미합니다.
&lt;ul&gt;
&lt;li&gt;E.g., &lt;a href=&quot;https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/ami&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;aws_ami&lt;/code&gt;&lt;/a&gt; 의 데이터 소스 블록은 이런 내용을 가지고 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;데이터 소스를 통하여 아래 내용을 사용할 수 있습니다.
&lt;ul&gt;
&lt;li&gt;테라폼 외부에서 정의된 정보&lt;/li&gt;
&lt;li&gt;별도의 테라폼 구성으로 정의된 정보&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;다른 코드에서, &lt;code class=&quot;language-text&quot;&gt;data.&amp;lt;provider&gt;.&amp;lt;name&gt;.&amp;lt;attribute&gt;&lt;/code&gt; 과 같은 방식으로 호출해올 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;데이터 소스 블록을 사용하는 방법은 아래와 같습니다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;data &lt;span class=&quot;token string&quot;&gt;&quot;&amp;lt;PROVIDER&gt;_&amp;lt;TYPE&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&amp;lt;NAME&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;CONFIG …&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;PROVIDER : &lt;code class=&quot;language-text&quot;&gt;aws&lt;/code&gt; 같은 공급자의 이름&lt;/li&gt;
&lt;li&gt;TYPE : &lt;code class=&quot;language-text&quot;&gt;vpc&lt;/code&gt; 같은 사용하려는 데이터 소스의 유형&lt;/li&gt;
&lt;li&gt;NAME : 테라폼 코드에서 이 데이터 소스를 참조하는 데 사용할 수 있는 식별자&lt;/li&gt;
&lt;li&gt;CONFIG : 해당 데이터 소스에 고유한 하나 이상의 인수로 구성됩니다.
&lt;ul&gt;
&lt;li&gt;아래의 예시는 &lt;code class=&quot;language-text&quot;&gt;aws_vpc&lt;/code&gt; 데이터 소스를 사용하여 기본 VPC(default vpc)의 데이터를 사용하는 구문입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;이런 방식으로 호출할 수 있지요:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;data &lt;span class=&quot;token type variable&quot;&gt;&quot;aws_ami&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;s3ich4n-chapter02-ex01-amazonlinux2&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;most_recent&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;filter&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;name&lt;/span&gt;   &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;owner-alias&quot;&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;values&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;amazon&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;filter&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;name&lt;/span&gt;   &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;name&quot;&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;values&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;amzn2-ami-hvm-*-x86_64-ebs&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token property&quot;&gt;owners&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;amazon&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;resource &lt;span class=&quot;token type variable&quot;&gt;&quot;aws_instance&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;s3ich4n-chapter02-ex01-ec2&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;ami&lt;/span&gt;                         &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; data.aws_ami.s3ich4n-chapter02-ex01-amazonlinux2.id
  (중략)
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;vpc환경에서-alb-asg-구축&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#vpc%ED%99%98%EA%B2%BD%EC%97%90%EC%84%9C-alb-asg-%EA%B5%AC%EC%B6%95&quot; aria-label=&quot;vpc환경에서 alb asg 구축 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;VPC환경에서 ALB, ASG 구축&lt;/h2&gt;
&lt;p&gt;이제 VPC 환경에서 ALB, ASG를 추가한 환경을 구축해보겠습니다. 도식은 아래와 같습니다:&lt;/p&gt;
&lt;p&gt;예시코드는 아래 경로를 참고해 주세요.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/s3ich4n/terraform-study-101/tree/main/chapter02/exercises/required02&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://github.com/s3ich4n/terraform-study-101/tree/main/chapter02/exercises/required02&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;구축에 앞서 ALB와 ASG, 그리고 이 둘을 함께 사용하려면 어떻게 해야하는지에 대해 살펴보겠습니다.&lt;/p&gt;
&lt;h3 id=&quot;asg란&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#asg%EB%9E%80&quot; aria-label=&quot;asg란 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;ASG란?&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.aws.amazon.com/autoscaling/ec2/userguide/auto-scaling-groups.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;AWS의 ASG(Auto Scaling Groups)&lt;/a&gt;를 의미합니다. EC2 인스턴스의 자동적인 스케일링, 관리를 위해 논리적인 그룹으로 묶는 기능을 수행합니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;EC2 인스턴스 클러스터 시작, 인스턴스 상태 모니터링/교체, 부하에 따른 클러스터 사이즈 조정 등을 자동으로 해줍니다.&lt;/li&gt;
&lt;li&gt;따라서, 운영하고자 하는 서비스의 트래픽 양에 따라 클러스터의 적절한 크기를 조절해야 합니다.&lt;/li&gt;
&lt;li&gt;공부를 마치고, &lt;a href=&quot;https://www.airpair.com/aws/posts/building-a-scalable-web-app-on-amazon-web-services-p1&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;AWS에 HA 및 scalable system 구축방법에 대한 링크&lt;/a&gt;를 읽어보시길 권장합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ASG는 시작 구성정보를 참고하여 인스턴스를 생성하는데, 재배포를 한다면 시작구성을 변경할 수 없습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;따라서, 리소스 생성, 업데이트, 삭제 방법을 구성하는 수명주기(&lt;code class=&quot;language-text&quot;&gt;lifecycle&lt;/code&gt;) 설정을 추가해야 합니다.
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;create_before_destroy&lt;/code&gt; 설정을 이 때 사용합니다.&lt;/li&gt;
&lt;li&gt;테라폼은 리소스를 교체하는 순서를 반대로 하여 교체 리소스를 먼저 생성하고(이전 리소스가 가리키고 있던 참조를 업데이트하여 교체한 리소스를 가리킴) 기존 리소스를 삭제합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;alb란&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#alb%EB%9E%80&quot; aria-label=&quot;alb란 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;ALB란?&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.aws.amazon.com/ko_kr/elasticloadbalancing/latest/application/introduction.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;AWS ALB(Application Load Balancer)&lt;/a&gt;를 의미합니다. 둘 이상의 AZ(Availability Zone, 가용 영역)에서 EC2, 컨테이너, IP 주소 등에 대해 들어오는 트래픽을 자동으로 분산하는 역할을 수행합니다.&lt;/p&gt;
&lt;p&gt;→ 트래픽을 분산시키고, 외부에 노출시키는 IP 주소를 단일화합니다.&lt;/p&gt;
&lt;p&gt;ALB의 주요 구성에 대해 알아보겠습니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;리스너
&lt;ul&gt;
&lt;li&gt;특정 포트, 특정 프로토콜에 대해 수신&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;리스너 규칙
&lt;ul&gt;
&lt;li&gt;특정 경로에 대해 어디로 요청을 “대상 그룹”으로 보낼지 설정&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;대상 그룹
&lt;ul&gt;
&lt;li&gt;요청을 받는 하나 이상의 서버&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;FYI, AWS에서는 로드 밸런싱을 위한 여러 서비스가 존재합니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;NLB (네트워크 로드 밸런서)
&lt;ul&gt;
&lt;li&gt;L4 레벨 트래픽 처리에 적합(TCP, UDP, TLS, etc.)합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;CLB (클래식 로드 밸런서)
&lt;ul&gt;
&lt;li&gt;AWS의 레거시 로드밸런서입니다.&lt;/li&gt;
&lt;li&gt;L7, L4 모두 가능하지만 새로 나온 서비스에 비하면 기능이 적습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;asg-alb를-사용하려면&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#asg-alb%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EB%A0%A4%EB%A9%B4&quot; aria-label=&quot;asg alb를 사용하려면 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;ASG, ALB를 사용하려면?&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;ASG, ALB를 함께 사용하려면?&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;어떤 인스턴스 그룹을 바라보아야 할지 설정해야 합니다.&lt;/li&gt;
&lt;li&gt;헬스체크 타입 추가(EC2 → ELB)가 필요합니다.&lt;/li&gt;
&lt;li&gt;LB healthcheck 룰을 추가해야합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;lessons-learned&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#lessons-learned&quot; aria-label=&quot;lessons learned permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Lessons Learned&lt;/h2&gt;
&lt;p&gt;제 2장에서는 테라폼을 사용하여 기본적인 환경구축을 수행하는 방법에 대해 배웠습니다. 또한 데이터 소스 블록에 대한 내용을 학습했습니다. 아래 내용을 반드시 기억하셨으면 좋겠습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;VPC 환경을 테라폼으로 표현하는 방법에 대해 배웠습니다.&lt;/li&gt;
&lt;li&gt;VPC 환경에 ALB, ASG를 함께 구축하여 트래픽양에 따른 scale-out을 코드화 하였습니다
&lt;ol&gt;
&lt;li&gt;아직 정확히 어떤 시점에, 어떻게 스케일아웃을 하고 다시 원복해야 하는지에 대한 내용은 나오지 않았습니다!&lt;/li&gt;
&lt;li&gt;후에 다시 기술할 예정입니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;데이터 소스 블록에 대해 배웠습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이것으로 제 2장을 마칩니다. 긴 글 읽어주셔서 감사합니다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[[CloudNet@] 테라폼 스터디 1주차 - Terraform의 기초]]></title><description><![CDATA[Terraform의 등장배경과, 간략한 소개, 그리고 기초적인 예시를 통해 어떻게 사용하는지에 대한 내용을 담고 있습니다.]]></description><link>https://blog.s3ich4n.me/devlog/terraform/2022-10-20-cloudneta-terraform-101-pt01</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/terraform/2022-10-20-cloudneta-terraform-101-pt01</guid><pubDate>Thu, 20 Oct 2022 16:34:00 GMT</pubDate><content:encoded>&lt;p&gt;이 내용은 &lt;a href=&quot;https://www.notion.so/gasidaseo/CloudNet-Blog-c9dfa44a27ff431dafdd2edacc8a1863&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;CloudNet@&lt;/a&gt; 에서 진행하는 테라폼 기초 입문 스터디에 대한 연재글입니다.&lt;/p&gt;
&lt;p&gt;스터디에서 사용하는 교재는 &lt;a href=&quot;http://www.yes24.com/Product/Goods/101511312&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Terraform Up &amp;#x26; Running 2nd Edition&lt;/a&gt; 입니다.&lt;/p&gt;
&lt;h1 id=&quot;들어가며&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0&quot; aria-label=&quot;들어가며 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;들어가며…&lt;/h1&gt;
&lt;p&gt;인프라를 코드를 통해 관리(Infrastructure as Code, 이하 IaC)하는 개념은 널리 퍼져있습니다. 이는 수동으로 운영하는 수고를 벗어나, 코드화하여 관리할 수 있는 이점을 지니기도 합니다.&lt;/p&gt;
&lt;p&gt;그렇지만 올바르게 알아야 이를 적재적소에 사용할 수 있으며, 백엔드 개발에 대한 지식을 익혀둔 현 시점에 학습하면 협업 및 서브프로젝트 진행에 도움이 될 것이라고 판단하였습니다.&lt;/p&gt;
&lt;p&gt;따라서 제가 공부한 내용을 남겨, 이해하고 배운 내용을 공유하려 합니다.&lt;/p&gt;
&lt;p&gt;부디 이 내용이 도움이 되기를 바랍니다.&lt;/p&gt;
&lt;h1 id=&quot;이-글의-대상은&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%B4-%EA%B8%80%EC%9D%98-%EB%8C%80%EC%83%81%EC%9D%80&quot; aria-label=&quot;이 글의 대상은 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;이 글의 대상은?&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;백엔드 개발 경험이 있으면서 인프라를 코드로 관리(Infrastructure as Code, IaC)하는 방법에 대해 알고싶은 분&lt;/li&gt;
&lt;li&gt;AWS, GCP, Microsoft Azure 등의 클라우드 컴퓨팅 서비스에 대한 기본 개념을 갖추신 분&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;목차&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AA%A9%EC%B0%A8&quot; aria-label=&quot;목차 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;목차&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#Prerequisites&quot;&gt;Prerequisites&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#devops%EC%9D%98-%EB%8C%80%EB%91%90-iac%EC%9D%98-%EB%93%B1%EC%9E%A5-%EA%B7%B8%EB%A6%AC%EA%B3%A0-terraform&quot;&gt;DevOps의 대두, IaC의 등장, 그리고 Terraform&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#terraform-%EC%9D%B4%EB%9E%80&quot;&gt;Terraform 이란?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%ED%85%8C%EB%9D%BC%ED%8F%BC%EC%97%90-%EB%8C%80%ED%95%98%EC%97%AC&quot;&gt;테라폼에 대하여&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#%ED%85%8C%EB%9D%BC%ED%8F%BC%EC%9D%98-%EA%B8%B0%EB%B3%B8-%EA%B0%9C%EB%85%90&quot;&gt;테라폼의 기본 개념&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%ED%85%8C%EB%9D%BC%ED%8F%BC-%EC%BD%94%EB%93%9C%EC%97%90-%EB%8C%80%ED%95%98%EC%97%AC&quot;&gt;테라폼 코드에 대하여&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%ED%85%8C%EB%9D%BC%ED%8F%BC-%EA%B5%AC%EB%8F%99%EB%B0%A9%EB%B2%95&quot;&gt;테라폼 구동방법&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#lessons-learned&quot;&gt;Lessons learned&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;prerequisites&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#prerequisites&quot; aria-label=&quot;prerequisites permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Prerequisites&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/tfutils/tfenv&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;tfenv&lt;/a&gt; 를 통한 테라폼 설치환경 분리
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.44bits.io/ko/post/managing-teraform-versions-with-tfenv&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;참고링크 1&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;AWS의 IAM user 자격증명 설정
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.voidmainvoid.net/405&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;AWS IAM에 대한 설명&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://direnv.net/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;direnv&lt;/a&gt; 를 설치하여, 디렉토리 별 환경변수 설정
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.44bits.io/ko/post/direnv_for_managing_directory_environment&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;참고링크 1&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;아래에서 1주차 스터디 내용을 공유합니다.&lt;/p&gt;
&lt;p&gt;교재의 1, 2장을 다룹니다.&lt;/p&gt;
&lt;h2 id=&quot;devops의-대두-iac의-등장-그리고-terraform&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#devops%EC%9D%98-%EB%8C%80%EB%91%90-iac%EC%9D%98-%EB%93%B1%EC%9E%A5-%EA%B7%B8%EB%A6%AC%EA%B3%A0-terraform&quot; aria-label=&quot;devops의 대두 iac의 등장 그리고 terraform permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;DevOps의 대두, IaC의 등장, 그리고 Terraform&lt;/h2&gt;
&lt;p&gt;과거에는 랙이나 캐비넷에 서버를 설치하고, 배선작업을 하고 쿨링 시스템을 설정하여 서버를 개발하던 시절이 있었습니다(물론 현재에도 여전히 유효하며, 필요에 따라서는 사용해야 합니다!). 이러한 시대에는 개발팀(Dev)과 운영팀(Ops)이 분리되어 하드웨어, 소프트웨어 파트를 각각 맡았으며 회사가 커짐에 따라 불필요한 수고가 많아졌습니다. &lt;a href=&quot;https://ko.wikipedia.org/wiki/%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C_%EC%BB%B4%ED%93%A8%ED%8C%85&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;클라우드 컴퓨팅&lt;/a&gt;의 시대가 도래하여 필요에 따라 하드웨어 제품을 “대여” 할 수 있게 되고, &lt;code class=&quot;language-text&quot;&gt;Chef&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;Puppet&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;Terraform&lt;/code&gt; 등과 같은 소프트웨어의 등장하여 이러한 수고를 “모든” 회사가 하지 않아도 되는 시대가 왔습니다. 이러한 시대의 흐름을 타고 개발과 운영이 한데 어우러진, 이른 바 “DevOps 운동”이 시작되었습니다. 소프트웨어 개발 전반에 필요한 프로세스와 방법론, 그리고 세부 기술에 대한 논의가 진행되는건 당연한 수순이라고 할 수 있겠네요.&lt;/p&gt;
&lt;p&gt;따라서, DevOps는 아래와 같다고 할 수 있겠습니다:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;소프트웨어를 효율적으로 전달하는 프로세스&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;IaC(Infrastructure as Code)는 이러한 DevOps를 할 수 있게 한 원동력입니다. 문자 그대로, 인프라환경을 코드로 작성할 수 있게 된 것이지요. 앞서 말씀드린 &lt;code class=&quot;language-text&quot;&gt;Chef&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;Puppet&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;Terraform&lt;/code&gt; 등과 같은 도구가 그 대상 중 하나입니다. 저희는 앞으로 그 중 하나인 &lt;code class=&quot;language-text&quot;&gt;Terraform&lt;/code&gt;(이하 테라폼)을 배우게 될 것입니다.&lt;/p&gt;
&lt;h2 id=&quot;terraform-이란&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#terraform-%EC%9D%B4%EB%9E%80&quot; aria-label=&quot;terraform 이란 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Terraform 이란?&lt;/h2&gt;
&lt;p&gt;HashiCorp 에서 만든 IaC 도구입니다. 사람이 읽기 쉬운(human-readable) 설정파일을 통해 버저닝과 재사용, 그리고 팀원간의 공유를 할 수 있게 합니다.&lt;/p&gt;
&lt;p&gt;코드화가 된다면, 코드를 작성할 때의 덕목을 모두 사용할 수 있음을 의미합니다. 따라서, 좋은 코드를 작성하기 위한 요소를 알고, Ops 파트의 특성을 공유한다면 보다 기민한 제품개발(뭐가 되었든!)을 할 수 있겠지요.&lt;/p&gt;
&lt;h3 id=&quot;iac-도구의-장점&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#iac-%EB%8F%84%EA%B5%AC%EC%9D%98-%EC%9E%A5%EC%A0%90&quot; aria-label=&quot;iac 도구의 장점 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;IaC 도구의 장점&lt;/h3&gt;
&lt;p&gt;인프라를 코드 형식으로 작성하는 경우, 아래의 장점을 가져갈 수 있습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;자급식 배포 (&lt;strong&gt;Self-service&lt;/strong&gt;): 배포 프로세스를 자동화 할 수 있으며, 개발자는 필요할 때마다 자체적으로 배포를 진행 할 수 있습니다.&lt;/li&gt;
&lt;li&gt;속도와 안정성 (&lt;strong&gt;Speed and safety&lt;/strong&gt;) : 제대로 작성된 코드는 자동/일관적이며, 사람이 발생시킬 수 있는 오류(human error)의 가능성이 현저히 적습니다.&lt;/li&gt;
&lt;li&gt;문서화 (&lt;strong&gt;Documentation&lt;/strong&gt;) : 시스템 관리자 조직만 인프라에 관한 정보를 독점하는 것이 아니라, 누구나 읽을 수 있는 소스 파일로 인프라 상태를 나타낼수 있습니다.&lt;/li&gt;
&lt;li&gt;버전 관리 (&lt;strong&gt;Version control&lt;/strong&gt;) : 인프라의 변경 내용이 모두 기록된 코드형 인프라 소스 파일을 저장할 수 있으므로 버전을 쉽게 관리할 수 있습니다. 또한 문제 발생 시 코드를 통한 원상복구가 가능합니다.&lt;/li&gt;
&lt;li&gt;유효성 검증 (&lt;strong&gt;Validation&lt;/strong&gt;) : 인프라 상태가 코드로 정의되어 있으면 코드가 변경될 때마다 검증을 수행하고 일련의 자동화된 테스트를 실행할 수 있습니다.&lt;/li&gt;
&lt;li&gt;재사용성 (&lt;strong&gt;Reuse&lt;/strong&gt;) : 인프라를 재사용 가능한 모듈로 패키징할 수 있어 검증된 모듈로 일관되게 배포할 수 있습니다.&lt;/li&gt;
&lt;li&gt;이 모든게 되다니 행복해요(&lt;strong&gt;Happiness&lt;/strong&gt;)!&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;테라폼에-대하여&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%85%8C%EB%9D%BC%ED%8F%BC%EC%97%90-%EB%8C%80%ED%95%98%EC%97%AC&quot; aria-label=&quot;테라폼에 대하여 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;테라폼에 대하여&lt;/h2&gt;
&lt;p&gt;아래에서 본격적으로 테라폼이 어떤 식으로 사용되는지에 대해 살펴보겠습니다.&lt;/p&gt;
&lt;h3 id=&quot;테라폼의-기본-개념&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%85%8C%EB%9D%BC%ED%8F%BC%EC%9D%98-%EA%B8%B0%EB%B3%B8-%EA%B0%9C%EB%85%90&quot; aria-label=&quot;테라폼의 기본 개념 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;테라폼의 기본 개념&lt;/h3&gt;
&lt;p&gt;테라폼에서 주요하게 사용되는 기본개념은 아래와 같습니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;resource&lt;/strong&gt; : 실제로 생성할 인프라 자원을 의미&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;provider&lt;/strong&gt; : 테라폼으로 정의할 Infrastructure Provider(AWS, Microsoft Azure, GCP 등)를 의미&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;output&lt;/strong&gt; : 인프라를 프로비저닝 한 후에 생성된 자원을 &lt;code class=&quot;language-text&quot;&gt;output&lt;/code&gt; 부분으로 뽑을 수 있음. &lt;code class=&quot;language-text&quot;&gt;output&lt;/code&gt;으로 추출한 부분은 이후에 &lt;code class=&quot;language-text&quot;&gt;remote state&lt;/code&gt;에서 활용 가능&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;backend&lt;/strong&gt; : 테라폼의 상태를 저장할 공간을 지정하는 부분. &lt;code class=&quot;language-text&quot;&gt;backend&lt;/code&gt;를 사용하면 현재 배포된 최신 상태를 외부에 저장하기 때문에 다른 사람과의 협업이 가능&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;module&lt;/strong&gt; : 공통적으로 활용할 수 있는 인프라 코드를 한 곳으로 모아서 정의하는 부분. 이를 사용하면 변수만 바꿔서 동일한 리소스를 손쉽게 생성할 수 있음&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;remote state&lt;/strong&gt; : &lt;code class=&quot;language-text&quot;&gt;remote state&lt;/code&gt;를 사용하면 VPC, IAM 등과 같이 여러 서비스가 공통으로 사용하는 것을 사용할 수 있음. &lt;code class=&quot;language-text&quot;&gt;tfstate&lt;/code&gt;파일이 저장되어 있는 &lt;code class=&quot;language-text&quot;&gt;backend&lt;/code&gt; 정보를 명시하면, 테라폼이 해당 &lt;code class=&quot;language-text&quot;&gt;backend&lt;/code&gt;에서 &lt;code class=&quot;language-text&quot;&gt;output&lt;/code&gt; 정보들을 가져옴&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;테라폼-코드에-대하여&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%85%8C%EB%9D%BC%ED%8F%BC-%EC%BD%94%EB%93%9C%EC%97%90-%EB%8C%80%ED%95%98%EC%97%AC&quot; aria-label=&quot;테라폼 코드에 대하여 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;테라폼 코드에 대하여&lt;/h3&gt;
&lt;p&gt;테라폼 코드의 실제 작성요소에 대해 간략히 정리하고자 합니다.&lt;/p&gt;
&lt;p&gt;테라폼 코드는 HCL(Hashicorp Configuration Language) 로 작성합니다.&lt;/p&gt;
&lt;p&gt;OS 마다 &lt;strong&gt;바이너리&lt;/strong&gt; 파일이 존재하는데, Go코드는 하나의 바이너리 파일로 컴파일되며 &lt;code class=&quot;language-text&quot;&gt;terraform &amp;lt;args&gt;&lt;/code&gt; 형식의 명령어로 실행합니다. 테라폼 바이너리가 &lt;code class=&quot;language-text&quot;&gt;provider&lt;/code&gt;를 대신해 API를 호출하여 리소스를 생성합니다. 테라폼은 인프라 정보가 담겨 있는 테라폼 구성 파일을 생성하여 API를 호출하지요.&lt;/p&gt;
&lt;p&gt;확장자는 &lt;code class=&quot;language-text&quot;&gt;*.tf&lt;/code&gt; 입니다.&lt;/p&gt;
&lt;h3 id=&quot;테라폼-구동방법&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%85%8C%EB%9D%BC%ED%8F%BC-%EA%B5%AC%EB%8F%99%EB%B0%A9%EB%B2%95&quot; aria-label=&quot;테라폼 구동방법 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;테라폼 구동방법&lt;/h3&gt;
&lt;p&gt;테라폼의 구동 후 프로비저닝[1] 은 크게 3단계로 나뉩니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;terraform init&lt;/code&gt; 을 통해 테라폼 프로젝트를 initialize
&lt;ul&gt;
&lt;li&gt;지정한 backend에 상태 저장을 위한 &lt;code class=&quot;language-text&quot;&gt;.tfstate&lt;/code&gt; 파일을 생성합니다. 여기에는 가장 마지막에 적용한 테라폼 내역이 저장됩니다.&lt;/li&gt;
&lt;li&gt;init 작업을 완료하면, local에는 &lt;code class=&quot;language-text&quot;&gt;.tfstate&lt;/code&gt;에 정의된 내용을 담은 &lt;code class=&quot;language-text&quot;&gt;.terraform&lt;/code&gt; 파일이 생성됩니다.&lt;/li&gt;
&lt;li&gt;기존에 다른 개발자가 이미 &lt;code class=&quot;language-text&quot;&gt;.tfstate&lt;/code&gt;에 인프라를 정의해 놓은 것이 있다면, 다른 개발자는 init작업을 통해서 local에 sync를 맞출 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;terraform plan&lt;/code&gt; 을 통해 수행하고자 하는 동작을 테스트
&lt;ul&gt;
&lt;li&gt;정의한 코드가 어떤 인프라를 만들게 되는지 미리 예측 결과를 보여줍니다. 단, plan을 한 내용에 에러가 없다고 하더라도, 실제 적용되었을 때는 에러가 발생할 수 있습니다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code class=&quot;language-text&quot;&gt;terraform plan&lt;/code&gt; 명령어는 어떠한 형상에도 변화를 주지 않습니다.&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;terraform apply&lt;/code&gt;를 통해 실제 프로비저닝을 수행
&lt;ul&gt;
&lt;li&gt;실제로 인프라를 배포하기 위한 명령어입니다. apply를 완료하면, AWS 상에 실제로 해당 인프라가 생성되고 작업 결과가 backend의 &lt;code class=&quot;language-text&quot;&gt;.tfstate&lt;/code&gt; 파일에 저장됩니다.&lt;/li&gt;
&lt;li&gt;해당 결과는 local의 .terraform 파일에도 저장됩니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;예시를-통한-resource-정의-방법-표현&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%98%88%EC%8B%9C%EB%A5%BC-%ED%86%B5%ED%95%9C-resource-%EC%A0%95%EC%9D%98-%EB%B0%A9%EB%B2%95-%ED%91%9C%ED%98%84&quot; aria-label=&quot;예시를 통한 resource 정의 방법 표현 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;예시를 통한 &lt;code class=&quot;language-text&quot;&gt;resource&lt;/code&gt; 정의 방법 표현&lt;/h3&gt;
&lt;p&gt;실제로 생성할 인프라 자원에 대해 정의하는 방법은 아래와 같습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;resource &lt;span class=&quot;token string&quot;&gt;&quot;&amp;lt;PROVIDER&gt;_&amp;lt;TYPE&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&amp;lt;NAME&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;CONFIG ...&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;PROVIDER : ‘aws’ 같은 공급자의 이름&lt;/li&gt;
&lt;li&gt;TYPE : ‘security_group’ 같은 리소스의 유형&lt;/li&gt;
&lt;li&gt;NAME : 리소스의 이름&lt;/li&gt;
&lt;li&gt;CONFIG : 한개 이상의 &lt;em&gt;arguments&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;그렇다면, 예시코드를 보며 이해해보죠.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/s3ich4n/terraform-study-101/blob/4e0b9159a443853311734cf0a839a11772290bbf/chapter01/example01/main.tf#L1-L12&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://github.com/s3ich4n/terraform-study-101/blob/4e0b9159a443853311734cf0a839a11772290bbf/chapter01/example01/main.tf#L1-L12&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;line 1~3: &lt;code class=&quot;language-text&quot;&gt;provider&lt;/code&gt; 정의를 통해 어느 프로바이더를 사용할지 기재합니다.
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;region&lt;/code&gt; 은 어느 지역의 장비를 사용할 것인지를 기재하는 것입니다.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Concepts.RegionsAndAvailabilityZones.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;region에 대한 리스트&lt;/a&gt; 는 해당 링크를 참조해주세요.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;line 5~11: &lt;code class=&quot;language-text&quot;&gt;resource&lt;/code&gt; 에 대한 정의입니다. 어떤 프로바이더의 리소스를 사용할 것이며, 사용자가 정의한 이름을 사용하겠다는 의미이지요.
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;config&lt;/code&gt; 값은 리소스에 따라 다릅니다. 현재 사용한 &lt;a href=&quot;https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;aws_instance&lt;/code&gt;&lt;/a&gt; 에 대한 상세한 내용은 이 링크를 참조해주세요.&lt;/li&gt;
&lt;li&gt;pro tips) 향후 작업하시며, 테라폼의 공식문서를 많이 보시게 될 겁니다!&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;예시를-통한-참조reference-방법-표현&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%98%88%EC%8B%9C%EB%A5%BC-%ED%86%B5%ED%95%9C-%EC%B0%B8%EC%A1%B0reference-%EB%B0%A9%EB%B2%95-%ED%91%9C%ED%98%84&quot; aria-label=&quot;예시를 통한 참조reference 방법 표현 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;예시를 통한 참조(reference) 방법 표현&lt;/h3&gt;
&lt;p&gt;참조(reference)는 코드의 다른 부분에서 사전에 정의한 리소스의 특정 값에 액세스 할 수 있게 해주는 표현식을 의미합니다. 정의 방법은 아래와 같습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;hcl&quot;&gt;&lt;pre class=&quot;language-hcl&quot;&gt;&lt;code class=&quot;language-hcl&quot;&gt;&amp;lt;PROVIDER&gt;_&amp;lt;TYPE&gt;.&amp;lt;NAME&gt;.&amp;lt;ATTRIBUTE&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;PROVIDER : ‘aws’ 같은 공급자의 이름&lt;/li&gt;
&lt;li&gt;TYPE : ‘security_group’ 같은 리소스의 유형&lt;/li&gt;
&lt;li&gt;NAME : 보안 그룹 이름인 ‘instance’ 같은 리소스의 이름&lt;/li&gt;
&lt;li&gt;ATTRIBUTE : ‘name’ 과 같은 리소스의 인수 중 하나이거나 리소스가 내보낸 속성 중 하나&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;예시1)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;aws&lt;/code&gt; PROVIDER의 &lt;code class=&quot;language-text&quot;&gt;security_group&lt;/code&gt; TYPE에 대해&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;instance&lt;/code&gt;라는 이름의 NAME내의 &lt;code class=&quot;language-text&quot;&gt;id&lt;/code&gt; 라는 ATTRIBUTE 을 가져오려면?
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;aws_security_group.instance.id&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;종속성
&lt;ul&gt;
&lt;li&gt;하나의 리소스에서 다른 리소스로 &lt;strong&gt;참조&lt;/strong&gt;를 추가하면 내재된 &lt;strong&gt;종속성&lt;/strong&gt;이 작성됩니다.&lt;/li&gt;
&lt;li&gt;테라폼은 종속성 구문을 분석하여 종속성 그래프를 작성하고, 이를 사용하여 리소스를 생성하는 순서를 &lt;strong&gt;자동&lt;/strong&gt;으로 결정합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;변수variables-표현&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%B3%80%EC%88%98variables-%ED%91%9C%ED%98%84&quot; aria-label=&quot;변수variables 표현 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;변수(variables) 표현&lt;/h3&gt;
&lt;p&gt;변수(variables)는 자주 사용되는 값에 대해 변수값으로 별도의 &lt;code class=&quot;language-text&quot;&gt;.tf&lt;/code&gt; 파일에 기록하는 것을 의미합니다.&lt;/p&gt;
&lt;p&gt;두가지 예시코드를 살펴보며 학습하겠습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;variables.tf&lt;/code&gt; 파일에 분리된 예시코드
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/s3ich4n/terraform-study-101/blob/main/chapter01/example04/variables.tf&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://github.com/s3ich4n/terraform-study-101/blob/main/chapter01/example04/variables.tf&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;server_port&lt;/code&gt; 라는 변수를 정의하여, 다른 테라폼 파일에서 사용하도록 합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;main.tf&lt;/code&gt; 파일에 작성된 프로바이더, 리소스 정의와 변수 참조
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/s3ich4n/terraform-study-101/blob/4e0b9159a4/chapter01/example04/main.tf&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://github.com/s3ich4n/terraform-study-101/blob/4e0b9159a4/chapter01/example04/main.tf&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;line 27~28: &lt;code class=&quot;language-text&quot;&gt;var.server_port&lt;/code&gt; 와 같이 변수값을 참조하여 사용&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;lessons-learned&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#lessons-learned&quot; aria-label=&quot;lessons learned permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Lessons learned&lt;/h2&gt;
&lt;p&gt;제 1장에서는 테라폼의 기본 내용을 살펴보았습니다. 아래 내용을 반드시 기억하셨으면 좋겠습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;다양한 IaC 도구들의 등장과 클라우드 컴퓨팅의 등장으로, 개발과 운영은 새로운 패러다임을 맞이했습니다.&lt;/li&gt;
&lt;li&gt;테라폼의 기본적인 개념에 대해 익히고, 특정 프로바이더의 리소스를 사용할 수 있습니다.&lt;/li&gt;
&lt;li&gt;2에서 언급한 리소스의 값을 마치 변수처럼 “참조”할 수 있으며, 공통적으로 사용되는 상수값은 “변수”로 둘 수 있습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이것으로 제 1장을 마칩니다. 긴 글 읽어주셔서 감사합니다.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;[1]: “작성된 코드에 대한 환경을 배포한다” 로 이해하면 쉽습니다. 적절한 권한을 가진 유저가 인프라 구성 명령을 내려서 실제 인프라 구성을 수행하는 것이지요.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[인가를 다시 살펴보다 (2) OpenID Connect 스펙과 OAuth 2.0, OpenID Connect 구현체 살펴보기]]></title><description><![CDATA[OAuth 2.0에 **인증** 을 추가한 OpenID Connect 스펙을 살펴보고, OpenID Connect의 주요 사항과 개념들, 그리고 유의사항에 대해 확인해보도록 하겠습니다.]]></description><link>https://blog.s3ich4n.me/devlog/backend/2022-10-17-considering-authn-and-authz-revisited-pt02</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/backend/2022-10-17-considering-authn-and-authz-revisited-pt02</guid><pubDate>Mon, 17 Oct 2022 21:50:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;연재-안내&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%97%B0%EC%9E%AC-%EC%95%88%EB%82%B4&quot; aria-label=&quot;연재 안내 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;연재 안내&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/devlog/backend/2022-10-16-considering-authn-and-authz-revisited-pt01&quot;&gt;인가를 다시 살펴보다 (1)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;인가를 다시 살펴보다 (2)&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;들어가며&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0&quot; aria-label=&quot;들어가며 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;들어가며&lt;/h1&gt;
&lt;p&gt;OAuth 2.0 스펙에 대해 알아보았으니, 흔히 잘못 사용되는 &lt;em&gt;OAuth 2.0을 인증으로 사용하기&lt;/em&gt; 의 오개념을 바로잡고, 이를 보완하기 위해 등장한 OpenID Connect를 살펴봅니다. 이는 OAuth 2.0 스펙에 &lt;strong&gt;인증&lt;/strong&gt;을 추가한 프로토콜이며, 어떤 식의 개념을 알아야 올바르게 사용할 수 있는지 확인해봅시다.&lt;/p&gt;
&lt;h1 id=&quot;openid-connect이하-oidc란&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#openid-connect%EC%9D%B4%ED%95%98-oidc%EB%9E%80&quot; aria-label=&quot;openid connect이하 oidc란 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;OpenID Connect(이하 OIDC)란?&lt;/h1&gt;
&lt;p&gt;OpenID Connect 1.0은 OAuth 2.0[RFC6749] 프로토콜 위에 있는 간단한 ID 계층입니다. 이를 통해 클라이언트는 권한 부여 서버에서 수행한 인증을 기반으로 최종 사용자의 신원을 확인할 수 있을 뿐만 아니라 상호 운용 가능한 REST 방식으로 최종 사용자에 대한 기본 프로필 정보를 얻을 수 있습니다.&lt;/p&gt;
&lt;p&gt;다시말해, OAuth 2.0은 상황에 맞는 &lt;strong&gt;권한 부여&lt;/strong&gt;에 적합한 프로토콜이며 여기에 인증 레이어를 추가한 기술로 이해하면 될 것입니다.&lt;/p&gt;
&lt;h2 id=&quot;oidc의-등장배경&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#oidc%EC%9D%98-%EB%93%B1%EC%9E%A5%EB%B0%B0%EA%B2%BD&quot; aria-label=&quot;oidc의 등장배경 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;OIDC의 등장배경&lt;/h2&gt;
&lt;p&gt;OAuth 2.0을 &lt;strong&gt;인증&lt;/strong&gt; 프로토콜로 &lt;strong&gt;잘못 사용&lt;/strong&gt;하는 케이스가 많았고, 이를 Pseudo-Authentication 이라고 부릅니다.&lt;/p&gt;
&lt;p&gt;페이스북, 트위터로 로그인하기 기능을 구현하는 API들을 보면, Access token을 바로 사용하여 Resource owner(페이스북, 트위터 등)로부터 값을 가져옵니다.&lt;/p&gt;
&lt;p&gt;이러한 방식은 문제가 있습니다. 사항은 아래와 같습니다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;유저 정보를 직접적으로 가져오는 API는 OAuth 2.0 표준에 존재하지 않습니다. OAuth 2.0은 처음부터 &lt;strong&gt;권한 부여&lt;/strong&gt; 프로토콜로 설계되었기 때문입니다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;인증&lt;/strong&gt;을 고려할 때는 “누가”, “언제”, “어떻게” 유저 자신임을 증명하는 것이기 때문에, 단순히 Access token만을 가지고 &lt;strong&gt;인증&lt;/strong&gt; 하는 것은 옳지 않습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이러한 문제를 해결하기 위해 OIDC가 등장하였고, 후술할 &lt;code class=&quot;language-text&quot;&gt;id_token&lt;/code&gt; 이라는 값을 인증으로 사용할 수 있습니다.&lt;/p&gt;
&lt;h2 id=&quot;용어소개&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9A%A9%EC%96%B4%EC%86%8C%EA%B0%9C&quot; aria-label=&quot;용어소개 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;용어소개&lt;/h2&gt;
&lt;p&gt;작성되지 않은 용어는 &lt;a href=&quot;https://openid.net/specs/openid-connect-core-1_0.html#Terminology&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;해당 링크&lt;/a&gt;를 참고해주시기 바랍니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Access Token
&lt;ul&gt;
&lt;li&gt;OAuth 2.0의 액세스 토큰을 의미합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Authentication
&lt;ul&gt;
&lt;li&gt;엔터티와 제시된 아이덴티티 간의 바인딩에서 충분한 신뢰를 얻기 위해 사용되는 프로세스입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;End-User
&lt;ul&gt;
&lt;li&gt;서비스를 이용하는 &lt;strong&gt;사람&lt;/strong&gt;을 의미합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;OpenID Connect Provider (OP)
&lt;ul&gt;
&lt;li&gt;인증, 인가 모두를 연관있는 Relying parties (RPs)에 제공합니다.&lt;/li&gt;
&lt;li&gt;이는 OIDC Provider(OP)일 수도 있고, 타 인증 제공처(IdP, Identity Provider. E.g., 외부 LDAP, WS-Federation, 등등)일 수도 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Relying Party(RP)
&lt;ul&gt;
&lt;li&gt;OpenID Provider로부터 받아온 End-User 인증과 클레임을 요구하는 OAuth 2.0 클라이언트 앱을 의미합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;UserInfo Endpoint
&lt;ul&gt;
&lt;li&gt;클라이언트가 액세스 토큰을 제공할 때 해당 권한 부여(Authorization Grant)가 나타내는 최종 사용자에 대한 권한 있는 정보를 반환하는 API 입니다.&lt;/li&gt;
&lt;li&gt;권한에 따라 보호받는 리소스값을 줍니다.&lt;/li&gt;
&lt;li&gt;이 엔드포인트는 &lt;code class=&quot;language-text&quot;&gt;https&lt;/code&gt; 로 서비스 해야합니다.&lt;/li&gt;
&lt;li&gt;포트, 경로, 쿼리 파라미터 컴포넌트는 포함될 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;대략적인-워크플로우-설명&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%8C%80%EB%9E%B5%EC%A0%81%EC%9D%B8-%EC%9B%8C%ED%81%AC%ED%94%8C%EB%A1%9C%EC%9A%B0-%EC%84%A4%EB%AA%85&quot; aria-label=&quot;대략적인 워크플로우 설명 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;대략적인 워크플로우 설명&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;+--------+                                   +--------+
|        |                                   |        |
|        |---------(1) AuthN Request--------&gt;|        |
|        |                                   |        |
|        |  +--------+                       |        |
|        |  |        |                       |        |
|        |  |  End-  |&amp;lt;--(2) AuthN &amp;amp; AuthZ--&gt;|        |
|        |  |  User  |                       |        |
|   RP   |  |        |                       |   OP   |
|        |  +--------+                       |        |
|        |                                   |        |
|        |&amp;lt;--------(3) AuthN Response--------|        |
|        |                                   |        |
|        |---------(4) UserInfo Request-----&gt;|        |
|        |                                   |        |
|        |&amp;lt;--------(5) UserInfo Response-----|        |
|        |                                   |        |
+--------+                                   +--------+&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;RP(클라이언트)가 OP(OpenID Provider)에 인증 요청을 보냅니다.&lt;/li&gt;
&lt;li&gt;OP가 (IdP 혹은 자기자신을 통해) End-User을 &lt;strong&gt;인증&lt;/strong&gt; 하고, 적당한 &lt;strong&gt;권한&lt;/strong&gt;을 부여합니다.
&lt;ol&gt;
&lt;li&gt;OP는 ID Token과 Access Token을 RP에 응답합니다.&lt;/li&gt;
&lt;li&gt;이때 ID Token[1]은 JWT를 사용합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;RP는 Access Token을 가지고 UserInfo Endpoint에 요청합니다.&lt;/li&gt;
&lt;li&gt;UserInfo Endpoint는 그 End-User에 대한 Claim을 리턴합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;설명을-풀어서-이해해봅시다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%84%A4%EB%AA%85%EC%9D%84-%ED%92%80%EC%96%B4%EC%84%9C-%EC%9D%B4%ED%95%B4%ED%95%B4%EB%B4%85%EC%8B%9C%EB%8B%A4&quot; aria-label=&quot;설명을 풀어서 이해해봅시다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;설명을 풀어서 이해해봅시다!&lt;/h3&gt;
&lt;p&gt;그렇다면 상기 내용을 모질라에서 제공하는 OIDC 다이어그램으로 다시 살펴봅시다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/e87b7799d999d5459562e5da330a61ac/77f8f/00_OIDC_diagram.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 57.91666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAABYlAAAWJQFJUiTwAAABXElEQVQoz31S24rCMBTs/3+KX+KbCAVNaG1NjSapTQq511wWDRTR3Z2HcMJhzmQmp4oxTtMkpcy/Ib1Qipyz1ppzvixL6VZCiMPhYIzJ/yKEoJRCCPV9jzF2zj3J1+u1ruu/lI0x3vsQwjiOQghK6TiOnHNr7ZN8Pp+PxyNCqDyswDmnlMIYN00DACCEFCmtNUKobVtCSEqpcs6904paGcw5b9vWe2+MKeaHYYAQAgC6rluWpWKMdV2HMZ7nefWWcxZCAADquu77njG2hvSOylrLOS/jc84xxlJorQkhjDFCiJTSe7+Gv35BtdvtNpvNdruNMRafEEIhxLvU4/EoRj6Vh2HY7/en00lKSSlljE3TRCktCcUYc87e+3L9JGutL5cLY+wjtnUxUkrW2u/uk5xSCiFIKbXW9gVjzP1+b9sWQtg0ze12U0p577/51YdU+WHxwjzP5VRK/bqCP+1OsblS02TKAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/e87b7799d999d5459562e5da330a61ac/8ac56/00_OIDC_diagram.webp 240w,
/static/e87b7799d999d5459562e5da330a61ac/d3be9/00_OIDC_diagram.webp 480w,
/static/e87b7799d999d5459562e5da330a61ac/e46b2/00_OIDC_diagram.webp 960w,
/static/e87b7799d999d5459562e5da330a61ac/87c73/00_OIDC_diagram.webp 1353w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/e87b7799d999d5459562e5da330a61ac/8ff5a/00_OIDC_diagram.png 240w,
/static/e87b7799d999d5459562e5da330a61ac/e85cb/00_OIDC_diagram.png 480w,
/static/e87b7799d999d5459562e5da330a61ac/d9199/00_OIDC_diagram.png 960w,
/static/e87b7799d999d5459562e5da330a61ac/77f8f/00_OIDC_diagram.png 1353w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/e87b7799d999d5459562e5da330a61ac/d9199/00_OIDC_diagram.png&quot;
            alt=&quot;OIDC 인증/인가와 관련한 도식&quot;
            title=&quot;OIDC 인증/인가와 관련한 도식&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;OIDC 인증/인가와 관련한 도식&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;OIDC는 웹 애플리케이션(여기선 RP를 의미)이 OIDC Provider (OP)로부터 유저 정보를 &lt;strong&gt;인증&lt;/strong&gt; 하는 기능을 제공하는 프로토콜 입니다. RP가 브라우저에 OP의 인증을 입력하는 로그인 폼을 제공하면&lt;code class=&quot;language-text&quot;&gt;(1)&lt;/code&gt;, OP는 인증을 수행하고&lt;code class=&quot;language-text&quot;&gt;(2)&lt;/code&gt; 성공시 유저 정보를 타 인증 제공처(IdP, Identity Provider)로부터 정보를 가지고옵니다&lt;code class=&quot;language-text&quot;&gt;(3)&lt;/code&gt;. 참고로 IdP는 유저의 인증정보와 유저 정보를 가지고 있는 데이터베이스를 의미합니다.&lt;/p&gt;
&lt;p&gt;OP와의 통신은 토큰을 사용하여 수행됩니다. ID token이란 값이 RP에 주어지는데, 이는 OP로부터 &lt;strong&gt;인증&lt;/strong&gt;을 완료하면 제공받습니다. 이 값은 JSON 으로 받으며 이 데이터 안에는 어떻게, 언제 인증을 완료하였는지와 필요한 어트리뷰트들, 그리고 인증의 만료기간은 언제까지인지 하는 정보들이 담겨있습니다. 이 토큰 또한 RP를 통해 갱신이 가능합니다. 이를 통해 유저와 각종 어트리뷰트들이 최신이자 유효한 값임을 확인시켜 줍니다.&lt;/p&gt;
&lt;p&gt;예를 들자면, ID token의 어트리뷰트 중 &lt;code class=&quot;language-text&quot;&gt;audience&lt;/code&gt;를 가지고 유효한 클라이언트에서 온 값인지 확인할 수도 있으며, ID token 내에 담긴 어트리뷰트를 통해서도 관련 정보를 확인할 수 있겠습니다.&lt;/p&gt;
&lt;p&gt;다른 Access token이나 Refresh token은 OAuth 2.0에서 쓰던 방식과 동일하게 사용하면 됩니다. OIDC는 OAuth 2.0 스펙에 인증을 추가하기 위한 기능이기 때문입니다.&lt;/p&gt;
&lt;h1 id=&quot;oidc-인증-과정&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#oidc-%EC%9D%B8%EC%A6%9D-%EA%B3%BC%EC%A0%95&quot; aria-label=&quot;oidc 인증 과정 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;OIDC 인증 과정&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;개요&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;OIDC는 인증을 수행하여 최종 사용자에 로그인하거나 최종 사용자가 이미 로그인했는지 확인합니다.&lt;/li&gt;
&lt;li&gt;OIDC는 서버에 의해 연산한 인증 결과를 클라이언트에게 보안규칙을 지켜서, 클라이언트가 이를 사용할 수 있도록 보냅니다.&lt;/li&gt;
&lt;li&gt;이런 이유로 클라이언트는 Relying Party(RP)를 호출합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;인증 결과&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;인증 결과로는 ID Token을 리턴합니다. ID Token엔 아래 클레임들이 포함됩니다
&lt;ul&gt;
&lt;li&gt;Issuer(식별자 발행인)&lt;/li&gt;
&lt;li&gt;Subject Identifier(개인 고유식별값)&lt;/li&gt;
&lt;li&gt;Authentication expires(토큰 만료기간)&lt;/li&gt;
&lt;li&gt;등등, REQUIRED 값들과 OPTIONAL 값들&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;인증 플로우&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;아래 인증 플로우를 따릅니다
&lt;ul&gt;
&lt;li&gt;Authorization Code Flow(&lt;code class=&quot;language-text&quot;&gt;response_type=code&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;Implicit Flow(&lt;code class=&quot;language-text&quot;&gt;response_type=id_token token&lt;/code&gt; 혹은 &lt;code class=&quot;language-text&quot;&gt;response_type=id_token&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;Hybrid Flow(&lt;a href=&quot;https://openid.net/specs/oauth-v2-multiple-response-types-1_0.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;OAuth 형식의 응답값&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;인증-과정의-플로우&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%B8%EC%A6%9D-%EA%B3%BC%EC%A0%95%EC%9D%98-%ED%94%8C%EB%A1%9C%EC%9A%B0&quot; aria-label=&quot;인증 과정의 플로우 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;인증 과정의 플로우&lt;/h2&gt;
&lt;p&gt;상세 요구사항까지는 들여다보지 않겠습니다. 다만 이 글은 이런 플로우로 흐름을 살펴보고자 합니다.&lt;/p&gt;
&lt;p&gt;OIDC의 다양한 플로우에 대한 상세한 설명은 &lt;a href=&quot;https://darutk.medium.com/diagrams-of-all-the-openid-connect-flows-6968e3990660&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 링크&lt;/a&gt;를 참고하시면 상당히 도움이 됩니다.&lt;/p&gt;
&lt;h3 id=&quot;authorization-code-flow&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#authorization-code-flow&quot; aria-label=&quot;authorization code flow permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Authorization Code Flow&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;클라이언트는 인증 Request를 원하는 리퀘스트 파라미터에 담아 보낼 준비를 합니다.&lt;/li&gt;
&lt;li&gt;클라이언트가 &lt;strong&gt;인가 서버&lt;/strong&gt;에 요청을 보냅니다.&lt;/li&gt;
&lt;li&gt;인가 서버가 엔드유저를 인증합니다.&lt;/li&gt;
&lt;li&gt;인가 서버는 엔드유저의 Consent와 인가를 획득합니다.&lt;/li&gt;
&lt;li&gt;인가 서버는 인증 코드와 함께 엔드유저를 클라이언트로 다시 보냅니다.&lt;/li&gt;
&lt;li&gt;클라이언트는 인가 코드를 사용하여 토큰 엔드포인트에 응답을 요청합니다.&lt;/li&gt;
&lt;li&gt;클라이언트는 응답 바디값에 ID 토큰과 액세스 토큰이 담긴 응답을 받습니다.&lt;/li&gt;
&lt;li&gt;클라이언트는 ID 토큰을 검증하고, 엔드 유저의 Subject Identifier를 획득합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;implicit-flow&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#implicit-flow&quot; aria-label=&quot;implicit flow permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Implicit Flow&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;클라이언트는 인증 Request를 원하는 리퀘스트 파라미터에 담아 보낼 준비를 합니다.&lt;/li&gt;
&lt;li&gt;클라이언트가 &lt;strong&gt;인가 서버&lt;/strong&gt;에 요청을 보냅니다.&lt;/li&gt;
&lt;li&gt;인가 서버가 엔드유저를 인증합니다.&lt;/li&gt;
&lt;li&gt;인가 서버는 엔드유저의 Consent와 인가를 획득합니다.&lt;/li&gt;
&lt;li&gt;인가 서버는, ID 토큰과 요청 시 액세스 토큰과 함께 엔드유저를 클라이언트로 다시 보냅니다.&lt;/li&gt;
&lt;li&gt;클라이언트는 ID 토큰을 검증하고, 엔드 유저의 Subject Identifier를 획득합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;hybrid-flow&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#hybrid-flow&quot; aria-label=&quot;hybrid flow permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Hybrid Flow&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;클라이언트는 인증 Request를 원하는 리퀘스트 파라미터에 담아 보낼 준비를 합니다.&lt;/li&gt;
&lt;li&gt;클라이언트가 &lt;strong&gt;인가 서버&lt;/strong&gt;에 요청을 보냅니다.&lt;/li&gt;
&lt;li&gt;인가 서버가 엔드유저를 인증합니다.&lt;/li&gt;
&lt;li&gt;인가 서버는 엔드유저의 Consent와 인가를 획득합니다.&lt;/li&gt;
&lt;li&gt;인가 서버는 인증 코드와, 응답 타입에 따라 하나 이상의 추가 파라미터를 담고 함께 엔드유저를 클라이언트로 다시 보냅니다.&lt;/li&gt;
&lt;li&gt;클라이언트는 인가 코드를 사용하여 토큰 엔드포인트에 응답을 요청합니다.&lt;/li&gt;
&lt;li&gt;클라이언트는 응답 바디값에 ID 토큰과 액세스 토큰이 담긴 응답을 받습니다.&lt;/li&gt;
&lt;li&gt;클라이언트는 ID 토큰을 검증하고, 엔드 유저의 Subject Identifier를 획득합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;oidc-시퀀스-다이어그램-살펴보기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#oidc-%EC%8B%9C%ED%80%80%EC%8A%A4-%EB%8B%A4%EC%9D%B4%EC%96%B4%EA%B7%B8%EB%9E%A8-%EC%82%B4%ED%8E%B4%EB%B3%B4%EA%B8%B0&quot; aria-label=&quot;oidc 시퀀스 다이어그램 살펴보기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;OIDC 시퀀스 다이어그램 살펴보기&lt;/h1&gt;
&lt;p&gt;마찬가지로, 모질라 재단에서 작성한 도식을 보고 이해해봅시다. 이해하기 위해, 상단에 먼저 작성한 &lt;a href=&quot;#%EB%8C%80%EB%9E%B5%EC%A0%81%EC%9D%B8-%EC%9B%8C%ED%81%AC%ED%94%8C%EB%A1%9C%EC%9A%B0-%EC%84%A4%EB%AA%85&quot;&gt;대략적인 워크플로우 설명&lt;/a&gt;을 활용해봅시다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/e75384ebc39dc3c4dfc9779e790af9ca/d5eae/01_OIDC_sequence_diagram.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 113.75%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB8UlEQVQ4y5WU127DMAxF8/+/l7c8ZCJ77x0WR8AxZNVFWwGELJm6vJytiIjT6RTb7TbJ8/kM1+FwiH6/H8PhMP3jfD6f4/F4xGazif1+H5/Ppzrvdrto8RDlyWSShAev1ysBs3O+XC5RLkh4j97xeEy6LSywAEBut1tS5idnrPPNHYyQHMwlTgX4fr+jaWF9NBpFt9uNXq+XvqfTaXKPf7keGBXg/X5PtI0V34iM2dGBMTuSkwAQrAoQFzqdTrTb7RiPx8k146dO6SKA/vsGCIPlcpkEZrAic4vFItbrdVyv14odO/q5Ib5rgLmyLgGCAcLAGRBdh71GNFCLoWXCJWLWBeIRZ93kjrDAHiHuNUAfAIrMZrOUzdVqldjI3tjlDdDossXMYwQgsytzwyH7smy+AWolDzZA1N5gMKjqD/d+LRsvysrnnjIyOcSNKtD9PwHmLLkHbD6fJ3aEwfD8i2HuMkODJAEGM+8bAfOHeQd4djSZLKTUqQHygCA7D8munWKplCUigTJ5CdCaAsDhAChCH9MNAFufllBTI6TC1gKuCEbMKBFcNbPOQ6e208gwcI83teFAFhGB7RQHbs6oLJvK5TIpeZBtel3P3bSXnVBVL0ObAw1u7Cxe48oOoG2osTKGiaF9KQtBOMvop/pscvkLB4cFLmHxcOcAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/e75384ebc39dc3c4dfc9779e790af9ca/8ac56/01_OIDC_sequence_diagram.webp 240w,
/static/e75384ebc39dc3c4dfc9779e790af9ca/d3be9/01_OIDC_sequence_diagram.webp 480w,
/static/e75384ebc39dc3c4dfc9779e790af9ca/e46b2/01_OIDC_sequence_diagram.webp 960w,
/static/e75384ebc39dc3c4dfc9779e790af9ca/3dc6e/01_OIDC_sequence_diagram.webp 1407w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/e75384ebc39dc3c4dfc9779e790af9ca/8ff5a/01_OIDC_sequence_diagram.png 240w,
/static/e75384ebc39dc3c4dfc9779e790af9ca/e85cb/01_OIDC_sequence_diagram.png 480w,
/static/e75384ebc39dc3c4dfc9779e790af9ca/d9199/01_OIDC_sequence_diagram.png 960w,
/static/e75384ebc39dc3c4dfc9779e790af9ca/d5eae/01_OIDC_sequence_diagram.png 1407w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/e75384ebc39dc3c4dfc9779e790af9ca/d9199/01_OIDC_sequence_diagram.png&quot;
            alt=&quot;AuthN Sequence w/ OIDC&quot;
            title=&quot;AuthN Sequence w/ OIDC&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;AuthN Sequence w/ OIDC&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;(추가됨)&lt;/strong&gt; 인증 전 단계입니다.
&lt;ol&gt;
&lt;li&gt;End-User가 브라우저를 통해 RP에 접속합니다. RP는 OP의 &lt;code class=&quot;language-text&quot;&gt;.well-known/openid-configuration&lt;/code&gt; 을 호출합니다.&lt;/li&gt;
&lt;li&gt;JSON 데이터를 받습니다. 이때 OIDC 프로토콜에 사용되는 엔드포인트의 메타데이터를 받습니다(&lt;a href=&quot;https://zetawiki.com/wiki/OpenID_%EB%94%94%EC%8A%A4%EC%BB%A4%EB%B2%84%EB%A6%AC_%EC%97%94%EB%93%9C%ED%8F%AC%EC%9D%B8%ED%8A%B8_/.well-known/openid-configuration&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 링크&lt;/a&gt;를 참고해주세요).
&lt;ol&gt;
&lt;li&gt;이를테면, &lt;code class=&quot;language-text&quot;&gt;token_endpoint&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;authorizaion_endpoint&lt;/code&gt; 등을 받습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;OP의 &lt;code class=&quot;language-text&quot;&gt;authorize&lt;/code&gt; 엔드포인트로 리디렉션을 수행합니다.
&lt;ol&gt;
&lt;li&gt;이 때 보안 취약점을 방지하기 위한 값들과 &lt;code class=&quot;language-text&quot;&gt;redirect_url&lt;/code&gt; 값과 &lt;code class=&quot;language-text&quot;&gt;response_code&lt;/code&gt;, 그리고 클라이언트 고유 식별값 등을 제공받고, End-User의 브라우저는 이를 리디렉션 처리합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;로그인 페이지를 받아봅니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;RP(클라이언트)가 OP(OpenID Provider)에 &lt;strong&gt;인증&lt;/strong&gt; 요청을 보냅니다.&lt;/li&gt;
&lt;li&gt;OP가 (IdP 혹은 자기자신을 통해) End-User을 &lt;strong&gt;인증&lt;/strong&gt; 하고, &lt;strong&gt;(상세과정 추가됨)&lt;/strong&gt; 적당한 &lt;strong&gt;권한&lt;/strong&gt;을 부여합니다.
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;callback&lt;/code&gt; 엔드포인트를 통해 &lt;code class=&quot;language-text&quot;&gt;state&lt;/code&gt; 값와 &lt;code class=&quot;language-text&quot;&gt;code&lt;/code&gt; 필드를 요청하도록 End-User의 브라우저가 RP에 리디렉션 처리할 수 있도록 합니다.&lt;/li&gt;
&lt;li&gt;RP는 토큰 요청을 수행합니다.&lt;/li&gt;
&lt;li&gt;OP는 ID Token과 Access Token을 RP에 응답합니다.
&lt;ol&gt;
&lt;li&gt;이때 ID Token[1]은 JWT를 사용합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;토큰이 유효한지, OP에 의해 서명된 것인지 확인합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;(도식에 표현되어있지 않음)&lt;/strong&gt; RP는 Access Token을 가지고 UserInfo Endpoint에 요청합니다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;(도식에 표현되어있지 않음)&lt;/strong&gt; UserInfo Endpoint는 그 End-User에 대한 Claim을 리턴합니다.&lt;/li&gt;
&lt;li&gt;세션 만료 시, RP는 URL에 &lt;code class=&quot;language-text&quot;&gt;prompt=none&lt;/code&gt; 값을 추가하고 OP에 요청합니다.&lt;/li&gt;
&lt;li&gt;유저에 대해 &lt;strong&gt;재인증&lt;/strong&gt;을 수행합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;oidc-사용-시-보안-점검사항&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#oidc-%EC%82%AC%EC%9A%A9-%EC%8B%9C-%EB%B3%B4%EC%95%88-%EC%A0%90%EA%B2%80%EC%82%AC%ED%95%AD&quot; aria-label=&quot;oidc 사용 시 보안 점검사항 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;OIDC 사용 시 보안 점검사항&lt;/h1&gt;
&lt;h2 id=&quot;세션-관리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%84%B8%EC%85%98-%EA%B4%80%EB%A6%AC&quot; aria-label=&quot;세션 관리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;세션 관리&lt;/h2&gt;
&lt;p&gt;OIDC의 OP는 일반적으로 유저의 세션쿠키를 생성합니다. 따라서 웹 애플리케이션(RP)에서 너무 자주 사용자에게 자격 증명을 다시 요청할 필요가 없습니다. 세션 만료는 OP가 세션을 설정하는 방법에 따라 다르며 쿠키가 사용자의 브라우저에 표시되는 것보다 빨리 OpenID Connect 공급자(OP)에 의해 세션이 강제로 만료될 수 있습니다. 이를 통해 OP는 OP 관점에서 사용자를 강제로 로그아웃시킬 수 있습니다. 그러나 OP와의 사용자 세션 조기 종료는 사용자가 로그인한 웹 애플리케이션(RP)에서 사용자 세션을 종료하지 않습니다.&lt;/p&gt;
&lt;p&gt;이러한 이유로 RP는 세션 관리에 대해 아래 규칙을 지키는 것이 매우 중요합니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;RP는 유저세션을 &lt;code class=&quot;language-text&quot;&gt;exp&lt;/code&gt; 값이 곧 다가오거나 지난다면, 유저의 세션을 &lt;strong&gt;반드시&lt;/strong&gt; 비활성화 해야합니다.&lt;/li&gt;
&lt;li&gt;만약 유저세션의 길이가 &lt;code class=&quot;language-text&quot;&gt;15분&lt;/code&gt;을 넘는다면, 매 15분 혹은 다음 요청때마다, 어느쪽 먼저 되든지 간에 &lt;strong&gt;반드시&lt;/strong&gt; ID token을 재점검 혹은 업데이트 해야합니다. 이를 통해 유저가 여전히 유효한지, 적합한 &lt;strong&gt;권한&lt;/strong&gt;을 가지고있는지 확인합니다.
&lt;ol&gt;
&lt;li&gt;OpenID Connect 공급자(OP)에 의해 사용자 계정이 비활성화된 경우 15분 이내에 액세스 권한이 취소될 수 있습니다.&lt;/li&gt;
&lt;li&gt;유저에 대해 새 ID 토큰과 어트리뷰트를 발급받을 수 있습니다.&lt;/li&gt;
&lt;li&gt;ID 토큰의 만료시간을 갱신할 수 있습니다.&lt;/li&gt;
&lt;li&gt;OIDC &lt;code class=&quot;language-text&quot;&gt;authorize&lt;/code&gt; 엔드포인트 호출 시 &lt;code class=&quot;language-text&quot;&gt;prompt=none&lt;/code&gt; 파라미터로 처리할 수 있습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;추가-고려사항&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%B6%94%EA%B0%80-%EA%B3%A0%EB%A0%A4%EC%82%AC%ED%95%AD&quot; aria-label=&quot;추가 고려사항 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;추가 고려사항&lt;/h2&gt;
&lt;h3 id=&quot;id-토큰에-대해&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#id-%ED%86%A0%ED%81%B0%EC%97%90-%EB%8C%80%ED%95%B4&quot; aria-label=&quot;id 토큰에 대해 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;ID 토큰에 대해&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;토큰 시그니처에 대해 &lt;strong&gt;언제나&lt;/strong&gt; 유효한지 확인하십시오.&lt;/li&gt;
&lt;li&gt;ID 토큰의 유효기간이 지난 토큰은 &lt;strong&gt;언제나&lt;/strong&gt; 비활성화 하십시오.&lt;/li&gt;
&lt;li&gt;토큰 만료 전 OP에 주기적으로 쿼리하여 ID 토큰의 컨텐츠를 업데이트 하십시오.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;authorization-code-grant&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#authorization-code-grant&quot; aria-label=&quot;authorization code grant permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Authorization code grant&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Front channel, Back channel 을 구별하여 구현하기를 권장합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;HttpOnly&lt;/code&gt; 세션 쿠키를 유저에게 전달하기를 권장합니다.&lt;/li&gt;
&lt;li&gt;Authorization code가 탈취당하는 케이스를 방지하기 위해, &lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc7636&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;PKCE&lt;/a&gt;를 도입하여 추가 챌린지를 수행할 것을 권장합니다. &lt;a href=&quot;https://oauth.net/2/pkce/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;참고링크 또한 읽어보세요&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;SPA 및 기본 애플리케이션은 리버스 엔지니어링에 취약합니다. SPA의 경우 애플리케이션의 소스 코드를 브라우저에서 사용할 수 있습니다.
&lt;ul&gt;
&lt;li&gt;네이티브 앱은 디컴파일할 수 있습니다.&lt;/li&gt;
&lt;li&gt;이러한 이유로 SPA 및 기본 애플리케이션은 클라이언트 자격 증명(특히 클라이언트 암호)을 안전하게 저장할 수 없습니다.&lt;/li&gt;
&lt;li&gt;이러한 이유로 퍼블릭 클라이언트로 간주됩니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;참고) OAuth 2.1 드래프트에는 Authorization code grant 사용 시, “반드시” 사용하도록 되어있다고 합니다.&lt;/li&gt;
&lt;li&gt;참고2) PKCE 또한 &lt;strong&gt;인증&lt;/strong&gt; 을 대체하는 로직이 아님에 유의하십시오!&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;implicit-grant&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#implicit-grant&quot; aria-label=&quot;implicit grant permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Implicit grant&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;가급적이면 해당 방안을 구현하지 않는 편을 권장합니다.&lt;/li&gt;
&lt;li&gt;Implicit grant는 Single Page Application(SPA)에 자주 쓰입니다.
&lt;ul&gt;
&lt;li&gt;서버단에 주기적으로 호출하지 않고 웹 브라우저 쿠키에 획득한 토큰을 보관하려 하지 마십시오.&lt;/li&gt;
&lt;li&gt;웹 브라우저가 이러한 정보를 담는다면 XSS와 CSRF에 취약할 수 있습니다.&lt;/li&gt;
&lt;li&gt;브라우저의 스토리지에 보관하지 말고 가급적 메모리에 보관하십시오.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Authorization code grant의 경우, 모든 요청이 적절한지 검증을 수행하기 때문에 이러한 문제를 해결할 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;state-파라미터-사용&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#state-%ED%8C%8C%EB%9D%BC%EB%AF%B8%ED%84%B0-%EC%82%AC%EC%9A%A9&quot; aria-label=&quot;state 파라미터 사용 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;state&lt;/code&gt; 파라미터 사용&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;CSRF 공격을 방지하기 위해 &lt;strong&gt;언제나&lt;/strong&gt; &lt;code class=&quot;language-text&quot;&gt;state&lt;/code&gt; 파라미터를 사용하시길 권장합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;refresh-token&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#refresh-token&quot; aria-label=&quot;refresh token permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Refresh token&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Refresh token은 RP 단(클라이언트)에서 연산되게 관리하십시오.&lt;/li&gt;
&lt;li&gt;웹 브라우저가 직접 받고 처리하지 않도록 관리하십시오.&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;마무리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%88%EB%AC%B4%EB%A6%AC&quot; aria-label=&quot;마무리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;마무리&lt;/h1&gt;
&lt;p&gt;이번 글을 통해, 아래 내용들을 살펴볼 수 있었습니다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;OIDC는 OAuth 2.0에서 어떤 식의 발전을 이루었는지 살펴볼 수 있었습니다.&lt;/li&gt;
&lt;li&gt;OIDC의 주요 플로우를 살펴보고, OIDC 구현 시 주요하게 살펴보아야 할 주의사항에 대해 확인할 수 있었습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;작성하며 많은 헷갈렸던 부분들이 정리되어 매우 기쁘게 생각합니다. 이 글을 읽으시는 여러분들께도 부디 도움이 되길 바랍니다.&lt;/p&gt;
&lt;p&gt;읽어주셔서 감사합니다.&lt;/p&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;References
&lt;ul&gt;
&lt;li&gt;[1] &lt;a href=&quot;https://infosec.mozilla.org/guidelines/iam/openid_connect.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;OIDC의 전체 플로우를 이해하는데 큰 도움이 되었습니다&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;[2] &lt;a href=&quot;https://nordicapis.com/what-is-openid-connect/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;OIDC 개념을 잡는데 큰 도움이 되었습니다&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;[3] &lt;a href=&quot;https://6991httam.medium.com/oauth%EB%9E%80-%EA%B7%B8%EB%A6%AC%EA%B3%A0-openid-8c46a65616e6&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;OIDC의 보안 위험성 mitigation 뿐 아니라 기존 OAuth 2.0의 pseudo-authentication 이란 개념을 명확히 이해하는데 도움이 되었습니다&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;[4] &lt;a href=&quot;https://swalloow.github.io/social-api-cognito/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;OAuth 2.0의 Serverless + Cognito 구현 방안에 대해 알 수 있었습니다&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;[5] &lt;a href=&quot;https://medium.com/@robert.broeckelmann/when-to-use-which-oauth2-grants-and-oidc-flows-ec6a5c00d864&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;언제 OAuth 2.0을 쓰고 OIDC를 써야할지, 그리고 OAuth 2.1 드래프트를 살펴보며 어떤 식의 변화와 차이점에 주목해야 할지 알 수 있었습니다&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[인가를 다시 살펴보다 (1) OAuth 2.0 개요와 프로토콜 소개]]></title><description><![CDATA[API 서비스가 많이 나누어졌을 때, 인가에 대해 살펴보며 **인가** 에 사용되는 OAuth 2.0 스펙을 알아봅시다.]]></description><link>https://blog.s3ich4n.me/devlog/backend/2022-10-16-considering-authn-and-authz-revisited-pt01</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/backend/2022-10-16-considering-authn-and-authz-revisited-pt01</guid><pubDate>Sun, 16 Oct 2022 21:50:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;연재-안내&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%97%B0%EC%9E%AC-%EC%95%88%EB%82%B4&quot; aria-label=&quot;연재 안내 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;연재 안내&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;인가를 다시 살펴보다 (1)&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/devlog/backend/2022-10-17-considering-authn-and-authz-revisited-pt02&quot;&gt;인가를 다시 살펴보다 (2)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;들어가며&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0&quot; aria-label=&quot;들어가며 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;들어가며&lt;/h1&gt;
&lt;p&gt;필요한 API 서비스를 나누고 서비스의 규모가 커지면, 인증과 인가에 대해 구조적으로 돌아보게 됩니다. 그러면서 자연스럽게 SSO(IdP, SP)나 OAuth 2.0, OpenID Connect 같은 큰 개념을 돌아보게 되고, 어떻게 이를 위임하거나 전파할지를 구상하게 됩니다.&lt;/p&gt;
&lt;h1 id=&quot;single-sign-onsso-이란&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#single-sign-onsso-%EC%9D%B4%EB%9E%80&quot; aria-label=&quot;single sign onsso 이란 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Single-sign On(SSO) 이란?&lt;/h1&gt;
&lt;p&gt;단일 로그인입니다. 자기 서비스에 한번만 로그인 하면, 연관있는 다른 “서비스”를 로그인 없이 이용할 수 있게 하는 것이지요. 사용자에게는 여러 서비스를 한번에 쓸 수 있게끔 세팅해주는 것이고, 뒷단에서는 각 서비스에 대해 별도 인증시스템을 따로 꾸리지 않으며 사용자 접근관리를 하도록 합니다.&lt;/p&gt;
&lt;h2 id=&quot;sso-구현-모델에-대해&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#sso-%EA%B5%AC%ED%98%84-%EB%AA%A8%EB%8D%B8%EC%97%90-%EB%8C%80%ED%95%B4&quot; aria-label=&quot;sso 구현 모델에 대해 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;SSO 구현 모델에 대해&lt;/h2&gt;
&lt;p&gt;SSO를 구현하는 구현모델 및 기법을 살펴봅시다. 여기서는 제가 이해한 모델에 대해서 기술하겠습니다.&lt;/p&gt;
&lt;h3 id=&quot;delegation-model&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#delegation-model&quot; aria-label=&quot;delegation model permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Delegation model&lt;/h3&gt;
&lt;p&gt;SSO 에이전트가 중앙에서 인증을 대행합니다.
대상 애플리케이션의 인증방식을 변경하기 어려울 때 서비스에 일일이 붙여주는 방식으로 사용합니다.
사용자의 인증 정보를 SSO 에이전트가 관리합니다(SPOF가 될 수 있겠지요).&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 945px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/549e80f403be0429f455ef576795da7a/0ede0/00_SSO_delegation_diagram.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIDBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHuRsIWT//EABgQAQEAAwAAAAAAAAAAAAAAAAERAhIg/9oACAEBAAEFAlhtcTj/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAWEAEBAQAAAAAAAAAAAAAAAAAA4SD/2gAIAQEABj8CVcf/xAAcEAEAAQQDAAAAAAAAAAAAAAABEQAQIUExUWH/2gAIAQEAAT8hVFAj2sJkM6ouc7sg6t//2gAMAwEAAgADAAAAEKj/AP/EABURAQEAAAAAAAAAAAAAAAAAABBB/9oACAEDAQE/EIf/xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAgEBPxBX/8QAHRABAAICAgMAAAAAAAAAAAAAAQARQVEhMYGRsf/aAAgBAQABPxAP1k8fkXgU6T3Usy+SIJSCaYAUANBKn//Z&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/549e80f403be0429f455ef576795da7a/8ac56/00_SSO_delegation_diagram.webp 240w,
/static/549e80f403be0429f455ef576795da7a/d3be9/00_SSO_delegation_diagram.webp 480w,
/static/549e80f403be0429f455ef576795da7a/a70f5/00_SSO_delegation_diagram.webp 945w&quot;
              sizes=&quot;(max-width: 945px) 100vw, 945px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/549e80f403be0429f455ef576795da7a/09b79/00_SSO_delegation_diagram.jpg 240w,
/static/549e80f403be0429f455ef576795da7a/7cc5e/00_SSO_delegation_diagram.jpg 480w,
/static/549e80f403be0429f455ef576795da7a/0ede0/00_SSO_delegation_diagram.jpg 945w&quot;
            sizes=&quot;(max-width: 945px) 100vw, 945px&quot;
            type=&quot;image/jpeg&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/549e80f403be0429f455ef576795da7a/0ede0/00_SSO_delegation_diagram.jpg&quot;
            alt=&quot;Delegation model의 도식&amp;lt;br /&amp;gt;(출처: https://itwiki.kr/w/SSO)&quot;
            title=&quot;Delegation model의 도식&amp;lt;br /&amp;gt;(출처: https://itwiki.kr/w/SSO)&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;Delegation model의 도식&lt;br /&gt;(출처: &lt;a href=&quot;https://itwiki.kr/w/SSO&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://itwiki.kr/w/SSO&lt;/a&gt;)&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&quot;propagation-model&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#propagation-model&quot; aria-label=&quot;propagation model permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Propagation model&lt;/h3&gt;
&lt;p&gt;통합인증 서비스에서 인증을 수행하고 인증 토큰을 받아옵니다.
서비스 접근 시, 인증토큰을 서비스에 전달하고, 이를 가지고 사용자를 확인할 수 있는 구조입니다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 945px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/9a847bcbd3eac8d49d838fb23932f7f9/0ede0/00_SSO_propagation_diagram.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIDBAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHtz0SRxgf/xAAYEAADAQEAAAAAAAAAAAAAAAAAAQIRMf/aAAgBAQABBQLWKSViJ6f/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAWEAEBAQAAAAAAAAAAAAAAAAABEAD/2gAIAQEABj8CzWf/xAAYEAEBAQEBAAAAAAAAAAAAAAABEQAgof/aAAgBAQABPyFRgIGFlH3DI4//2gAMAwEAAgADAAAAEOTP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQIBAT8QJ//EABoQAQEAAwEBAAAAAAAAAAAAAAERABAhMbH/2gAIAQEAAT8QZoCLOuImxedH1yb0Let0QkHuv//Z&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/9a847bcbd3eac8d49d838fb23932f7f9/8ac56/00_SSO_propagation_diagram.webp 240w,
/static/9a847bcbd3eac8d49d838fb23932f7f9/d3be9/00_SSO_propagation_diagram.webp 480w,
/static/9a847bcbd3eac8d49d838fb23932f7f9/a70f5/00_SSO_propagation_diagram.webp 945w&quot;
              sizes=&quot;(max-width: 945px) 100vw, 945px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/9a847bcbd3eac8d49d838fb23932f7f9/09b79/00_SSO_propagation_diagram.jpg 240w,
/static/9a847bcbd3eac8d49d838fb23932f7f9/7cc5e/00_SSO_propagation_diagram.jpg 480w,
/static/9a847bcbd3eac8d49d838fb23932f7f9/0ede0/00_SSO_propagation_diagram.jpg 945w&quot;
            sizes=&quot;(max-width: 945px) 100vw, 945px&quot;
            type=&quot;image/jpeg&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/9a847bcbd3eac8d49d838fb23932f7f9/0ede0/00_SSO_propagation_diagram.jpg&quot;
            alt=&quot;Propagation model의 도식&amp;lt;br /&amp;gt;(출처: https://itwiki.kr/w/SSO)&quot;
            title=&quot;Propagation model의 도식&amp;lt;br /&amp;gt;(출처: https://itwiki.kr/w/SSO)&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;Propagation model의 도식&lt;br /&gt;(출처: &lt;a href=&quot;https://itwiki.kr/w/SSO&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://itwiki.kr/w/SSO&lt;/a&gt;)&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;h1 id=&quot;oauth-20이란&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#oauth-20%EC%9D%B4%EB%9E%80&quot; aria-label=&quot;oauth 20이란 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;OAuth 2.0이란?&lt;/h1&gt;
&lt;p&gt;유저에게 자신, 타인의 리소스에 접근할 수 있는 &lt;strong&gt;권한을 토큰으로 부여&lt;/strong&gt; 하는 프로토콜(&lt;a href=&quot;https://tools.ietf.org/html/rfc6749&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;RFC 6749&lt;/a&gt;)입니다.&lt;/p&gt;
&lt;h2 id=&quot;oauth-20의-특징&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#oauth-20%EC%9D%98-%ED%8A%B9%EC%A7%95&quot; aria-label=&quot;oauth 20의 특징 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;OAuth 2.0의 특징&lt;/h2&gt;
&lt;p&gt;OAuth 2.0은 인증 성공시 제한된 권한을 가진 &lt;strong&gt;Access Token&lt;/strong&gt;과, 이를 갱신하는 &lt;strong&gt;Refresh Token&lt;/strong&gt;을 동시에 발급받습니다. 이를 통해 유저별로 다양한 서비스에 대해 필요한 권한을 부여할 수 있습니다.&lt;/p&gt;
&lt;p&gt;이처럼 권한을 부여하고 토큰을 관리하는 구조를 이해하는 것이 &lt;strong&gt;OAuth 2.0의 핵심&lt;/strong&gt; 입니다.&lt;/p&gt;
&lt;h2 id=&quot;oauth-20의-주요-용어&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#oauth-20%EC%9D%98-%EC%A3%BC%EC%9A%94-%EC%9A%A9%EC%96%B4&quot; aria-label=&quot;oauth 20의 주요 용어 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;OAuth 2.0의 주요 용어&lt;/h2&gt;
&lt;p&gt;OAuth 2.0을 이해하기에 앞서, 용어를 정리해봅시다.&lt;/p&gt;
&lt;h3 id=&quot;역할에-대해&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%97%AD%ED%95%A0%EC%97%90-%EB%8C%80%ED%95%B4&quot; aria-label=&quot;역할에 대해 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;역할에 대해&lt;/h3&gt;
&lt;p&gt;OAuth 2.0을 구성하고 있는 주요 4가지 객체(Roles)는 다음과 같습니다. 이 글을 기술하며, 아래의 상황을 가정합시다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;“나”는, “파이어폭스”로 “가나다” 서비스에서 “곰곰”이라는 서비스에 접근하는 권한을 주려합니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Resource owner&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Resource Server(후술할 서버)의 데이터의 주인, 즉 “나” 입니다(참고: 개인 뿐 아니라 회사 단위일 수도 있습니다).&lt;/li&gt;
&lt;li&gt;각자의 계정을 가지고 있지요.&lt;/li&gt;
&lt;li&gt;정보에 접근할 수 있는 범위(scope)를 스스로 지정합니다.
&lt;ul&gt;
&lt;li&gt;외부 Resource Server에 어떤 행동을 할지에 대한 권한을 부여합니다.&lt;/li&gt;
&lt;li&gt;read, write 뿐 아니라 다른 권한 또한 주고 빼고를 결정할 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Resource server&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;일반 사용자(Resouce owner)의 정보를 가지고있는 API 서버입니다. 즉 “곰곰”이라는 서비스의 서버지요.&lt;/li&gt;
&lt;li&gt;Access token을 사용하여 요청을 수신할 때, 권한을 검증한 후 적절한 결과를 응답합니다.
&lt;ul&gt;
&lt;li&gt;권한이 있으면 값을 주고, 아니면 401이나 403을 리턴하겠죠.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Client&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Resource owner&lt;/code&gt;가 리소스에 접근하는 애플리케이션을 의미합니다. “가나다” 서비스에 접근하는 “파이어폭스” 이자, “가나다” 서비스 내부의 비밀정보를 저장하는 프로그램을 의미합니다.&lt;/li&gt;
&lt;li&gt;참고로, 이는 클라이언트는 노출될 수도, 내부에 존재할 수도 있습니다.
&lt;ul&gt;
&lt;li&gt;Confidential Client(이하 내부 클라이언트)는 사용자가 직접 관리할 수 없는 공간에 있습니다.&lt;/li&gt;
&lt;li&gt;Public Client(이하 외부 클라이언트)는 브라우저, 모바일 앱, IoT 디바이스입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;참고. Client 등록은 앱에 접근하기 위한 자격을 얻는 것을 의미합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Authorization server&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;OAuth 2.0 프레임워크가 구현된 &lt;strong&gt;권한 부여&lt;/strong&gt; 처리용 서버입니다. “가나다” 서비스의 OAuth 2.0 처리서버를 의미합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Resource owner&lt;/code&gt;를 인증한 후, Client에 대해 적절한 권한을 부여해줍니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Access token&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;Refresh token&lt;/code&gt;를 발급합니다.
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Access token&lt;/code&gt;에는 각종 권한과 유효기간 등 주요정보가 들어가있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;토큰에-대해&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%86%A0%ED%81%B0%EC%97%90-%EB%8C%80%ED%95%B4&quot; aria-label=&quot;토큰에 대해 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;토큰에 대해&lt;/h3&gt;
&lt;p&gt;OAuth 2.0에서 “토큰”이란 아래와 같은 두 가지가 있습니다. 토큰을 어떤 스펙으로 정해야 하는지는 정해져있진 않습니다만, 주로 &lt;code class=&quot;language-text&quot;&gt;JWT&lt;/code&gt;를 사용합니다.&lt;/p&gt;
&lt;h4 id=&quot;access-token&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#access-token&quot; aria-label=&quot;access token permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;Access token&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;Access token의 주요 특징은 아래와 같습니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;보호된 리소스에 접근하기 위해 필요한 토큰입니다.&lt;/li&gt;
&lt;li&gt;살아있는 기간이 짧습니다. 보통 시간단위나 분단위입니다.&lt;/li&gt;
&lt;li&gt;외부 클라이언트가 사용합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Access Token&lt;/code&gt; 만료시 &lt;code class=&quot;language-text&quot;&gt;Refresh Token&lt;/code&gt;으로 갱신합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;refresh-token&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#refresh-token&quot; aria-label=&quot;refresh token permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;Refresh token&lt;/code&gt;&lt;/h4&gt;
&lt;p&gt;Refresh token의 주요 특징은 아래와 같습니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;유효기간이 지나 만료된 &lt;code class=&quot;language-text&quot;&gt;Access token&lt;/code&gt; 을 갱신하기 위한 토큰입니다.&lt;/li&gt;
&lt;li&gt;보통 일간, 월간, 연간 단위로 살아있을 수 있습니다.&lt;/li&gt;
&lt;li&gt;외부 클라이언트가 &lt;strong&gt;인증&lt;/strong&gt;을 하여 획득합니다.&lt;/li&gt;
&lt;li&gt;갱신될 수 없으며, 유효기간이 만료되면 재로그인을 수행해야 합니다.&lt;/li&gt;
&lt;li&gt;“삭제(revoke)“가 가능하며, 그러면 더이상 &lt;strong&gt;권한 부여&lt;/strong&gt;를 하지 않게 됩니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Refresh token에 담긴 주요 리소스들을 살펴보도록 합시다.&lt;/p&gt;
&lt;h3 id=&quot;토큰과-연관된-엔드포인트&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%86%A0%ED%81%B0%EA%B3%BC-%EC%97%B0%EA%B4%80%EB%90%9C-%EC%97%94%EB%93%9C%ED%8F%AC%EC%9D%B8%ED%8A%B8&quot; aria-label=&quot;토큰과 연관된 엔드포인트 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;토큰과 연관된 엔드포인트&lt;/h3&gt;
&lt;p&gt;이 토큰은 &lt;strong&gt;인증 서버&lt;/strong&gt;로부터 받아옵니다. 관련 엔드포인트는 &lt;code class=&quot;language-text&quot;&gt;authorize&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;token&lt;/code&gt; 이라는 두 개의 엔드포인트를 일컫습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;token&lt;/code&gt; 엔드포인트
&lt;ul&gt;
&lt;li&gt;상기 &lt;code class=&quot;language-text&quot;&gt;authorize&lt;/code&gt; 엔드포인트에 성공적으로 응답을 받고, &lt;code class=&quot;language-text&quot;&gt;Access token&lt;/code&gt; 과 &lt;code class=&quot;language-text&quot;&gt;Refresh token&lt;/code&gt; 을 받습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;authorize&lt;/code&gt; 엔드포인트
&lt;ul&gt;
&lt;li&gt;사용자로부터 동의 및 권한 부여, 유저에 대한 &lt;strong&gt;권한 정보&lt;/strong&gt;를 받기 위해 이동하는 곳입니다.&lt;/li&gt;
&lt;li&gt;“나”는 “가나다” 서비스로부터 “권한부여를 허용하시겠어요?” 와 같은 메시지를 받습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;introspect&lt;/code&gt; 엔드포인트
&lt;ul&gt;
&lt;li&gt;Authorization Server가 Resource server에 접근하기 위해, &lt;code class=&quot;language-text&quot;&gt;token&lt;/code&gt; 엔드포인트로부터 받은 토큰을 물어보는 과정입니다.&lt;/li&gt;
&lt;li&gt;“가나다” 서비스가 “곰곰” 서비스에 물어본다고 할 수 있지요.&lt;/li&gt;
&lt;li&gt;“나”가 “파이어폭스”로 직접 해당 서비스를 호출할 수도 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;revoke&lt;/code&gt; 엔드포인트
&lt;ul&gt;
&lt;li&gt;사용하지 않을 &lt;code class=&quot;language-text&quot;&gt;Refresh token&lt;/code&gt;을 “만료시키는” 엔드포인트 입니다. 유저가 특정 앱에 대해 권한을 주지 않음을 명시할 때 호출합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;획득한 Access token으로 API에 접근할 때 사용하며, 만료되면 내부 클라이언트가 Refresh token을 가지고 Access token을 갱신합니다.&lt;/p&gt;
&lt;h1 id=&quot;oauth-20의-작동방식&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#oauth-20%EC%9D%98-%EC%9E%91%EB%8F%99%EB%B0%A9%EC%8B%9D&quot; aria-label=&quot;oauth 20의 작동방식 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;OAuth 2.0의 작동방식&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;아래 내용을 시행하기에 앞서, 클라이언트는 자신의 서비스에 먼저 “로그인” 한 것을 가정한 것으로 이해하시면 됩니다. 저는 RFC 문서 상의 2.3. Client Authentication 을 보고 이를 판단했습니다:&lt;/p&gt;
&lt;p&gt;If the client type is confidential, the client and authorization server establish a client authentication method suitable for the security requirements of the authorization server. The authorization server MAY accept any form of client authentication meeting its security requirements. (후략)&lt;/p&gt;
&lt;p&gt;그 후에 추가적인 “인가” 를 받고(OAuth 2.0) Resource Server에 통신하거나, 추가적인 “인증”, “인가” 를 모두 받고(OpenID Connect) Resource Server와 통신하는 것으로 이해하시면 됩니다.&lt;/p&gt;
&lt;p&gt;상세한 내용은 후술하겠습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;OAuth 2.0의 전체 프레임워크의 가장 기본적인 Flow는 다음과 같습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;          +--------+                               +---------------+
          |        |--(A)- Authorization Request -&gt;|   Resource    |
          |        |                               |     Owner     |
          |        |&amp;lt;-(B)-- Authorization Grant ---|               |
          |        |                               +---------------+
          |        |
          |        |                               +---------------+
          |        |--(C)-- Authorization Grant --&gt;| Authorization |
          | Client |                               |     Server    |
          |        |&amp;lt;-(D)----- Access Token -------|               |
          |        |                               +---------------+
          |        |
          |        |                               +---------------+
          |        |--(E)----- Access Token ------&gt;|    Resource   |
          |        |                               |     Server    |
          |        |&amp;lt;-(F)--- Protected Resource ---|               |
          +--------+                               +---------------+

                          Figure 1: Abstract Protocol Flow&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;또한, 이 문서에서는 Front channel이란 용어와, Back channel이란 용어를 각각 사용하겠습니다. Front channel은 고객(클라이언트 사이드)과 연관있는 파트를, Back channel은 Authorization Server, Resource server 와 같이 프로그래머 및 서비스와 밀접한 관계가 있는 파트를 의미합니다.&lt;/p&gt;
&lt;h2 id=&quot;front-channel에서의-작업&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#front-channel%EC%97%90%EC%84%9C%EC%9D%98-%EC%9E%91%EC%97%85&quot; aria-label=&quot;front channel에서의 작업 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Front channel에서의 작업&lt;/h2&gt;
&lt;p&gt;“나”가 “파이어폭스”를 통해, “가나다” 서비스에서 “곰곰” 서비스로 요청하는 과정을 도식화한 것입니다. 여기서는 간략히 설명하겠습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;(A): 클라이언트는 &lt;strong&gt;인가&lt;/strong&gt;를 resource owner에 요청합니다. 인증요청은 resource owner에 직접적으로 요청되거나, authorization server를 중간에 거쳐서 수행합니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;(B): Resource owner는 Client에게 인증허가를 수행합니다. 인증허가 방법은 총 4가지가 있습니다. 인증허가 방식은 하단에서 자세히 후술하겠습니다. 여기서는 특징만을 기술합니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Authorization Code Grant&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;클라이언트가 resource owner에게 권한부여를 요청하는 대신, resource owner가 authorization server에서 인증을 받고 권한을 허가합니다.&lt;/li&gt;
&lt;li&gt;owner가 권한을 허가하면 authorization code가 발급되고 이를 클라이언트에 전달합니다.&lt;/li&gt;
&lt;li&gt;클라이언트는 authorization code를 authorization server에 코드를 보내며 권한허가 사실을 알리고 access token을 받습니다.&lt;/li&gt;
&lt;li&gt;후술할 Back channel과 Front channel이 확실히 분리되어 있어, 훨씬 안전합니다.&lt;/li&gt;
&lt;li&gt;해당 프로토콜의 다이어그램은 다음과 같습니다:
&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 737px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/9d1fd5e124b5e02589bb8b4832aa9cea/d125e/01-oauth-auth-code.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 64.58333333333334%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAABp0lEQVQoz4WS266bMBBF8//f1LdElfIQRVFIEEICDObikBQMvo2N7Za44kSqdDpv45nl2dueHSGkbZtpmpRSUkrGWNu1r9cvIddUCFmWZZqmwzCod1BK7/d73/ev12s3juP1GgGAf4dS6ng8YlR476213vssyw6HgzEmNADAfr/vuk4ptZNSUjo750JNa5Pcox9R0Urv/XrY9/3pdDqfz6FBCBHH8eVyeT6fOwBYlkUIwRijdJoZ53T8WU0Fc4HWWqdpmiTJmjpnrR3HESFECNlprQEA4zq63W7RLctypdQmcvPymWqtnXOc8xVWStZ1nedFmqZ5XszzzIVYlsUYE+xIKTdfwba1doWNMUIIAGCM1XXTtR3GGCFUVVWWZ8MwzDNjjH9OBoCvycH2dre1NvBFUVS4Ig/CufgO/lRlrUUlul6jOI4JIcYYxlh4rdD2JftfeFmWx+NR17hpO1xhzvm2Bf+fbIyZpplzjgqU50XQ3zQNxphz8a5O38GUUgDgnE8TzfI8SRKESkqplCKssPf+L7x9ySZba72lzjmlVFjVYDtswR/4N8ne5l07c/+0AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/9d1fd5e124b5e02589bb8b4832aa9cea/8ac56/01-oauth-auth-code.webp 240w,
/static/9d1fd5e124b5e02589bb8b4832aa9cea/d3be9/01-oauth-auth-code.webp 480w,
/static/9d1fd5e124b5e02589bb8b4832aa9cea/a99e1/01-oauth-auth-code.webp 737w&quot;
              sizes=&quot;(max-width: 737px) 100vw, 737px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/9d1fd5e124b5e02589bb8b4832aa9cea/8ff5a/01-oauth-auth-code.png 240w,
/static/9d1fd5e124b5e02589bb8b4832aa9cea/e85cb/01-oauth-auth-code.png 480w,
/static/9d1fd5e124b5e02589bb8b4832aa9cea/d125e/01-oauth-auth-code.png 737w&quot;
            sizes=&quot;(max-width: 737px) 100vw, 737px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/9d1fd5e124b5e02589bb8b4832aa9cea/d125e/01-oauth-auth-code.png&quot;
            alt=&quot;Authorization Code Grant의 도식&quot;
            title=&quot;Authorization Code Grant의 도식&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;Authorization Code Grant의 도식&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Implicit&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Authorization code 방식에서 마지막의 코드 관련 통신을 뺀것입니다.&lt;/li&gt;
&lt;li&gt;Refresh token을 지원하지 않습니다.&lt;/li&gt;
&lt;li&gt;이는 자격증명을 안전하게 저장하기 힘든 클라이언트에 최적화된 방식입니다. Resource Owner와 Client가 모두 한 디바이스인 것을 가정합니다.&lt;/li&gt;
&lt;li&gt;이러한 연유로 보안성이 낮아집니다. 주의해야 할 부분의 링크는 &lt;a href=&quot;https://tools.ietf.org/html/rfc6749#section-10.16&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;여기를 참고&lt;/a&gt;해주세요.
&lt;ul&gt;
&lt;li&gt;Front channel에 Access token이 노출되는 케이스이기 때문입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Resource Owner Password Credentials&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;계정 인증정보(ID/PW) 같은 정보가 access token을 얻기 위한 authorizaion grant로 쓰입니다. access token을 얻으면 리소스 요청을 위해 ID/PW를 클라이언트가 보관할 필요는 없습니다.&lt;/li&gt;
&lt;li&gt;해당 프로토콜의 다이어그램은 다음과 같습니다:
&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 746px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/c68f9acd46f568aa7ae3e4578a820b50/62de4/02-oauth-password.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 55.41666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABd0lEQVQoz12QWY7jMAxEc//79AUCDwIE+ZieTi/ZJrGy2LLcsK1doigNYmWMRupLFOuBLM4opbfbTQjuvXfOGWMul3PdNNZ5Zy0AEEJeX/8wxgAgG9brNSHEez/r+/5t/a61TqMAYLVa7beblBLGmFJq23Y+n0+GlNJyudztdimlmVJKSoWIuREC/t1+vfw+vPcxpTvMOS+KX0VR/DeE/X6/WCwYY3cYMVprhRBKaYzRG7VhspQxuxGxruvj8ZjLGKPWuqqqYRhmWmsAX5anj4/PzWZblkQIOS0yZflZhhDimOgOe+8RMcaIiABgrW2/v2tKa0qrqjpfLlyIPDPDzrkQwgPOr0kxxq7rKKXNKKnU02QAyKvdMz/1EHG8orxer2dybpqmbduu61jLjDE58wMeMz/DxhjvvVKq7/uyJIfD4XQ6dV1njHHOjTceYWPM09qI6JybSu+9lNI5N2UGgMfBGGOcc/FDfNRUSik550qp6WcYhmz4B0lwdcaj5YoDAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/c68f9acd46f568aa7ae3e4578a820b50/8ac56/02-oauth-password.webp 240w,
/static/c68f9acd46f568aa7ae3e4578a820b50/d3be9/02-oauth-password.webp 480w,
/static/c68f9acd46f568aa7ae3e4578a820b50/f7ebd/02-oauth-password.webp 746w&quot;
              sizes=&quot;(max-width: 746px) 100vw, 746px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/c68f9acd46f568aa7ae3e4578a820b50/8ff5a/02-oauth-password.png 240w,
/static/c68f9acd46f568aa7ae3e4578a820b50/e85cb/02-oauth-password.png 480w,
/static/c68f9acd46f568aa7ae3e4578a820b50/62de4/02-oauth-password.png 746w&quot;
            sizes=&quot;(max-width: 746px) 100vw, 746px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/c68f9acd46f568aa7ae3e4578a820b50/62de4/02-oauth-password.png&quot;
            alt=&quot;Resource Owner Password Credentials의 도식&quot;
            title=&quot;Resource Owner Password Credentials의 도식&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;Resource Owner Password Credentials의 도식&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Client Credentials&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;자원 소유자가 유저가 아니고 클라이언트면 사용하는 방식.&lt;/li&gt;
&lt;li&gt;client가 관리하는 리소스에 접근하는 경우로 권한이 한정되어있을 때 씁니다. 클라이언트 각각이 resource owner가 될 수 있습니다.&lt;/li&gt;
&lt;li&gt;해당 프로토콜의 다이어그램은 다음과 같습니다:
&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 573px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/85b7b29c60834a648b9a206543917a12/3c024/03-oauth-client-creds.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 65.41666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAABpklEQVQoz42RyY7bMBBE9f+fkS/w2Qgi5GxYRmDDC+MxRVoLSVmLtZAiKakDmTOewUwC5B10KHR1V4leWZbDA2NM/4ZSKn+QZZmU0ola67qub7dbVVXGGMaYp5TCGAdBwBgHAJgmeEAp9X3/dDpND8V9y7JcLpf7/R4AiqLwrLWEEN//kSSxG3rOrddrjPFHsa7rIAgQQq9mF+Cw/fX9EF86ABjHcQSAWTwcfN8/Ho9OdQaE0Gq1iuO4LEtPa13VdUou33bFTzGvHx9H2rZljC0Wi+12+zQrpdI03Ww2u91uviylBACt9TiOgqVhGJKQCCGmaTLGwBe01tba19hPs1Tq5eWCMT6fzwj9rqqqbVv3ENPbX3STbum7ue97ITihJEln4jiWUv3vZaWUlLKTknNOKI2iiM3wvCiKPBdCdF33NA/D8Dn2MAzW2vv9nmWZEOIaRYTQJEk450KIpmmstX3fN03zbnYru66TUlprXUOt9fUaXTAOyVzENXeBpZSuTp7nXt/3AGCMcY/xkb92dgcAoKoqj1KaZZnL9ol/iZzzPM8RQn8Af/TfHgZXV7QAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/85b7b29c60834a648b9a206543917a12/8ac56/03-oauth-client-creds.webp 240w,
/static/85b7b29c60834a648b9a206543917a12/d3be9/03-oauth-client-creds.webp 480w,
/static/85b7b29c60834a648b9a206543917a12/351b3/03-oauth-client-creds.webp 573w&quot;
              sizes=&quot;(max-width: 573px) 100vw, 573px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/85b7b29c60834a648b9a206543917a12/8ff5a/03-oauth-client-creds.png 240w,
/static/85b7b29c60834a648b9a206543917a12/e85cb/03-oauth-client-creds.png 480w,
/static/85b7b29c60834a648b9a206543917a12/3c024/03-oauth-client-creds.png 573w&quot;
            sizes=&quot;(max-width: 573px) 100vw, 573px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/85b7b29c60834a648b9a206543917a12/3c024/03-oauth-client-creds.png&quot;
            alt=&quot;Client Credentials의 도식&quot;
            title=&quot;Client Credentials의 도식&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;Client Credentials의 도식&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;참고) 인증 허가 후의 과정은 아래의 Back channel과도 밀접한 연관을 가집니다. Back channel에서의 플로우 및 상세 구현방법이 정해지기 때문입니다. 여기서는 개념만 짚고 넘어가도록 하겠습니다.&lt;/p&gt;
&lt;h2 id=&quot;back-channel에서의-작업&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#back-channel%EC%97%90%EC%84%9C%EC%9D%98-%EC%9E%91%EC%97%85&quot; aria-label=&quot;back channel에서의 작업 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Back Channel에서의 작업&lt;/h2&gt;
&lt;p&gt;유저에게 동의(consent)를 구하고, 클라이언트는 토큰을 통해 작업하는 큰 흐름에 대해 설명합니다. 상세한 구현방법은 상기 (B) 과정에 설명한 내용입니다. 아래 내용은 OAuth 2.0의 대략적인 플로우를 의미합니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;(C): 권한부여를 받은 클라이언트는 access token을 authorization server 에 요청합니다.&lt;/li&gt;
&lt;li&gt;(D): authorization server는 권한부여가 올바른지 유효성을 검증하고, 유효하다면 access token을 발급한 후 클라이언트에 결과를 보냅니다.&lt;/li&gt;
&lt;li&gt;(E): 발급받은 access token으로 client는 resource server에 리소스를 요청합니다.&lt;/li&gt;
&lt;li&gt;(F): resource server는 access token의 유효성을 점검 후 필요한 리소스를 줍니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;oauth-20의-grant-flow에-대해&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#oauth-20%EC%9D%98-grant-flow%EC%97%90-%EB%8C%80%ED%95%B4&quot; aria-label=&quot;oauth 20의 grant flow에 대해 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;OAuth 2.0의 Grant flow에 대해&lt;/h1&gt;
&lt;p&gt;토큰 부여까지는 살펴보았고, 그렇다면 이제 그 토큰을 통해 어떤식으로 &lt;strong&gt;권한 처리&lt;/strong&gt; 에 대한 플로우를 사용하는지 알아봅시다. 이 글에서는 Authorization Code Grant만을 살펴보도록 하겠습니다. 보다 더 상세한 스펙과 내용에 대해서는 RFC 문서를 참고해주시기 바랍니다.&lt;/p&gt;
&lt;h2 id=&quot;grant-flow에-대해&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#grant-flow%EC%97%90-%EB%8C%80%ED%95%B4&quot; aria-label=&quot;grant flow에 대해 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Grant flow에 대해&lt;/h2&gt;
&lt;p&gt;인가 이 후 어떤 식으로 동작하는지에 대해 살펴봅시다. Back channel에서 일어나는 일에 대해 보다 소상히 살펴본다고 생각하시면 됩니다.&lt;/p&gt;
&lt;h3 id=&quot;authorization-code-grant&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#authorization-code-grant&quot; aria-label=&quot;authorization code grant permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Authorization Code Grant&lt;/h3&gt;
&lt;p&gt;Authorization code grant type은 Access token과 Refresh token을 모두 얻는 데 사용되며 기밀 클라이언트에 최적화되어 있습니다. 이것은 리디렉션 기반 흐름이므로 클라이언트는 Resource Owner의 사용자 에이전트(일반적으로 웹 브라우저)와 상호 작용할 수 있어야 하며 Authorization Server에서 들어오는 요청(리디렉션을 통해)을 수신할 수 있어야 합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;          +----------+
          | Resource |
          |   Owner  |
          |          |
          +----------+
                ^
                |
              (B)
          +----|-----+          Client Identifier      +---------------+
          |         -+----(A)-- &amp;amp; Redirection URI ----&gt;|               |
          |  User-   |                                 | Authorization |
          |  Agent  -+----(B)-- User authenticates ---&gt;|     Server    |
          |          |                                 |               |
          |         -+----(C)-- Authorization Code ---&amp;lt;|               |
          +-|----|---+                                 +---------------+
            |    |                                         ^      v
            (A)  (C)                                       |      |
            |    |                                         |      |
            ^    v                                         |      |
          +---------+                                      |      |
          |         |&gt;---(D)-- Authorization Code ---------&apos;      |
          |  Client |          &amp;amp; Redirection URI                  |
          |         |                                             |
          |         |&amp;lt;---(E)----- Access Token -------------------&apos;
          +---------+       (w/ Optional Refresh Token)

        Note: The lines illustrating steps (A), (B), and (C) are broken into
        two parts as they pass through the user-agent.

                          Figure 3: Authorization Code Flow&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&quot;권한요청시&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B6%8C%ED%95%9C%EC%9A%94%EC%B2%AD%EC%8B%9C&quot; aria-label=&quot;권한요청시 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;권한요청시&lt;/h4&gt;
&lt;p&gt;Authorization Code Grant 플로우 중, 권한요청 시에는 아래 request 쿼리값이 들어갈 수 있습니다. &lt;code class=&quot;language-text&quot;&gt;application/x-www-form-urlencoded&lt;/code&gt; 포맷으로 전송합니다.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;필드명&lt;/th&gt;
&lt;th&gt;필수여부&lt;/th&gt;
&lt;th&gt;상세설명&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;response_type&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;REQUIRED&lt;/td&gt;
&lt;td&gt;반드시 &lt;code class=&quot;language-text&quot;&gt;code&lt;/code&gt; 라는 문자열이야 합니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;client_id&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;REQUIRED&lt;/td&gt;
&lt;td&gt;Client identifier 값입니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;redirect_uri&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;OPTIONAL&lt;/td&gt;
&lt;td&gt;토큰이 발급받을 위치를 지정합니다. 이 값을 엉뚱한 값으로 바꾸어 리소스에 접근할 수 없도록 하는 약속입니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;scope&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;OPTIONAL&lt;/td&gt;
&lt;td&gt;클라이언트가 수행할 수 있는 “범위”를 지정해주는 값입니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;state&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;RECOMMENDED&lt;/td&gt;
&lt;td&gt;요청-콜백 간 상태를 유지하기 위해 클라이언트 측에서 사용하는 opaque한 값입니다. CSRF를 방지하기 위해 사용됩니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;요청 예시는 아래와 같습니다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;
GET /authorize?response_type=code&amp;amp;client_id=s6BhdRkqt3&amp;amp;state=xyz
    &amp;amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb HTTP/1.1
Host: server.example.com&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&quot;권한응답시-정상처리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B6%8C%ED%95%9C%EC%9D%91%EB%8B%B5%EC%8B%9C-%EC%A0%95%EC%83%81%EC%B2%98%EB%A6%AC&quot; aria-label=&quot;권한응답시 정상처리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;권한응답시 (정상처리)&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;필드명&lt;/th&gt;
&lt;th&gt;필수여부&lt;/th&gt;
&lt;th&gt;상세설명&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;code&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;REQUIRED&lt;/td&gt;
&lt;td&gt;Authrization 서버로부터 생성된 &lt;strong&gt;권한 부여&lt;/strong&gt; 코드값입니다. 이 값은 악의적인 사용(유출되거나 하는 등)을 방지하기 위해 만료시간이 짧아야 합니다(&lt;code class=&quot;language-text&quot;&gt;10분&lt;/code&gt; 이 권장됩니다). &lt;br /&gt;해당 값은 반드시 한번 이상 &lt;strong&gt;사용할 수 없도록&lt;/strong&gt; 해야합니다. 한번 이상 사용한다면 요청을 &lt;strong&gt;반드시&lt;/strong&gt; 거부해야합니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;state&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;REQUIRED&lt;/td&gt;
&lt;td&gt;앞선 요청에 &lt;code class=&quot;language-text&quot;&gt;state&lt;/code&gt; 필드값이 있었다면, 요청과 동일한 값을 응답해줍니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;응답 예시는 아래와 같습니다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;HTTP/1.1 302 Found
Location: https://client.example.com/cb?code=SplxlOBeZQQYbYS6WxSbIA
          &amp;amp;state=xyz&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;클라이언트 측에서도 식별되지 않은 응답 파라미터는 &lt;strong&gt;반드시&lt;/strong&gt; 무시해야합니다.&lt;/p&gt;
&lt;h4 id=&quot;권한응답시-비정상-처리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B6%8C%ED%95%9C%EC%9D%91%EB%8B%B5%EC%8B%9C-%EB%B9%84%EC%A0%95%EC%83%81-%EC%B2%98%EB%A6%AC&quot; aria-label=&quot;권한응답시 비정상 처리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;권한응답시 (비정상 처리)&lt;/h4&gt;
&lt;p&gt;Authorization server는 아래 상황에 대해 에러를 리턴해야 하고, 잘못된 리디렉션 URI로 &lt;strong&gt;반드시 가게해선 안 됩니다&lt;/strong&gt;.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;필드명&lt;/th&gt;
&lt;th&gt;필수여부&lt;/th&gt;
&lt;th&gt;상세설명&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;error&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;REQUIRED&lt;/td&gt;
&lt;td&gt;에러를 표기하기 위한 &lt;code class=&quot;language-text&quot;&gt;ASCII&lt;/code&gt; 값입니다(알파벳 대소문자, 숫자 이외의 값은 포함하면 안됩니다). 값들은 아래와 같습니다: &lt;br /&gt;&lt;code class=&quot;language-text&quot;&gt;invalid_request&lt;/code&gt;: 필수 파라미터를 포함하지 않았거나 잘못 사용한 경우 &lt;br /&gt;&lt;code class=&quot;language-text&quot;&gt;unauthorized_client&lt;/code&gt;: 클라이언트가 해당 리소스를 사용하기에 적절한 권한이 없는 경우 &lt;br /&gt;&lt;code class=&quot;language-text&quot;&gt;access_denied&lt;/code&gt;: Resource owner 혹은 Authorization server가 요청을 거부한 경우 &lt;br /&gt;&lt;code class=&quot;language-text&quot;&gt;unsupported_response_type&lt;/code&gt;: Authorization server가 이 방법을 사용한 액세스 토큰 획득을 지원하지 않는 경우 &lt;br /&gt;&lt;code class=&quot;language-text&quot;&gt;invalid_scope&lt;/code&gt;: 요청의 &lt;code class=&quot;language-text&quot;&gt;scope&lt;/code&gt; 값이 유효하지 않거나, 알려지지 않은 값이거나, 손상된 경우 &lt;br /&gt;&lt;code class=&quot;language-text&quot;&gt;server_error&lt;/code&gt;: Authorization server 측의 예기치 않은 에러가 발생된 경우. &lt;code class=&quot;language-text&quot;&gt;500 Internal Server Error&lt;/code&gt; Response를 줄 수 없는 경우 사용합니다. &lt;br /&gt;&lt;code class=&quot;language-text&quot;&gt;temporarily_unavailable&lt;/code&gt;: Authorization server 측의 과부화 혹은 점검의 이유로 인해 해당 요청을 처리할 수 없는 경우 사용합니다. &lt;code class=&quot;language-text&quot;&gt;503 Service Unavailable&lt;/code&gt; Response를 줄 수 없는 경우 사용합니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;error_description&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;OPTIONAL&lt;/td&gt;
&lt;td&gt;human-readable &lt;code class=&quot;language-text&quot;&gt;ASCII&lt;/code&gt; 텍스트. 클라이언트 개발자에게 보다 유용한 에러 메시지를 전달하기 위한 필드입니다. &lt;br /&gt;알파벳 대소문자, 숫자 이외의 값을 포함하면 안됩니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;error_uri&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;OPTIONAL&lt;/td&gt;
&lt;td&gt;클라이언트 개발자에게 보다 유용한 에러 메시지를 전달하기 위한 human-readable 웹페이지 URI 값입니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;state&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;REQUIRED&lt;/td&gt;
&lt;td&gt;앞선 요청에 &lt;code class=&quot;language-text&quot;&gt;state&lt;/code&gt; 필드값이 있었다면, 요청과 동일한 값을 응답해줍니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol&gt;
&lt;li&gt;URI 리디렉션이 잘못되었거나, 유효하지 않거나, 없는 값인 경우&lt;/li&gt;
&lt;li&gt;Client identifier가 없거나 유요하지 않은경우&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Authorization server가 요청을 거부한 경우에 대한 응답 예시는 아래와 같습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;HTTP/1.1 302 Found
Location: https://client.example.com/cb#error=access_denied&amp;amp;state=xyz&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&quot;token-발행-요청&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#token-%EB%B0%9C%ED%96%89-%EC%9A%94%EC%B2%AD&quot; aria-label=&quot;token 발행 요청 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Token 발행 요청&lt;/h4&gt;
&lt;p&gt;HTTP request entity-body에 &lt;code class=&quot;language-text&quot;&gt;UTF-8&lt;/code&gt; 인코딩을 사용하고, &lt;code class=&quot;language-text&quot;&gt;application/x-www-form-urlencoded&lt;/code&gt; 포맷으로 보냅니다.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;필드명&lt;/th&gt;
&lt;th&gt;필수여부&lt;/th&gt;
&lt;th&gt;상세설명&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;grant_type&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;REQUIRED&lt;/td&gt;
&lt;td&gt;이 값은 &lt;strong&gt;반드시&lt;/strong&gt; 문자열 &lt;code class=&quot;language-text&quot;&gt;authorization_code&lt;/code&gt; 값이어야합니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;code&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;REQUIRED&lt;/td&gt;
&lt;td&gt;Authorization server로부터 받은 authorization code 값입니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;redirect_url&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;REQUIRED&lt;/td&gt;
&lt;td&gt;Authorization request 과정에서 해당 값이 포함되어 있었다면, &lt;strong&gt;반드시&lt;/strong&gt; 그 값과 동일해야합니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;client_id&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;REQUIRED&lt;/td&gt;
&lt;td&gt;클라이언트 자격증명에 사용됩니다. 클라이언트가 권한 서버에 등록하면 발급받을 수 있으며 권한 서버 연동 시 클라이언트의 검증에 사용됩니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;요청 예시는 아래와 같습니다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;POST /token HTTP/1.1
Host: server.example.com
Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code&amp;amp;code=SplxlOBeZQQYbYS6WxSbIA
&amp;amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&quot;token-발행-요청에-대한-응답-정상처리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#token-%EB%B0%9C%ED%96%89-%EC%9A%94%EC%B2%AD%EC%97%90-%EB%8C%80%ED%95%9C-%EC%9D%91%EB%8B%B5-%EC%A0%95%EC%83%81%EC%B2%98%EB%A6%AC&quot; aria-label=&quot;token 발행 요청에 대한 응답 정상처리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Token 발행 요청에 대한 응답 (정상처리)&lt;/h4&gt;
&lt;p&gt;해당 값 리턴 시, 헤더에 &lt;code class=&quot;language-text&quot;&gt;Cache-Control: no-store&lt;/code&gt; 값과 &lt;code class=&quot;language-text&quot;&gt;Pragma: no-cache&lt;/code&gt; 값이 &lt;strong&gt;반드시&lt;/strong&gt; 존재해야 합니다. &lt;code class=&quot;language-text&quot;&gt;Content-Type&lt;/code&gt; 은 &lt;code class=&quot;language-text&quot;&gt;application/json&lt;/code&gt; 입니다.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;필드명&lt;/th&gt;
&lt;th&gt;필수여부&lt;/th&gt;
&lt;th&gt;상세설명&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;access_token&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;REQUIRED&lt;/td&gt;
&lt;td&gt;Authorization server로부터 발급받은 Access token 값입니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;token_type&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;REQUIRED&lt;/td&gt;
&lt;td&gt;발급한 토큰의 타입을 기재합니다. 대소문자를 구별합니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;expires_in&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;RECOMMENDED&lt;/td&gt;
&lt;td&gt;Access token의 유효기간입니다. &lt;br /&gt;&lt;code class=&quot;language-text&quot;&gt;3600&lt;/code&gt; 이라면, 1시간 후 만료됩니다. 만약 이 값이 없다면 Authorization server에서 만료 시간을 기본값으로 정해주어야 합니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;refresh_token&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;OPTIONAL&lt;/td&gt;
&lt;td&gt;Refresh token값입니다. 이 값은 동일한 authorization grant 과정에 사용되는 새로운 Access token을 발급받는데 사용됩니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;scope&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;OPTIONAL&lt;/td&gt;
&lt;td&gt;어떤 권한을 요청할 것인지에 대한 범위입니다. 유저별로 구별되어있다면 OPTIONAL이지만, 그렇지 않다면 REQUIRED 입니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;응답 예시는 아래와 같습니다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Cache-Control: no-store
Pragma: no-cache

{
  &quot;access_token&quot;:&quot;2YotnFZFEjr1zCsicMWpAA&quot;,
  &quot;token_type&quot;:&quot;example&quot;,
  &quot;expires_in&quot;:3600,
  &quot;refresh_token&quot;:&quot;tGzv3JOkF0XG5Qx2TlKWIA&quot;,
  &quot;example_parameter&quot;:&quot;example_value&quot;
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;상단에서 살펴본 Access token과 Refresh token이 보입니다. 이를 통해 리소스 요청 및 Access token 갱신을 수행합니다. 또한 클라이언트 측에서도 식별되지 않은 응답 파라미터는 &lt;strong&gt;반드시&lt;/strong&gt; 무시해야합니다.&lt;/p&gt;
&lt;h4 id=&quot;token-발행-요청에-대한-응답-정상처리-1&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#token-%EB%B0%9C%ED%96%89-%EC%9A%94%EC%B2%AD%EC%97%90-%EB%8C%80%ED%95%9C-%EC%9D%91%EB%8B%B5-%EC%A0%95%EC%83%81%EC%B2%98%EB%A6%AC-1&quot; aria-label=&quot;token 발행 요청에 대한 응답 정상처리 1 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Token 발행 요청에 대한 응답 (정상처리)&lt;/h4&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;필드명&lt;/th&gt;
&lt;th&gt;필수여부&lt;/th&gt;
&lt;th&gt;상세설명&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;error&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;REQUIRED&lt;/td&gt;
&lt;td&gt;에러를 표기하기 위한 &lt;code class=&quot;language-text&quot;&gt;ASCII&lt;/code&gt; 값입니다(알파벳 대소문자, 숫자 이외의 값은 포함하면 안됩니다). 값들은 아래와 같습니다: &lt;br /&gt;&lt;code class=&quot;language-text&quot;&gt;invalid_request&lt;/code&gt;: 파라미터가 잘못되거나, 클라이언트 인증에 문제가 있거나, 값이 변조된 경우 &lt;br /&gt;&lt;code class=&quot;language-text&quot;&gt;invalid_client&lt;/code&gt;: 클라이언트 인증에 실패하는 경우 &lt;br /&gt;&lt;code class=&quot;language-text&quot;&gt;invalid_grant&lt;/code&gt;: authorization grant 과정 혹은 refresh token이 잘못된 경우 &lt;br /&gt;&lt;code class=&quot;language-text&quot;&gt;unauthorized_client&lt;/code&gt; : 클라이언트가 적절한 권한을 가지지 않은 경우&lt;br /&gt;&lt;code class=&quot;language-text&quot;&gt;unsupported_grant_type&lt;/code&gt; : authorization server에서 지원하지 않는 authorization grant type인 경우 &lt;br /&gt;&lt;code class=&quot;language-text&quot;&gt;invalid_scope&lt;/code&gt;: resource owner가 제공하지 않은 권한 밖의 &lt;code class=&quot;language-text&quot;&gt;scope&lt;/code&gt; 를 요청한 경우&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;error_description&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;OPTIONAL&lt;/td&gt;
&lt;td&gt;human-readable &lt;code class=&quot;language-text&quot;&gt;ASCII&lt;/code&gt; 텍스트. 클라이언트 개발자에게 보다 유용한 에러 메시지를 전달하기 위한 필드입니다. &lt;br /&gt;알파벳 대소문자, 숫자 이외의 값을 포함하면 안됩니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;error_uri&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;OPTIONAL&lt;/td&gt;
&lt;td&gt;클라이언트 개발자에게 보다 유용한 에러 메시지를 전달하기 위한 human-readable 웹페이지 URI 값입니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;응답 예시는 아래와 같습니다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;HTTP/1.1 400 Bad Request
Content-Type: application/json;charset=UTF-8
Cache-Control: no-store
Pragma: no-cache

{
  &quot;error&quot;:&quot;invalid_request&quot;
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;또한 클라이언트 측에서도 식별되지 않은 응답 파라미터는 &lt;strong&gt;반드시&lt;/strong&gt; 무시해야합니다.&lt;/p&gt;
&lt;h4 id=&quot;access-token-갱신&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#access-token-%EA%B0%B1%EC%8B%A0&quot; aria-label=&quot;access token 갱신 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Access token 갱신&lt;/h4&gt;
&lt;p&gt;권한서버는&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;필드명&lt;/th&gt;
&lt;th&gt;필수여부&lt;/th&gt;
&lt;th&gt;상세설명&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;grant_type&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;REQUIRED&lt;/td&gt;
&lt;td&gt;이 값은 &lt;strong&gt;반드시&lt;/strong&gt; &lt;code class=&quot;language-text&quot;&gt;refresh_token&lt;/code&gt; 이라는 문자열이어야 합니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;refresh_token&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;REQUIRED&lt;/td&gt;
&lt;td&gt;클라이언트에게 발급된 refresh token 값입니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;scope&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;OPTIONAL&lt;/td&gt;
&lt;td&gt;어떤 권한을 요청할 것인지에 대한 범위입니다. 유저별로 구별되어있다면 OPTIONAL이지만, 그렇지 않다면 REQUIRED 입니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;요청 예시는 아래와 같습니다&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;POST /token HTTP/1.1
Host: server.example.com
Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
Content-Type: application/x-www-form-urlencoded

grant_type=refresh_token&amp;amp;refresh_token=tGzv3JOkF0XG5Qx2TlKWIA&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;그-외&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B7%B8-%EC%99%B8&quot; aria-label=&quot;그 외 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;그 외?&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;상세한 내용 및 스펙에 대한 기재사항은 OAuth 2.0의 RFC 문서를 참고해 주십시오.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc7662&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Introspection 스펙&lt;/a&gt;과 &lt;a href=&quot;https://www.rfc-editor.org/rfc/rfc7009&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Revocation 스펙&lt;/a&gt;은 RFC 링크를 참고해 주십시오.&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;마무리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%88%EB%AC%B4%EB%A6%AC&quot; aria-label=&quot;마무리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;마무리&lt;/h1&gt;
&lt;p&gt;이번 글을 통해, 아래 내용들을 살펴볼 수 있었습니다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;OAuth 2.0의 기본 원리와 도식을 살펴보았습니다.
&lt;ol&gt;
&lt;li&gt;OAuth 2.0에 사용되는 주요 용어와&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;어떤식으로 &lt;strong&gt;권한 부여&lt;/strong&gt;에 활용되는지 살펴보았습니다.
&lt;ol&gt;
&lt;li&gt;권한 부여를 위해, 어떤 설계가 이루어지는지 살펴보았습니다.&lt;/li&gt;
&lt;li&gt;토큰 요청과 응답과 관련한 스펙을 살펴보고, 어떤 식으로 작동하는지 살펴보았습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;잘못된 사항은 언제든 댓글로 되짚어주십시오.&lt;/p&gt;
&lt;p&gt;읽어주셔서 감사합니다.&lt;/p&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;References
&lt;ul&gt;
&lt;li&gt;[1] &lt;a href=&quot;https://datatracker.ietf.org/doc/rfc6749/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;OAuth 2.0의 RFC 문서입니다&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;[2] &lt;a href=&quot;https://developer.okta.com/blog/2017/06/21/what-the-heck-is-oauth&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;OAuth 2.0의 flow를 확인하며 정말 도움되었던 글입니다&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;[3] &lt;a href=&quot;https://www.youtube.com/watch?v=nSa0ZCfF2Sc&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;OAuth 2.0의 Introspection에 대한 해설을 이해하는데 도움되었습니다&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;[4] &lt;a href=&quot;https://auth0.com/blog/what-is-and-how-does-single-sign-on-work/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Single Sign-on 이해에 상당히 도움되었습니다&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;[5] &lt;a href=&quot;https://wiki.wikisecurity.net/wiki:sso&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;SSO 구현 모델에 대해 살펴보는데 도움되었습니다&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;[6] &lt;a href=&quot;https://blog.naver.com/mds_datasecurity/222182943542&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;OAuth 2.0의 구동 관련 내용을 번역해둔 사항에 대해 참고하였습니다&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[제발 한국인이라면 파일 끝에 엔터 칩시다]]></title><description><![CDATA[EOL을 왜 입력해야 하는지 알아보며, 개행문자에 대해 발생한 문제가 함께 떠올라 적절한 해결책을 알아보고자 조사하게 되었습니다.]]></description><link>https://blog.s3ich4n.me/tips/2022-10-10-why-should-i-put-eol-at-the-end-of-file</link><guid isPermaLink="false">https://blog.s3ich4n.me/tips/2022-10-10-why-should-i-put-eol-at-the-end-of-file</guid><pubDate>Mon, 10 Oct 2022 19:30:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 381px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/21519913a8bf7c5b79a5ae0bc583dedc/2add2/01_no_newline.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 45.416666666666664%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABu0lEQVQoz43PXYvTQBjF8XwyRXFZV+vnEMRP4603IhQK7oUICl64N4IoKCxu39xum9Ymk0kymUya1zZJ/7JxVRZEPMOPc/NwYCzbtvGlxHEchPCQvsKVEa5UODJi6YYITyI9D9d1ubiY46zXSCm7+/V6zdK2cYXAGIOltaYsim708iAyGb7ZsfRzHFXi6S2B0iTGdCPz+QLhugRhSBwbhBDYiwWelFymG/x3Wv43TdNgBX6A3mjsyUfiUBEbg3AFSkUEQUieF6Rp+ldZlpHn+e8uiuLnYLyJ+T77QhJpTGK6L0VRhO/7VGVF27ad5qp/qeuaosivsbwgROc1cQkq26HSLaZsiJKctNqhTMrp2YjTryNGk3OG428MJ+ecjafMFis25Y5N8YcVOoKtG5KtBOXap3QCKhGyEQF1mPD5/ScObh9weOeQ3v0HHN29R++ox60bN3n88BFVlNAkGTuTUpsUy/VsAjNBqBEyGnf8eErgL1CrGdPpkP5xnxevB/QHT3n+7Amv3r3k+M2Akw9v2eSyk1y15WkfRUyI7gT7iHCvMVuDyTWmSsnbkootZZvSUtCy715NQ7rPrvkBSgiY+vcsdcMAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/21519913a8bf7c5b79a5ae0bc583dedc/8ac56/01_no_newline.webp 240w,
/static/21519913a8bf7c5b79a5ae0bc583dedc/25250/01_no_newline.webp 381w&quot;
              sizes=&quot;(max-width: 381px) 100vw, 381px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/21519913a8bf7c5b79a5ae0bc583dedc/8ff5a/01_no_newline.png 240w,
/static/21519913a8bf7c5b79a5ae0bc583dedc/2add2/01_no_newline.png 381w&quot;
            sizes=&quot;(max-width: 381px) 100vw, 381px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/21519913a8bf7c5b79a5ae0bc583dedc/2add2/01_no_newline.png&quot;
            alt=&quot;으아ㅏㅏ 개행&quot;
            title=&quot;으아ㅏㅏ 개행&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;으아ㅏㅏ 개행&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;코드리뷰 시 왜 GitHub이 파일 끝에 엔터를 치도록 요구하는지 궁금했습니다. 이참에 Git을 쓰며 개행문자 문제를 해결하는 방안이 떠올라 함께 썼습니다. 왜냐하면 엔터는 개행문자를 텍스트파일에 쓰는 것이니까요(?)&lt;/p&gt;
&lt;h1 id=&quot;tldr&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#tldr&quot; aria-label=&quot;tldr permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;TL;DR&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;POSIX 에서 하나의 행을 정의하는 표준을 지킵시다.&lt;/li&gt;
&lt;li&gt;개행에 대해 잘 이해하고 있으면, 타 운영체제에서 Git을 이용할 때 개행문자 차이로부터 일어나는 사이드이펙트를 방지할 수 있습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;posix-표준을-준수합시다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#posix-%ED%91%9C%EC%A4%80%EC%9D%84-%EC%A4%80%EC%88%98%ED%95%A9%EC%8B%9C%EB%8B%A4&quot; aria-label=&quot;posix 표준을 준수합시다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;POSIX 표준을 준수합시다&lt;/h1&gt;
&lt;p&gt;필요한 부분들을 살펴보기 위해, 논의에 연관이 없다고 판단되는 부분은 생략하려 합니다.&lt;/p&gt;
&lt;p&gt;먼저, 코드가 쓰여지는 텍스트 파일의 정의를 먼저 살펴봅시다.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap03.html#tag_03_403&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;3.403 Text File&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A file that contains characters organized into zero or more lines. (중략)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;모든 텍스트 파일에서 줄(Line)은 개행문자(newline)를 기준으로 만들어 집니다.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap03.html#tag_03_206&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;3.206 Line&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A sequence of zero or more non- &lt;newline&gt; characters plus a terminating &lt;newline&gt; character. (중략)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;끝나지 않은 줄(Incomplete Line)은 파일 끝에 non-newline 문자가 하나 이상 있는 것을 의미합니다&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap03.html#tag_03_195&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;3.195 Incomplete Line&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A sequence of one or more non- &lt;newline&gt; characters at the end of the file. (중략)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;다시말해, 파일 끝에 newline 문자가 없으면 끝나지 않은 행으로 한다는 것입니다.&lt;/p&gt;
&lt;h2 id=&quot;git에서-개행-문자new-line차이의-문제를-미연에-방지할-수-있어요&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#git%EC%97%90%EC%84%9C-%EA%B0%9C%ED%96%89-%EB%AC%B8%EC%9E%90new-line%EC%B0%A8%EC%9D%B4%EC%9D%98-%EB%AC%B8%EC%A0%9C%EB%A5%BC-%EB%AF%B8%EC%97%B0%EC%97%90-%EB%B0%A9%EC%A7%80%ED%95%A0-%EC%88%98-%EC%9E%88%EC%96%B4%EC%9A%94&quot; aria-label=&quot;git에서 개행 문자new line차이의 문제를 미연에 방지할 수 있어요 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Git에서 개행 문자(New line)차이의 문제를 미연에 방지할 수 있어요&lt;/h2&gt;
&lt;p&gt;Git을 사용할 때, 윈도우즈에서 수정한 코드를 가져오면 &lt;code class=&quot;language-text&quot;&gt;^M&lt;/code&gt; 문자열이 온 코드 끝에 다 붙어있는 경우를 간혹 보게됩니다. 이는 개행문자의 차이로 인해 발생하는 문제입니다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 168px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/1bfee06304876faf876ef53c5bbadf3f/f697d/02_crlf_lf.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 55.952380952380956%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHm5Kygf//EABkQAAMAAwAAAAAAAAAAAAAAAAABAhAREv/aAAgBAQABBQI0OWs9Uf/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABgQAAIDAAAAAAAAAAAAAAAAAAAQASEx/9oACAEBAAY/Alb2T//EABoQAAIDAQEAAAAAAAAAAAAAAAERACFRYRD/2gAIAQEAAT8hXB4MhDYYjOxnZUqh2f/aAAwDAQACAAMAAAAQN/8A/8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQMBAT8Qp//EABURAQEAAAAAAAAAAAAAAAAAABAh/9oACAECAQE/EKf/xAAcEAACAgMBAQAAAAAAAAAAAAAAARExIWGRQcH/2gAIAQEAAT8QSwlch+qFYlE65Tpm903OmBhEJSwr+n//2Q==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/1bfee06304876faf876ef53c5bbadf3f/311a7/02_crlf_lf.webp 168w&quot;
              sizes=&quot;(max-width: 168px) 100vw, 168px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/1bfee06304876faf876ef53c5bbadf3f/f697d/02_crlf_lf.jpg 168w&quot;
            sizes=&quot;(max-width: 168px) 100vw, 168px&quot;
            type=&quot;image/jpeg&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/1bfee06304876faf876ef53c5bbadf3f/f697d/02_crlf_lf.jpg&quot;
            alt=&quot;??: 이거 고치려면 또 dos2unix 깔아야해? 으..&quot;
            title=&quot;??: 이거 고치려면 또 dos2unix 깔아야해? 으..&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;??: 이거 고치려면 또 dos2unix 깔아야해? 으..&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;윈도우즈는 CRLF 방식의 개행을, GNU/Linux나 macOS에서는 LF를 개행으로 사용합니다. 엔터키를 눌렀을 때, 파일에 새 줄을 어떻게 기록할 것인지를 구별하는 바이너리 값이 다르게 붙음을 의미합니다.&lt;/p&gt;
&lt;p&gt;Git에서는 이를 방지할 수 있도록 설정을 부여해줄 수 있습니다. 여러 방법이 있습니다만 이 글에서 소개할 방법은 리포지토리에 &lt;code class=&quot;language-text&quot;&gt;.gitattributes&lt;/code&gt; 파일을 추가하는 방안입니다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;git config --global core.autocrlf [true|false|input]&lt;/code&gt; 명령을 통해 개인 PC에 설정을 넣어두는 것으로 해결할 수 있습니다. 하지만 저는 프로젝트 전체에 &lt;code class=&quot;language-text&quot;&gt;.gitattributes&lt;/code&gt; 파일 추가를 통해 모든 사람과 논의하는 것이 좋다고 생각합니다. 이유는 아래와 같습니다:&lt;/p&gt;
&lt;p&gt;첫째, 모든 이에게 이런 문제가 일어날 수 있음을 제고할 수 있습니다.&lt;/p&gt;
&lt;p&gt;둘째, 해결책을 제시하고 보다 나은 사항을 알아볼 수 있게끔 방향을 잡을 수 있습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;gitattributes&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#gitattributes&quot; aria-label=&quot;gitattributes permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;.gitattributes&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;이 파일은 프로젝트에 Git 설정을 동일하게 하여 혼동을 없앨 때 사용합니다. 그 중, EOL 과 관련한 옵션을 살펴봅시다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;text=auto&lt;/code&gt; 옵션&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이 설정은 EOL normalization에 대한 설정입니다. &lt;code class=&quot;language-text&quot;&gt;text=auto&lt;/code&gt; 을 주면 모든 텍스트 파일의 EOL이 LF로 normalize됩니다. 하지만 현재 워킹 트리의 텍스트 파일은 CRLF 그대로입니다. 바이너리(이미지, 폰트 등)들의 EOF는 변경되지 않습니다(참조링크를 확인해보세요).&lt;/p&gt;
&lt;p&gt;아래 설정은 &lt;a href=&quot;https://github.com/alexkaratarakis/gitattributes&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 리포지토리&lt;/a&gt;에서 가져왔습니다(이런 게 있군요!).&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;git&quot;&gt;&lt;pre class=&quot;language-git&quot;&gt;&lt;code class=&quot;language-git&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# THIS IS ONLY FOR THE gitattributes REPOSITORY.&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# Handle line endings automatically for files detected as text&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# and leave all files detected as binary untouched.&lt;/span&gt;
*               text=auto&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;파일 일괄적용&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;git 2.16 버전(2018년 2월 22일 릴리즈)부터 현 브랜치 내의 모든 파일들에 대해 renormalize 할 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;--renormalize&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;.&lt;/span&gt;             &lt;span class=&quot;token comment&quot;&gt;# normalize 수행&lt;/span&gt;

&lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; status                          &lt;span class=&quot;token comment&quot;&gt;# 변경된 상태확인&lt;/span&gt;

&lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; ls-files &lt;span class=&quot;token parameter variable&quot;&gt;--eol&lt;/span&gt;                  &lt;span class=&quot;token comment&quot;&gt;# 파일의 EOL을 살펴봅시다.&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; ls-files path/to/file &lt;span class=&quot;token parameter variable&quot;&gt;--eol&lt;/span&gt;     &lt;span class=&quot;token comment&quot;&gt;# 특정 파일의 EOL을 살펴봅시다.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;git 버전이 그보다 아래라면, &lt;code class=&quot;language-text&quot;&gt;find&lt;/code&gt;와 &lt;code class=&quot;language-text&quot;&gt;sed&lt;/code&gt;를 적절히 이용하거나, &lt;code class=&quot;language-text&quot;&gt;dos2unix&lt;/code&gt; 같은 바이너리를 이용하여 수동으로 개행 바이너리값을 바꾸어 커밋하면 되겠죠.&lt;/p&gt;
&lt;h1 id=&quot;마무리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%88%EB%AC%B4%EB%A6%AC&quot; aria-label=&quot;마무리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;마무리&lt;/h1&gt;
&lt;p&gt;파일에 EOL을 균일하게 넣고, 모든 구성원들에게 동일한 설정을 부여하는 것으로 일어나는 문제를 해결할 수 있었습니다.&lt;/p&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;참고링크
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://git-scm.com/docs/gitattributes#_text&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;.gitattributes&lt;/code&gt;의 text 옵션&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://git-scm.com/docs/gitattributes#Documentation/gitattributes.txt-Settostringvalueauto&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;text=auto&lt;/code&gt;의 의미&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.aleksandrhovhannisyan.com/blog/crlf-vs-lf-normalizing-line-endings-in-git/#all-line-ending-transformations-concern-the-index&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;CRLF vs. LF: Normalizing Line Endings in Git&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://velog.io/@jangws/EOL%EC%9D%84-%EB%84%A3%EC%96%B4%EC%95%BC-%ED%95%98%EB%8A%94-%EC%9D%B4%EC%9C%A0%EC%99%80-git%EC%97%90%EC%84%9C-CRLF-EOL-%EC%B0%A8%EC%9D%B4%EB%A1%9C-%EC%9D%B8%ED%95%9C-%EB%AC%B8%EC%A0%9C-%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;EOL을 넣어야 하는 이유와 운영체제별 EOL(EndOfLine) 차이로 인한 Git 문제 해결&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Bash 스크립트의 문자열 비교에 대해 알아봅시다]]></title><description><![CDATA[Bash 스크립트를 작성하며 -z 라는 키워드에 대해 알게되었습니다. 더 나아가 쉘 스크립트에선 문자열을 어떻게 다루는지 살펴봅시다.]]></description><link>https://blog.s3ich4n.me/tips/2022-10-08-meaning-of-z-in-shell-script</link><guid isPermaLink="false">https://blog.s3ich4n.me/tips/2022-10-08-meaning-of-z-in-shell-script</guid><pubDate>Sat, 08 Oct 2022 19:30:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;문자열-비교&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AC%B8%EC%9E%90%EC%97%B4-%EB%B9%84%EA%B5%90&quot; aria-label=&quot;문자열 비교 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;문자열 비교&lt;/h1&gt;
&lt;p&gt;이전 회사에서 근무 중, Bash 스크립트를 작성할 일이 있었습니다. 그 때 Bash 스크립트에서 문자열을 다루는 오퍼레이터에 대해 살펴보았던 기억이 있어 이를 글로 남기고 공유하고자 합니다.&lt;/p&gt;
&lt;h2 id=&quot;들어가기에-앞서&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%93%A4%EC%96%B4%EA%B0%80%EA%B8%B0%EC%97%90-%EC%95%9E%EC%84%9C&quot; aria-label=&quot;들어가기에 앞서 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;들어가기에 앞서..&lt;/h2&gt;
&lt;h3 id=&quot;bash-스크립트에서의-if-then-구문&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#bash-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8%EC%97%90%EC%84%9C%EC%9D%98-if-then-%EA%B5%AC%EB%AC%B8&quot; aria-label=&quot;bash 스크립트에서의 if then 구문 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Bash 스크립트에서의 &lt;code class=&quot;language-text&quot;&gt;if-then&lt;/code&gt; 구문&lt;/h3&gt;
&lt;p&gt;논리적 참/거짓을 다루어 분기하기 위한 구문입니다. 으레 있는 구분이지요. 어셈블리어부터 현대 언어까지 다 있습니다.&lt;/p&gt;
&lt;p&gt;그런데 if 구문에서 참/거짓을 다루는 것은 바이너리입니다. &lt;code class=&quot;language-text&quot;&gt;/usr/bin/test&lt;/code&gt; 라는 바이너리를 사용하죠. 이러한 이유로 Test constructs 라고 부르는 것으로 보입니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token shebang important&quot;&gt;#!/bin/bash&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 1st cmd) test를 직접 사용하는 경우&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-z&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$1&lt;/span&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;then&lt;/span&gt;
  &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;no args&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
  &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;1st args: &lt;span class=&quot;token variable&quot;&gt;$1&lt;/span&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;fi&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 2nd cmd) test의 fullpath를 직접 사용하는 경우&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; /usr/bin/test &lt;span class=&quot;token parameter variable&quot;&gt;-z&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$1&lt;/span&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;then&lt;/span&gt;
    &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;no args&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;1st args: &lt;span class=&quot;token variable&quot;&gt;$1&lt;/span&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;fi&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 3rd cmd) bracket 내에 조건문을 담는 경우&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-z&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$1&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;then&lt;/span&gt;
  &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;no args&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
  &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;1st args: &lt;span class=&quot;token variable&quot;&gt;$1&lt;/span&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;fi&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 4th cmd) /usr/bin/[if 구문을 사용]&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# 3rd와 동일&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; /usr/bin/&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-z&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$1&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;then&lt;/span&gt;
  &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;no args&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
  &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;1st args: &lt;span class=&quot;token variable&quot;&gt;$1&lt;/span&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;fi&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;문자열의-동일여부-체크&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AC%B8%EC%9E%90%EC%97%B4%EC%9D%98-%EB%8F%99%EC%9D%BC%EC%97%AC%EB%B6%80-%EC%B2%B4%ED%81%AC&quot; aria-label=&quot;문자열의 동일여부 체크 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;문자열의 동일여부 체크&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;=&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;값이 같은가?&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;if [ &quot;$a&quot; = &quot;$b&quot; ]&lt;/code&gt; 과 같이 사용합니다. 띄어쓰기가 반드시 필요합니다!!!&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;==&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;값이 같은가?&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;if [ &quot;$a&quot; == &quot;$b&quot; ]&lt;/code&gt; 과 같이 사용합니다. &lt;code class=&quot;language-text&quot;&gt;==&lt;/code&gt; 비교는 double-brackets에서는 전혀 다르게 동작할 수 있음에 유의하십시오.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;!=&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;값이 같지 않은가?&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;if [ &quot;$a&quot; != &quot;$b&quot; ]&lt;/code&gt; 과 같이 사용합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;문자열의-사전-순서-체크&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AC%B8%EC%9E%90%EC%97%B4%EC%9D%98-%EC%82%AC%EC%A0%84-%EC%88%9C%EC%84%9C-%EC%B2%B4%ED%81%AC&quot; aria-label=&quot;문자열의 사전 순서 체크 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;문자열의 사전 순서 체크&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;&amp;lt;&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;값이 작은가 (ASCII 알파벳 순)&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;if [[ &quot;$a&quot; &amp;lt; &quot;$b&quot; ]]&lt;/code&gt; 혹은 &lt;code class=&quot;language-text&quot;&gt;if [ &quot;$a&quot; \&amp;lt; &quot;$b&quot; ]&lt;/code&gt; 과 같이 사용합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;&gt;&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;값이 큰가? (ASCII 알파벳 순)&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;if [[ &quot;$a&quot; &gt; &quot;$b&quot; ]]&lt;/code&gt; 혹은 &lt;code class=&quot;language-text&quot;&gt;if [[ &quot;$a&quot; \&gt; &quot;$b&quot; ]]&lt;/code&gt; 과 같이 사용합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;문자열의-null-여부-체크&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AC%B8%EC%9E%90%EC%97%B4%EC%9D%98-null-%EC%97%AC%EB%B6%80-%EC%B2%B4%ED%81%AC&quot; aria-label=&quot;문자열의 null 여부 체크 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;문자열의 null 여부 체크&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;-z&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;문자열이 &lt;code class=&quot;language-text&quot;&gt;null&lt;/code&gt;인지를 묻는 구문입니다. 다시말해, 문자열의 길이가 &lt;code class=&quot;language-text&quot;&gt;0&lt;/code&gt;인지 묻는 것과 동일합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;-n&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;문자열이 null이 아니고, 길이가 &lt;code class=&quot;language-text&quot;&gt;0&lt;/code&gt;이 아닌지를 &lt;strong&gt;함께&lt;/strong&gt; 묻습니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;if [ -n &quot;${1}&quot; ]&lt;/code&gt; 과 같이 사용합니다.&lt;/li&gt;
&lt;li&gt;이 때, 예기치 않은 동작을 방지하려면 문자열을 항상 &lt;code class=&quot;language-text&quot;&gt;&quot;&lt;/code&gt;로 감싸서 사용합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;예를들어, 아래의 코드가 있다고 칩시다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token shebang important&quot;&gt;#!/bin/bash&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 이 값을 직접 바꾸며 테스트하면 됩니다!&lt;/span&gt;
&lt;span class=&quot;token assign-left variable&quot;&gt;abc&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;abc&apos;&lt;/span&gt;

&lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;step 1&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-z&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$abc&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;then&lt;/span&gt;
    &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;[1] empty string&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;[1] string is not null: &lt;span class=&quot;token variable&quot;&gt;$abc&lt;/span&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;fi&lt;/span&gt;

&lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;step 2&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;$abc&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;then&lt;/span&gt;
    &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;[2] string is not null: &lt;span class=&quot;token variable&quot;&gt;$abc&lt;/span&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
    &lt;span class=&quot;token builtin class-name&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;[2] empty string&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;fi&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;오잉&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%98%A4%EC%9E%89&quot; aria-label=&quot;오잉 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;오잉?&lt;/h2&gt;
&lt;h3 id=&quot;single-brackets-and-double-brackets&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#single-brackets-and-double-brackets&quot; aria-label=&quot;single brackets and double brackets permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;single-brackets and double-brackets&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://tldp.org/LDP/abs/html/testconstructs.html#DBLBRACKETS&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;참고경로&lt;/a&gt;를 읽어주세요!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Bash 2.02 버전(1998년에 릴리즈 되었습니다!) 부터 if 구문에서 double bracket 사용할 수 있게 되었습니다. 논리구문 처리에 있어서 보다 작성된 의도대로 돌게끔 해석합니다. IMHO, 잘 모르겠다면 double brackets을 사용하는게 좋을 듯 하네요.&lt;/p&gt;
&lt;h3 id=&quot;하나-더&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%95%98%EB%82%98-%EB%8D%94&quot; aria-label=&quot;하나 더 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;하나 더!&lt;/h3&gt;
&lt;p&gt;스크립트 작성 시 Regex를 쓸 때는 이른바 “교환법칙”이 성립하지 않습니다. 왜 그런지는 아래 설명을 함께 보시죠:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;When the ‘==’ and ‘!=’ operators are used, the string to the right of the operator is considered a pattern and matched according to the rules described below in &lt;a href=&quot;https://www.gnu.org/software/bash/manual/html_node/Pattern-Matching.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Pattern Matching&lt;/a&gt;, as if the extglob shell option were enabled. The ‘=’ operator is identical to ‘==’. If the nocasematch shell option (see the description of shopt in &lt;a href=&quot;https://www.gnu.org/software/bash/manual/html_node/The-Shopt-Builtin.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;The Shopt Builtin&lt;/a&gt;) is enabled, the match is performed without regard to the case of alphabetic characters. The return value is 0 if the string matches (‘==’) or does not match (‘!=’) the pattern, and 1 otherwise.&lt;/p&gt;
&lt;p&gt;’==’ 및 ‘!=’ 연산자를 사용하면 연산자 오른쪽의 문자열이 패턴으로 간주되어 마치 extglob 셸 옵션이 활성화된 것처럼 패턴 일치에서 설명하는 규칙에 따라 일치됩니다. ’=’ 연산자는 ’==‘와 동일합니다. nocasematch 셸 옵션(The Shopt Builtin의 shopt 설명 참조)이 활성화되면 알파벳 대소문자 구분 없이 일치가 수행됩니다. 문자열이 패턴과 일치(’==‘)하거나 일치하지 않으면(‘!=’) 반환 값은 0이고 그렇지 않으면 1입니다. 인용된 부분이 문자열로 일치하도록 강제하기 위해 패턴의 일부를 인용할 수 있습니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;마무리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%88%EB%AC%B4%EB%A6%AC&quot; aria-label=&quot;마무리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;마무리&lt;/h2&gt;
&lt;p&gt;공부하면 공부할 수록 더 정확히 알아야겠다는 것은 변함이 없습니다. 추후에도 Bash 스크립트를 더 봐야한다면, 공식 문서를 자주 살펴봐야겠군요.&lt;/p&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;참고링크
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://tldp.org/LDP/abs/html/comparison-ops.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;tldp.org의 배시 스크립트 강의 중&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://systemoverlord.com/2017/04/17/bash-extended-test-pattern-matching.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;extended-test의 패턴 매칭관련&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[HTTP의 인증에 대해 (2) 인증으로 JWT를 쓰는게 맞나?]]></title><description><![CDATA[JWT의 사용방안과, 세션 쿠키처럼 사용하는 JWT 토큰 사용방식이 과연 타당한 쓰임새인지 살펴봅시다.]]></description><link>https://blog.s3ich4n.me/devlog/backend/2022-10-05-considering-http-authn-pt02</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/backend/2022-10-05-considering-http-authn-pt02</guid><pubDate>Wed, 05 Oct 2022 22:52:00 GMT</pubDate><content:encoded>&lt;p&gt;이 시리즈에서는 HTTP의 인증(Authentication) 중 일부에 대해 다룹니다.&lt;/p&gt;
&lt;p&gt;이번 글에서는 JWT가 인증에서는 어떻게 쓰이며 인가에서는 어떻게 쓰이는지, JWT를 제대로 이해하고 사용하기 위한 방안에 대해 살펴보겠습니다.&lt;/p&gt;
&lt;h1 id=&quot;목차&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AA%A9%EC%B0%A8&quot; aria-label=&quot;목차 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;목차&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/devlog/backend/2022-10-05-considering-http-authn-pt01&quot;&gt;HTTP의 인증에 대해 (1)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;HTTP의 인증에 대해 (2)&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;jwt의-사용방안&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#jwt%EC%9D%98-%EC%82%AC%EC%9A%A9%EB%B0%A9%EC%95%88&quot; aria-label=&quot;jwt의 사용방안 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;JWT의 사용방안&lt;/h1&gt;
&lt;p&gt;JWT는 일반적으로 인증, 인가에 필요한 정보를 담는 도구로써 사용됩니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;인증서버와 다른 서비스 서버를 각각 분리하여 운용할 수 있습니다(Single sign-on)
&lt;ul&gt;
&lt;li&gt;OAuth 2.0 &lt;strong&gt;인가&lt;/strong&gt; 용 Bearer Token으로, OpenID Connect(이하 OIDC) &lt;strong&gt;인증&lt;/strong&gt; 의 Bearer Token으로 쓰일 수 있습니다.
&lt;ul&gt;
&lt;li&gt;OAuth 2.0의 Authorization Code Grant 플로우 중 Access Token과 Refresh Token을 리턴하는 시접에서 이 토큰들을 JWT로 전달할 수 있습니다.
&lt;ul&gt;
&lt;li&gt;이 토큰에는 &lt;strong&gt;인가 정보&lt;/strong&gt;를 담는 것이 목표입니다. 그런 이유로 이 토큰을 사용하여 &lt;strong&gt;인증으로 오용하지 않아야&lt;/strong&gt;합니다. &lt;a href=&quot;https://oauth.net/articles/authentication/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;관련 링크&lt;/a&gt;를 반드시 일독하시길 권장합니다.&lt;/li&gt;
&lt;li&gt;다시말해, OAuth 2.0으로는 권한부여에 집중해야 한다는 의미가 되겠습니다. (상기 관련링크를 누르면 &lt;em&gt;OAuth 2.0 is not an authentication protocol.&lt;/em&gt; 이란 말이 바로 나오는군요…)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;OIDC는 OAuth 2.0을 통해 만들어진 &lt;strong&gt;인증&lt;/strong&gt; 레이어 입니다.
&lt;ul&gt;
&lt;li&gt;유저 인증을 위한 값으로 &lt;code class=&quot;language-text&quot;&gt;id_token&lt;/code&gt; 이 추가되었으며, 이 값이 JWT 형식입니다.&lt;/li&gt;
&lt;li&gt;OIDC 의 인증, 인가 시점에서의 다양한 response 대해서는 &lt;a href=&quot;https://darutk.medium.com/diagrams-of-all-the-openid-connect-flows-6968e3990660&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 글&lt;/a&gt;을 읽어보시면 좋습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;OAuth 2.0과 OIDC의 차이점 및 오용방지를 위한 정보에 대해서는 &lt;a href=&quot;https://gruuuuu.github.io/security/ssofriends/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 링크&lt;/a&gt;에 정말 자세히 설명되어 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;간략히 정리하자면 인증과 인가의 요소로서 JWT 토큰을 전달하여 사용할 수 있습니다. 이런 탓에, 상호간 신뢰할 수 있는 서비스들 간 데이터를 주고받는 식의 시나리오에서는 매우 유용하게 쓰일 수 있지만, 잘못쓰기 매우 쉽다는 단점이 있습니다.&lt;/p&gt;
&lt;h2 id=&quot;기존-설명들하고-좀-다른데요&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B8%B0%EC%A1%B4-%EC%84%A4%EB%AA%85%EB%93%A4%ED%95%98%EA%B3%A0-%EC%A2%80-%EB%8B%A4%EB%A5%B8%EB%8D%B0%EC%9A%94&quot; aria-label=&quot;기존 설명들하고 좀 다른데요 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;기존 설명들하고 좀 다른데요?&lt;/h2&gt;
&lt;p&gt;사실 그래서 준비했습니다. JWT를 도입하고자 연구할 때, 흔히 맞닥뜨리는 여러 실수들(pitfalls)에 대해 바로잡고, JWT를 보다 상황에 맞도록 쓸 수 있게 논의하려고 합니다.&lt;/p&gt;
&lt;h1 id=&quot;jwt에-대한-오해를-바로잡읍시다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#jwt%EC%97%90-%EB%8C%80%ED%95%9C-%EC%98%A4%ED%95%B4%EB%A5%BC-%EB%B0%94%EB%A1%9C%EC%9E%A1%EC%9D%8D%EC%8B%9C%EB%8B%A4&quot; aria-label=&quot;jwt에 대한 오해를 바로잡읍시다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;JWT에 대한 오해를 바로잡읍시다&lt;/h1&gt;
&lt;p&gt;아래와 같은 세션으로 나누어 작성하고자 합니다&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;문서 전반에 사용될 개념정리&lt;/li&gt;
&lt;li&gt;JWT에 대한 오해 바로잡기&lt;/li&gt;
&lt;li&gt;JWT를 오해함으로 인해 발생하는 문제&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;개념정리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B0%9C%EB%85%90%EC%A0%95%EB%A6%AC&quot; aria-label=&quot;개념정리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;개념정리&lt;/h2&gt;
&lt;p&gt;아래에 걸쳐 사용할 개념정리를 하고 갑시다&lt;/p&gt;
&lt;h3 id=&quot;개념정리-1-쿠키-vs-jwt를-비교하는게-맞냐&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B0%9C%EB%85%90%EC%A0%95%EB%A6%AC-1-%EC%BF%A0%ED%82%A4-vs-jwt%EB%A5%BC-%EB%B9%84%EA%B5%90%ED%95%98%EB%8A%94%EA%B2%8C-%EB%A7%9E%EB%83%90&quot; aria-label=&quot;개념정리 1 쿠키 vs jwt를 비교하는게 맞냐 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;개념정리 (1) 쿠키 vs. JWT를 비교하는게 맞냐?&lt;/h3&gt;
&lt;p&gt;세션을 담는 쿠키와 JWT는 비교대상이 아닙니다. 완전 다르기 때문에 둘을 비교하는 것은 의미가 없습니다. 세션과 JWT, 그리고 쿠키와 LocalStorage를 비교하는 것이 의미있습니다.&lt;/p&gt;
&lt;h3 id=&quot;개념정리-2&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B0%9C%EB%85%90%EC%A0%95%EB%A6%AC-2&quot; aria-label=&quot;개념정리 2 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;개념정리 (2)&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;stateless JWT: 세션 데이터가 담긴 JWT 토큰. 인코딩하면 바로 토큰 되는 케이스.&lt;/li&gt;
&lt;li&gt;stateful JWT: 세션을 가리키는 레퍼런스나 ID가 담긴 JWT 토큰. 세션 자체는 서버에 있음 (얘는 암호학적으로 사인되어있어요)&lt;/li&gt;
&lt;li&gt;session token/cookie: 통상의 세션 ID. 여느 웹 프레임워크에 있는 그것을 의미합니다. (얘는 평문이에요)&lt;/li&gt;
&lt;li&gt;LocalStorage
&lt;ul&gt;
&lt;li&gt;자바스크립트 API입니다.&lt;/li&gt;
&lt;li&gt;유저가 브라우저에 자바스크립트만 접근가능한 값을 저장할 수 있게 합니다.&lt;/li&gt;
&lt;li&gt;세션 스토리지라고 부르기도 합니다.&lt;/li&gt;
&lt;li&gt;쿠키를 사용해 세션 데이터를 저장하는 것의 대체제로 많이 인식되지요.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;jwt에-대한-오해&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#jwt%EC%97%90-%EB%8C%80%ED%95%9C-%EC%98%A4%ED%95%B4&quot; aria-label=&quot;jwt에 대한 오해 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;JWT에 대한 오해&lt;/h2&gt;
&lt;p&gt;인터넷에 흔히 JWT로 로그인하는 방식을 구현하는 게시글은 아래와 같이 작성되어 있습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;credential 정보를 가지고 로그인한다.&lt;/li&gt;
&lt;li&gt;credential 정보가 유효한지 확인하고 JWT 토큰을 생성한다&lt;/li&gt;
&lt;li&gt;JWT를 담고 리턴한다.&lt;/li&gt;
&lt;li&gt;브라우저는 JWT를 LocalStorage에 저장한다.&lt;/li&gt;
&lt;li&gt;위에 저장한 토큰을 꺼내와서 다음 요청에 사용한다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이거 지난 장에서 살펴보던 쿠키와 세션을 이용한 인증방식과 매우 유사하네요 그리고 이러한 방식으로 JWT를 사용했을 때 생기는 함정이(pitfall) 있습니다.&lt;/p&gt;
&lt;h3 id=&quot;훨씬-유연하다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%9B%A8%EC%94%AC-%EC%9C%A0%EC%97%B0%ED%95%98%EB%8B%A4&quot; aria-label=&quot;훨씬 유연하다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;훨씬 유연하다?&lt;/h3&gt;
&lt;p&gt;세션 쿠키를 사용하더라도 똑같이 커스텀 필드를 넣을 수 있습니다. Private Claim names를 쓰는 것 처럼요.&lt;/p&gt;
&lt;h3 id=&quot;스케일-아웃이-쉽다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%8A%A4%EC%BC%80%EC%9D%BC-%EC%95%84%EC%9B%83%EC%9D%B4-%EC%89%BD%EB%8B%A4&quot; aria-label=&quot;스케일 아웃이 쉽다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;스케일-아웃이 쉽다?&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;외부 DB가 별도로 필요없긴 합니다. 이미 정보를 담고있으니까요. 하지만,
stateful JWT에는 적용하기 어렵습니다. 세션 자체가 서버에 있으니, 여전히 DB 호출을 해야합니다.&lt;/li&gt;
&lt;li&gt;로그인해서 받아오는 stateful 세션을 쓴다고 해도 스케일-아웃이 가능합니다.
&lt;ul&gt;
&lt;li&gt;매번 세션 검증을 해야하는 속도를 올리려면? → 캐시를 둡니다.&lt;/li&gt;
&lt;li&gt;여러 서버, 여러 클러스터에 대해서도 적용하려면? → sticky session이나 dedicated session storage 확보와 스토리지 클러스터링 등을 통해 얻을 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;쓰기-쉽다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%93%B0%EA%B8%B0-%EC%89%BD%EB%8B%A4&quot; aria-label=&quot;쓰기 쉽다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;쓰기 쉽다?&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;글쎄요. 앞단 뒷단 모두 JWT 토큰을 가공하고 사용하는 것, 세션 스토리지에 접근하거나 세션을 관리하고 주는 것 모두 필요합니다.&lt;/li&gt;
&lt;li&gt;JWT 외부 라이브러리를 쓰는 것 만큼, 이미 오랜기간동안 수많은 웹 프레임워크에서 증명되었고 장고에서도 &lt;a href=&quot;https://docs.djangoproject.com/en/4.1/topics/http/sessions/#using-sessions-in-views&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;쓰기 쉽게 구현&lt;/a&gt; 되어있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;만료기간을-정해줄-수-있다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%8C%EB%A3%8C%EA%B8%B0%EA%B0%84%EC%9D%84-%EC%A0%95%ED%95%B4%EC%A4%84-%EC%88%98-%EC%9E%88%EB%8B%A4&quot; aria-label=&quot;만료기간을 정해줄 수 있다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;만료기간을 정해줄 수 있다?&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;세션도 충분히 가능합니다. 위에 첨부한 링크에서 &lt;a href=&quot;https://docs.djangoproject.com/en/4.1/topics/http/sessions/#django.contrib.sessions.backends.base.SessionBase.set_expiry&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;set_expiry(value)&lt;/code&gt; 함수&lt;/a&gt; 가 정확히 그 역할을 합니다.
&lt;ul&gt;
&lt;li&gt;세션 관련 &lt;a href=&quot;https://docs.djangoproject.com/en/4.1/ref/settings/#sessions&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;변수들&lt;/a&gt;도 눈여겨 봐야겠죠.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;보안이-강화되어있다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%B3%B4%EC%95%88%EC%9D%B4-%EA%B0%95%ED%99%94%EB%90%98%EC%96%B4%EC%9E%88%EB%8B%A4&quot; aria-label=&quot;보안이 강화되어있다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;보안이 강화되어있다?&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;아니오, 암호화된 서명을 한다고 해서 보안이 강화되는 것은 아닙니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;먼저, HTTPS 통신으로 메시지 자체를 못 보게 하는 것이 우선입니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;쿠키에 제한을 걸어 자바스크립트 코드가 함부로 사용하지 못하게 하는 것이 방법입니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;CSRF&lt;/code&gt;를 웹 프레임워크 수준에서 방어하고, 프론트엔드 파트에 &lt;code class=&quot;language-text&quot;&gt;XSS&lt;/code&gt;를 방어하도록 하는 로직을 작성하도록 요청하는 것이 그 다음입니다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;jwt를-오해하면-이런-문제가-생깁니다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#jwt%EB%A5%BC-%EC%98%A4%ED%95%B4%ED%95%98%EB%A9%B4-%EC%9D%B4%EB%9F%B0-%EB%AC%B8%EC%A0%9C%EA%B0%80-%EC%83%9D%EA%B9%81%EB%8B%88%EB%8B%A4&quot; aria-label=&quot;jwt를 오해하면 이런 문제가 생깁니다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;JWT를 오해하면 이런 문제가 생깁니다!&lt;/h2&gt;
&lt;h3 id=&quot;용량이-훨씬-커진다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9A%A9%EB%9F%89%EC%9D%B4-%ED%9B%A8%EC%94%AC-%EC%BB%A4%EC%A7%84%EB%8B%A4&quot; aria-label=&quot;용량이 훨씬 커진다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;용량이 훨씬 커진다&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;JWT는 기본적으로 크기가 큽니다. 커스텀 필드를 조금 넣었다 하면, 세션보다 훨씬 커집니다.&lt;/li&gt;
&lt;li&gt;세션이 단순히 32bit의 문자열이라면, JWT는 못해도 그 10배 이상입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;로그아웃-기능이-사실상-없다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A1%9C%EA%B7%B8%EC%95%84%EC%9B%83-%EA%B8%B0%EB%8A%A5%EC%9D%B4-%EC%82%AC%EC%8B%A4%EC%83%81-%EC%97%86%EB%8B%A4&quot; aria-label=&quot;로그아웃 기능이 사실상 없다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;로그아웃 기능이 사실상 “없다”&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;만료기간 전까지는 사실상 로그아웃 기능이 없다고 봐야합니다. 그리하여 이를 관리하기 위해 revocation list(일종의 만료 세션 리스트)를 따로 관리하면 될텐데, 그러면 기존의 세션 관리와 다를게 없지요. 게다가 용량이 훨씬 큰 토큰이 bandwidth를 잡아먹습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;그리하여 이런 해결책 또한 제기되었습니다[1]:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;특정 로그아웃 콜을 받으면, 만료기간 전에 revoke 시킨 토큰의 글로벌 리스트를 갖고있습니다.&lt;/li&gt;
&lt;li&gt;로그인 관련 서버가 매븐 해당 리스트에 대해 요청/응답 하지 않고 각 비즈니스 서버에 pub/sub 메커니즘을 통해서 즉각 처리하도록 합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;jwt-스펙-오용abuse으로-인한-보안-취약점&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#jwt-%EC%8A%A4%ED%8E%99-%EC%98%A4%EC%9A%A9abuse%EC%9C%BC%EB%A1%9C-%EC%9D%B8%ED%95%9C-%EB%B3%B4%EC%95%88-%EC%B7%A8%EC%95%BD%EC%A0%90&quot; aria-label=&quot;jwt 스펙 오용abuse으로 인한 보안 취약점 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;JWT 스펙 오용(abuse)으로 인한 보안 취약점&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;설정이 잘못되면 아무나 JWT 토큰을 생성할 수 있고, 유저가 다른 유저인 척 하는게 가능합니다.&lt;/li&gt;
&lt;li&gt;Auth0에는 &lt;a href=&quot;https://insomniasec.com/blog/auth0-jwt-validation-bypass&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;JWT Validation bypass&lt;/a&gt; 과 같이, 권한을 무시하고 요청할 수 있는 버그가 있었습니다.&lt;/li&gt;
&lt;li&gt;그 외에도 &lt;a href=&quot;https://infosecwriteups.com/attacks-on-json-web-token-jwt-278a49a1ad2e&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;JWT의 각종 취약점&lt;/a&gt;에 대한 글을 소개드립니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;정리해보면&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A0%95%EB%A6%AC%ED%95%B4%EB%B3%B4%EB%A9%B4&quot; aria-label=&quot;정리해보면 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;정리해보면?&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;JWT는 일회용 인증 토큰(single-use authorization token) 으로 쓰는 편이 좋겠습니다.&lt;/li&gt;
&lt;li&gt;JWT 스펙을 살펴보면 다음과 같은 글귀가 나옵니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;JSON Web Token (JWT) is a compact, URL-safe means of representing claims to be transferred between two parties.
(두 당사자 간에 전송되는 클레임을 나타내는 간결한 URL 안전 수단입니다.)&lt;/p&gt;
&lt;p&gt;[…] enabling the claims to be digitally signed or integrity protected with a Message Authentication Code (MAC) and/or encrypted.
(디지털 서명하거나 MAC(메시지 인증 코드) 또는 암호화된 무결성 보호를 가능하게 합니다.)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;다시말해 “claim”은 마치 명령처럼, 이것 할 수 있다던데 하는 일회성 식별표 정도로 인식하면 될 것 입니다. 그리고 암호화된 서명도 함께요.&lt;/li&gt;
&lt;li&gt;그런 의미로 제가 참고한 모든 글들을 공통적으로 살펴보면, 세션과 JWT 토큰을 병행해서 쓰거나 각각 용도에 맞게 쓰는 것이 좋겠습니다.&lt;/li&gt;
&lt;li&gt;제 생각에는 유저 간의 로그인은 세션으로 처리하고, 목표에 따라 잘 분리 된 API 서버간의 통신에서 JWT를 활용하는 것이 어떨까 싶습니다. 예를 들면 다음과 같겠습니다:
&lt;ol&gt;
&lt;li&gt;서버-서버 간 JWT를 담고 필요한 요청-응답을 수행해야 한다면 이는 충분히 말이되는 내용이다.&lt;/li&gt;
&lt;li&gt;예를들어 SPA(Single-page Application) 에서 이것저것 많은 API를 호출해야 하고, 그 권한을 토큰을 통해 관리한다면 훨씬 효율적일 것으로 보입니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;그 정도로 큰 서비스에 대해 다루게 될 때를 위해, 다음번엔 OAuth 2.0과 OIDC 및 &lt;a href=&quot;https://en.wikipedia.org/wiki/Federated_identity&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Fedarated identity&lt;/a&gt;와 같은 키워드를 알아보는 글을 작성해보겠습니다.&lt;/p&gt;
&lt;h1 id=&quot;마무리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%88%EB%AC%B4%EB%A6%AC&quot; aria-label=&quot;마무리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;마무리&lt;/h1&gt;
&lt;p&gt;이번 글을 통해, 아래 내용들을 살펴볼 수 있었습니다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;JWT를 세션 쿠키처럼 사용하면 아래와 같은 문제가 생깁니다.
&lt;ol&gt;
&lt;li&gt;좋은 줄 알았던 점은 사실 세션으로도 처리가 가능했습니다.&lt;/li&gt;
&lt;li&gt;JWT를 잘못 사용함으로 인한 문제를 해결하기 위한 사이드 이펙트가 있었습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;쉽게 구할 수 있고, 장점&lt;strong&gt;만&lt;/strong&gt; 보인다는 이유로 이해없이 기술을 사용하지 맙시다. 정말 위합니다. 보안과 기능의 장단점과 잠재적 문제사항을 모두 알고 있어야 합니다.‘보일러플레이트’ 및 템플릿에서 제외하고 기본 선택으로 만들지 마십시오.&lt;/li&gt;
&lt;li&gt;기술을 잘못 쓰지 않도록, 많은 케이스를 배워둡시다. 필요와 적절한 요구사항에 따라 기술을 택해야겠습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;읽어주셔서 감사합니다.&lt;/p&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;References
&lt;ul&gt;
&lt;li&gt;[1] &lt;a href=&quot;https://evertpot.com/jwt-is-a-bad-default/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;sidenotes 항목&lt;/a&gt; 참조&lt;/li&gt;
&lt;li&gt;[2] &lt;a href=&quot;https://developer.okta.com/blog/2017/08/17/why-jwts-suck-as-session-tokens&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;링크참조&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;[3] &lt;a href=&quot;http://cryto.net/~joepie91/blog/2016/06/13/stop-using-jwt-for-sessions/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;링크참조&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;[4] &lt;a href=&quot;https://redis.com/blog/json-web-tokens-jwt-are-dangerous-for-user-sessions/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;링크참조&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;[5] &lt;a href=&quot;https://www.youtube.com/watch?v=GdJ0wFi1Jyo&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;링크참조&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[HTTP의 인증에 대해 (1) 인증의 발전사]]></title><description><![CDATA[HTTP 기본 스펙을 이용한 기초적 인증부터 쿠키와 세션을, 그리고 갑자기 들불처럼 등장한 JWT이 뭔지까지만 살펴봅니다.]]></description><link>https://blog.s3ich4n.me/devlog/backend/2022-10-05-considering-http-authn-pt01</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/backend/2022-10-05-considering-http-authn-pt01</guid><pubDate>Wed, 05 Oct 2022 22:51:00 GMT</pubDate><content:encoded>&lt;p&gt;이 시리즈에서는 HTTP의 인증(Authentication)에 대해 다룹니다.&lt;/p&gt;
&lt;p&gt;이번 글에서는 HTTP의 인증이 어떤 방식으로 발전되어 왔으며, JWT가 뭐고 무엇인지를 다루도록 하겠습니다.&lt;/p&gt;
&lt;h1 id=&quot;목차&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AA%A9%EC%B0%A8&quot; aria-label=&quot;목차 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;목차&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;HTTP의 인증에 대해 (1)&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/devlog/backend/2022-10-05-considering-http-authn-pt02&quot;&gt;HTTP의 인증에 대해 (2)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;인증authentication과-인가authorization&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%B8%EC%A6%9Dauthentication%EA%B3%BC-%EC%9D%B8%EA%B0%80authorization&quot; aria-label=&quot;인증authentication과 인가authorization permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;인증(Authentication)과 인가(Authorization)?&lt;/h1&gt;
&lt;p&gt;헷갈리기 쉬운 인증과 인가부터 짚고 넘어가도록 하겠습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;인증&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;서버가 유저에게, “리소스에 접근하는 당신이 누구십니까?”를 물어볼 수 있도록 하는 과정입니다. 쉽게말해 열쇠로 문을 여는 것이죠.&lt;/li&gt;
&lt;li&gt;유저가 인증을 하면, 서버는 “이 유저가 정말 맞는지” 감별합니다.&lt;/li&gt;
&lt;li&gt;유저가 인증에 성공했다면 &lt;code class=&quot;language-text&quot;&gt;2xx&lt;/code&gt; 응답을, 실패했다면 &lt;code class=&quot;language-text&quot;&gt;4xx&lt;/code&gt; 응답을 받을 것입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;인가&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;서버가 유저에게, “리소스에 당신이 무엇을 할 수 있습니까?”를 물어볼 수 있도록 하는 과정입니다. 쉽게말해 권한부여 입니다.&lt;/li&gt;
&lt;li&gt;유저가 인가를 거쳐 리소스에 “요청”을 수행하면, 서버는 “이 유저가 할 수 있는 요청”인지 감별합니다&lt;/li&gt;
&lt;li&gt;유저의 권한이 올바르다면 &lt;code class=&quot;language-text&quot;&gt;2xx&lt;/code&gt; 응답을, 올바르지 않다면 &lt;code class=&quot;language-text&quot;&gt;4xx&lt;/code&gt; 응답을 받을 것입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;1-http의-초창기-인증&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1-http%EC%9D%98-%EC%B4%88%EC%B0%BD%EA%B8%B0-%EC%9D%B8%EC%A6%9D&quot; aria-label=&quot;1 http의 초창기 인증 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1. HTTP의 초창기 인증&lt;/h1&gt;
&lt;p&gt;데이터를 받아보는 당신이 누구인지를 묻는 요구사항은 HTTP/1.0 스펙부터 등장하였습니다[1]. 1996년부터 등장했고 현재는 사용하지 않습니다. 다만 어떤식으로 발전했는지를 살펴봅시다.&lt;/p&gt;
&lt;h2 id=&quot;basic-인증&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#basic-%EC%9D%B8%EC%A6%9D&quot; aria-label=&quot;basic 인증 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;BASIC&lt;/code&gt; 인증&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;유저명과 패스워드를 &lt;code class=&quot;language-text&quot;&gt;base64(유저명 + &quot;:&quot; + 패스워드)&lt;/code&gt;로 인코딩하여 아래와 같은 방식으로 헤더에 추가합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Authorization: &quot;Basic dXNlcjpwYXNz&quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;digest-인증&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#digest-%EC%9D%B8%EC%A6%9D&quot; aria-label=&quot;digest 인증 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;Digest&lt;/code&gt; 인증&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;먼저 &lt;code class=&quot;language-text&quot;&gt;401&lt;/code&gt; 응답으로 거부를 받은 후, 거기서 얻은 정보를 가지고 재요청을 하는 것이 특징입니다.&lt;/li&gt;
&lt;li&gt;공통된 해시 함수를 이용하여 서버와 유저 모두 인증에 필요한 값을 연산하여 “인증”을 수행합니다.&lt;/li&gt;
&lt;li&gt;과정은 아래와 같습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;보호된 영역에 접속하려할 때, &lt;code class=&quot;language-text&quot;&gt;401 Unauthorized&lt;/code&gt;를 받고, 서버로부터 특정 값을 받습니다(&lt;code class=&quot;language-text&quot;&gt;handle_401&lt;/code&gt; 호출).&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;WWW-Authenticate: Digest realm=&quot;영역명&quot;, nonce=&quot;임의의값&quot;, algorithm=&quot;알고리즘명&quot;, qop=&quot;auth&quot;&lt;/code&gt;
&lt;ol&gt;
&lt;li&gt;접근하고자 하는 영역(&lt;code class=&quot;language-text&quot;&gt;realm&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;서버에서 무작위로 생성하는 데이터(&lt;code class=&quot;language-text&quot;&gt;nonce&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;서버의 보호수준 (&lt;code class=&quot;language-text&quot;&gt;qop&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;nonce&lt;/code&gt;를 통해 호출한 횟수 (&lt;code class=&quot;language-text&quot;&gt;nc&lt;/code&gt;)&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;유저는(사실은 유저의 클라이언트죠) &lt;code class=&quot;language-text&quot;&gt;A1&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;A2&lt;/code&gt;와, 무작위로 생성한 &lt;code class=&quot;language-text&quot;&gt;cnonce&lt;/code&gt; 라는 값을 토대로 &lt;code class=&quot;language-text&quot;&gt;response&lt;/code&gt;를 계산합니다(&lt;code class=&quot;language-text&quot;&gt;build_digest_header&lt;/code&gt;).&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;A1&lt;/code&gt;: 유저명 ”:” realm ”:” 패스워드&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;A2&lt;/code&gt;: HTTP 메소드 ”:” 컨텐츠 URI&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;response&lt;/code&gt;: MD5(MD5(&lt;code class=&quot;language-text&quot;&gt;A1&lt;/code&gt;) ”:” nonce ”:” nc ”:” cnonce ”:” qop ”:” MD5(&lt;code class=&quot;language-text&quot;&gt;A2&lt;/code&gt;))&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;서버측은 자신이 가진 유저명/패스워드와 위 과정에서 받은 정보를 가지고 “동일한”response를 계산하게 되면, 인증에 성공하게 됩니다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;옛-인증의-한계점&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%98%9B-%EC%9D%B8%EC%A6%9D%EC%9D%98-%ED%95%9C%EA%B3%84%EC%A0%90&quot; aria-label=&quot;옛 인증의 한계점 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;옛 인증의 한계점&lt;/h2&gt;
&lt;p&gt;이런 인증을 현대에 대응하기에는 무리가 있습니다. 이유는 아래와 같습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;요청/응답마다 매번 연산하는 것이 부담입니다.&lt;/li&gt;
&lt;li&gt;로그인 화면을 사용자화 하기 어렵습니다.&lt;/li&gt;
&lt;li&gt;명시적 로그오프 명령을 내리기 어렵습니다.&lt;/li&gt;
&lt;li&gt;로그인한 유저를 식별할 수 없습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이러한 사항 때문에, &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/HTML/Element/form&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;HTML의 &lt;code class=&quot;language-text&quot;&gt;Form&lt;/code&gt;&lt;/a&gt;을 이용한 로그인과, 쿠키를 이용한 세션관리 조합으로 발달되게 되었습니다.&lt;/p&gt;
&lt;h1 id=&quot;2-쿠키와-세션을-사용한-인증&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2-%EC%BF%A0%ED%82%A4%EC%99%80-%EC%84%B8%EC%85%98%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%9C-%EC%9D%B8%EC%A6%9D&quot; aria-label=&quot;2 쿠키와 세션을 사용한 인증 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2. 쿠키와 세션을 사용한 인증&lt;/h1&gt;
&lt;p&gt;현대에까지 널리 사용되고 있는 브라우저 쿠키와 세션을 통한 인증이 있곘습니다. 아래에서 기본적인 개념을 살펴보겠습니다.&lt;/p&gt;
&lt;h2 id=&quot;쿠키와-세션을-이용한-인증&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%BF%A0%ED%82%A4%EC%99%80-%EC%84%B8%EC%85%98%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EC%9D%B8%EC%A6%9D&quot; aria-label=&quot;쿠키와 세션을 이용한 인증 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;쿠키와 세션을 이용한 인증&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;유저는 Form을 통해 ID와 비밀전호를 직접 전송합니다.
&lt;ul&gt;
&lt;li&gt;이 탓에 SSL/TLS가 필수입니다.&lt;/li&gt;
&lt;li&gt;보안 통신을 통해 HTTP 요청/응답을 주고받는 것은 HTTP/1.1 스펙부터 등장했습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;서버는 인증 후 문제가 없으면 세션 토큰을 발행해두고 자신의 데이터베이스에 저장합니다(장고에서의 방안은 아래에 후술합니다).
&lt;ul&gt;
&lt;li&gt;이 때, 관련 토큰을 쿠키에 저장하도록 유저(클라이언트)에게 값을 돌려줍니다.&lt;/li&gt;
&lt;li&gt;이런 쿠키 사용에는 제약이 걸려있습니다.&lt;/li&gt;
&lt;li&gt;쿠키도 평문으로 갈 수 있고, 원칙상 유저가 쿠키를 변조해서 보낼 수도 있습니다(!)&lt;/li&gt;
&lt;li&gt;따라서 쿠키 사용에는 아래와 같은 제약이 걸릴 수 있지요.
&lt;ul&gt;
&lt;li&gt;쿠키의 수명을 결정하기(&lt;code class=&quot;language-text&quot;&gt;Expires&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;Max-Age&lt;/code&gt; 속성)&lt;/li&gt;
&lt;li&gt;유저가 쿠키를 전송할 대상 서버 (&lt;code class=&quot;language-text&quot;&gt;Domain&lt;/code&gt; 속성)&lt;/li&gt;
&lt;li&gt;유저가 쿠키를 전송할 대상 서버의 경로 (&lt;code class=&quot;language-text&quot;&gt;Path&lt;/code&gt; 속성)&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;HTTPS&lt;/code&gt; 를 통한 접속일 때만 서버로 쿠키를 전송 (&lt;code class=&quot;language-text&quot;&gt;Secure&lt;/code&gt; 속성)&lt;/li&gt;
&lt;li&gt;자바스크립트 엔진으로부터 쿠키를 감추는 속성을 추가 (&lt;code class=&quot;language-text&quot;&gt;HttpOnly&lt;/code&gt; 속성)&lt;/li&gt;
&lt;li&gt;(Chrome 브라우저 추가스펙) 동일한 Origin의 도메인에만 전송(&lt;code class=&quot;language-text&quot;&gt;SameSite&lt;/code&gt; 속성, 비표준입니다!)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;인증을 마쳤으므로, 이후 쿠키를 재전송하고 서버에서는 “서명”을 확인하여 클라이언트를 재확인하며 서비스합니다. (인가는 그 다음 이야기겠지요.)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;장고에서는&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9E%A5%EA%B3%A0%EC%97%90%EC%84%9C%EB%8A%94&quot; aria-label=&quot;장고에서는 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;장고에서는?&lt;/h2&gt;
&lt;p&gt;여러 방법이 있겠습니다만, &lt;a href=&quot;https://docs.djangoproject.com/en/4.1/topics/http/sessions/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;장고에서 세션을 활용하는 방안&lt;/a&gt;은 여러가지가 있습니다.&lt;/p&gt;
&lt;p&gt;세션을 어떤 식으로 관리할지에 대한 설정은 아래와 같습니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Database-backend 세션관리&lt;/li&gt;
&lt;li&gt;Cached 세션관리&lt;/li&gt;
&lt;li&gt;file-based 세션관리&lt;/li&gt;
&lt;li&gt;cookie-based 세션관리&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;django-rest-framework-에서는&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#django-rest-framework-%EC%97%90%EC%84%9C%EB%8A%94&quot; aria-label=&quot;django rest framework 에서는 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Django REST Framework 에서는?&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.django-rest-framework.org/api-guide/authentication/#sessionauthentication&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;SessionAuthentication&lt;/a&gt; 을 통해 구현됩니다. 이 값을 사용하면 장고 설정 내의 기본 세션정보(위의 4가지 방법 중 하나)를 따라갑니다. 필요에 따라 상기 장고에서의 설정값을 확실히 알아둬야 올바르게 쓸 수 있을 것입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;3-jwtjson-web-token의-등장&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#3-jwtjson-web-token%EC%9D%98-%EB%93%B1%EC%9E%A5&quot; aria-label=&quot;3 jwtjson web token의 등장 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3. JWT(JSON Web Token)의 등장&lt;/h1&gt;
&lt;p&gt;이어서 JWT입니다. 우선은 간략하게 JWT가 무엇인지 살펴보겠습니다.&lt;/p&gt;
&lt;h2 id=&quot;jwt란&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#jwt%EB%9E%80&quot; aria-label=&quot;jwt란 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;JWT란?&lt;/h2&gt;
&lt;p&gt;JSON Web Token(JWT)는 2010년 10월 28일, 처음 발표되었습니다. 간략한 정보는 아래와 같습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc7519&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;RFC 7519&lt;/a&gt; 로 발표된 proposed Internet standard 입니다.&lt;/li&gt;
&lt;li&gt;JSON을 상호간 안전하게 교환하려는 체계로써 제시된 토큰이지요(중요!)&lt;/li&gt;
&lt;li&gt;claim이란 값을 가진 JSON 페이로드와, 시그니처 데이터를 생성합니다.&lt;/li&gt;
&lt;li&gt;이 토큰은 공개키/비밀키(RSA나 ECDSA 등)로 열고 잠그거나, shared secrets값(HAMC)을 통해 열고 잠글 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;소개는 이쯤하고, 구조를 먼저 살펴본 후 사용례를 살펴봅시다.&lt;/p&gt;
&lt;h2 id=&quot;구조&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B5%AC%EC%A1%B0&quot; aria-label=&quot;구조 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;구조&lt;/h2&gt;
&lt;p&gt;JWT의 구조를 살펴봅시다. JWT는 헤더.페이로드.시그니처 의 세 부분으로 구성됩니다. &lt;code class=&quot;language-text&quot;&gt;.&lt;/code&gt;은 구분자로 사용됩니다.&lt;/p&gt;
&lt;p&gt;JWT는 이런 모양을 가집니다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;aaaaa.bbbbb.ccccc&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;보다 정확한 스펙은 상술한 RFC 문서를 참고해주세요.&lt;/p&gt;
&lt;h3 id=&quot;헤더&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%97%A4%EB%8D%94&quot; aria-label=&quot;헤더 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;헤더&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;두 가지 값을 가집니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;알고리즘: 시그니처가 어떤 알고리즘으로 생성되었는지 식별합니다. 예를 들어 &lt;code class=&quot;language-text&quot;&gt;HS256&lt;/code&gt; 이라는 값은, &lt;code class=&quot;language-text&quot;&gt;HMAC-SHA256&lt;/code&gt;을 사용하여 이 토큰을 생성하였음을 의미합니다. 통상적으로 사용할 수 있는 알고리즘은 &lt;a href=&quot;https://datatracker.ietf.org/doc/html/draft-ietf-jose-json-web-algorithms-40&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 링크&lt;/a&gt;를 참고해주세요.&lt;/li&gt;
&lt;li&gt;타입: &lt;code class=&quot;language-text&quot;&gt;JWT&lt;/code&gt; 를 사용하거나 스펙에 맞게 사용합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;아래와 같은 모양으로 생겼습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;{
  &quot;alg&quot;: &quot;HS256&quot;,
  &quot;typ&quot;: &quot;JWT&quot;
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;페이로드&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%8E%98%EC%9D%B4%EB%A1%9C%EB%93%9C&quot; aria-label=&quot;페이로드 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;페이로드&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;claim&lt;/code&gt;의 모임입니다. 클레임은 크게 세 종류로 나눌 수 있습니다.
&lt;ul&gt;
&lt;li&gt;Registered Claim names
&lt;ul&gt;
&lt;li&gt;JWT 설계자들이 일반적으로 담아서 쓸만한 값들을 미리 정의한 값입니다. 아래와 같습니다
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;iss&lt;/code&gt;: 누가 이 토큰을 발급했는지를 표기합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;exp&lt;/code&gt;: 만기 시간을 기재합니다. (단위: miliseconds가 반영된 Epoch time)&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;sub&lt;/code&gt;: 토큰의 발급 목적을 의미합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;aud&lt;/code&gt;: 토큰을 받는 사람을 의미합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;nbf&lt;/code&gt;: 연산의 이유로 이 시간 전에는 토큰이 유효하지 않다는 시간을 의미합니다. (단위: miliseconds가 반영된 Epoch time)&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;iat&lt;/code&gt;: 언제 이 토큰이 발급되었는지를 의미합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;jti&lt;/code&gt;: JWT 토큰의 고유ID 입니다. 중복되지 않는 값으로 생성시켜야 합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Public Claim names
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.iana.org/assignments/jwt/jwt.xhtml&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;IANA JWT 레지스트리&lt;/a&gt;에 정의되거나 중복 방지 등의 이유로 URI로 지정되기도 합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Private Claim names
&lt;ul&gt;
&lt;li&gt;말 그대로인 커스텀 클레임 값입니다. 상기 클레임들과 중복되지 않는 값입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;상기 클레임 값들을 필요에 따라 넣어서 사용할 수 있습니다. registered clame name에 속한 값을 반드시 사용하도록 강제되진 않으나, 해당 의미를 가지는 값이라면 기재된 이름을 쓰면 됩니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;(!) claim: JWT에 의해 전달된 개별 값들이 구성원인 JSON 개체를 나타냅니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;아래와 같은 모양으로 생겼습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;{
  &quot;sub&quot;: &quot;1&quot;,
  &quot;name&quot;: &quot;s3ich4n&quot;,
  &quot;admin&quot;: false
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;시그니처&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%8B%9C%EA%B7%B8%EB%8B%88%EC%B2%98&quot; aria-label=&quot;시그니처 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;시그니처&lt;/h3&gt;
&lt;p&gt;토큰이 유효한지 검증합니다. 시그니처는 &lt;a href=&quot;https://datatracker.ietf.org/doc/html/rfc4648&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;RFC 4648(Base64Url)&lt;/a&gt;을 사용하여 헤더와 페이로드를 인코딩하기위해 계산됩니다. 그리고 구분자 &lt;code class=&quot;language-text&quot;&gt;.&lt;/code&gt;을 이용하여 둘을(헤더, 페이로드) 합칩니다. 이후 공개키/비밀키(RSA나 ECDSA 등)나 shared secrets값(HAMC)을 통해 시그니처를 생성합니다.&lt;/p&gt;
&lt;p&gt;예를들어 HMAC SHA-256 알고리즘을 사용한다면, 시그니처는 아래와 같이 생성됩니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;HMAC_SHA256(
  secret,
  base64UrlEncode(header) + &quot;.&quot; +
  base64UrlEncode(payload)
)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;세-값을-모두-합치면&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%84%B8-%EA%B0%92%EC%9D%84-%EB%AA%A8%EB%91%90-%ED%95%A9%EC%B9%98%EB%A9%B4&quot; aria-label=&quot;세 값을 모두 합치면 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;세 값을 모두 합치면?&lt;/h3&gt;
&lt;p&gt;이런 모양이 나옵니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJsb2dnZWRJbkFzIjoiYWRtaW4iLCJpYXQiOjE0MjI3Nzk2Mzh9.gzSraSYS8EXBxLN_oWnFSRgCzcmJmMjLiuyu5CSpyHI&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id=&quot;마무리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%88%EB%AC%B4%EB%A6%AC&quot; aria-label=&quot;마무리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;마무리&lt;/h1&gt;
&lt;p&gt;이번 글을 통해, 아래 내용들을 살펴볼 수 있었습니다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;HTTP 상에서의 인증에 대해 Basic 부터 쿠키와 세션, JWT에 이르기까지를 간략히 살펴볼 수 있었습니다.&lt;/li&gt;
&lt;li&gt;JWT가 무슨 목적으로 만들어졌으며, 어떤 구조로 이루어져 있는지 간략히 알 수 있었습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;다음 글에서는 JWT가 어떤식으로 인증(및 인가)에 쓰이게 되는지, JWT의 특성을 오해하고 잘못 사용중인건 아닌지 살펴보겠습니다.&lt;/p&gt;
&lt;p&gt;읽어주셔서 감사합니다.&lt;/p&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;References
&lt;ul&gt;
&lt;li&gt;[1] &lt;a href=&quot;https://www.w3.org/Protocols/HTTP/1.0/spec.html#BasicAA&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;해당 링크&lt;/a&gt;를 참고해주세요.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Python의 디스크립터에 대해 (1): 이론]]></title><description><![CDATA[Python의 디스크립터에 대하여 공부한 내용을 정리하고자 글을 작성하였습니다. 2부에서는 실제 오픈소스들의 코드를 보고 해설할 예정입니다.]]></description><link>https://blog.s3ich4n.me/devlog/python/2022-06-10-python-descriptor-described</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/python/2022-06-10-python-descriptor-described</guid><pubDate>Fri, 10 Jun 2022 12:30:00 GMT</pubDate><content:encoded>&lt;p&gt;이 문서는 &lt;a href=&quot;https://realpython.com/python-descriptors/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;여기&lt;/a&gt;와 이펙티브 파이썬 2nd edition의 내용을 발췌하여 요약한 내용이다.&lt;/p&gt;
&lt;h1 id=&quot;목차&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AA%A9%EC%B0%A8&quot; aria-label=&quot;목차 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;목차&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#%EB%A9%94%EC%86%8C%EB%93%9C-%EB%82%B4%EC%9D%98-python-descriptor%EC%99%80-%ED%95%A8%EC%88%98&quot;&gt;메소드 내의 python descriptor와 함수&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#attribute%EC%9D%B4-lookup-chain%EC%9D%84-%ED%86%B5%ED%95%B4-access-%EB%90%98%EB%8A%94-%EB%B0%A9%EC%8B%9D&quot;&gt;Attribute이 lookup chain을 통해 access 되는 방식&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%ED%8C%8C%EC%9D%B4%EC%8D%AC%EC%9D%98-%EB%94%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%84%B0%EB%A5%BC-%EC%A0%9C%EB%8C%80%EB%A1%9C-%EC%93%B0%EB%A0%A4%EB%A9%B4&quot;&gt;파이썬의 디스크립터를 제대로 쓰려면?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%EB%94%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%84%B0%EB%A5%BC-%EC%93%B0%EB%8A%94-%EC%9D%B4%EC%9C%A0&quot;&gt;디스크립터를 쓰는 이유?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%EB%82%B4-%EB%82%98%EB%A6%84%EC%9D%98-%EA%B2%B0%EB%A1%A0&quot;&gt;내 나름의 결론&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;메소드-내의-python-descriptor와-함수&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A9%94%EC%86%8C%EB%93%9C-%EB%82%B4%EC%9D%98-python-descriptor%EC%99%80-%ED%95%A8%EC%88%98&quot; aria-label=&quot;메소드 내의 python descriptor와 함수 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;메소드 내의 python descriptor와 함수&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;python의 메소드란?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;메소드는 ‘object’ 인스턴스에 할당한 첫번째 arg를 가진 정규 함수다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;메소드에 &lt;code class=&quot;language-text&quot;&gt;.&lt;/code&gt; notation을 사용하여 접근하면, 다음 작동을 한다&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;알맞은 함수를 호출한다&lt;/li&gt;
&lt;li&gt;object 인스턴스를 첫번째 파라미터로 전달한다&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;obj.method(*args)&lt;/code&gt;가 &lt;code class=&quot;language-text&quot;&gt;method(obj, *args)&lt;/code&gt;로 호출되는 과정에는 function 오브젝트의 &lt;code class=&quot;language-text&quot;&gt;__get__()&lt;/code&gt; 구현체가 쓰인다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;이는 non-data descriptor 라고 부른다(후에 다시 설명될 것임).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;구체적으로 보면, &lt;code class=&quot;language-text&quot;&gt;function&lt;/code&gt; 오브젝트는 &lt;code class=&quot;language-text&quot;&gt;__get__()&lt;/code&gt; 오브젝트를 구현한다. 이는 &lt;code class=&quot;language-text&quot;&gt;.&lt;/code&gt; notation으로 호출할 때 bound method를 리턴한다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;다른 전체 아규먼트 호출을 하기위해 함수 호출에 따라오는 (*args) 가 필요하다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;CPython&lt;/code&gt; 구현체를 python 형태로 풀어내면 다음과 같다:&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# 참고링크&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# https://docs.python.org/3/howto/descriptor.html#functions-and-methods&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; types

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__get__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; obj&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; objtype&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token string&quot;&gt;&quot;Simulate func_descr_get() in Objects/funcobject.c&quot;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; obj &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; self
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; types&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;MethodType&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; obj&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;함수가 &lt;code class=&quot;language-text&quot;&gt;.&lt;/code&gt; notation 으로 호출되면 &lt;code class=&quot;language-text&quot;&gt;__get__()&lt;/code&gt; 함수가 호출되고 bound method 가 리턴된다.&lt;/p&gt;
&lt;p&gt;이는 일반 인스턴스 메소드 호출에 대해 작동한다. class method나 static method 에 대해서도 마찬가지다.&lt;/p&gt;
&lt;p&gt;static method 를 &lt;code class=&quot;language-text&quot;&gt;obj.method(*args)&lt;/code&gt; 형태로 호출할 때, 이는 자동으로 &lt;code class=&quot;language-text&quot;&gt;method(*args)&lt;/code&gt; 형태로 바뀐다. 비슷하게, class method를 &lt;code class=&quot;language-text&quot;&gt;obj.method(type(obj), *args)&lt;/code&gt; 형태로 호출할 때, 이는 자동으로 &lt;code class=&quot;language-text&quot;&gt;method(type(obj), *args)&lt;/code&gt; 형식으로 변경된다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;@classmethod&lt;/code&gt; 와 &lt;code class=&quot;language-text&quot;&gt;@staticmethod&lt;/code&gt; 간의 차이를 알기 위해서는 아래 페이지를 참고한다
&lt;a href=&quot;https://blog.s3ich4n.me/devlog/python/2022-06-09---python-classmethod-and-staticmethod/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Python의 @classmethod&lt;/code&gt; 와 &lt;code class=&quot;language-text&quot;&gt;@&lt;/code&gt;staticmethod 에 대하여&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;static method의 cpython 형태를 python 형식으로 바꿔보면 다음과 같다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;StaticMethod&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;Emulate PyStaticMethod_Type() in Objects/funcobject.c&quot;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; f&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;f &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; f

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__get__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; obj&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; objtype&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;f&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;class method 구현체도 마찬가지:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ClassMethod&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;Emulate PyClassMethod_Type() in Objects/funcobject.c&quot;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; f&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;f &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; f

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__get__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; obj&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; klass&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; klass &lt;span class=&quot;token keyword&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            klass &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;obj&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;newfunc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;f&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;klass&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; newfunc&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;파이썬에서는 class method 는 단순히 class reference를 argument list 의 첫번째 argument로 받는 static method 일 뿐이다.&lt;/p&gt;
&lt;h2 id=&quot;attribute이-lookup-chain을-통해-access-되는-방식&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#attribute%EC%9D%B4-lookup-chain%EC%9D%84-%ED%86%B5%ED%95%B4-access-%EB%90%98%EB%8A%94-%EB%B0%A9%EC%8B%9D&quot; aria-label=&quot;attribute이 lookup chain을 통해 access 되는 방식 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Attribute이 lookup chain을 통해 access 되는 방식&lt;/h2&gt;
&lt;p&gt;파이썬의 descriptor와 내부 방식을 알기위해선 attribute에 access할 때 일어나는 일을 알아야 한다.&lt;/p&gt;
&lt;p&gt;파이썬에서 모든 객체는 build-in &lt;code class=&quot;language-text&quot;&gt;__dict__&lt;/code&gt; 객체 안에 담겨있다. 이는 객체 자체가 선언한 모든 객체를 담는 딕셔너리다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Vehicle&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    can_fly &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;
    number_of_weels &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Car&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Vehicle&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    number_of_weels &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; color&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;color &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; color

my_car &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Car&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;red&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_car&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__dict__&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# 해당 클래스 인스턴스의 __dict__ 값&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_car&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__dict__&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;    &lt;span class=&quot;token comment&quot;&gt;# Car 클래스의 __dict__ 값&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;파이썬에서 모든 값은 ‘객체’ 다. 클래스도 마찬가지로 객체이며, &lt;code class=&quot;language-text&quot;&gt;__dict__&lt;/code&gt; attribute을 가지고있다. 그 값은 모든 attribute과 method 를 가지고 있다.&lt;/p&gt;
&lt;p&gt;내부 객체에 실제로 접근할때는 어떤식으로 접근하는걸까? 아래 코드를 예시로 들어보자&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# lookup.py&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Vehicle&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    can_fly &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;
    number_of_wheels &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Car&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Vehicle&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    number_of_wheels &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; color&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;color &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; color

my_car &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Car&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;red&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_car&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;color&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_car&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;number_of_wheels&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_car&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;can_fly&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;결과야 쉽게 알 수 있을 것이다.&lt;/p&gt;
&lt;p&gt;내부적으로는 &lt;code class=&quot;language-text&quot;&gt;my_car&lt;/code&gt; 변수의 &lt;code class=&quot;language-text&quot;&gt;color&lt;/code&gt; 를 찾을 때, &lt;code class=&quot;language-text&quot;&gt;my_car&lt;/code&gt; 의 &lt;code class=&quot;language-text&quot;&gt;__dict__&lt;/code&gt; 객체 내부에서 ‘하나의’ 값을 찾는다. &lt;code class=&quot;language-text&quot;&gt;number_of_wheels&lt;/code&gt; 에 접근할 떄는 &lt;code class=&quot;language-text&quot;&gt;Car&lt;/code&gt; 객체의 &lt;code class=&quot;language-text&quot;&gt;__dict__&lt;/code&gt; 에서 찾는 것이다. &lt;code class=&quot;language-text&quot;&gt;can_fly&lt;/code&gt; 값은 &lt;code class=&quot;language-text&quot;&gt;Vehicle&lt;/code&gt; 객체의 &lt;code class=&quot;language-text&quot;&gt;__dict__&lt;/code&gt; 를 찾는 것이다.&lt;/p&gt;
&lt;p&gt;그러니까 실제로는 이렇다 이말임&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# lookup2.py&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Vehicle&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    can_fly &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;
    number_of_weels &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Car&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;Vehicle&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    number_of_weels &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; color&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;color &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; color

my_car &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Car&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;red&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_car&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__dict__&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;color&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_car&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__dict__&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;number_of_weels&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_car&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__base__&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__dict__&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;can_fly&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;lookup chain 이 작동하는 방식을 풀면 다음과 같다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;찾는 이름의 attribute가 가진 &lt;strong&gt;data descriptor&lt;/strong&gt;의 &lt;code class=&quot;language-text&quot;&gt;__get__&lt;/code&gt; 메소드로 결과를 얻는다.&lt;/li&gt;
&lt;li&gt;그게 잘 안되면, 찾는 이름의 attribute가 가진 object의 &lt;code class=&quot;language-text&quot;&gt;__dict__&lt;/code&gt; 키값으로 값을 구한다.&lt;/li&gt;
&lt;li&gt;그게 잘 안되면, 찾는 이름의 attribute가 가진 &lt;strong&gt;non data descriptor&lt;/strong&gt;의 &lt;code class=&quot;language-text&quot;&gt;__get__&lt;/code&gt; 메소드로 결과를 얻는다.&lt;/li&gt;
&lt;li&gt;그게 잘 안되면, 찾는 이름의 attribute가 가진 object type의 &lt;code class=&quot;language-text&quot;&gt;__dict__&lt;/code&gt; 키값으로 값을 구한다.&lt;/li&gt;
&lt;li&gt;그게 잘 안되면, 찾는 이름의 attribute가 가진 object 부모 type의 &lt;code class=&quot;language-text&quot;&gt;__dict__&lt;/code&gt; 키값으로 값을 구한다.&lt;/li&gt;
&lt;li&gt;그게 잘 안되면, 위의 과정을 모든 부모의 type 에 대해 객체의 &lt;a href=&quot;https://data-flair.training/blogs/python-multiple-inheritance/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;MRO&lt;/a&gt; 대로 반복한다.&lt;/li&gt;
&lt;li&gt;그러고도 안되면 &lt;code class=&quot;language-text&quot;&gt;AttributeError&lt;/code&gt; Exception이 발생한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;파이썬의-디스크립터를-제대로-쓰려면&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%ED%8C%8C%EC%9D%B4%EC%8D%AC%EC%9D%98-%EB%94%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%84%B0%EB%A5%BC-%EC%A0%9C%EB%8C%80%EB%A1%9C-%EC%93%B0%EB%A0%A4%EB%A9%B4&quot; aria-label=&quot;파이썬의 디스크립터를 제대로 쓰려면 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;파이썬의 디스크립터를 제대로 쓰려면?&lt;/h2&gt;
&lt;p&gt;descriptor 프로토콜(비-데이터 디스크립터)은, 객체 안에 다음 함수를 구현하면 된다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;def __get__(self, obj, type=None) -&gt; object&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;def __set__(self, obj, value) -&gt; None&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;디스크립터를 구현할 때, 다음 요소를 잘 기억해두어야 한다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;self&lt;/code&gt; 값은 디스크립터 인스턴스이다&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;obj&lt;/code&gt; 값은 디스크립터가 attach 하는 인스턴스이다&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;type&lt;/code&gt; 값은 디스크립터가 atttach 하는 타입이다&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;__set__()&lt;/code&gt; 에는 &lt;code class=&quot;language-text&quot;&gt;type&lt;/code&gt; &lt;a href=&quot;https://realpython.com/python-variables/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;변수&lt;/a&gt;를 가지고 있지 않아도 된다. 왜냐면 객체에서만 &lt;code class=&quot;language-text&quot;&gt;__set__()&lt;/code&gt; 함수를 호출할 수 있기 때문이다. 반면, &lt;code class=&quot;language-text&quot;&gt;__get__()&lt;/code&gt; 함수는 객체와 클래스 모두 호출할 수 있다.&lt;/p&gt;
&lt;p&gt;다른 중요한점. 파이썬의 디스크립터는 클래스별로 ‘딱 한번’ 초기화된다는 점이다. 이는, 디스크립터를 포함하는 모든 클래스 인스턴스는 디스크립터 인스턴스를 공유한다는 것이다. 이점은 자칫 잘못하면 아래의 실수를 할 수 있다는 점이다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# descriptors2.py&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OneDigitNumericValue&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__get__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; obj&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__set__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; obj&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; value &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;9&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;or&lt;/span&gt; value &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; AttributeError&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;The value is invalid&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; value

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    number &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; OneDigitNumericValue&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

my_foo_object &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Foo&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
my_second_foo_object &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Foo&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

my_foo_object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;number &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_foo_object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;number&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_second_foo_object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;number&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

my_third_foo_object &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Foo&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_third_foo_object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;number&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Foo&lt;/code&gt; 클래스는 number attribute를 가지고있고 이는 디스크립터다. 이 디스크립터는 정수값을 받고, 디스크립터의 속성으로 저장한다.&lt;/p&gt;
&lt;p&gt;그런데 뜻대로 되지않을텐데, 이유는 모든 &lt;code class=&quot;language-text&quot;&gt;Foo&lt;/code&gt; 인스턴스가 디스크립터 인스턴스를 공유하기 때문이다.&lt;/p&gt;
&lt;p&gt;결국 만든 것은 새로운 클래스 수준의 attribute 일 뿐이다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;my_foo_object.number&lt;/code&gt; 속성이 설정된 후 마지막 인스턴스가 생성 되었음에도 불구하고 Foo의 모든 인스턴스가 속성 번호에 대해 동일한 값을 가지고 있음을 알 수 있다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;my_foo_object.number&lt;/code&gt; attribute이 설정된 후 마지막 인스턴스가 생성 되었음에도 불구하고 모든 &lt;code class=&quot;language-text&quot;&gt;Foo&lt;/code&gt; 인스턴스가 동일한 &lt;code class=&quot;language-text&quot;&gt;number&lt;/code&gt; 값이 있음을 볼 수 있다.&lt;/p&gt;
&lt;p&gt;연결된 모든 객체에 대한 디스크립터의 모든 값을 저장하기 위해 딕셔너리를 쓰는게 낫겠다 싶다. 거기에다가 &lt;code class=&quot;language-text&quot;&gt;__get__&lt;/code&gt; 해서 값 두고 &lt;code class=&quot;language-text&quot;&gt;__set__&lt;/code&gt; 하면 되겠다 싶은데, 치명적인 단점이 있다.&lt;/p&gt;
&lt;p&gt;아래는 그 예시:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# descriptors3.py&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OneDigitNumericValue&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__get__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; obj&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;obj&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;except&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__set__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; obj&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; value &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;9&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;or&lt;/span&gt; value &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; AttributeError&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;The value is invalid&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;obj&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; value

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    number &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; OneDigitNumericValue&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

my_foo_object &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Foo&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
my_second_foo_object &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Foo&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

my_foo_object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;number &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_foo_object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;number&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_second_foo_object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;number&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

my_third_foo_object &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Foo&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_third_foo_object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;number&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;값은 원하는대로 갖고있는데 단점이 있다. 이는, 디스크립터가 오너 오브젝트에 대한 strong reference를 갖고있다는 점이다.&lt;/p&gt;
&lt;p&gt;객체를 destroy해도 메모리가 release되지 않는다. 이는 &lt;a href=&quot;https://realpython.com/python-memory-management/#garbage-collection&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;gc&lt;/a&gt;가 객체안의 디스크립터에 대한 객체를 계속 찾기 때문이다.&lt;/p&gt;
&lt;p&gt;이러면… weak reference를 하면 되겠다 싶다. 그럴 수도 있지만 모든 값이 weak reference로 참조될 수 있는 것은 아니며, 객체가 (gc에 의해) 수집되면 딕셔너리에서 사라진다는 사실을 처리해야 한다.&lt;/p&gt;
&lt;p&gt;괜찮은 해결책은, 디스크립터 자체에 값을 두는게 아니라, 디스크립터가 붙는 &lt;strong&gt;객체&lt;/strong&gt;에 저장하면 될 것이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# descriptors4.py&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OneDigitNumericValue&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; name

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__get__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; obj&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__dict__&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__set__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; obj&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__dict__&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; value

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    number &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; OneDigitNumericValue&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;number&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

my_foo_object &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Foo&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
my_second_foo_object &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Foo&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

my_foo_object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;number &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_foo_object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;number&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_second_foo_object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;number&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

my_third_foo_object &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Foo&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_third_foo_object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;number&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;다 잘되는데 단점이 있다. 초기화를 할 때 항상 이런식으로 선언을 해줘야 한다는 점이다:&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;number = OneDigitNumericValue(&quot;number&quot;)&lt;/code&gt; ← “number” 라는 값을 기입해줘야 함&lt;/p&gt;
&lt;p&gt;파이썬 3.6부터는 &lt;code class=&quot;language-text&quot;&gt;.__set_name__()&lt;/code&gt; 이라는 걸출한게 &lt;a href=&quot;https://www.python.org/dev/peps/pep-0487/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;PEP 487&lt;/a&gt;에 제안되었고, 정식 기능으로 생겼다.&lt;/p&gt;
&lt;p&gt;그 아래에는 메타클래스와 데코레이터로 할 수 있다. (사실 메타클래스는 제대로 쓰기에 너무 복잡해서, 필요하면 다시 공부하도록 하자…)&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;__set_name__(self, owner, name)&lt;/code&gt; 을 사용한 예시코드는 아래와 같다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# descriptors5.py&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;OneDigitNumericValue&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__set_name__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; owner&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; name

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__get__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; obj&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__dict__&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__set__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; obj&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__dict__&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; value

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    number &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; OneDigitNumericValue&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

my_foo_object &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Foo&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
my_second_foo_object &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Foo&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

my_foo_object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;number &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_foo_object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;number&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_second_foo_object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;number&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

my_third_foo_object &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Foo&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_third_foo_object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;number&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;예상한대로 잘 됐고, &lt;code class=&quot;language-text&quot;&gt;__init__()&lt;/code&gt; 도 없다.&lt;/p&gt;
&lt;h2 id=&quot;디스크립터를-쓰는-이유&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%94%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%84%B0%EB%A5%BC-%EC%93%B0%EB%8A%94-%EC%9D%B4%EC%9C%A0&quot; aria-label=&quot;디스크립터를 쓰는 이유 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;디스크립터를 쓰는 이유?&lt;/h2&gt;
&lt;p&gt;API 작성같이 고수준의 로직을 풀거나 하는 케이스에서는 디스크립터를 쓸 일이 없다. 일반적인 유스케이스 보다 아래 케이스에서 사용을 고려할 수 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Lazy properties (for &lt;strong&gt;non-data descriptor&lt;/strong&gt;)
&lt;ul&gt;
&lt;li&gt;이것은 최초로 액세스 하기 전까지에는 initial value가 로드되지 않는다는 것&lt;/li&gt;
&lt;li&gt;그 후에는 initial value를 로드하고 나중의 사용을 위해 값이 캐시된다는 것&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;DeepThought&lt;/code&gt; 라는 클래스가 &lt;code class=&quot;language-text&quot;&gt;meaning_of_life()&lt;/code&gt; 라는 함수를 갖고있다고 치자. 이 함수는 3초쯤 쉬고 해답을 주는 함수다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# slow_properties.py&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; time

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DeepThought&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;meaning_of_life&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        time&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sleep&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;42&lt;/span&gt;

my_deep_thought_instance &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; DeepThought&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_deep_thought_instance&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;meaning_of_life&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_deep_thought_instance&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;meaning_of_life&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_deep_thought_instance&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;meaning_of_life&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;셋다 구동하려고 3초씩 매번 쉰다. 해답은 똑같은데 말이지. lazy property는 그 대신 이 메소드의 최초 실행시 연산 후 결과값을 캐싱한다. 디스크립터를 쓰면 이런 해답이 나온다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# lazy_properties.py&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; time

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;LazyProperty&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; function&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;function &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; function
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; function&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__name__

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__get__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; obj&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__dict__&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;function&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;obj&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__dict__&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DeepThought&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@LazyProperty&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;meaning_of_life&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        time&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sleep&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;42&lt;/span&gt;

my_deep_thought_instance &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; DeepThought&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_deep_thought_instance&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;meaning_of_life&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_deep_thought_instance&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;meaning_of_life&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_deep_thought_instance&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;meaning_of_life&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;DeepThought&lt;/code&gt; 를 선언하면서 &lt;code class=&quot;language-text&quot;&gt;@LazyProperty&lt;/code&gt; 를 타고간다.
&lt;ol&gt;
&lt;li&gt;&lt;del&gt;데코레이터니까&lt;/del&gt; non-data 디스크립터를 먼저 선언한다. &lt;code class=&quot;language-text&quot;&gt;__init__&lt;/code&gt; 하면서 function 값을 읽어와서 넣고, name도 마찬가지로 넣는다
&lt;ol&gt;
&lt;li&gt;function에는 함수의 주소값이 담긴다&lt;/li&gt;
&lt;li&gt;name에는 함수의 이름이 담긴다&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;DeepThought&lt;/code&gt; 를 초기화한다&lt;/li&gt;
&lt;li&gt;meaning_of_life를 호출하면 &lt;code class=&quot;language-text&quot;&gt;LazyProperty&lt;/code&gt;의 &lt;code class=&quot;language-text&quot;&gt;__get__&lt;/code&gt; 이 실행된다. 디스크립터가 붙는 객체에 함수 이름을 넣는다.
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;self.function(obj)&lt;/code&gt; 를 실행하면서 &lt;code class=&quot;language-text&quot;&gt;meaning_of_life&lt;/code&gt; 함수를 구동한다.
&lt;code class=&quot;language-text&quot;&gt;obj&lt;/code&gt; 값은 &lt;code class=&quot;language-text&quot;&gt;DeepThought&lt;/code&gt; 값이다
그 결과는 &lt;code class=&quot;language-text&quot;&gt;obj.__dict__[self.name]&lt;/code&gt; 에 담긴다.&lt;/li&gt;
&lt;li&gt;그 결과를 &lt;code class=&quot;language-text&quot;&gt;self.__name__&lt;/code&gt; 에 저장한다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;나머지는 실행할 때마다 동일한 값을 공유한다.
&lt;ol&gt;
&lt;li&gt;이 때 파이썬은 &lt;code class=&quot;language-text&quot;&gt;lookup chain&lt;/code&gt; 을 사용하여, &lt;code class=&quot;language-text&quot;&gt;__dict__&lt;/code&gt; 내의 attribute 값을 찾는다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# wrong_lazy_properties.py&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; time

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;LazyProperty&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; function&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;function &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; function
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; function&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__name__

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__get__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; obj&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__dict__&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;function&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;obj&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__dict__&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__set__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; obj&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;pass&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DeepThought&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@LazyProperty&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;meaning_of_life&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        time&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sleep&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;42&lt;/span&gt;

my_deep_thought_instance &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; DeepThought&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_deep_thought_instance&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;meaning_of_life&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_deep_thought_instance&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;meaning_of_life&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_deep_thought_instance&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;meaning_of_life&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;다만 &lt;strong&gt;data descriptor&lt;/strong&gt; 에선 작동하지 않는다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;DRY 한 코드&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이런류의 코드에 대해서는 DRY 해진다. 아래는 data descriptor를 안 쓴 예시&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# properties.py&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Values&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_value1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_value2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_value3 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_value4 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_value5 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;

    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@property&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;value1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_value1

    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@value1&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;setter&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;value1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_value1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; value &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; value &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;

    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@property&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;value2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_value2

    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@value2&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;setter&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;value2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_value2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; value &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; value &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;

    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@property&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;value3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_value3

    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@value3&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;setter&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;value3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_value3 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; value &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; value &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;

    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@property&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;value4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_value4

    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@value4&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;setter&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;value4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_value4 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; value &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; value &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;

    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@property&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;value5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_value5

    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@value5&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;setter&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;value5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_value5 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; value &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; value &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;

my_values &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Values&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
my_values&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
my_values&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_values&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value1&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_values&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이걸 디스크립터로는 다음과 같이 줄일 수 있다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# properties2.py&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;EvenNumber&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__set_name__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; owner&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; name

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__get__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; obj&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__dict__&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__set__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; obj&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__dict__&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; value &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Values&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    value1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; EvenNumber&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    value2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; EvenNumber&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    value3 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; EvenNumber&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    value4 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; EvenNumber&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    value5 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; EvenNumber&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

my_values &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Values&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
my_values&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
my_values&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_values&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value1&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_values&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;내-나름의-결론&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%82%B4-%EB%82%98%EB%A6%84%EC%9D%98-%EA%B2%B0%EB%A1%A0&quot; aria-label=&quot;내 나름의 결론 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;내 나름의 결론&lt;/h2&gt;
&lt;p&gt;이거… 제대로 쓰려면 상위 클래스에서 쓰고, 하위 클래스에서는 상속을 받고 써먹어야 하는 것 같다..&lt;/p&gt;
&lt;p&gt;코드가 dry 해지고, lazy properties 의 특징을 가지기야 한다만… 필요할 때 제대로 쓰자. 왜냐하면 평소엔 필요없을 것이기 때문이다.&lt;/p&gt;
&lt;p&gt;따라서, 좋은 라이브러리의 코드를 이해하고 타고들어갈 때, 혹은 저수준의 라이브러리/파이썬 스러운 인터페이스 설계 시에는 쓸 수 있으니 얼마든지 이런 방향을 알고는 있어야할 것이다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA["@classmethod" 와 "@staticmethod"에 대해]]></title><description><![CDATA[Python의 "@classmethod" 와 "@staticmethod"에 대해]]></description><link>https://blog.s3ich4n.me/devlog/python/2022-06-09-python-classmethod-and-staticmethod</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/python/2022-06-09-python-classmethod-and-staticmethod</guid><pubDate>Thu, 09 Jun 2022 10:30:00 GMT</pubDate><content:encoded>&lt;p&gt;본 페이지에서는 Python의 &lt;code class=&quot;language-text&quot;&gt;@classmethod&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;@staticmethod&lt;/code&gt; 에 대한 차이와 실제 예시를 통해 어떤식의 차이가 있는지 기술한다.&lt;/p&gt;
&lt;h2 id=&quot;classmethod-란&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#classmethod-%EB%9E%80&quot; aria-label=&quot;classmethod 란 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;@classmethod&lt;/code&gt; 란?&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;클래스에 바인딩된 메소드를 의미한다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;self&lt;/code&gt; 대신, &lt;code class=&quot;language-text&quot;&gt;cls&lt;/code&gt; 변수를 메소드 앞에 추가한다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;@classmethod&lt;/code&gt; 를 상속받은 자식 클래스에서는, 자식 클래스의 property 를 가리킨다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;staticmethod-란&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#staticmethod-%EB%9E%80&quot; aria-label=&quot;staticmethod 란 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;@staticmethod&lt;/code&gt; 란?&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;정적 메소드 개체는 일반적으로 사용자 정의 메소드 개체와 같은 다른 개체를 감싸는 래퍼다.&lt;/li&gt;
&lt;li&gt;정적 메소드 개체가 클래스 또는 클래스 인스턴스에서 검색될 때 실제로 반환된 개체는 더 이상 변형되지 않는 래핑된 개체이다.&lt;/li&gt;
&lt;li&gt;정적 메소드 개체는 일반적으로 래핑하는 개체가 있지만 자체적으로 호출할 수 없다.&lt;/li&gt;
&lt;li&gt;특정 객체 내에서, 로직으로 연결된 처리를 위해 작성하는 메소드를 의미한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;실제-예시&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%8B%A4%EC%A0%9C-%EC%98%88%EC%8B%9C&quot; aria-label=&quot;실제 예시 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;실제 예시&lt;/h2&gt;
&lt;h3 id=&quot;classmethod-예시&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#classmethod-%EC%98%88%EC%8B%9C&quot; aria-label=&quot;classmethod 예시 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;@classmethod&lt;/code&gt; 예시&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;공통적으로 상속받은 클래스들이 자신의 객체정보를 연산하기 위하여 처리한 예시값이다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;TypeBase&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;BaseModel&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot; TypeBase는 모든 이벤트 클래스가 상속하는 클래스
    Pydantic을 통해, 필요 기능들을 사용할 수 있도록 작업하였다.
    &quot;&quot;&quot;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;self&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token builtin&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__init__&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;**&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;# (중략)&lt;/span&gt;

    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@classmethod&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get_types&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;cls&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot; 이벤트 클래스의 모든 필드에 대해 {변수명: 타입} 으로 리턴한다.
        &quot;&quot;&quot;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            field&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; field&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;type_ &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; field &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; cls&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__fields__&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;values&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@classmethod&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get_searchables&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;cls&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot; 검색 가능한 필드에 대해 {변수명: 타입} 으로 리턴한다.
        &quot;&quot;&quot;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            idx&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; idx&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;type_ &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; idx &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;field &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; field &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; cls&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__fields__&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;values&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt;
              field&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; cls&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Config&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;searchables&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@classmethod&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get_result_fields&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;cls&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token triple-quoted-string string&quot;&gt;&quot;&quot;&quot; 리턴값으로 제공가능한 필드에 대해 {변수명: 타입} 으로 리턴한다.
        &quot;&quot;&quot;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            idx&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; idx&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;type_ &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; idx &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;field &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; field &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; cls&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;__fields__&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;values&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt;
              field&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; cls&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Config&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;results&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;이런 식으로, &lt;code class=&quot;language-text&quot;&gt;TypeBase&lt;/code&gt; 클래스를 상속받는 하위 객체에서 다음과 같이 사용할 수 있다.
&lt;ol&gt;
&lt;li&gt;상속받는 하위 객체에서, 메타클래스로 &lt;code class=&quot;language-text&quot;&gt;searchables&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;results&lt;/code&gt; 라는 필드값을 지정한다.&lt;/li&gt;
&lt;li&gt;해당 값에 대한 dictionary comprehension을 사용하여, &lt;code class=&quot;language-text&quot;&gt;{변수명:타입}&lt;/code&gt; 형식을 제공할 수 있게 된다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;staticmethod-예시&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#staticmethod-%EC%98%88%EC%8B%9C&quot; aria-label=&quot;staticmethod 예시 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;@staticmethod&lt;/code&gt; 예시&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;특정 메소드의 연산 등, 필요한 값들에 대해 바로 연산하는 용도로 사용할 수 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@staticmethod&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;parse_bool_envbars&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;bool&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; value &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;true&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;True&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;True&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;False&lt;/span&gt;

    &lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@staticmethod&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;parse_list_envbars&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; value
        &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;split&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;,&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;이런 식으로, 특정 메소드 내의 일부 값을 받은 후 즉시 필요한 값을 전달하는 용도로 사용한다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[시작부터 배포까지: 도커 패키징의 베스트케이스]]></title><description><![CDATA[PyCon US 2021 발표영상 중, 파이썬 도커 이미지를 만드는 좋은 방법에 대한 동영상을 번역해봤습니다.]]></description><link>https://blog.s3ich4n.me/devlog/docker/2021-09-18-how-to-make-docker-image-securely</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/docker/2021-09-18-how-to-make-docker-image-securely</guid><pubDate>Sat, 18 Sep 2021 19:00:00 GMT</pubDate><content:encoded>&lt;p&gt;이 글은 &lt;a href=&quot;https://www.youtube.com/watch?v=EC0CSevbt9k&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;0 to production-ready: a best-practices process for Docker packaging&lt;/a&gt; 을 읽고 제 나름 번역해본 글입니다. 도움이 되길 바랍니다.&lt;/p&gt;
&lt;h1 id=&quot;목차&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AA%A9%EC%B0%A8&quot; aria-label=&quot;목차 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;목차&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#1-%EC%9D%BC%EB%8B%A8-%EB%8F%8C%EB%A6%AC%EC%9E%90&quot;&gt;일단 돌도록 만든다&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#2-%EB%B3%B4%EC%95%88%EC%9D%84-%EA%B3%A0%EB%A0%A4%ED%95%98%EC%9E%90&quot;&gt;보안적 측면을 고려한다&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#3-%EC%9E%90%EB%8F%99%ED%99%94%EB%90%9C-%EB%B9%8C%EB%93%9Cci&quot;&gt;CI를 돌린다&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#4-%EC%A0%95%EC%83%81%EC%9E%91%EB%8F%99-%EB%B0%8F-%EB%94%94%EB%B2%84%EA%B9%85-%EA%B0%80%EB%8A%A5%ED%95%98%EB%8F%84%EB%A1%9D&quot;&gt;정상작동 및 디버깅가능하게 만든다&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#5-%EC%9E%AC%EC%83%9D%EC%82%B0%EC%84%B1&quot;&gt;재생산가능한 빌드를 한다&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#6-%EB%B9%8C%EB%93%9C%EB%A5%BC-%EB%8D%94-%EB%B9%A0%EB%A5%B4%EA%B2%8C-%EC%82%AC%EC%9D%B4%EC%A6%88%EB%8A%94-%EB%8D%94-%EC%9E%91%EA%B2%8C&quot;&gt;빌드를 더 빠르게 하고 이미지를 작게 만든다&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%EB%81%9D%EC%9C%BC%EB%A1%9C&quot;&gt;끝으로…&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%EC%82%AC%EC%A1%B1-%EC%B6%94%EA%B0%80%EB%A1%9C&quot;&gt;(사족) 추가로…&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;1-일단-돌리자&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1-%EC%9D%BC%EB%8B%A8-%EB%8F%8C%EB%A6%AC%EC%9E%90&quot; aria-label=&quot;1 일단 돌리자 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1. 일단 돌리자&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;docker&quot;&gt;&lt;pre class=&quot;language-docker&quot;&gt;&lt;code class=&quot;language-docker&quot;&gt;&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; python:3.9-slim-buster&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;COPY&lt;/span&gt; . .&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; pip install .&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;ENTRYPOINT&lt;/span&gt; [&lt;span class=&quot;token string&quot;&gt;&quot;./run-server.sh&quot;&lt;/span&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이러면 일단 돌아는 감&lt;/p&gt;
&lt;h2 id=&quot;2-보안을-고려하자&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2-%EB%B3%B4%EC%95%88%EC%9D%84-%EA%B3%A0%EB%A0%A4%ED%95%98%EC%9E%90&quot; aria-label=&quot;2 보안을 고려하자 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2. 보안을 고려하자&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;root&lt;/code&gt; 로 구동하지 말자!&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;public에 배포하기 전엔 보안을 항시 신경쓰자&lt;/li&gt;
&lt;li&gt;컨테이너가 해야 할 범위를 명확히 정하자
&lt;ul&gt;
&lt;li&gt;자기 실햄범위를 넘기지 않도록 권한을 주자&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;보안 업데이트를 하자!&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;도커 이미지는 이뮤터블 아티팩트다. 보안 업데이트는 곧 신규 이미지 배포를 의미한다.
&lt;ol&gt;
&lt;li&gt;보안 업데이트와 관련된 디펜던시를 이해한다
&lt;ol&gt;
&lt;li&gt;정확히 뭐가 문제인가?
&lt;ol&gt;
&lt;li&gt;환경변수 수정같은걸로도 안되는 심각한 사안인가?&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;이미지 업데이트&lt;/li&gt;
&lt;li&gt;이미지 리빌드&lt;/li&gt;
&lt;li&gt;앱 재배포&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;docker&quot;&gt;&lt;pre class=&quot;language-docker&quot;&gt;&lt;code class=&quot;language-docker&quot;&gt;&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; python:3.8-slim-buster&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; useradd --create-home appuser&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;USER&lt;/span&gt; appuser&lt;/span&gt;

&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;WORKDIR&lt;/span&gt; /home/appuser&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;COPY&lt;/span&gt; . .&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; pip install --user .&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;ENTRYPOINT&lt;/span&gt; [&lt;span class=&quot;token string&quot;&gt;&quot;./run-server.sh&quot;&lt;/span&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;3-자동화된-빌드ci&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#3-%EC%9E%90%EB%8F%99%ED%99%94%EB%90%9C-%EB%B9%8C%EB%93%9Cci&quot; aria-label=&quot;3 자동화된 빌드ci permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3. 자동화된 빌드/CI&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;이미지를 &lt;strong&gt;매번, 손으로&lt;/strong&gt; 빌드하고 싶지 않을거다.&lt;/li&gt;
&lt;li&gt;다른 팀원들도 이미지를 빌드하기 쉽도록 하고싶을거다.
&lt;ul&gt;
&lt;li&gt;빌드, CI 시스템과 통합하여 배포하라!&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token shebang important&quot;&gt;#!/usr/bin/env bash&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# Ver 1.&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#   브랜치 안 가리고 작업&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;

&lt;span class=&quot;token builtin class-name&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-euxo&lt;/span&gt; pipefail

test.py
&lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; build &lt;span class=&quot;token parameter variable&quot;&gt;-t&lt;/span&gt; my_image:latest &lt;span class=&quot;token builtin class-name&quot;&gt;.&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# 혹은 이 과정조차 스크립트로&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; push my_image:latest        &lt;span class=&quot;token comment&quot;&gt;# 이것도 마찬가지&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;참고)
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;[set -euxo pipefail&lt;/code&gt; 이 뭔데?](&lt;a href=&quot;https://zetawiki.com/wiki/%EB%A6%AC%EB%88%85%EC%8A%A4_set_-euxo_pipefail&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://zetawiki.com/wiki/%EB%A6%AC%EB%88%85%EC%8A%A4_set_-euxo_pipefail&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;개발 프로세스에 접목시킨다
&lt;ul&gt;
&lt;li&gt;회사 내 프로세스와 잘 맞아 떨어지는지 알아봐야함&lt;/li&gt;
&lt;li&gt;질문사항
&lt;ul&gt;
&lt;li&gt;패키징 전에 테스트하나? 후에 하나? 둘 다 하나?&lt;/li&gt;
&lt;li&gt;브랜치는 어떻게 관리하나?&lt;/li&gt;
&lt;li&gt;패키징이 개발자에게 있어 &lt;em&gt;병목(bottleneck)&lt;/em&gt; 인가?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token shebang important&quot;&gt;#!/usr/bin/env bash&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# Ver 2.&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#   브랜치 이름을 기반으로, 태그를 붙여 배포하는 스크립트&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;

&lt;span class=&quot;token builtin class-name&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-euxo&lt;/span&gt; pipefail

&lt;span class=&quot;token assign-left variable&quot;&gt;GIT_BRANCH&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;git&lt;/span&gt; rev-parse --abbrev-ref HEAD&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; build &lt;span class=&quot;token parameter variable&quot;&gt;-t&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;my_image:&lt;span class=&quot;token variable&quot;&gt;$GIT_BRANCH&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; push &lt;span class=&quot;token string&quot;&gt;&quot;my_image:&lt;span class=&quot;token variable&quot;&gt;$GIT_BRANCH&lt;/span&gt;&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;4-정상작동-및-디버깅-가능하도록&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#4-%EC%A0%95%EC%83%81%EC%9E%91%EB%8F%99-%EB%B0%8F-%EB%94%94%EB%B2%84%EA%B9%85-%EA%B0%80%EB%8A%A5%ED%95%98%EB%8F%84%EB%A1%9D&quot; aria-label=&quot;4 정상작동 및 디버깅 가능하도록 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4. 정상작동 및 디버깅 가능하도록…&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;이런 식의 작업은 (당연히)실환경에서 잘 도는걸 기대함… 그리고 에러를 잘 볼 수 있게끔 되기를 바람&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;PYTHONFAULTHANDLER=1&lt;/code&gt; 이라는 옵션을 주면, C 코드내에서의 트레이스백까지 같이 받아볼 수 있게 된다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;ENV &lt;span class=&quot;token assign-left variable&quot;&gt;PYTHONFAULTHANDLER&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
ENTRYPOINT &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;python&quot;&lt;/span&gt;, &lt;span class=&quot;token string&quot;&gt;&quot;program.py&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;참고) &lt;a href=&quot;https://docs.python.org/ko/3/library/faulthandler.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://docs.python.org/ko/3/library/faulthandler.html&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;조용히&lt;/strong&gt; 죽는 원인파악에 좋다&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;matplotlib&lt;/code&gt;의 문제, DB연결 등…&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;예시&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;pre-compile bytecode&lt;/li&gt;
&lt;li&gt;파이썬은 빠른 구동을 위해 &lt;code class=&quot;language-text&quot;&gt;pyc&lt;/code&gt; 확장자로 컴파일을 한다.&lt;/li&gt;
&lt;li&gt;이미지에 &lt;code class=&quot;language-text&quot;&gt;.pyc&lt;/code&gt; 파일이 없다면 초기구동이 느려질 수도 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;docker&quot;&gt;&lt;pre class=&quot;language-docker&quot;&gt;&lt;code class=&quot;language-docker&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# (보통은 pip에서 한다) 설치한 코드를 컴파일함&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; python -c &lt;span class=&quot;token string&quot;&gt;&quot;import compileall; \
    compileall.compile_path(maxlevels=10)&quot;&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# my_package 디렉토리에 코드를 컴파일한다&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; python -m compileall my_package/&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;이런 기능이 있으니, 필요한지 파악한 후 추가하는 것이 좋다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;5-재생산성&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#5-%EC%9E%AC%EC%83%9D%EC%82%B0%EC%84%B1&quot; aria-label=&quot;5 재생산성 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;5. 재생산성&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;메이저 디펜던시는 쉽게 바뀌지 않는다. 그런데, 시간이 지나면 지날 수록 업데이트가 필요해진다&lt;/li&gt;
&lt;li&gt;따라서, 재생산가능한 빌드를 하고싶어질 것이다. 이를 통해 통제된 방법으로 업데이트가 가능하다.
&lt;ul&gt;
&lt;li&gt;좋은 베이스 이미지를 선택하자!&lt;/li&gt;
&lt;li&gt;보안업데이트도 해주고 하위호환도 좋은 OS를 고르고 싶을 것임…&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;python:3.9-slim-buster&lt;/code&gt; 는 Debian Buster 슬림버전을 사용함&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;매 빌드마다 디펜던시를 업데이트하면 재생산성이 떨어진다.
&lt;ul&gt;
&lt;li&gt;→ 따라서, 디펜던시를 고정시키는 것도 방법.&lt;/li&gt;
&lt;li&gt;아래 도구들 고려하는 것을 추천
&lt;ul&gt;
&lt;li&gt;pip-tools&lt;/li&gt;
&lt;li&gt;pipenv&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/conda-incubator/conda-lock&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;conda-lock&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;poetry (배워두면 아주 요긴할 듯 함. 주요 오픈소스 프로젝트들도 다 사용하고…)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;업데이트를 하지 않는다면? 오래된 디펜던시가 생기고 위험한 업그레이드를 하게된다.
&lt;ul&gt;
&lt;li&gt;→정기적으로(on a regular basis)파이썬 디펜던시 업데이트를 위한 조직적 프로세스가 필요하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;6-빌드를-더-빠르게-사이즈는-더-작게&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#6-%EB%B9%8C%EB%93%9C%EB%A5%BC-%EB%8D%94-%EB%B9%A0%EB%A5%B4%EA%B2%8C-%EC%82%AC%EC%9D%B4%EC%A6%88%EB%8A%94-%EB%8D%94-%EC%9E%91%EA%B2%8C&quot; aria-label=&quot;6 빌드를 더 빠르게 사이즈는 더 작게 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;6. 빌드를 더 빠르게, 사이즈는 더 작게&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;위의 과정을 따르면, 비로소 &lt;em&gt;제대로&lt;/em&gt; 패키지화 한다고 할 수 있다. 그러면 최적화도 고려해야 한다.&lt;/li&gt;
&lt;li&gt;시간은 소중하므로, 빌드에 많은 시간을 버리고 싶지 않을 것이다&lt;/li&gt;
&lt;li&gt;더 작은 이미지일 수록 테스트 구동, 프로덕션 구동을 더 빨리할 수 있다&lt;/li&gt;
&lt;li&gt;Alpine 이미지는 쓰지 말자!
&lt;ul&gt;
&lt;li&gt;현재(2021년 5월 14일, PyCon US 2021 발표시점) 알파인 리눅스는 PyPI의 precompiled wheel을 사용하지 못한다&lt;/li&gt;
&lt;li&gt;그 결과, 모든 라이브러리를 다운받고 직접 컴파일하여 구동해야한다.
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;pandas&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;matplotlib&lt;/code&gt; 을 포함하고 빌드하면 훨씬 오래걸린다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://peps.python.org/pep-0656/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;PEP 656&lt;/a&gt;이 이를 해결할 지도…&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;끝으로&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%81%9D%EC%9C%BC%EB%A1%9C&quot; aria-label=&quot;끝으로 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;끝으로…&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Dockerizing은 단순한 아티팩트 생성만을 말하는건 아니다
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Dockerfile&lt;/code&gt; 자체도 필요하고 빌드 스크립트, 환경 등이 필요하다&lt;/li&gt;
&lt;li&gt;그렇지만 &lt;em&gt;“프로세스”&lt;/em&gt; 또한 필요하다
&lt;ul&gt;
&lt;li&gt;개발환경과의 상호작용
&lt;ul&gt;
&lt;li&gt;버전관리, 테스팅, CI 등..&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;보안 업데이트 프로세스&lt;/li&gt;
&lt;li&gt;디펜던시 업데이트 프로세스&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;사족-추가로&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%82%AC%EC%A1%B1-%EC%B6%94%EA%B0%80%EB%A1%9C&quot; aria-label=&quot;사족 추가로 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;(사족) 추가로?&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.docker.com/develop/develop-images/multistage-build/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Docker의 멀티-스테이지 빌드&lt;/a&gt;를 추가해서, 파이썬 빌드같은 스테이지는 따로 빼는게 좋다.
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/cookiecutter/cookiecutter-django&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;django-cookiecutter&lt;/a&gt; 로 만들어진 도커 이미지에 그런 스테이지가 있으므로, 참고하면 어떤 식으로 스테이지를 둘지에 대한 도움을 얻을 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;references&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#references&quot; aria-label=&quot;references permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://pythonspeed.com/docker&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://pythonspeed.com/docker&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[아니 내 탭 어디감?]]></title><description><![CDATA[우분투 환경에서 VSCode를 사용하던 시절에 뜬금없이 탭이 사라지는 일이 있었습니다. 해결책이 쉽습니다! 여러분들께서는 부디 헤메는 일이 없길 바랍니다...]]></description><link>https://blog.s3ich4n.me/tips/2021-09-05-what-is-wrong-with-my-vscode-tab</link><guid isPermaLink="false">https://blog.s3ich4n.me/tips/2021-09-05-what-is-wrong-with-my-vscode-tab</guid><pubDate>Sun, 05 Sep 2021 19:30:00 GMT</pubDate><content:encoded>&lt;p&gt;평소처럼 출근한 어느 날이었습니다. 작업을 하다가 키보드 내 먼지를 훅훅 불고 닦다가보니 갑자기 VSCode의 탭이 없어진 것이었습니다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/5222f327748bfaed1ca2537df9f08e27/0cd7b/000_preface.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 27.500000000000004%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAGABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAQD/2gAMAwEAAhADEAAAAcyCQT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAEFAn//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAWEAEBAQAAAAAAAAAAAAAAAAAAEQH/2gAIAQEAAT8h1Ff/2gAMAwEAAgADAAAAEIQv/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGxABAAAHAAAAAAAAAAAAAAAAAQAQETFBcaH/2gAIAQEAAT8QBgDUtRbpH//Z&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/5222f327748bfaed1ca2537df9f08e27/8ac56/000_preface.webp 240w,
/static/5222f327748bfaed1ca2537df9f08e27/d3be9/000_preface.webp 480w,
/static/5222f327748bfaed1ca2537df9f08e27/e46b2/000_preface.webp 960w,
/static/5222f327748bfaed1ca2537df9f08e27/f992d/000_preface.webp 1440w,
/static/5222f327748bfaed1ca2537df9f08e27/882b9/000_preface.webp 1920w,
/static/5222f327748bfaed1ca2537df9f08e27/6ba55/000_preface.webp 3148w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/5222f327748bfaed1ca2537df9f08e27/09b79/000_preface.jpg 240w,
/static/5222f327748bfaed1ca2537df9f08e27/7cc5e/000_preface.jpg 480w,
/static/5222f327748bfaed1ca2537df9f08e27/6a068/000_preface.jpg 960w,
/static/5222f327748bfaed1ca2537df9f08e27/644c5/000_preface.jpg 1440w,
/static/5222f327748bfaed1ca2537df9f08e27/0f98f/000_preface.jpg 1920w,
/static/5222f327748bfaed1ca2537df9f08e27/0cd7b/000_preface.jpg 3148w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/jpeg&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/5222f327748bfaed1ca2537df9f08e27/6a068/000_preface.jpg&quot;
            alt=&quot;아니 내 탭 어디감?&quot;
            title=&quot;아니 내 탭 어디감?&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;아니 내 탭 어디감?&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;대강 이런식이었습니다. 저는 작업 시 많은 탭을 열어서 사용하는 편이라 매우 당황스러웠습니다. 뭔가 단축키를 눌렀을 것이라 생각했지만 이를 어떻게 찾아야할지 몰라서 짧은 영어로 스택오버플로우에 검색을 했습니다. &lt;a href=&quot;https://stackoverflow.com/questions/48589785/vscode-showing-only-one-file-in-the-tab-bar-cant-open-multiple-files&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;역시 해답이 있더군요!&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;문제는&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AC%B8%EC%A0%9C%EB%8A%94&quot; aria-label=&quot;문제는 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;문제는?&lt;/h2&gt;
&lt;p&gt;제 우분투에 설치된 VSCode 상에서는 단축키 바인딩이 되어있었고, 그걸 예기치않게 눌렀나봅니다. 그 탓에 탭이 사라지지 않았나 싶었습니다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/82c50e4650173ff00047c998900a0fe6/2d912/001-02-problem-found.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 15%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAtUlEQVQI1y2NW27CMBREsxUEBEPS0MQQx4DBUAei0IbXDw+x/2WcyhYfI92ZM1cTjVOFLC3f0hCPJUNRMBQy3INRQW8wpR/nH58HxR++MC3WXVC6oZhbkqwiEolipnbUzYV5tWPypUmnS/yQL/m8WtaIpKTUDqUdIlVMMk2Wr8hnlq3rQtf/RlLVuOZO272D9u2Dw/GJNh3W3fg9+/yFdVc2PzfM9hrYYn2iMn/odcfx9A7M+3/dmmUI9bE9jwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/82c50e4650173ff00047c998900a0fe6/8ac56/001-02-problem-found.webp 240w,
/static/82c50e4650173ff00047c998900a0fe6/d3be9/001-02-problem-found.webp 480w,
/static/82c50e4650173ff00047c998900a0fe6/e46b2/001-02-problem-found.webp 960w,
/static/82c50e4650173ff00047c998900a0fe6/f992d/001-02-problem-found.webp 1440w,
/static/82c50e4650173ff00047c998900a0fe6/f4368/001-02-problem-found.webp 1772w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/82c50e4650173ff00047c998900a0fe6/8ff5a/001-02-problem-found.png 240w,
/static/82c50e4650173ff00047c998900a0fe6/e85cb/001-02-problem-found.png 480w,
/static/82c50e4650173ff00047c998900a0fe6/d9199/001-02-problem-found.png 960w,
/static/82c50e4650173ff00047c998900a0fe6/07a9c/001-02-problem-found.png 1440w,
/static/82c50e4650173ff00047c998900a0fe6/2d912/001-02-problem-found.png 1772w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/png&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/82c50e4650173ff00047c998900a0fe6/d9199/001-02-problem-found.png&quot;
            alt=&quot;많이 쓰는 기능같지 않아서, 저는 이 단축키를 없앴습니다.&quot;
            title=&quot;많이 쓰는 기능같지 않아서, 저는 이 단축키를 없앴습니다.&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;많이 쓰는 기능같지 않아서, 저는 이 단축키를 없앴습니다.&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;또다른-해결책&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%98%90%EB%8B%A4%EB%A5%B8-%ED%95%B4%EA%B2%B0%EC%B1%85&quot; aria-label=&quot;또다른 해결책 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;또다른 해결책?&lt;/h2&gt;
&lt;p&gt;Show all commands(&lt;code class=&quot;language-text&quot;&gt;Ctrl + Shift + P&lt;/code&gt;) 를 통해 토글을 직접 수행할 수도 있습니다.&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;gatsby-resp-image-figure&quot; style=&quot;&quot;&gt;
    &lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/f8a0a108f674bf3f21e10b9f9e7700a2/0c02e/002_command_toggle.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 19.583333333333332%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAEABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFgEBAQEAAAAAAAAAAAAAAAAAAQAC/9oADAMBAAIQAxAAAAHOg0AX/8QAFRABAQAAAAAAAAAAAAAAAAAAARD/2gAIAQEAAQUCS//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAABD/2gAIAQEABj8Cf//EABgQAQADAQAAAAAAAAAAAAAAAAEAECFR/9oACAEBAAE/IQDCkOT/2gAMAwEAAgADAAAAEPQ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhAAAgIDAAAAAAAAAAAAAAAAAAERIVFhof/aAAgBAQABPxCXwN7ZWOiDpD//2Q==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;picture&gt;
          &lt;source
              srcset=&quot;/static/f8a0a108f674bf3f21e10b9f9e7700a2/8ac56/002_command_toggle.webp 240w,
/static/f8a0a108f674bf3f21e10b9f9e7700a2/d3be9/002_command_toggle.webp 480w,
/static/f8a0a108f674bf3f21e10b9f9e7700a2/e46b2/002_command_toggle.webp 960w,
/static/f8a0a108f674bf3f21e10b9f9e7700a2/b732a/002_command_toggle.webp 1206w&quot;
              sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
              type=&quot;image/webp&quot;
            /&gt;
          &lt;source
            srcset=&quot;/static/f8a0a108f674bf3f21e10b9f9e7700a2/09b79/002_command_toggle.jpg 240w,
/static/f8a0a108f674bf3f21e10b9f9e7700a2/7cc5e/002_command_toggle.jpg 480w,
/static/f8a0a108f674bf3f21e10b9f9e7700a2/6a068/002_command_toggle.jpg 960w,
/static/f8a0a108f674bf3f21e10b9f9e7700a2/0c02e/002_command_toggle.jpg 1206w&quot;
            sizes=&quot;(max-width: 960px) 100vw, 960px&quot;
            type=&quot;image/jpeg&quot;
          /&gt;
          &lt;img
            class=&quot;gatsby-resp-image-image&quot;
            src=&quot;/static/f8a0a108f674bf3f21e10b9f9e7700a2/6a068/002_command_toggle.jpg&quot;
            alt=&quot;액티비티 버튼도 토글을 할 수 있군요...&quot;
            title=&quot;액티비티 버튼도 토글을 할 수 있군요...&quot;
            loading=&quot;lazy&quot;
            decoding=&quot;async&quot;
            style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
          /&gt;
        &lt;/picture&gt;
  &lt;/a&gt;
    &lt;/span&gt;
    &lt;figcaption class=&quot;gatsby-resp-image-figcaption&quot;&gt;&lt;p&gt;액티비티 버튼도 토글을 할 수 있군요…&lt;/p&gt;&lt;/figcaption&gt;
  &lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;lessons-learned&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#lessons-learned&quot; aria-label=&quot;lessons learned permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Lessons learned&lt;/h2&gt;
&lt;p&gt;아래의 내용을 배울 수 있었습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;짧은 영어로 검색해서 최대한 힌트를 얻어봅시다.
&lt;ol&gt;
&lt;li&gt;저는 이번 건을 해결하기 위해 &lt;code class=&quot;language-text&quot;&gt;vscode tab is missing&lt;/code&gt; 이라고 쳤음에도(!) 결과를 찾을 수 있었습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;VSCode의 Show all commands 가 정말 꿀기능 이었습니다. 필요한 커맨드를 찾고 바로 수행할 수가 있네요.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;마무리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%88%EB%AC%B4%EB%A6%AC&quot; aria-label=&quot;마무리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;마무리&lt;/h2&gt;
&lt;p&gt;별 것 아닌 내용이지만, 괜히 지웠다 깔 필요 없이 다음번에도 헤메지 않기 위해 메모했습니다. 별 것 아니지만, 여러분들께도 도움이 되길 바랍니다. 감사합니다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[PyCharm에서 파일 맨 위에 작성하는 주석을 작성하는 매크로 만들기]]></title><description><![CDATA[매일 입력하는 파일 설명(시그니처)을 귀찮지 않게 커맨드 하나로 자동입력되게 하는 방안을 찾았습니다. 회사 팀원들과 주변사람들에게만 공유하기는 아까워서 짧은 글을 써봤습니다.]]></description><link>https://blog.s3ich4n.me/tips/how-to-use-file-signature-in-pycharm</link><guid isPermaLink="false">https://blog.s3ich4n.me/tips/how-to-use-file-signature-in-pycharm</guid><pubDate>Thu, 03 Jun 2021 09:00:00 GMT</pubDate><content:encoded>&lt;p&gt;PyCharm에서 파일 시그니처를 바로 입력하려면?&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Live Templates&lt;/code&gt; 기능을 사용하면 보다 손쉽게 사용할 수 있다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;shift 두번 눌러서 액션을 열고 &lt;code class=&quot;language-text&quot;&gt;Live Templates&lt;/code&gt; 를 연다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;add를 하되, 파이썬 파일에서만 쓸거니까 파이썬에서 기능을 혀용하도록 한다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;이런 식으로 시그니처를 작성한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;#
# (코드의 전반적인 내용을 설명해 주세요)
#
# @author      Seongeun Yu (seongeun.yu@somma.kr)
# @date        $DATE$ $TIME$ created.
# @modified    $DATE$ $TIME$ modified.
# @copyright   MIT License
#&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol&gt;
&lt;li&gt;변수를 저렇게 두면 원하는 함수를 써서 매핑할 수 있다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;$DATE$&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;$TIME$&lt;/code&gt; 값은 함수를 쓰면 된다. 관련 참고링크는 &lt;a href=&quot;https://www.jetbrains.com/help/pycharm/template-variables.html#predefined_functions&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;여기&lt;/a&gt;:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;date()&lt;/code&gt; 함수의 파라미터 규격은 자바의 (&lt;a href=&quot;https://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;SimpleDateFormat&lt;/a&gt;)을 따라간다.&lt;/li&gt;
&lt;li&gt;date, time의 규격은 이렇게 하면 된다.
&lt;ol&gt;
&lt;li&gt;date는? &lt;code class=&quot;language-text&quot;&gt;date(&quot;yyyy/MM/dd&quot;)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;time은? &lt;code class=&quot;language-text&quot;&gt;date(&quot;HH:mm&quot;)&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;파일을 열 때마다 &lt;code class=&quot;language-text&quot;&gt;sign_s3ich4n&lt;/code&gt; 를 한두글자만 치면 자동완성으로 알아서 완성된다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;</content:encoded></item><item><title><![CDATA[pre-commit hook, 나도 한번 써보자 (1)]]></title><description><![CDATA[pre-commit hook 말만 들었지 실제로 써보지 못했는데, 이참에 써보고 팀원들에게 공유하기 위해 글을 씁니다. 제 1탄입니다.]]></description><link>https://blog.s3ich4n.me/tips/2021-07-11-how-to-use-pre-commit-hook-vol1</link><guid isPermaLink="false">https://blog.s3ich4n.me/tips/2021-07-11-how-to-use-pre-commit-hook-vol1</guid><pubDate>Thu, 03 Jun 2021 09:00:00 GMT</pubDate><content:encoded>&lt;p&gt;이 글은 pre-commit hook 을 사용하고 전파하기 위해 작성한 시리즈 글입니다.&lt;/p&gt;
&lt;h2 id=&quot;설치-및-설정하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%84%A4%EC%B9%98-%EB%B0%8F-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0&quot; aria-label=&quot;설치 및 설정하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;설치 및 설정하기&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;작업 환경에 맞게 &lt;a href=&quot;https://pre-commit.com/#installation&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;pre-commit hook을 설치한다&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;pre-commit 환경을 추가한다. 우선은 제대로 따라해보기 위해 예시만 간략히 써보자.&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;추가할 수 있는 훅의 종류는 &lt;a href=&quot;https://pre-commit.com/hooks.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;여기&lt;/a&gt;를 참조한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;repos&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;repo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; https&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;//github.com/pre&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;commit/pre&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;commit&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;hooks
    &lt;span class=&quot;token key atrule&quot;&gt;rev&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; v2.3.0
    &lt;span class=&quot;token key atrule&quot;&gt;hooks&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; check&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;yaml
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; end&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;of&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;file&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;fixer
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; trailing&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;whitespace
  &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;repo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; https&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;//github.com/psf/black
    &lt;span class=&quot;token key atrule&quot;&gt;rev&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 19.3b0
    &lt;span class=&quot;token key atrule&quot;&gt;hooks&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; black&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;브랜치에 깃 훅 스크립트를 설치한다
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;pre-commit install&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;수동으로 돌려본다
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;pre-commit run --all-files&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;앞으로 매 커밋마다 &lt;code class=&quot;language-text&quot;&gt;pre-commit&lt;/code&gt; 훅이 걸릴 것임. &lt;del&gt;똥같은&lt;/del&gt; 구린 코드를 커밋하면 아래와 같은 수정내역이 뜬다!&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;오후 1&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;54	Commit failed with error
        0 file committed&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;5 files failed to commit&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;feat&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; pre&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;commit hook 추가
        Check Yaml&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;.(no files to check)Skipped
        Fix End of Files&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;Passed
        Trim Trailing Whitespace&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;.Passed
        black&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;..Failed
        &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;hook id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; black
        &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; files were modified by this hook

        reformatted /home/l4in/garage.object/01_객체&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;설계/01_대충설계한코드/audience.py
        reformatted /home/l4in/garage.object/01_객체&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;설계/01_대충설계한코드/bag.py
        All done&lt;span class=&quot;token tag&quot;&gt;!&lt;/span&gt; ✨ 🍰 ✨
        2 files reformatted&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 3 files left unchanged.

        mypy&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;...&lt;/span&gt;Failed
        &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;hook id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; mypy
        &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;exit code&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;

        01_대충설계한코드 is not a valid Python package name&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;제거하기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A0%9C%EA%B1%B0%ED%95%98%EA%B8%B0&quot; aria-label=&quot;제거하기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;제거하기&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;pre-commit 훅 삭제는 &lt;a href=&quot;https://pre-commit.com/#pre-commit-uninstall&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;다음 링크를 참고&lt;/a&gt;한다&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;차후-해볼것&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%B0%A8%ED%9B%84-%ED%95%B4%EB%B3%BC%EA%B2%83&quot; aria-label=&quot;차후 해볼것 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;차후 해볼것&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://pre-commit.com/#usage-in-continuous-integration&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;CI 연동&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;더 없나 찾아보자&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[간략히 써본 서버 점검 가이드]]></title><description><![CDATA[서버 점검과 관련하여]]></description><link>https://blog.s3ich4n.me/tips/2021-02-03-server-maintenance-guide</link><guid isPermaLink="false">https://blog.s3ich4n.me/tips/2021-02-03-server-maintenance-guide</guid><pubDate>Wed, 03 Feb 2021 10:17:43 GMT</pubDate><content:encoded>&lt;p&gt;서버 점검과 관련하여 좋은글들을 추합한 내용을 공유합니다.&lt;/p&gt;
&lt;h1 id=&quot;작성에-앞서&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9E%91%EC%84%B1%EC%97%90-%EC%95%9E%EC%84%9C&quot; aria-label=&quot;작성에 앞서 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;작성에 앞서…&lt;/h1&gt;
&lt;p&gt;이 글은 좋은 글을 가져와 제 입맛에 맞게 정리한 것에 불과합니다. 제 스스로 되새김질 하기 위해 썼기 때문에, 하단의 참조링크를 반드시 보실 것을 권해드립니다.&lt;/p&gt;
&lt;h1 id=&quot;prerequisite&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#prerequisite&quot; aria-label=&quot;prerequisite permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Prerequisite&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;서버에 부하가 걸리는 명령은, &lt;code class=&quot;language-text&quot;&gt;ionice&lt;/code&gt; 커맨드를 붙여서 사용합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;ionice &lt;span class=&quot;token parameter variable&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;nice&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;19&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# -c 2: 디스크 I/O의 실행 우선 순위 조정&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# -n 7: 명령의 우선 순위를 낮추는&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# -n 19: 프로세스 실행 우선 순위를 가장 낮게&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;vi&lt;/code&gt;로 파일확인 대신, &lt;code class=&quot;language-text&quot;&gt;less&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;more&lt;/code&gt; 혹은 &lt;code class=&quot;language-text&quot;&gt;cat&lt;/code&gt;을 사용합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;명령&lt;/th&gt;
&lt;th&gt;설명&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;less&lt;/td&gt;
&lt;td&gt;파일의 내용을 표시하며 스크롤 있고, vi와 달리 전체 파일을 로드하지 않기 때문에 시작이 빠고 q를 누르면 종료합니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;more&lt;/td&gt;
&lt;td&gt;파일의 내용을 표시하며 스크롤 있고, 첫 행까지 표시하고 종료합니다. less와 달리 q 버튼으로 종료해도 출력이 터미널에 남아 있습니다.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;작업 결과 등의 일시적인 파일 저장은 &lt;code class=&quot;language-text&quot;&gt;/tmp&lt;/code&gt; 와 &lt;code class=&quot;language-text&quot;&gt;/var/tmp&lt;/code&gt; 에 저장합니다(파일 삭제를 할 필요가 없음).&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;/tmp&lt;/code&gt;를 (&lt;code class=&quot;language-text&quot;&gt;tmpfs&lt;/code&gt;에 마운트 된 경우) 다시 시작하면 파일이 사라집니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;/var/tmp&lt;/code&gt;는 다시 시작해도 파일은 사라지지 않고 &lt;code class=&quot;language-text&quot;&gt;/tmp&lt;/code&gt;보다 오랜 기간 유지됩니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;/tmp&lt;/code&gt;(10일), &lt;code class=&quot;language-text&quot;&gt;/var/tmp&lt;/code&gt;(30일) 둘다 정기적으로 지워집니다.
&lt;ul&gt;
&lt;li&gt;서버에 설정된 사항은 &lt;code class=&quot;language-text&quot;&gt;more /usr/lib/tmpfiles.d/tmp.conf&lt;/code&gt; 로 확인 가능합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;history에서 커맨드 기록을 삭제해야 할 때는 다음 명령을 수행합니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;history | less&lt;/code&gt;: 명령어를 수행한 번호를 파악합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;history -d 42&lt;/code&gt;: 명령어를 통해 스크립트 수행 기록을 삭제합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;1-서버-구동시간-확인&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1-%EC%84%9C%EB%B2%84-%EA%B5%AC%EB%8F%99%EC%8B%9C%EA%B0%84-%ED%99%95%EC%9D%B8&quot; aria-label=&quot;1 서버 구동시간 확인 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1. 서버 구동시간 확인&lt;/h1&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;uptime&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id=&quot;2-dmesg를-이용한-os-레벨의-에러메시지-특이사항-확인&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2-dmesg%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-os-%EB%A0%88%EB%B2%A8%EC%9D%98-%EC%97%90%EB%9F%AC%EB%A9%94%EC%8B%9C%EC%A7%80-%ED%8A%B9%EC%9D%B4%EC%82%AC%ED%95%AD-%ED%99%95%EC%9D%B8&quot; aria-label=&quot;2 dmesg를 이용한 os 레벨의 에러메시지 특이사항 확인 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2. dmesg를 이용한 OS 레벨의 에러메시지 특이사항 확인&lt;/h1&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;dmesg&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;tail&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id=&quot;3-메모리-확인&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#3-%EB%A9%94%EB%AA%A8%EB%A6%AC-%ED%99%95%EC%9D%B8&quot; aria-label=&quot;3 메모리 확인 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3. 메모리 확인&lt;/h1&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;free&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-hm&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# human readable, mebibyte 단위로 출력&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;또는 아래 스크립트를 작성해두어 메모리를 확인합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token shebang important&quot;&gt;#!/bin/bash&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;&lt;span class=&quot;token environment constant&quot;&gt;LANG&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;C, &lt;span class=&quot;token assign-left variable&quot;&gt;&lt;span class=&quot;token environment constant&quot;&gt;LC_ALL&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;C

&lt;span class=&quot;token function&quot;&gt;free&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;
    BEGIN{
        total=0; used=0; available=0; rate=0;
    }

    /^Mem:/{
        total = $2;
        available = $7;
    }

    END {
        used = total - available;
        rate= 100 * used / total;
        printf(&quot;total(KB)\tused(KB)\tavailable(KB)\tused-rate(%)\n&quot;);
        printf(&quot;%d \t %d \t %d \t %.1f\n&quot;, total, used, available, rate);
    }&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;실행결과&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;bash&lt;/span&gt; memory-usage-free.sh
total&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;KB&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;	used&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;KB&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;	available&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;KB&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;	used-rate&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;7747768&lt;/span&gt; 	&lt;span class=&quot;token number&quot;&gt;4783068&lt;/span&gt; 	&lt;span class=&quot;token number&quot;&gt;2964700&lt;/span&gt; 	    &lt;span class=&quot;token number&quot;&gt;61.7&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id=&quot;4-파일-시스템-확인&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#4-%ED%8C%8C%EC%9D%BC-%EC%8B%9C%EC%8A%A4%ED%85%9C-%ED%99%95%EC%9D%B8&quot; aria-label=&quot;4 파일 시스템 확인 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4. 파일 시스템 확인&lt;/h1&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# 파일 시스템 확인&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-Th&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 디스크 사용량 순으로 확인하는 스크립트&lt;/span&gt;
ionice &lt;span class=&quot;token parameter variable&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;nice&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;19&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;du&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-scm&lt;/span&gt; /* &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sort&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-rn&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;scm 옵션
&lt;ul&gt;
&lt;li&gt;하위 디렉토리 숨기기 + 전체 디스크 사용량 표시 + M 바이트 형식으로 표시이고 rn 옵션은 사용량이 많은 순서로 + 수치로 비교합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;5-네트워크-상태-확인&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#5-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%83%81%ED%83%9C-%ED%99%95%EC%9D%B8&quot; aria-label=&quot;5 네트워크 상태 확인 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;5. 네트워크 상태 확인&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;아래 스크립트를 통해 &lt;code class=&quot;language-text&quot;&gt;TIME_WAIT&lt;/code&gt; 및 &lt;code class=&quot;language-text&quot;&gt;CLOSE_WAIT&lt;/code&gt; 현황 파악을 수행합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token shebang important&quot;&gt;#!/bin/bash&lt;/span&gt;
&lt;span class=&quot;token assign-left variable&quot;&gt;COUNT&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;:&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$COUNT&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;then&lt;/span&gt;
                &lt;span class=&quot;token builtin class-name&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+ &lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;&quot;&lt;/span&gt;
                &lt;span class=&quot;token builtin class-name&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;|  TIME  |ESTAB|LISTN|T_WAT|CLOSD|S_SEN|S_REC|C_WAT|F_WT1|F_WT2|CLOSI|L_ACK| &lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;&quot;&lt;/span&gt;
                &lt;span class=&quot;token builtin class-name&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+ &lt;span class=&quot;token entity&quot; title=&quot;\n&quot;&gt;\n&lt;/span&gt;&quot;&lt;/span&gt;
                &lt;span class=&quot;token assign-left variable&quot;&gt;COUNT&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;fi&lt;/span&gt;
        &lt;span class=&quot;token assign-left variable&quot;&gt;COUNT&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;expr&lt;/span&gt; $COUNT + &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;
        &lt;span class=&quot;token assign-left variable&quot;&gt;TIME&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;/bin/date +%H:%M:%S&lt;span class=&quot;token variable&quot;&gt;`&lt;/span&gt;&lt;/span&gt;
        &lt;span class=&quot;token builtin class-name&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;|%s&quot;&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;${TIME}&lt;/span&gt;
        &lt;span class=&quot;token function&quot;&gt;netstat&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-an&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;
        &lt;span class=&quot;token function&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;BEGIN {
                CLOSED = 0;
                LISTEN = 0;
                SYN_SENT = 0;
                SYN_RECEIVED = 0;
                ESTABLISHED = 0;
                CLOSE_WAIT = 0;
                FIN_WAIT_1 = 0;
                FIN_WAIT_2 = 0;
                CLOSING = 0;
                LAST_ACK = 0;
                TIME_WAIT = 0;
                OTHER = 0;
                }
                $6 ~ /^CLOSED$/ { CLOSED++; }
                $6 ~ /^CLOSE_WAIT$/ { CLOSE_WAIT++; }
                $6 ~ /^CLOSING$/ { CLOSING++; }
                $6 ~ /^ESTABLISHED$/ { ESTABLISHED++; }
                $6 ~ /^FIN_WAIT1$/ { FIN_WAIT_1++; }
                $6 ~ /^FIN_WAIT2$/ { FIN_WAIT_2++; }
                $6 ~ /^LISTEN$/ { LISTEN++; }
                $6 ~ /^LAST_ACK$/ { LAST_ACK++; }
                $6 ~ /^SYN_SENT$/ { SYN_SENT++; }
                $6 ~ /^SYN_RECV$/ { SYN_RECEIVED++; }
                $6 ~ /^TIME_WAIT$/ { TIME_WAIT++; }

                END {
                        printf &quot;| %4d| %4d| %4d| %4d| %4d| %4d| %4d| %4d| %4d| %4d| %4d|\n&quot;,ESTABLISHED,LISTEN,TIME_WAIT,CLOSED,SYN_SENT,SYN_RECEIVED,CLOSE_WAIT,FIN_WAIT_1,FIN_WAIT_2,CLOSING,LAST_ACK;
                }&apos;&lt;/span&gt;
        &lt;span class=&quot;token function&quot;&gt;sleep&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;done&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;실행결과&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;bash&lt;/span&gt; netmon.sh
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;  TIME  &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;ESTAB&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;LISTN&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;T_WAT&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;CLOSD&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;S_SEN&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;S_REC&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;C_WAT&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;F_WT1&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;F_WT2&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;CLOSI&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;L_ACK&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
+--------+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;18&lt;/span&gt;:28:27&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;    &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;    &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;    &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;    &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;    &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;    &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;    &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;    &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;    &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;    &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;    &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;18&lt;/span&gt;:28:29&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;    &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;    &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;    &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;    &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;    &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;    &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;    &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;    &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;    &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;    &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;    &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;이하 생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;아래 스크립트를 통해 서버의 &lt;code class=&quot;language-text&quot;&gt;LISTEN&lt;/code&gt; 포트 별 커넥션 수 모니터링을 수행합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token shebang important&quot;&gt;#!/bin/bash&lt;/span&gt;

&lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;rem_address&quot;&lt;/span&gt; /proc/net/tcp  &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;function hextodec(str,ret,n,i,k,c){
    ret = 0
    n = length(str)
    for (i = 1; i &amp;lt;= n; i++) {
        c = tolower(substr(str, i, 1))
        k = index(&quot;123456789abcdef&quot;, c)
        ret = ret * 16 + k
    }
    return ret
} {x=hextodec(substr($2,index($2,&quot;:&quot;)-2,2)); for (i=5; i&gt;0; i-=2) x = x&quot;.&quot;hextodec(substr($2,i,2))}{print x&quot;:&quot;hextodec(substr($2,index($2,&quot;:&quot;)+1,4))}&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sort&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;uniq&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sort&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-rn&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;실행결과&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;bash&lt;/span&gt; connection-port.sh
      &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10.41&lt;/span&gt;.36.207:22
      &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.0&lt;/span&gt;.0.0:22&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id=&quot;6-부하상황-확인&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#6-%EB%B6%80%ED%95%98%EC%83%81%ED%99%A9-%ED%99%95%EC%9D%B8&quot; aria-label=&quot;6 부하상황 확인 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;6. 부하상황 확인&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;시스템에 구동중인 프로세스 및 상태 표시&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;ionice &lt;span class=&quot;token parameter variable&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;nice&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;19&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;top&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-c&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;-c&lt;/code&gt;를 쓰면 프로세스 목록 창에 표시되는 프로세스 이름이 인자의 정보도 포함.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;top&lt;/code&gt; 화면으로 이동한 다음 &lt;code class=&quot;language-text&quot;&gt;1&lt;/code&gt;을 입력하면 각 CPU 코어의 활용도를 개별적으로 볼 수 있습니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;E&lt;/code&gt; (대소문자 구별)을 입력하면, 메모리 단위를 MiB, GiB 단위로&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;us(user)&lt;/code&gt;: OS의 유저에서 사용한 CPU 비율. 애플리케이션 이 얼마만큼 CPU를 사용하고 있는지에 대한 지표.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;sy(system)&lt;/code&gt;: OS의 커널에서 사용한 CPU 비율. system 값이 높은 경우 OS의 자원(파일 디스크립터와 포트 등)을 가진 경우입니다. 커널 파라미터 튜닝에 의해 부하를 낮출 수 있습니다. &lt;code class=&quot;language-text&quot;&gt;fork&lt;/code&gt; 횟수가 많은 등 부하가 높은 시스템 호출을 응용 프로그램이 했을 가능성이 있고 &lt;code class=&quot;language-text&quot;&gt;strace&lt;/code&gt;를 통해 더 자세하게 조사할 수 있습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;wa(iowait)&lt;/code&gt;: 디스크 I/O에 사용된 CPU 비율. &lt;code class=&quot;language-text&quot;&gt;iowait&lt;/code&gt;가 높은 경우는 &lt;code class=&quot;language-text&quot;&gt;iostat&lt;/code&gt; 명령어를 통해 디스크 I/O 상황을 볼 수 있습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;아래 표는 &lt;code class=&quot;language-text&quot;&gt;top&lt;/code&gt; 명령을 통해 볼 수 있는 지표들을 설명합니다:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;PR&lt;/th&gt;
&lt;th&gt;NI&lt;/th&gt;
&lt;th&gt;VIRT&lt;/th&gt;
&lt;th&gt;RES&lt;/th&gt;
&lt;th&gt;SHR&lt;/th&gt;
&lt;th&gt;S&lt;/th&gt;
&lt;th&gt;%CPU&lt;/th&gt;
&lt;th&gt;%MEM&lt;/th&gt;
&lt;th&gt;TIME+&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;우선 순위&lt;/td&gt;
&lt;td&gt;상대 우선 순위&lt;/td&gt;
&lt;td&gt;가상 메모리&lt;/td&gt;
&lt;td&gt;실제 메모리&lt;/td&gt;
&lt;td&gt;공유 메모리&lt;/td&gt;
&lt;td&gt;상태&lt;/td&gt;
&lt;td&gt;CPU 사용률&lt;/td&gt;
&lt;td&gt;메모리 사용률&lt;/td&gt;
&lt;td&gt;실행 시간&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;S: Process Status&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;플래그&lt;/th&gt;
&lt;th&gt;의미&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;D&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;인터럽트 불가&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;R&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;실행 중&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;S&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;잠&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;T&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;정지 중&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;Z&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;좀비 프로세스&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CPU 사용량, R/W에 대한 I/O량, 메모리 사용량&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;sar &lt;span class=&quot;token parameter variable&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 만일 시스템에 sar가 설치되어 있지 않을 경우, 설치를 수행하여 확인합니다.&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;apt-get&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; sysstat&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;%user&lt;/code&gt;: 사용자 영역에서의 CPU 사용률.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;%nice&lt;/code&gt;: 우선 순위 변경된 프로세스를 통해 사용자 영역에서 CPU가 사용된 활용도.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;%system&lt;/code&gt;: 커널 영역에서의 CPU 사용률.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;%iowiat&lt;/code&gt;: 표시되는 경우 CPU가 I/O 작업을 기다리고 있었음을 나타내는데, 시간의 비율로 보여준다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;%idle&lt;/code&gt;: 디스크 I/O 대기에서 CPU가 기다리던 시간의 비율.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;CPU 사용률, 대기/차단된 프로세스 정보&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;vmstat&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt;: CPU에서 실행 및 순서를 기다리고있는 프로세스의 수. &lt;code class=&quot;language-text&quot;&gt;r&lt;/code&gt;값이 CPU 수보다 많으면 포화 상태입니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;b&lt;/code&gt;: 차단된 프로세스 수입니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;si, so&lt;/code&gt;: 스왑과 스왑. 제로가 아닌 값이 있으면 메모리 부족을 의미합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;us, sy, id, wa, st&lt;/code&gt;: CPU 시간의 분석에서 모든 CPU에 대한 평균 값. 각 사용자 시간, 시스템(커널) 시간, 유휴, 대기 시간, I/O 지연, steal된 시간.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;프로세스 당 상황&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;CPU 점유율 순으로 내림차순 정렬 후, 점유율이 높은 프로세스를 확인&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;ps&lt;/span&gt; aux &lt;span class=&quot;token parameter variable&quot;&gt;--sort&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;-%cpu&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;7-도커-컨테이너-상황-확인&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#7-%EB%8F%84%EC%BB%A4-%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88-%EC%83%81%ED%99%A9-%ED%99%95%EC%9D%B8&quot; aria-label=&quot;7 도커 컨테이너 상황 확인 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;7. 도커 컨테이너 상황 확인&lt;/h1&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;ps&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-a&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 이상있는 컨테이너 상황을 살펴보려고 할 때&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 컨테이너 로그 보기&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; logs &lt;span class=&quot;token parameter variable&quot;&gt;-f&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$CONTAINER_NAME&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# tail 파라미터를 이용하여 로그의 마지막부터 보기&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; logs &lt;span class=&quot;token parameter variable&quot;&gt;-f&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;--tail&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$CONTAINER_NAME&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 컨테이너 내부 설정 등을 보기&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;docker&lt;/span&gt; inspect &lt;span class=&quot;token variable&quot;&gt;$CONTAINER_NAME&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id=&quot;마무리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%88%EB%AC%B4%EB%A6%AC&quot; aria-label=&quot;마무리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;마무리&lt;/h1&gt;
&lt;p&gt;다시금 말씀드리지만, 이 글은 좋은 글을 가져와 제 입맛에 맞게 정리한 것에 불과합니다. 제 스스로 되새김질 하기 위해 썼기 때문에 하단의 참조링크를 꼭 일독하시기를 권해드립니다.&lt;/p&gt;
&lt;p&gt;감사합니다.&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id=&quot;references&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#references&quot; aria-label=&quot;references permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;References&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://brunch.co.kr/@daniellim/19&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://brunch.co.kr/@daniellim/19&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.mimul.com/blog/linux-server-operations/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://www.mimul.com/blog/linux-server-operations/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://netflixtechblog.com/linux-performance-analysis-in-60-000-milliseconds-accc10403c55&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://netflixtechblog.com/linux-performance-analysis-in-60-000-milliseconds-accc10403c55&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[1년차 회고]]></title><description><![CDATA[2019년 입사부터 약 1년간 어떻게 살아왔는지에 대한 이야기입니다. (노잼)]]></description><link>https://blog.s3ich4n.me/retrospect/2020-05-22-s3ich4n-1-year-retrospect</link><guid isPermaLink="false">https://blog.s3ich4n.me/retrospect/2020-05-22-s3ich4n-1-year-retrospect</guid><pubDate>Fri, 22 May 2020 19:30:00 GMT</pubDate><content:encoded>&lt;h1 id=&quot;1년을-돌아보며&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1%EB%85%84%EC%9D%84-%EB%8F%8C%EC%95%84%EB%B3%B4%EB%A9%B0&quot; aria-label=&quot;1년을 돌아보며 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1년을 돌아보며&lt;/h1&gt;
&lt;p&gt;지난 1년간 회사생활을 하며 제가 겪었던 (거의) 모든 일들을 요약하여 회고합니다.&lt;/p&gt;
&lt;h2 id=&quot;목차&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AA%A9%EC%B0%A8&quot; aria-label=&quot;목차 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;목차&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#%EC%88%98%EC%8A%B5%EA%B8%B0%EA%B0%84%EA%B3%BC-3%EA%B0%9C%EC%9B%94-%EA%B0%84&quot;&gt;수습기간과 3개월간&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%EB%B0%B1%EC%97%94%EB%93%9C-%EC%9E%91%EC%97%85%EC%9D%84-%EB%A7%A1%EC%9C%BC%EB%A9%B0&quot;&gt;백엔드 작업을 맡으며&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%EC%96%B4%EB%96%A4-%EC%B1%85%EC%9D%84-%EB%B4%A4%EC%97%88%EB%82%98?&quot;&gt;어떤 책을 봤었나?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%EA%B3%BC%EC%97%B0-%EB%82%98%EB%8A%94-%EB%82%98%EC%95%84%EC%A1%8C%EB%82%98&quot;&gt;과연 나는 나아졌나?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%EB%A7%88%EC%B9%98%EB%A9%B0&quot;&gt;마치며&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;수습기간과-3개월-간&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%88%98%EC%8A%B5%EA%B8%B0%EA%B0%84%EA%B3%BC-3%EA%B0%9C%EC%9B%94-%EA%B0%84&quot; aria-label=&quot;수습기간과 3개월 간 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;수습기간과 3개월 간&lt;/h2&gt;
&lt;h3 id=&quot;첫번째-오더와-드러난-큰-단점&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%B2%AB%EB%B2%88%EC%A7%B8-%EC%98%A4%EB%8D%94%EC%99%80-%EB%93%9C%EB%9F%AC%EB%82%9C-%ED%81%B0-%EB%8B%A8%EC%A0%90&quot; aria-label=&quot;첫번째 오더와 드러난 큰 단점 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;첫번째 오더와 드러난 큰 단점&lt;/h3&gt;
&lt;p&gt;처음 입사를 하고 회사에서 개발중인 에이전트와 백엔드 시스템에 대한 큰 그림을 전달받았습니다. 특히 백엔드 시스템은 크게 어떤 방식으로 관리되며, 필요한 지시사항과 향후 발전과정에 대한 이야기를 들었습니다. 이 때부터 였을까요, 저의 단점이 드러나기 시작했습니다.&lt;/p&gt;
&lt;p&gt;회사에 처음 왔으니 회사에서 사용하는 기술과 처음보는 소스코드 등 모르는 것들이 많았고, 백엔드 시스템이 어떻게 구성되는지를 먼저 파악하기 위해 기술문서들을 계속 읽었습니다. 그러면 자연스럽게 모르는 것이 많이 생기고, 질문하지 않으면 오랜 시간이 걸릴 작업일게 뻔한 것들이 많이 생깁니다. 하지만 &lt;strong&gt;질문 없이&lt;/strong&gt; 스스로 풀려고 했던 실수를 했었지요.&lt;/p&gt;
&lt;h3 id=&quot;lessons-learned&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#lessons-learned&quot; aria-label=&quot;lessons learned permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Lessons learned&lt;/h3&gt;
&lt;p&gt;이를 위해 저는 아래의 것들을 생각하게 되었습니다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;일의 전체 흐름을 파악합시다.&lt;/li&gt;
&lt;li&gt;이를 통해 해야할 일을 파악해나가며, 스케줄링을 진행합니다(이에 대해선, 대표님께 GTD를 추천받았던 게시글로 후술하려 합니다).&lt;/li&gt;
&lt;li&gt;위의 일을 하면서 모르면 주저하지 말고 정제된 질문을 만든 후 물어봅시다.&lt;/li&gt;
&lt;li&gt;두괄식으로 말합시다. 뉴스에서 아나운서, 리포터들이 말하는 스타일을 생각하면 됩니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;위의 것이 “생산성을 내는 기본기” 로 마음가짐을 두게 되었습니다.&lt;/p&gt;
&lt;p&gt;모르는 것을 정제하지 않고 물어보면 팀원 및 팀장의 귀중한 시간을 뺏는 셈이 됩니다. 하지만, 그것을 두려워하여 필요한 질문을 하지 않는 것 또한 분명 나중의 귀중한 시간을 뺏는 행동입니다. 아울러 질문에 대해 원하는 대답을 주지 않는 것도 마찬가지입니다. 답변을 줄 때도 심사숙고할 필요가 있지요.&lt;/p&gt;
&lt;h2 id=&quot;백엔드-작업을-맡으며&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%B0%B1%EC%97%94%EB%93%9C-%EC%9E%91%EC%97%85%EC%9D%84-%EB%A7%A1%EC%9C%BC%EB%A9%B0&quot; aria-label=&quot;백엔드 작업을 맡으며 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;백엔드 작업을 맡으며&lt;/h2&gt;
&lt;p&gt;1년이면 많은 일이 일어날 수 있지요. 제겐 프로그래머라는 직업을 달고 처음 일하는 때였기 때문에 누구보다 많이 긴장했었던 기억이 다시 떠오릅니다.&lt;/p&gt;
&lt;p&gt;그 때는 자사 백엔드가 어떻게 구성되어있고, 앞으로 어떻게 구상해야 할 지를 구상하던 시기였습니다. 기존에 있던 기능을 Django로 이전하거나, KSQL(현재는 &lt;code class=&quot;language-text&quot;&gt;ksqlDB&lt;/code&gt;이죠) 이나 Schema Registry 에 대해 공부하고 세미나를 했던 기억이 납니다. 객관화할 수 있는 데이터나 근거가 있다면 신기술 도입에 망설임이 없었던 덕분이었습니다. 그렇기 때문에, 기술의 선택폭에 대해선 괜찮다 싶으면 바로 도입할 수 있었습니다.&lt;/p&gt;
&lt;p&gt;아래에서, 크게 떠오르는 몇몇 케이스를 작성해보고자 합니다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;“좋아보인다”로 짐작하지 말고, 좋은 코드를 먼저 이해하자 (ft. 테스트코드)&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;p&gt;1년차 기간동안에는, Flask로 된 API 서비스를 Django 로 고치는 작업을 진행했습니다. 기존에 있던 기능을 하나씩 캐치하고, 이를 고치기는 작업을 진행했었고, 그 때 처음 TDD 를 알게되었습니다.
이건 좋아보인다! 하는 마음에 테스트코드를 비즈니스 로직에 끼워맞추는(!) 짓을 했었고, 그 시기 코드리뷰 시절에 크게 혼났던 기억이 나네요.
내가 검증해야할 로직이 뭔지 파악하고, 이를 테스트케이스를 짜서 로직을 방어하는 코드를 만들었어야 했는데 말이죠. &lt;a href=&quot;https://meetup.toast.com/posts/174&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 링크&lt;/a&gt; 를 봤음에도 전혀 엉뚱한 코드가 나왔던 기억이 납니다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;디테일에 신경을 쓰자.&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;p&gt;단순 CRUD 는 누구나 만들 수 있습니다. 그러나 &lt;a href=&quot;https://itsnothingg.medium.com/%EC%98%A4-%EC%9D%B4%EB%9F%B0-%EB%8B%B9%EC%8B%A0%EC%9D%B4-%EB%A7%8C%EB%93%A0-api-%EC%A2%80-%EB%B3%B4%EC%84%B8%EC%9A%94-98877936b10c&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이런&lt;/a&gt; &lt;a href=&quot;https://engineering.linecorp.com/ko/blog/document-engineering-api-documentation/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;아티클을&lt;/a&gt; 보며, 하나하나 살펴보며 좀 더 좋게 만들어야 하지 않나 하고 생각하게 되었습니다. 누구나 할 수 있는 것에선, 디테일을 더 따져야죠.&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;어떤 원칙이 맞는거야?&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;p&gt;때로는 API를 오픈하며, GET을 쓸지, POST를 쓸지 하는 고민을 할 때도 있었습니다. 때에 따라 다른 법이지요. &lt;a href=&quot;https://homoefficio.github.io/2019/12/25/GET%EC%9D%B4%EB%83%90-POST%EB%83%90-%EA%B7%B8%EA%B2%83%EC%9D%B4-%EB%AC%B8%EC%A0%9C%EB%A1%9C%EB%8B%A4/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 글&lt;/a&gt;을 읽고 그 생각을 잡고, Elasticsearch의 API 호출을 보고 생각을 굳혔습니다. 회사에서 제공할 서비스의 설계방향에 맞게 바꾸는게 중요하겠죠.&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;여긴 어디고 나는 누구지?&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;p&gt;핵심을 파악하는 것은 중요합니다. 하고자 하는 일에 대한 원인 파악과 근거를 알면 실수가 크게 줄어들기 때문이지요. 이를 이해하지 않고서 일에 뛰어들면 잘못 이해하거나 하지 않아도 될 고려를 할 수도 있습니다. 제게도 그런 생각을 할 수 있게 많이 도와주셨습니다. 어떤 비즈니스 로직을 작성하기 위한 방향성을 인지하고, 이를 위해 어떤 일을 해야할지를 파악하고 그를 위한 배경지식 쌓기 및 관련 내용을 찾아보기 시작했던 기억이 납니다.&lt;/p&gt;
&lt;h2 id=&quot;어떤-책을-봤었나&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%96%B4%EB%96%A4-%EC%B1%85%EC%9D%84-%EB%B4%A4%EC%97%88%EB%82%98&quot; aria-label=&quot;어떤 책을 봤었나 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;어떤 책을 봤었나?&lt;/h2&gt;
&lt;p&gt;감사하게도, 아래 책들을 추천받아서 읽게 되었습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;실용주의 프로그래머&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;프로그래머의 삶을 살기 위해 어떤 식의 삶의 태도를 가지는게 좋을까? 하는 마음가짐을 잡게 해준 책이었습니다. 처음 봤을 때는 이해 안되고 넘어간 것들도 많았는데, 되돌아보니 이해되는 부분들도 있더라구요.&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;파이썬 클린코드&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;정말 좋은책인데, 아직은 많이 어려운 것 같습니다. 주로 기억나는 부분은 이정도네요.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;주요 매직 메소드 쓰는 법&lt;/li&gt;
&lt;li&gt;객체를 깔끔하게 만들고 쓰기 위한 방안(디스크립터)&lt;/li&gt;
&lt;li&gt;SOLID principles in Python (하나같이 어려워서 나중에 볼까해요…)&lt;/li&gt;
&lt;li&gt;파이썬스러운 코드를 짜기위한 방안(제너레이터, 데코레이터)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이 책은 다시 읽어봐야겠습니다.&lt;/p&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;쏟아지는 일 완벽하게 해내는 법 (Getting Things Done)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;일을 어떻게 처리할 것인가? 에 대한 주요 방향성을 알 수 있었습니다. 정신없이 치고오는 일에 대해, 빠르게 쳐낼지/플랜을 세울지/타인에게 부탁할지/미룰지 를 판단하게 두어서, 빠르게 쳐내도록 하는 방법론이지요. 제게는 개인적으로 상당히 도움이 되어서, 제 습관으로 체득화하기 위해 노력중입니다.&lt;/p&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;TDD 실천법과 도구&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;a href=&quot;https://repo.yona.io/doortts/blog/issue/1&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 책&lt;/a&gt;입니다. 온라인으로 나온 책이고, Java였어서, 개념을 잡는데 보다 더 큰 주안점을 두고 읽었던 기억이 납니다. 제가 먼저 읽고, 나중에 동료분들이나 혹은 아는 동생들에게 가르쳐주고 싶네요.&lt;/p&gt;
&lt;h2 id=&quot;과연-나는-나아졌나&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B3%BC%EC%97%B0-%EB%82%98%EB%8A%94-%EB%82%98%EC%95%84%EC%A1%8C%EB%82%98&quot; aria-label=&quot;과연 나는 나아졌나 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;과연 나는 나아졌나?&lt;/h2&gt;
&lt;p&gt;적어도, 어제보다 나아지기 위해 생각은 하고있습니다. 한 발짝 걸었다 하고 생각되던 날은 좀 드물었던 것 같아 아쉽습니다.&lt;/p&gt;
&lt;p&gt;참 많은 용어들을 접하고, 메모하고, 다시 읽으며 역량을 키우려고 부던히 애썼습니다. 지식을 일단 쌓아야 지혜가 생길테니까요.&lt;/p&gt;
&lt;p&gt;그런 의미로, &lt;a href=&quot;https://www.popit.kr/%ED%8F%89%EB%B2%94%ED%95%9C-%EA%B0%9C%EB%B0%9C%EC%9E%90-%EA%B7%B8-%EC%9D%B4%EC%83%81%EC%9D%B4-%EB%90%98%EA%B8%B0-%EC%9C%84%ED%95%9C-%EC%95%BC%EC%83%9D-%ED%95%99%EC%8A%B5-%EB%B9%84%EA%B2%B0&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;야생학습&lt;/a&gt; 이란 말에 상당부분 동의합니다. 몸이 배워서, 효율적인 행동으로 체화되고 이를 써먹는다고나 할까요.&lt;/p&gt;
&lt;h2 id=&quot;마치며&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%88%EC%B9%98%EB%A9%B0&quot; aria-label=&quot;마치며 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;마치며&lt;/h2&gt;
&lt;p&gt;한마디로, 지난 1년은 엄청(!) 깨졌습니다. &lt;strong&gt;같이&lt;/strong&gt; 일할 준비가 안되었다 라고 하면 좋을까요. 저는 실수와 실패로부터 배웠습니다. 그 때의 저는 두려워하고 소통하지 않았습니다. 하지만 나아지기 위해 좌절하지 않고 나아갔습니다. 그땐 그랬습니다.&lt;/p&gt;
&lt;p&gt;사실 개발자로써 이렇게 하면 좋을 것이다 하는 글은 정말 많습니다. 누구나 성공을 뽐내고 싶어하며 실패를 말하기를 두려워합니다. 저의 1년간의 경험이 여러분들에게 좋은 반면교사가 되었으면 하는 바람입니다.&lt;/p&gt;
&lt;p&gt;이건 뭐 회고가 아니라 고해성사가 되어버렸군요. 재밌는 인생입니다.&lt;/p&gt;
&lt;p&gt;읽어주셔서 감사합니다.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[ksqlDB 101, part 3. 실전 예시: 오픈소스를 통해 살펴보는 실시간 보안 이벤트 탐지 룰]]></title><description><![CDATA[ksqlDB을 활용한 오픈소스의 예시를 통해, 보안 이벤트를 실시간으로 걸러내는 방안에 대해 학습해보고 이를 토대로 어떤식으로 활용하면 좋을지 살펴봅시다.]]></description><link>https://blog.s3ich4n.me/devlog/data/2020-03-10-ksqldb-101-pt03</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/data/2020-03-10-ksqldb-101-pt03</guid><pubDate>Tue, 10 Mar 2020 06:19:00 GMT</pubDate><content:encoded>&lt;p&gt;이 글은 &lt;code class=&quot;language-text&quot;&gt;ksqlDB&lt;/code&gt;(당시에는 &lt;code class=&quot;language-text&quot;&gt;KSQL&lt;/code&gt;이라는 명칭이었습니다)를 학습하기 위해 정리한 연재글입니다.&lt;/p&gt;
&lt;p&gt;이 글의 순서는 아래와 같습니다.&lt;/p&gt;
&lt;h1 id=&quot;목차&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AA%A9%EC%B0%A8&quot; aria-label=&quot;목차 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;목차&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.s3ich4n.me/devlog/data/2020-02-05-ksqldb-101-pt01&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;part 1. 배경지식&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.s3ich4n.me/devlog/data/2020-02-17-ksqldb-101-pt02&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;part 2. Kafka Streams에 대해&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;part 3. 실전 예시: 오픈소스를 통해 살펴보는 실시간 보안 이벤트 탐지 룰&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;3-ksqldb란&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#3-ksqldb%EB%9E%80&quot; aria-label=&quot;3 ksqldb란 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3. ksqlDB란?&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;카프카를 위한 Streaming SQL engine이며, Kafka Stream 기반으로 만들어졌습니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;파트 2에 언급한 해당 개념 또한 모두 SQL 쿼리로 수행할 수 있습니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;stateless processing(&lt;code class=&quot;language-text&quot;&gt;Filtering&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;Mapping&lt;/code&gt;의 개념)&lt;/li&gt;
&lt;li&gt;stateful processing(&lt;code class=&quot;language-text&quot;&gt;JOIN&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;Aggregation&lt;/code&gt;의 개념),
&lt;ul&gt;
&lt;li&gt;여러개의 스트림에 대해 실시간으로 JOIN 연산을 수행할 수도 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;windowing operations 를 지원합니다(&lt;code class=&quot;language-text&quot;&gt;WINDOW TUMBLING&lt;/code&gt;, 정의한 이상행위가 발생했다면 새로운 토픽에 씀)
&lt;ul&gt;
&lt;li&gt;이를 활용한 Anomaly Detection이 가능합니다. (&lt;code class=&quot;language-text&quot;&gt;WINDOW TUMBLING&lt;/code&gt; 범위 설정등을 의미합니다.)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;SQL 기반의 real-time 앱을 작성하는데 쓰인다 (별도의 프로세싱)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;그런 이유로 카프카 브로커 위에서 작동하는게 아닙니다. &lt;br /&gt;앞서 설명한 Kafka Streams API를 사용하는 앱처럼 구동됩니다.&lt;/li&gt;
&lt;li&gt;ksqlDB에 맞는 SQL문을 작성 후 서비스를 구동하면 프로세싱이 됩니다!&lt;/li&gt;
&lt;li&gt;User-defined Function은 Java/Scala로 사용하여 ksqlDB에 별도로 추가하여 구동하면 됩니다!&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ksqlDB를 통해 검증하고 배포하는 방법은 아래와 같습니다&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;SQL문을 별도로 준비해놓고 Interactive ksqlDB for development에서 쿼리를 개발한다&lt;/li&gt;
&lt;li&gt;Headless ksqlDB inproduction… 필요에 따른 SQL구문을 준비하고 deploy한다&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.ksqldb.io/en/latest/operate-and-deploy/how-it-works/#ksql-deployment-modes&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;참고링크&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;ksqldb을-도입한다면-어떤-관점에서-기술을-바라볼까&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#ksqldb%EC%9D%84-%EB%8F%84%EC%9E%85%ED%95%9C%EB%8B%A4%EB%A9%B4-%EC%96%B4%EB%96%A4-%EA%B4%80%EC%A0%90%EC%97%90%EC%84%9C-%EA%B8%B0%EC%88%A0%EC%9D%84-%EB%B0%94%EB%9D%BC%EB%B3%BC%EA%B9%8C&quot; aria-label=&quot;ksqldb을 도입한다면 어떤 관점에서 기술을 바라볼까 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;ksqlDB을 도입한다면? ~어떤 관점에서 기술을 바라볼까~&lt;/h2&gt;
&lt;p&gt;이벤트를 가공하여 필요한 카프카 토픽에 별도로 저장하거나 데이터를 저장하여 유의미한 데이터를 뽑아낼 수 있도록 하는 관점으로 바라봐야 한다는 것입니다.&lt;/p&gt;
&lt;p&gt;이는 Apache Spark나 앞서 살펴본 Faust로도 가능하지만, ksqlDB는 이를 쿼리로 빠르게 작성하여 결과를 얻어볼 수 있다는 점에서 의의를 가집니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;빠른 테스트를 통해 데이터가 입증을 수행하고 고도화가 필요한 그 시점에 다른 기술을 통하여 비율절감, 성능개선을 수행하면 될 것으로 보입니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;ksqldb-실전예시-helkhunting-elk&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#ksqldb-%EC%8B%A4%EC%A0%84%EC%98%88%EC%8B%9C-helkhunting-elk&quot; aria-label=&quot;ksqldb 실전예시 helkhunting elk permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;ksqlDB 실전예시: HELK(Hunting ELK)&lt;/h2&gt;
&lt;p&gt;ksqlDB를 통해 Anomaly Detection을 수행하고자 하는 예시는 사이버보안 파트에서도 충분히 활용될 수 있는 문제입니다. 소개할 HELK라는 시스템은 이를 잘 활용한 훌륭한 오픈소스입니다. 해커의 고도화된 공격과 같은 &lt;strong&gt;“이상행위”&lt;/strong&gt; 가 무엇인지 면밀히 이해한 후, 시스템 이벤트를 수집하고 이를 실시간으로 탐지하고 알림을 준다는 것이 주요 골자입니다.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/Cyb3rWard0g/HELK/master/docs/images/HELK-Design.png&quot; alt=&quot;HELK의 전체 구조. 이 글에선 Kafka와 KSQL(현 ksqlDB)를 주요하게 살펴볼 것입니다&quot;&gt;&lt;/p&gt;
&lt;p&gt;그렇다면, 이상행위를 어떻게 탐지하는지 살펴봅시다. 실제 HELK라는 큰 프로젝트에서 어떻게 쓰이는지는 &lt;a href=&quot;https://posts.specterops.io/real-time-sysmon-processing-via-ksql-and-helk-part-3-basic-use-case-8fbf383cb54f&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;해당 링크&lt;/a&gt;를 참고해주세요(아래 Reference에도 기재해두었습니다).&lt;/p&gt;
&lt;h2 id=&quot;ksqldb-쿼리-작성-1&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#ksqldb-%EC%BF%BC%EB%A6%AC-%EC%9E%91%EC%84%B1-1&quot; aria-label=&quot;ksqldb 쿼리 작성 1 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;ksqlDB 쿼리 작성 (1)&lt;/h2&gt;
&lt;p&gt;WinlogBeat라는 프로그램을 통해 수집된 윈도우즈의 시스템 이벤트를 수집하는 스트림을 생성하였습니다. 아래 쿼리는 해당 내용을 ksqlDB가 해석하도록 하는 코드입니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sql&quot;&gt;&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; STREAM WINLOGBEAT_STREAM &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  source_name &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  task &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  log_name &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  computer_name &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data STRUCT&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;
    UtcTime &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    ProcessGuid &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    ProcessId &lt;span class=&quot;token keyword&quot;&gt;INTEGER&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    Image &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    FileVersion &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    Description &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    Product &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    Company &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    CommandLine &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    CurrentDirectory &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;User&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    LogonGuid &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    LogonId &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    TerminalSessionId &lt;span class=&quot;token keyword&quot;&gt;INTEGER&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    IntegrityLevel &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    Hashes &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    ParentProcessGuid &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    ParentProcessId &lt;span class=&quot;token keyword&quot;&gt;INTEGER&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    ParentImage &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    ParentCommandLine &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    Protocol &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    Initiated &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    SourceIsIpv6 &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    SourceIp &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    SourceHostname &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    SourcePort &lt;span class=&quot;token keyword&quot;&gt;INTEGER&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    SourcePortName &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    DestinationIsIpv6 &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    DestinationIp &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    DestinationHostname &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    DestinationPort &lt;span class=&quot;token keyword&quot;&gt;INTEGER&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    DestinationPortName &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_id &lt;span class=&quot;token keyword&quot;&gt;INTEGER&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;WITH&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;KAFKA_TOPIC&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;winlogbeat&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; VALUE_FORMAT&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;JSON&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;ksqldb-쿼리-작성-2&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#ksqldb-%EC%BF%BC%EB%A6%AC-%EC%9E%91%EC%84%B1-2&quot; aria-label=&quot;ksqldb 쿼리 작성 2 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;ksqlDB 쿼리 작성 (2)&lt;/h2&gt;
&lt;p&gt;(1)에서 작성한 쿼리를 토대로, 별도의 스트림을 통해 키값을 새로 추가하여 새 스트림을 만들어낼 수도 있습니다. 아래는 해당 내용에 대한 쿼리입니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sql&quot;&gt;&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; STREAM WINLOGBEAT_STREAM_REKEY
&lt;span class=&quot;token keyword&quot;&gt;WITH&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;VALUE_FORMAT&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;JSON&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; PARTITIONS&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;TIMESTAMP&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;event_date_creation&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; STRINGTOTIMESTAMP&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;UtcTime&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;yyyy-MM-dd HH:mm:ss.SSS&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt;
  event_date_creation&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;ProcessGuid &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; process_guid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;ProcessId &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; process_id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;Image &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; process_path&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;FileVersion &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; file_version&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;Description &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; file_description&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;Company &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; file_company&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;CommandLine &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; process_command_line&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;CurrentDirectory &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; process_current_directory&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;User&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; user_account&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;LogonGuid &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; user_logon_guid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;LogonId &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; user_logon_id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;TerminalSessionId &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; user_session_id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;IntegrityLevel &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; process_integrity_level&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;Hashes &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; hashes&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;ParentProcessGuid &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; parent_process_guid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;ParentProcessId &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; parent_process_id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;ParentImage &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; parent_process_path&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;ParentCommandLine &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; parent_process_command_line&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;Protocol &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; network_protocol&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;Initiated &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; network_connection_initiated&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;SourceIsIpv6 &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; src_is_ipv6&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;SourceIp &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; src_ip_addr&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;SourceHostname &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; src_host_name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;SourcePort &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; src_port&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;SourcePortName &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; src_port_name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;DestinationIsIpv6 &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; dst_is_ipv6&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;DestinationIp &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; dst_ip_addr&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;DestinationHostname &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; dst_host_name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;DestinationPort &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; dst_port&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_data&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;DestinationPortName &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; dst_port_name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  source_name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  log_name
&lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; WINLOGBEAT_STREAM
&lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; source_name&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Microsoft-Windows-Sysmon&apos;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;PARTITION&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;BY&lt;/span&gt; process_guid&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;ksqldb-쿼리-작성-3-응용&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#ksqldb-%EC%BF%BC%EB%A6%AC-%EC%9E%91%EC%84%B1-3-%EC%9D%91%EC%9A%A9&quot; aria-label=&quot;ksqldb 쿼리 작성 3 응용 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;ksqlDB 쿼리 작성 (3): 응용&lt;/h2&gt;
&lt;p&gt;앞서 작성한 내용을 통해, sysmon에서 유의미한 데이터를 가져오는 쿼리를 작성해보도록 합시다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sql&quot;&gt;&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; STREAM SYSMON_PROCESS_CREATE
&lt;span class=&quot;token keyword&quot;&gt;WITH&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;VALUE_FORMAT&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;JSON&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; PARTITIONS&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;TIMESTAMP&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;event_date_creation&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt;
  event_date_creation&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  process_guid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  process_id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  process_path&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  file_version&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  file_description&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  file_company&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  process_command_line&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  process_current_directory&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  user_account&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  user_logon_guid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  user_logon_id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  user_session_id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  process_integrity_level&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  hashes&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  parent_process_guid&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  parent_process_id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  parent_process_path&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  parent_process_command_line&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  source_name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  log_name
&lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; WINLOGBEAT_STREAM_REKEY
&lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; event_id&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;관련 내용을 테이블에 저장할 수도 있습니다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sql&quot;&gt;&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;TABLE&lt;/span&gt; SYSMON_PROCESS_CREATE_TABLE &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  event_date_creation &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  process_guid &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  process_id &lt;span class=&quot;token keyword&quot;&gt;INTEGER&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  process_path &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  file_version &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  file_description &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  file_company &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  process_command_line &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  process_current_directory &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  user_account &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  user_logon_guid &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  user_logon_id &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  user_session_id &lt;span class=&quot;token keyword&quot;&gt;INTEGER&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  process_integrity_level &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  hashes &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  parent_process_guid &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  parent_process_id &lt;span class=&quot;token keyword&quot;&gt;INTEGER&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  parent_process_path &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  parent_process_command_line &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  event_id &lt;span class=&quot;token keyword&quot;&gt;INTEGER&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  source_name &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  log_name &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;WITH&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;KAFKA_TOPIC&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;SYSMON_PROCESS_CREATE&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; VALUE_FORMAT&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;JSON&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;KEY&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;process_guid&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;ksqldb-쿼리-작성-4-이상행위-탐지&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#ksqldb-%EC%BF%BC%EB%A6%AC-%EC%9E%91%EC%84%B1-4-%EC%9D%B4%EC%83%81%ED%96%89%EC%9C%84-%ED%83%90%EC%A7%80&quot; aria-label=&quot;ksqldb 쿼리 작성 4 이상행위 탐지 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;ksqlDB 쿼리 작성 (4): 이상행위 탐지&lt;/h2&gt;
&lt;p&gt;상기 과정을 이용하여, Lateral Movement 를 수행하여 타 PC에 “측면이동”을 하여 네트워크를 살펴보는 악성행위를 감지할 수 있습니다. 아래 내용이 해당 쿼리입니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sql&quot;&gt;&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; STREAM SYSMON_JOIN &lt;span class=&quot;token keyword&quot;&gt;WITH&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;PARTITIONS&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt;
  N&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;EVENT_DATE_CREATION&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  N&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PROCESS_GUID&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  N&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PROCESS_ID&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  N&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PROCESS_PATH&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  N&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;USER_ACCOUNT&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  N&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;NETWORK_PROTOCOL&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  N&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;NETWORK_CONNECTION_INITIATED&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  N&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SRC_IS_IPV6&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  N&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SRC_IP_ADDR&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  N&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SRC_HOST_NAME&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  N&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SRC_PORT&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  N&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SRC_PORT_NAME&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  N&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;DST_IS_IPV6&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  N&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;DST_IP_ADDR&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  N&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;DST_HOST_NAME&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  N&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;DST_PORT&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  N&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;DST_PORT_NAME&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  N&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SOURCE_NAME&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  N&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;LOG_NAME&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  P&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PROCESS_COMMAND_LINE&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  P&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;HASHES&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  P&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PARENT_PROCESS_PATH&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  P&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PARENT_PROCESS_COMMAND_LINE&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  P&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;USER_LOGON_GUID&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  P&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;USER_LOGON_ID&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  P&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;USER_SESSION_ID&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  P&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PROCESS_CURRENT_DIRECTORY&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  P&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PROCESS_INTEGRITY_LEVEL&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  P&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PARENT_PROCESS_GUID&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  P&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PARENT_PROCESS_ID
&lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; SYSMON_NETWORK_CONNECT N &lt;span class=&quot;token keyword&quot;&gt;INNER&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;JOIN&lt;/span&gt; SYSMON_PROCESS_CREATE_TABLE P &lt;span class=&quot;token keyword&quot;&gt;ON&lt;/span&gt; N&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PROCESS_GUID &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; P&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PROCESS_GUID&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;마무리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%88%EB%AC%B4%EB%A6%AC&quot; aria-label=&quot;마무리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;마무리&lt;/h2&gt;
&lt;p&gt;이번 글을 통해, 아래 내용들을 살펴볼 수 있었습니다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ksqlDB&lt;/code&gt;에 대해 이해하였습니다.&lt;/li&gt;
&lt;li&gt;의미있는 데이터를 추려낼 수 있도록 작업하는 것이 &lt;code class=&quot;language-text&quot;&gt;ksqlDB&lt;/code&gt;의 로직을 작성하는 핵심입니다.&lt;/li&gt;
&lt;li&gt;실전 예시를 통해, 어떤식으로 사용하는지에 대한 쿼리 작성법을 배웠습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;읽어주셔서 대단히 감사합니다.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;References&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.confluent.io/platform/current/ksqldb/tutorials/index.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;KSQL Tutorials end Examples&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/kafkakru/meetup/blob/master/conference/1st-conference/KSQL%20vs%20Kafka%20Streams.pdf&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;KSQL and Kafka Streams&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.confluent.io/ja-jp/blog/sysmon-security-event-processing-real-time-ksql-helk/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;HELK, Hunting ELK&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://posts.specterops.io/real-time-sysmon-processing-via-ksql-and-helk-part-3-basic-use-case-8fbf383cb54f&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Real-time sysmon processing via ksql and HELP pt.3&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[ksqlDB 101, part 2. Kafka Streams에 대해]]></title><description><![CDATA[ksqlDB의 내부 구조인 Apache Kafka의 Kafka Streams를 간략하게 살펴봅시다.]]></description><link>https://blog.s3ich4n.me/devlog/data/2020-02-17-ksqldb-101-pt01</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/data/2020-02-17-ksqldb-101-pt01</guid><pubDate>Mon, 17 Feb 2020 19:00:00 GMT</pubDate><content:encoded>&lt;p&gt;이 글은 &lt;code class=&quot;language-text&quot;&gt;ksqlDB&lt;/code&gt;(당시에는 &lt;code class=&quot;language-text&quot;&gt;KSQL&lt;/code&gt;이라는 명칭이었습니다)를 학습하기 위해 정리한 연재글입니다.&lt;/p&gt;
&lt;p&gt;이 글의 순서는 아래와 같습니다.&lt;/p&gt;
&lt;h1 id=&quot;목차&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AA%A9%EC%B0%A8&quot; aria-label=&quot;목차 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;목차&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.s3ich4n.me/devlog/data/2020-02-05-ksqldb-101-pt01&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;part 1. 배경지식&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;part 2. Kafka Streams에 대해&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.s3ich4n.me/devlog/data/2020-03-10-ksqldb-101-pt03&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;part 3. 실전 예시: 오픈소스를 통해 살펴보는 실시간 보안 이벤트 탐지 룰&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;2-kafka-streams-details&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2-kafka-streams-details&quot; aria-label=&quot;2 kafka streams details permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2. Kafka Streams details&lt;/h1&gt;
&lt;p&gt;상술하였던 아파치 카프카의 API에 대해 상세히 살펴봅시다.&lt;/p&gt;
&lt;h2 id=&quot;stream-이란&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#stream-%EC%9D%B4%EB%9E%80&quot; aria-label=&quot;stream 이란 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Stream 이란?&lt;/h2&gt;
&lt;p&gt;아파치 카프카에서의 Stream이 무슨의미를 지니는지 살펴봅시다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;말 그대로 물줄기처럼 연속성있는 real-time flow of records를 의미합니다.&lt;/li&gt;
&lt;li&gt;새 레코드를 달라고 명시적으로 하는게 아니라 계속해서 받는것을 의미합니다.&lt;/li&gt;
&lt;li&gt;스트림은 &lt;code class=&quot;language-text&quot;&gt;[k|v] -&gt; [k|v] -&gt; [k|v] -&gt; [k|v]&lt;/code&gt; 모양으로 계속 흐르며, &lt;code class=&quot;language-text&quot;&gt;[k|v]&lt;/code&gt; 한 쌍은 데이터 레코드라고 부릅니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;그렇다면-kafka-stream은-무엇을-의미하나요&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EA%B7%B8%EB%A0%87%EB%8B%A4%EB%A9%B4-kafka-stream%EC%9D%80-%EB%AC%B4%EC%97%87%EC%9D%84-%EC%9D%98%EB%AF%B8%ED%95%98%EB%82%98%EC%9A%94&quot; aria-label=&quot;그렇다면 kafka stream은 무엇을 의미하나요 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;그렇다면 Kafka Stream은 무엇을 의미하나요?&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;real-time 앱을 작성하는데 쓰입니다.
&lt;ul&gt;
&lt;li&gt;카프카 브로커 위에서 작동하는게 아님에 유의합니다. 별도의 앱임을 의미합니다!&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Java/Scala로 만들어진 마이크로서비스(JVM application)입니다.
&lt;ul&gt;
&lt;li&gt;Python 구현체로는 &lt;a href=&quot;https://github.com/faust-streaming/faust&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Faust&lt;/a&gt; 가 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Deploy 후 앱을 구동해야 작동합니다.&lt;/li&gt;
&lt;li&gt;scalable하게 늘릴 수 있다.&lt;/li&gt;
&lt;li&gt;kafka streams API는 데이터를 변환/강화(enrichment) 하는데 쓰입니다. (이하 내용은 후술될 것입니다.)
&lt;ul&gt;
&lt;li&gt;per-record 스트림 프로세싱을 밀리초 단위로 지원합니다.&lt;/li&gt;
&lt;li&gt;stateless processing(Filtering, Mapping의 개념)을 지원합니다.&lt;/li&gt;
&lt;li&gt;이전 스트림의 처리 결과와 관계없이 현재 데이터로만 처리를 함을 의미합니다.&lt;/li&gt;
&lt;li&gt;stateful processing(JOIN, AGGREGATION의 개념)을 지원합니다.&lt;/li&gt;
&lt;li&gt;windowing operations 를 지원합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;kafka-streams의-주요-용어&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#kafka-streams%EC%9D%98-%EC%A3%BC%EC%9A%94-%EC%9A%A9%EC%96%B4&quot; aria-label=&quot;kafka streams의 주요 용어 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Kafka Streams의 주요 용어&lt;/h2&gt;
&lt;p&gt;카프카 스트림의 주요 용어에 대해 살펴보겠습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;스트림 처리 애플리케이션(Stream Processing Application)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;카프카 스트림 클라이언트를 사용하는 애플리케이션. 하나 이상의 프로세서 토폴로지에서 처리되는 로직을 의미한다.&lt;/li&gt;
&lt;li&gt;프로세서 토폴로지는 스트림 프로세서가 서로 연결된 그래프를 의미한다.&lt;/li&gt;
&lt;li&gt;스트림으로 정제한 데이터를 흘려보내는 앱을 의미&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;스트림 프로세서(Stream Processor)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;프로세서 토폴로지를 이루는 하나의 노드.&lt;/li&gt;
&lt;li&gt;데이터를 받고 처리하거나(소스 프로세서), 받기만 한다(싱크프로세서)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;소스 프로세서(Source Processor)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;위쪽으로 연결된 프로세서가 없는 프로세서를 말한다.&lt;/li&gt;
&lt;li&gt;하나 이상의 카프카 토픽에서 데이터 레코드를 읽어서 아래쪽 프로세서에 전달한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;싱크 프로세서(Sink Processor)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;토폴로지 아래쪽에 프로세서 연결이 없는 프로세서&lt;/li&gt;
&lt;li&gt;상위 프로세서로부터 받은 데이터 레코드를 카프카 &lt;strong&gt;특정 토픽에 저장&lt;/strong&gt;한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;#x26;fname=http%3A%2F%2Fcfile29.uf.tistory.com%2Fimage%2F99AFC23E5C98CDEA2D64B0&quot; alt=&quot;Kafka Streams의 도식. 상기 내용들이 표시되어 있습니다.&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;kstream과-ktable이란&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#kstream%EA%B3%BC-ktable%EC%9D%B4%EB%9E%80&quot; aria-label=&quot;kstream과 ktable이란 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;KStream&lt;/code&gt;과 &lt;code class=&quot;language-text&quot;&gt;KTable&lt;/code&gt;이란?&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;KStream&lt;/code&gt;은 stream의 abstraction입니다.&lt;/li&gt;
&lt;li&gt;stream of records를 원하면 &lt;code class=&quot;language-text&quot;&gt;KStream&lt;/code&gt;을, changelog 주어진 키에 대해 가장 최신값만 원한다면 &lt;code class=&quot;language-text&quot;&gt;KTable&lt;/code&gt;을 사용하는 것이 좋습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;kstream과-ktable의-차이&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#kstream%EA%B3%BC-ktable%EC%9D%98-%EC%B0%A8%EC%9D%B4&quot; aria-label=&quot;kstream과 ktable의 차이 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;code class=&quot;language-text&quot;&gt;KStream&lt;/code&gt;과 &lt;code class=&quot;language-text&quot;&gt;KTable&lt;/code&gt;의 차이?&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;KStream&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;an unbounded collection of facts: immutable things; 쉬지않고 들어오는값, 바뀔 수 없는(immutable) 하나의 메시지를 의미합니다.&lt;/li&gt;
&lt;li&gt;e.g. &lt;code class=&quot;language-text&quot;&gt;postgres.exe&lt;/code&gt; 프로세스에 대한 1500번 이벤트가 10월 31일, A클라이언트에서 발생했다 (서로 독립적)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;KTable&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;a collection of evolving facts; 변하는 프로파일&lt;/li&gt;
&lt;li&gt;e.g. 다섯달 전엔 대구에 살았는데 지금은 서울에 산다.. 하고 업데이트; Overwrite하는 경우를 의미하지요.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;KTable&lt;/code&gt; 은 time-evolving stream 과 관련있습니다. 시간이 흐름에 따라 값이 변화하는 스트림에 주로 사용될 수 있겠습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;kafka-streams의-time의-개념&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#kafka-streams%EC%9D%98-time%EC%9D%98-%EA%B0%9C%EB%85%90&quot; aria-label=&quot;kafka streams의 time의 개념 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Kafka Streams의 &lt;code class=&quot;language-text&quot;&gt;Time&lt;/code&gt;의 개념&lt;/h3&gt;
&lt;p&gt;스트림 프로세싱의 핵심은 시간을 가지고 작업하는 개념입니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;event time&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;레코드가 emit 되는 시점의 시간&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ingestion time&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;emitted records 가 브로커에 의해 Kafka 토픽에 저장되는 시간(데이터 통신 메커니즘에 따라 이벤트 시간 및 처리 시간이 달라짐) 대부분의 경우 타임 스탬프가 데이터 레코드 자체에 포함되므로 처리 시간은 이벤트 시간과 거의 같다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;processing time&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;스트림 처리 응용 프로그램에서 이벤트 또는 데이터 레코드를 처리하는 시점(예 : 레코드가 소비되는 시점). 처리 시간은 원래 이벤트 시간보다 밀리 초, 시간 또는 며칠이 걸릴 수 있다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;stateful-stateless-in-ksqldb&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#stateful-stateless-in-ksqldb&quot; aria-label=&quot;stateful stateless in ksqldb permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Stateful, Stateless in ksqlDB&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;상태가 필요없이 다른 메시지와 독립적으로 처리하는 것을 &lt;em&gt;stateless&lt;/em&gt; 라고 일컫습니다.&lt;/li&gt;
&lt;li&gt;한 스트림을 변환만 할 필요가 있을 때, 혹은 상태에 맞게 스트림을 걸러내는 것을 말합니다.&lt;/li&gt;
&lt;li&gt;상태를 필요로 하는 것을 &lt;em&gt;stateful&lt;/em&gt; 이라고 하며, 대부분의 앱은 상태를 필요로 합니다. stateful한 스트림은 input 스트림을 join, aggregate, window 처리할 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;kafka-streams-앱-구현-java&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#kafka-streams-%EC%95%B1-%EA%B5%AC%ED%98%84-java&quot; aria-label=&quot;kafka streams 앱 구현 java permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Kafka Streams 앱 구현: Java&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=7JYEEx7SBuE&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 영상&lt;/a&gt;을 참고해주세요.&lt;/li&gt;
&lt;li&gt;소스코드는 &lt;a href=&quot;https://github.com/confluentinc/kafka-streams-examples&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;여기&lt;/a&gt; 를 참고 바랍니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;config 변수를 만들어서 &lt;code class=&quot;language-text&quot;&gt;APPLICATION_ID_CONFIG&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;BOOTSTRAP_SERVERS_CONFIG&lt;/code&gt;을 설정합니다.
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;APPLICATION_ID_CONFIG&lt;/code&gt;: 새로 만들 필터링 앱의 이름 (unique)&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;BOOSTRAP_SERVERS_CONFIG&lt;/code&gt;: 데이터 스트림을 가져올 카프카의 주소&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;new StreamsBuilder()&lt;/code&gt; 구문으로 빌더를 만들고(토폴로지 정의 빌더), &lt;code class=&quot;language-text&quot;&gt;KStream&lt;/code&gt; 변수타입을 사용해서 어느 토픽에 어떤 필터로 값을 가져올지 정합니다.&lt;/li&gt;
&lt;li&gt;그 후 &lt;code class=&quot;language-text&quot;&gt;KafkaStreams&lt;/code&gt; 타입의 변수를 만들고 빌더, 설정값을 세팅합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;kafka stream&lt;/code&gt; 설정을 입력합니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;KStream&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;KTable&lt;/code&gt; 및 &lt;code class=&quot;language-text&quot;&gt;GlobalKTable&lt;/code&gt;을 정의합니다 (앞서 입력한 설정을 추가)&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;KafkaStreams&lt;/code&gt; 객체를 선언하고 consume 을 통해 새로운 스트림 생성합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;faust-python의-스트림-프로세싱-라이브러리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#faust-python%EC%9D%98-%EC%8A%A4%ED%8A%B8%EB%A6%BC-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8B%B1-%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC&quot; aria-label=&quot;faust python의 스트림 프로세싱 라이브러리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Faust: Python의 스트림 프로세싱 라이브러리&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;python&quot;&gt;&lt;pre class=&quot;language-python&quot;&gt;&lt;code class=&quot;language-python&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; os

&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; faust


CONSUMER_NAME &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;TEST_CLICK_CONSUMER_01&quot;&lt;/span&gt;
KAFKA_BROKER &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;임의의 브로커 주소&quot;&lt;/span&gt;
SRC_TOPIC &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;임의의 토픽주소&quot;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 앱 구동 전, 기본 설정값 세팅&lt;/span&gt;
app &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; faust&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;App&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    CONSUMER_NAME&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    broker&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string-interpolation&quot;&gt;&lt;span class=&quot;token string&quot;&gt;f&quot;kafka://&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;KAFKA_BROKER&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 값을 가져오기위한 메인토픽&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# data sent to &apos;clicks&apos; topic sharded by URL key.&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# e.g. key=&quot;http://example.com&quot; value=&quot;1&quot;&lt;/span&gt;
click_topic &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; app&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;topic&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    SRC_TOPIC&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    key_type&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    value_type&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# 새로이 저장할 토픽&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# default value for missing URL will be 0 with `default=int`&lt;/span&gt;
counts &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; app&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Table&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&apos;click_counts&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    default&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token decorator annotation punctuation&quot;&gt;@app&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;agent&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;src_topic&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;count_click&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;clicks&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; url&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; count &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; clicks&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;items&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        counts&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; count&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;도커 이미지를 아래와 같이 작성 후 구동하면 파이썬 코드로도 상기 Kafka Streams 처리가 가능합니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;dockerfile&quot;&gt;&lt;pre class=&quot;language-dockerfile&quot;&gt;&lt;code class=&quot;language-dockerfile&quot;&gt;&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; python:3.9&lt;/span&gt;

&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;COPY&lt;/span&gt; . /app&lt;/span&gt;
&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;WORKDIR&lt;/span&gt; /app&lt;/span&gt;

&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;\&lt;/span&gt;
    pip install -r requirements.txt&lt;/span&gt;

&lt;span class=&quot;token instruction&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;RUN&lt;/span&gt; [&lt;span class=&quot;token string&quot;&gt;&quot;python&quot;&lt;/span&gt;, &lt;span class=&quot;token string&quot;&gt;&quot;stream.py&quot;&lt;/span&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Faust 에 대한 상세한 설명은 &lt;a href=&quot;https://faust-streaming.github.io/faust/userguide/index.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;여기&lt;/a&gt;를 살펴봐주세요.&lt;/p&gt;
&lt;h3 id=&quot;caveats&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#caveats&quot; aria-label=&quot;caveats permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Caveats&lt;/h3&gt;
&lt;p&gt;만일 파이썬 베이스 이미지를 통해 &lt;a href=&quot;https://github.com/confluentinc/confluent-kafka-python&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;librdkafka 기반의 카프카 처리 라이브러리&lt;/a&gt;를 사용해야 한다면, 추가적인 의존성을 필요로 할 수 있습니다. 관련 내용은 &lt;a href=&quot;https://github.com/confluentinc/confluent-kafka-python/blob/master/INSTALL.md&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 링크&lt;/a&gt;를 참고해주세요.&lt;/p&gt;
&lt;h1 id=&quot;마무리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%88%EB%AC%B4%EB%A6%AC&quot; aria-label=&quot;마무리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;마무리&lt;/h1&gt;
&lt;p&gt;이번 글을 통해, 아래 내용들을 살펴볼 수 있었습니다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Kafka Streams과 주요 용어 및 개념을 살펴보았습니다.&lt;/li&gt;
&lt;li&gt;Kafka Streams 앱 구현을 Java 및 Python 라이브러리를 통하여 어떻게 진행하는지 살펴보았습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;다음 파트에선 본격적으로 ksqlDB가 무엇인지, 그리고 이를 통해 어떤식으로 실시간 이벤트 처리를 수행할 수 있는지를 대표적인 예시로 살펴보겠습니다.&lt;/p&gt;
&lt;p&gt;읽어주셔서 대단히 감사합니다.&lt;/p&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;References
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.confluent.io/current/streams/introduction.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Kafka Streams Introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://medium.com/@stephane.maarek/introduction-to-schemas-in-apache-kafka-with-the-confluent-schema-registry-3bf55e401321&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Introduction to Schemas in Apache Kafka with the Confluent Schema Registry&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/kafkakru/meetup/blob/master/conference/1st-conference/KSQL%20vs%20Kafka%20Streams.pdf&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;KSQL and Kafka Streams&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://faust.readthedocs.io/en/latest/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Faust: Python Stream Processing&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[ksqlDB 101, part 1. 배경지식]]></title><description><![CDATA[ksqlDB를 어느정도 이해하기 위해 필요한 기본지식을 설명하였습니다.]]></description><link>https://blog.s3ich4n.me/devlog/data/2020-02-05-ksqldb-101-pt01</link><guid isPermaLink="false">https://blog.s3ich4n.me/devlog/data/2020-02-05-ksqldb-101-pt01</guid><pubDate>Wed, 05 Feb 2020 05:14:00 GMT</pubDate><content:encoded>&lt;p&gt;이 글은 &lt;code class=&quot;language-text&quot;&gt;ksqlDB&lt;/code&gt;(당시에는 &lt;code class=&quot;language-text&quot;&gt;KSQL&lt;/code&gt;이라는 명칭이었습니다)를 학습하기 위해 정리한 연재글입니다.&lt;/p&gt;
&lt;p&gt;이 글의 순서는 아래와 같습니다.&lt;/p&gt;
&lt;h1 id=&quot;목차&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%AA%A9%EC%B0%A8&quot; aria-label=&quot;목차 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;목차&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;part 1. 배경지식&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.s3ich4n.me/devlog/data/2020-02-17-ksqldb-101-pt01&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;part 2. Kafka Streams에 대해&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.s3ich4n.me/devlog/data/2020-03-10-ksqldb-101-pt03&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;part 3. 실전 예시: 오픈소스를 통해 살펴보는 실시간 보안 이벤트 탐지 룰&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&quot;1-ksqldb를-알기-위해-필요한-것들&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1-ksqldb%EB%A5%BC-%EC%95%8C%EA%B8%B0-%EC%9C%84%ED%95%B4-%ED%95%84%EC%9A%94%ED%95%9C-%EA%B2%83%EB%93%A4&quot; aria-label=&quot;1 ksqldb를 알기 위해 필요한 것들 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1. ksqlDB를 알기 위해 필요한 것들&lt;/h1&gt;
&lt;p&gt;ksqlDB를 이해하고 효율적으로 사용하기 위해 아래 기능들에 대해 이해하고 넘어갈 필요가 있습니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;(필수) Apache Kafka에 대한 기본적인 이해&lt;/li&gt;
&lt;li&gt;(필수) Kafka Streams&lt;/li&gt;
&lt;li&gt;(선택…이지만 사실상 필수라고 생각합니다) Schema Registry&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;사전-학습-아파치-카프카의-api들에-대하여&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%82%AC%EC%A0%84-%ED%95%99%EC%8A%B5-%EC%95%84%ED%8C%8C%EC%B9%98-%EC%B9%B4%ED%94%84%EC%B9%B4%EC%9D%98-api%EB%93%A4%EC%97%90-%EB%8C%80%ED%95%98%EC%97%AC&quot; aria-label=&quot;사전 학습 아파치 카프카의 api들에 대하여 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;사전 학습: 아파치 카프카의 API들에 대하여&lt;/h2&gt;
&lt;p&gt;아파치 카프카의 몇몇 API에 대한 설명을 살펴봅시다. &lt;a href=&quot;https://kafka.apache.org/documentation/#api&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 링크&lt;/a&gt;를 살펴본다면 ksqlDB를 살펴볼 때에도 도움이 될 것입니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Producer API: 특정 앱이 레코드 스트림을 발행하고 하나 이상의 카프카 토픽에 보내는 기능&lt;/li&gt;
&lt;li&gt;Consumer API: 특정 앱이 하나 이상의 토픽을 subscribe 하고 produce 받은 레코드의 스트림을 가공한다&lt;/li&gt;
&lt;li&gt;Streams API(Kafka Streams): 특정 앱이 stream processor로 작동하게 한다. 이는 하나 이상의 토픽으로부터 오는 input stream을 consume 하고, 하나 이상의 토픽에 produce하는 output stream을 produce한다. input stream을 output stream으로 바꾸는데 효과적이다.&lt;/li&gt;
&lt;li&gt;Connect API(Kafka Connects): 카프카 토픽을 다른 앱이나 데이터 시스템에 연결하는, 재사용 가능한 producer/consumer를 빌드/실행한다. 예시) RDBMS의 커넥터는 테이블의 모든 변화를 감지할 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;너무 직역이라, 이를 풀어보자면 아래와 같습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;아파치 카프카의 프로듀서 API, 컨슈머 API는 말 그대로, 카프카 토픽을 프로듀스/컨슘 하는데 사용되는 네이티브 API 입니다.&lt;/li&gt;
&lt;li&gt;스트림 API는, 한 토픽에서 다른 토픽으로 데이터의 흐름(streams of data)을 흘려보내는 기능을 의미합니다.&lt;/li&gt;
&lt;li&gt;커넥트 API는 외부 시스템에서 카프카로 데이터를 뽑아오거나, 카프카에서 외부 시스템으로 데이터를 저장하는(sink data system이라고 일컫습니다) 기능을 의미합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;미리 말씀드리자면, ksqlDB는 이 스트림 API를 SQL문 작성 만으로 사용할 수 있도록 하는 애플리케이션이라 볼 수 있습니다.&lt;/p&gt;
&lt;h2 id=&quot;schema-registry&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#schema-registry&quot; aria-label=&quot;schema registry permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Schema Registry&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;(이하 스키마 레지스트리라고 부르겠습니다)&lt;/li&gt;
&lt;li&gt;상기 내용에서 보았듯, 데이터를 단순히 프로듀스/컨슘 하는 것 뿐 아니라 데이터의 흐름을 바꾸어서 다른곳에 저장하고, 또 불러오기도 합니다. 실수가 많을 수 있는 부분들에 대해 일종의 “객체화”를 수행하여, 이 데이터를 주고받도록 하면 실수가 줄겠죠.&lt;/li&gt;
&lt;li&gt;카프카의 스키마 관리 도구입니다.&lt;/li&gt;
&lt;li&gt;변조되거나 망가진 이벤트가 쓰이지 않도록 방지해줍니다.&lt;/li&gt;
&lt;li&gt;카프카로부터 Produce/Consume 할 데이터를 정의해둔 값&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://kafka.apache.org/documentation/#multitenancy-more&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;카프카 운영 시 웬만해선 사용하기를 권장합니다!&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;스키마를 따로 관리하는 서버입니다.&lt;/li&gt;
&lt;li&gt;내부적으로 Avro, JSON 스키마, Protobuf 스키마를 사용할 수 있고 REST API로 스키마를 저장/조회할 수 있습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;avro란&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#avro%EB%9E%80&quot; aria-label=&quot;avro란 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Avro란?&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;아파치에서 작성한 데이터 직렬화 시스템입니다.&lt;/li&gt;
&lt;li&gt;Avro는 Schema에 의존적입니다. 쉽게 말해, 어떤식으로 직렬화/역직렬화 될지에 대한 스펙이라고 할 수 있지요.&lt;/li&gt;
&lt;li&gt;Avro 스키마는 JSON으로 정의되며, JSON 라이브러리를 사용하여 작성합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Avro는 스키마 정의를 아래의 방식으로 수행합니다.
• 파일타입
• 레코드의 길이
• 레코드의 이름
• 레코드 필드
• 필요한 데이터타입에 맞게 정의&lt;/p&gt;
&lt;p&gt;아래와 같은 형식으로 담깁니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;typeName&quot;&lt;/span&gt; ...attributes...&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;type
&lt;ul&gt;
&lt;li&gt;Primitive data type일 수도 있습니다.&lt;/li&gt;
&lt;li&gt;Complex type일 수도 있으며, 이 때는 &lt;code class=&quot;language-text&quot;&gt;record&lt;/code&gt; 라는 값을 별도로 기재합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;namespace
&lt;ul&gt;
&lt;li&gt;이 필드는 오브젝트가 위치한 네임스페이스를 정의합니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;name
&lt;ul&gt;
&lt;li&gt;레코드의 이름을 가리키며, Avro API가 해당 데이터 타입을 참조할 때 쓰는 값입니다.&lt;/li&gt;
&lt;li&gt;schema name은 namespace와 함께 쓰입니다. 아래 예시를 보며 이해해봅시다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;e.g. document을 정의하고 namespace는 “Test”이며 이름은 “Employee”이고 2개의 필드를 가지고있다. 각각 string 타입의 “Name”, int 타입의 “Age”이다. &lt;br /&gt; 라고 하는 데이터 타입에 대한 Avro 정의는 아래와 같습니다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;record&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;namespace&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Test&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Employee&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;fields&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token property&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Name&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;string&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token property&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Age&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token property&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;int&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;스키마 이름은, 위의 예시대로 쓰자면 &lt;code class=&quot;language-text&quot;&gt;Test.Employee&lt;/code&gt;가 되겠습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Avro의 primitive data type은 아래와 같습니다.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;데이터타입&lt;/th&gt;
&lt;th&gt;상세&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;null&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;아무값도 없는 값&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;int&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;32bit signed integer&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;long&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;64bit signed integer&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;float&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;IEEE 754를 따르는 32-bit 부동소수점 값&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;double&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;IEEE 754를 따르는 64-bit 부동소수점 값&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;bytes&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;8-bit unsigned bytes의 시퀀스&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code class=&quot;language-text&quot;&gt;string&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;유니코드 캐릭터 시퀀스&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Avro의 Complex data type은 다음과 같으며, 이는 &lt;code class=&quot;language-text&quot;&gt;&quot;type&quot;: &quot;&amp;lt;complex_data_type&gt;&quot;&lt;/code&gt; 와 같은 형태로 정의하며, 여기에서는 &lt;em&gt;일부만 소개&lt;/em&gt; 하겠습니다.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;데이터타입&lt;/th&gt;
&lt;th&gt;상세&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Record&lt;/td&gt;
&lt;td&gt;다양한 애트리뷰트들의 컬렉션&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Enum&lt;/td&gt;
&lt;td&gt;아이템 리스트에 대한 enumuration&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Arrays&lt;/td&gt;
&lt;td&gt;배열 형식의 값을 담을 수 있는 데이터 타입&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Maps&lt;/td&gt;
&lt;td&gt;key, value 쌍의 값을 담을 수 있는 데이터 타입&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;그 외의 내용은 아래 링크를 통해 확인해보시기 바랍니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://avro.apache.org/docs/current/spec.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://avro.apache.org/docs/current/spec.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.tutorialspoint.com/avro/avro_schemas.htm&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;https://www.tutorialspoint.com/avro/avro_schemas.htm&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;avro-serializer-를-어떻게-사용하나요&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#avro-serializer-%EB%A5%BC-%EC%96%B4%EB%96%BB%EA%B2%8C-%EC%82%AC%EC%9A%A9%ED%95%98%EB%82%98%EC%9A%94&quot; aria-label=&quot;avro serializer 를 어떻게 사용하나요 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Avro Serializer 를 어떻게 사용하나요?&lt;/h3&gt;
&lt;p&gt;자, 원하는 타입대로 직렬화/역직렬화를 수행할 수 있도록 포맷을 정했습니다. 그 다음은 어떤 절차를 거쳐야할까요? 아래 내용을 살펴봅시다. 이 내용은 파이썬의 &lt;a href=&quot;https://github.com/confluentinc/confluent-kafka-python&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;confluent-kafka-python&lt;/a&gt; 라이브러리를 통해 사용하였음을 말씀드립니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;프로듀서가 유효한 스키마를 가지고있는지 schema registry에 쿼리한다.&lt;/li&gt;
&lt;li&gt;schema registry는 스키마의 유효성에 따라 다르게 처리한다:
&lt;ol&gt;
&lt;li&gt;유효하지 않다면 &lt;code class=&quot;language-text&quot;&gt;KafkaAvroSerializer&lt;/code&gt;를 raise한다.&lt;/li&gt;
&lt;li&gt;유효하면 스키마 ID를 메시지에 추가하고 카프카에 쏜다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;필요에 따라 produce/consume을 한다(이 내용은 상세히 봅시다!)&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&quot;produce-과정&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#produce-%EA%B3%BC%EC%A0%95&quot; aria-label=&quot;produce 과정 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Produce 과정&lt;/h4&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/confluentinc/confluent-kafka-python/blob/master/examples/avro_producer.py&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 예시코드&lt;/a&gt;를 살펴보시면 이해가 빠릅니다!&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;AvroSerializer&lt;/code&gt; 객체를 통해 Schema Registry 정보를 받고 직렬화/역직렬화 처리준비를 완료함&lt;/li&gt;
&lt;li&gt;카프카 정보를 받은 후 토픽에 &lt;code class=&quot;language-text&quot;&gt;produce&lt;/code&gt; 수행&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&quot;consume-과정&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#consume-%EA%B3%BC%EC%A0%95&quot; aria-label=&quot;consume 과정 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Consume 과정&lt;/h4&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/confluentinc/confluent-kafka-python/blob/master/examples/avro_consumer.py&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이 예시코드&lt;/a&gt;를 살펴보시면 이해가 빠릅니다!&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;AvroDeserializer&lt;/code&gt; 객체를 통해 Schema Registry 정보를 받고 직렬화/역직렬화 처리준비를 완료함&lt;/li&gt;
&lt;li&gt;카프카 정보를 받은 후 토픽으로부터 &lt;code class=&quot;language-text&quot;&gt;subscribe&lt;/code&gt; 한다.&lt;/li&gt;
&lt;li&gt;값이 있으면 그때부터 계속 poll하면서 가져온다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;스키마-레지스트리의-작동-원리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%8A%A4%ED%82%A4%EB%A7%88-%EB%A0%88%EC%A7%80%EC%8A%A4%ED%8A%B8%EB%A6%AC%EC%9D%98-%EC%9E%91%EB%8F%99-%EC%9B%90%EB%A6%AC&quot; aria-label=&quot;스키마 레지스트리의 작동 원리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;스키마 레지스트리의 작동 원리&lt;/h3&gt;
&lt;p&gt;스키마 레지스트리 호출을 언급했는데, 정확히 어떤식으로 작동하는 걸까요? 그 내용에 대해선 아래 도식을 통해 설명하겠습니다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Producer&lt;/code&gt;는 Avro포맷으로 REST API에 &lt;code class=&quot;language-text&quot;&gt;POST&lt;/code&gt; 를 수행합니다.&lt;/li&gt;
&lt;li&gt;REST interface는 Schama Registry에 스키마를 전송합니다.
&lt;ol&gt;
&lt;li&gt;그 후 카프카에 binary data를 전송합니다.&lt;/li&gt;
&lt;li&gt;이때 binary data 에는 schema ID가 포함되어 있습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Consumer&lt;/code&gt;는 binary data를 Kafka에서 consume합니다.
&lt;ol&gt;
&lt;li&gt;그 후 해당 정보를 가지고 스키마 레지스트리(혹은 로컬캐시)에서 스키마 정보를 탐색후 가져오고, 이를 이용하여 역직렬화합니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&amp;#x26;fname=https%3A%2F%2Fk.kakaocdn.net%2Fdn%2Fbj33QF%2FbtqxIoJpMYx%2FicoZHVOOwxU2MHH2xNva2k%2Fimg.png&quot; alt=&quot;스키마 레지스트리의 작동방식&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;스키마-레지스트리-서버세팅-docker-compose-사용-시&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%8A%A4%ED%82%A4%EB%A7%88-%EB%A0%88%EC%A7%80%EC%8A%A4%ED%8A%B8%EB%A6%AC-%EC%84%9C%EB%B2%84%EC%84%B8%ED%8C%85-docker-compose-%EC%82%AC%EC%9A%A9-%EC%8B%9C&quot; aria-label=&quot;스키마 레지스트리 서버세팅 docker compose 사용 시 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;스키마 레지스트리 서버세팅 (Docker Compose 사용 시)&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;docker-compose에 스키마 레지스트리 관련 컨테이너 설정을 추가하면 됩니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;docker-compose 내의 환경설정값은 &lt;code class=&quot;language-text&quot;&gt;&apos;SCHEMA_REGISTRY_&apos;&lt;/code&gt; 형태의 prefix를 붙여야합니다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;이 설정값은 기본적으로 체크해야 합니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;kafkastore.bootstrap.servers&lt;/code&gt;: 연결할 카프카 브로커들의 리스트&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;listeners&lt;/code&gt;: HTTP(S)를 통해 API request를 받을 리스너의 리스트&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;kafkastore.connection.url&lt;/code&gt;: ZooKeeper URL&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;host.name&lt;/code&gt;: 스키마 레지스트리가 여러 노드로 작동중일 때의 설정&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.confluent.io/current/schema-registry/installation/deployment.html#important-configuration-options&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;참고 링크&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;추가로 확인해야할 설정값(SSL, SASL 등의 설정이 필요하다면 아래 링크를 참조해 주세요)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.confluent.io/current/schema-registry/installation/config.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;링크&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;deployment시 점검해야할 스펙은 아래와 같습니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.confluent.io/current/schema-registry/installation/deployment.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;링크&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;서버 세팅이 완료되면, 그 후 스키마 레지스트리 서버에 대해 API 요청을 테스트해볼 수 있습니다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;schema 등록&lt;/li&gt;
&lt;li&gt;schema 조회&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.confluent.io/current/schema-registry/develop/api.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;링크&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;스키마-레지스트리의-장단점&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%8A%A4%ED%82%A4%EB%A7%88-%EB%A0%88%EC%A7%80%EC%8A%A4%ED%8A%B8%EB%A6%AC%EC%9D%98-%EC%9E%A5%EB%8B%A8%EC%A0%90&quot; aria-label=&quot;스키마 레지스트리의 장단점 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;스키마 레지스트리의 장단점&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;schema를 사용할 때 생기는 장점&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;주고받는 메시지의 스키마 관리가 용이합니다.&lt;/li&gt;
&lt;li&gt;Schema 호환성만 유지된다면, &lt;em&gt;특정 토픽에 여러 버전의 스키마 데이터&lt;/em&gt; 를 Produce/Consume이 가능합니다.&lt;/li&gt;
&lt;li&gt;반복되는 값이 많다면 압축률이 상승됩니다(약간의 CPU 연산이 소모됩니다).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;schema를 사용할 때 생기는 단점&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;초기 도입이 다소 까다롭습니다.
&lt;ul&gt;
&lt;li&gt;Avro Schema를 먼저 정의하고 스키마 레지스트리에 등록 후 그 대로 데이터를 보는데 시간이 어느정도 걸린다.&lt;/li&gt;
&lt;li&gt;JSON 스키마나 Protobuf를 통한 스키마 정의도 마찬가지입니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;스키마 레지스트리 의 역할이 굉장히 중요; 스키마 레지스트리 의 &lt;strong&gt;장애&lt;/strong&gt;가 발생하는 경우 정상적으로 메시지를 &lt;strong&gt;전달하지 못하게&lt;/strong&gt; 됩니다.
&lt;ul&gt;
&lt;li&gt;Kafka 만 운영하였을때와 비교했을 때, 운영포인트가 증가한다는 것을 의미합니다.&lt;/li&gt;
&lt;li&gt;그렇기 때문에 스키마 레지스트리도 분산운영을 할 수 있는 방안이 있는지 찾아봐야 합니다.
&lt;img src=&quot;https://docs.confluent.io/current/_images/multi-dc-setup-kafka.png&quot; alt=&quot;img&quot;&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;스키마 레지스트리를 강요하지하지는 않지만, 많은 케이스 에서 &lt;a href=&quot;https://www.confluent.io/blog/schema-registry-kafka-stream-processing-yes-virginia-you-really-need-one/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;스키마 레지스트리 형식으로 포맷을 보장하기를 바라는 것으로 보입니다&lt;/a&gt;.&lt;/p&gt;
&lt;h1 id=&quot;마무리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EB%A7%88%EB%AC%B4%EB%A6%AC&quot; aria-label=&quot;마무리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;마무리&lt;/h1&gt;
&lt;p&gt;이번 글을 통해, 아래 내용들을 살펴볼 수 있었습니다:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;아파치 카프카의 Produce/Consume 뿐 아니라 Streams, Connect 기능을 이용하여 데이터의 흐름을 추가적으로 제어할 수 있음을 알 수 있었습니다.&lt;/li&gt;
&lt;li&gt;데이터 흐름이 복잡해짐에 따라 데이터 직렬화/역직렬화에 대한 관리도구 및 직렬화/역직렬화 도구가 대두되었습니다. 이는 각각 스키마 레지스트리 및 Apache Avro를 말합니다.&lt;/li&gt;
&lt;li&gt;스키마 레지스트리와 Apache Avro에 대해 간략하게나마 살펴보고, 장단점을 살펴보았습니다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;다음 파트에선 ksqlDB를 명확히 이해하기 위해 Kafka Streams에 대해 명확히 알아보도록 합시다.&lt;/p&gt;
&lt;p&gt;읽어주셔서 대단히 감사합니다.&lt;/p&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;References
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.confluent.io/current/schema-registry/schema_registry_tutorial.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Confluent Schema Registry Tutorial&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://dol9.tistory.com/274&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;Kafka 스키마 관리, Schema Registry&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Django 코드를 Jekyll에 작성할 때 Liquid syntax error가 뜬다면?]]></title><description><![CDATA[Python 코드를 Jekyll에 작성 시, Liquid syntax error가 뜬다면?]]></description><link>https://blog.s3ich4n.me/tips/2019-04-19-jekyll-liquid-issue</link><guid isPermaLink="false">https://blog.s3ich4n.me/tips/2019-04-19-jekyll-liquid-issue</guid><pubDate>Fri, 19 Apr 2019 12:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Django 코드를 Jekyll에 작성할 때 아래 에러메시지가 떴었다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;Liquid syntax error &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line &lt;span class=&quot;token number&quot;&gt;26&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;: Unknown tag &lt;span class=&quot;token string&quot;&gt;&apos;url&apos;&lt;/span&gt; ?

&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;생략&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Django의 템플릿 문법이 Jekyll의 &lt;a href=&quot;https://jekyllrb.com/docs/liquid/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;liquid&lt;/a&gt;와 같아서 루비 문법으로 해석하다보니 충돌이 발생한다. 해결책은 아래와 같다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;{% raw %}{%{% endraw %} raw %}
{% raw %}
&amp;lt;a href=&quot;{% url &apos;social:begin&apos; &apos;oauth2-provider-name&apos; %}&quot;&gt;Login&amp;lt;/a&gt;

{%{% endraw %} endraw %}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;references&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#references&quot; aria-label=&quot;references permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;References:&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/jekyll/jekyll/issues/4569&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;jekyll issue #4569&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[실용주의 프로그래머 pt. 4]]></title><description><![CDATA[실용주의 프로그래머 2nd edition을 읽은 후... pt. 4]]></description><link>https://blog.s3ich4n.me/books/pragmatic-programmer-1st/2018-02-24-pt04</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/pragmatic-programmer-1st/2018-02-24-pt04</guid><pubDate>Sat, 24 Feb 2018 09:00:00 GMT</pubDate><content:encoded>&lt;h3 id=&quot;읽기에-앞서&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%BD%EA%B8%B0%EC%97%90-%EC%95%9E%EC%84%9C&quot; aria-label=&quot;읽기에 앞서 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;읽기에 앞서…&lt;/h3&gt;
&lt;p&gt;실용주의 프로그래머를 읽고 느낀점을 써보려고 합니다. 제가 느낀바로는 이러한 내용이다 하는 방향으로 기술할 것 같습니다.&lt;/p&gt;
&lt;p&gt;craftsman 이라면 연장 정도는 손에 익혀둬야하는게 맞다. 프로그래머도 자신의 툴을 손에 익혀야하는 것이 당연하다.&lt;/p&gt;
&lt;p&gt;도구는 재능을 증폭시켜준다. 도구가 좋다는 가정하에 쓰는법만 알면 반드시 최고의 결과를 보장해준다. 생산성을 높히려면 경험을 통해 툴쓰는 법을 자꾸만 많이 익혀둬야 한다. 내 툴박스에는 자꾸만 뭔가 추가될거고 언젠간 빼게될 것들이 막 생길 것이다. 필요에 따라 어떤툴을 써야할지도 알게 될 것이다.&lt;/p&gt;
&lt;p&gt;모양을 만들 재료는 어떤 것인가? (일반 텍스트의 힘)&lt;/p&gt;
&lt;p&gt;IDE에만 익숙해지지 말고 간단한 쉘 프로그라밍 정도는 할 줄 알아야한다! (shell games)&lt;/p&gt;
&lt;p&gt;(파워 에디팅) 장에서는 툴 어케쓰면 좋은지 알려준다.&lt;/p&gt;
&lt;p&gt;(소스코드 관리) git 써라&lt;/p&gt;
&lt;p&gt;(디버깅) 디버깅은 완벽한 프로그램을 만들기 위한 필수다. 디버깅을 못한다 = 좋은 프로그래머가 되긴 힘들지 않을까&lt;/p&gt;
&lt;p&gt;(텍스트 처리) awk, perl, python을 소개&lt;/p&gt;
&lt;p&gt;(코드 생성기)는 봐야 알듯.&lt;/p&gt;
&lt;h2 id=&quot;14-일반-텍스트의-힘&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#14-%EC%9D%BC%EB%B0%98-%ED%85%8D%EC%8A%A4%ED%8A%B8%EC%9D%98-%ED%9E%98&quot; aria-label=&quot;14 일반 텍스트의 힘 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;14. 일반 텍스트의 힘&lt;/h2&gt;
&lt;p&gt;일반 텍스트(plain text)를 의미.&lt;/p&gt;
&lt;p&gt;사람이 이해할 수 있는 텍스트를 쓰는게 좋다. 그냥 플레인텍스트 뿐 아니라 XML이나 HTML처럼 잘 정의된 구조를 가진거면 일반 텍스트 정도로 이해된다.&lt;/p&gt;
&lt;p&gt;일반 텍스트를 쓰면 데이터가 어떻게 흘러가는지 보다 빠르게 이해할 수 있다.&lt;/p&gt;
&lt;p&gt;단점)&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;이진포맷보다 데이터 크기가 더 클 수 있다&lt;/li&gt;
&lt;li&gt;플레인 텍스트 처리엔 더 많은 시간이 들 수 있다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;그런데도 불구하고 쓸 필요가 있는 이유는?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;구식이 되는 것에 대한 보험
&lt;ul&gt;
&lt;li&gt;끊임없이 변하는 애플리케이션의 내용에 대해 사람이 이해하기 편해진다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;호환성
&lt;ul&gt;
&lt;li&gt;거의 어지간한 컴퓨터 세계의 도구들은 일반 텍스트를 다룰 수 있다.
e.g. 설정파일 관련 데이터라 해도 git에 넣어서 변화를 감지하거나, 그게 아니면 diff나 fc같은거로 변화를 감지할 수 있다. sum으로 첵섬 만들어서 변화감지를 할 수도 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;더 쉬운 테스트
&lt;ul&gt;
&lt;li&gt;테스트 시에 써먹을 값으로 테스트 데이터를 쉽게 업뎃,추가,수정이 가능하다.&lt;/li&gt;
&lt;li&gt;스크립트로 더 빨리도 가능하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;알아보기: &lt;a href=&quot;https://learnxinyminutes.com/docs/yaml/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;yaml은 뭐임?&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;15-조개-놀이shell-games&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#15-%EC%A1%B0%EA%B0%9C-%EB%86%80%EC%9D%B4shell-games&quot; aria-label=&quot;15 조개 놀이shell games permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;15. 조개 놀이(shell games)&lt;/h2&gt;
&lt;p&gt;텍스트를 다루는 프로그래머라면 쉘에서 주로 놀게될 것이다. 파이프, 매크로 등…&lt;/p&gt;
&lt;p&gt;GUI도 존나 좋은거다. 대놓고 직관적이니까. 근데 텍스트에서의 장점은 따로 있다. 그것은 ‘자동화’, ‘매크로’가 그것이다. 이건 미쳤다. 파일 이름 일일이 변경이나 필요한 작업들은 쉘이 더 빠를 때가 있다.&lt;/p&gt;
&lt;p&gt;e.g.
Makefile보다 더 최근에 바뀐 모든 c 파일을 찾아라&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;find&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-name&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;*.c&apos;&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-newer&lt;/span&gt; Makefile &lt;span class=&quot;token parameter variable&quot;&gt;-print&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;소스의 zip/tar 아카이브를 떠라&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;zip&lt;/span&gt; archive.zip *.h *.c
$ &lt;span class=&quot;token function&quot;&gt;tar&lt;/span&gt; cvf archive.tar *.h *.c&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;지난주에 바뀌지 않은 자바파일은 무엇인가?&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;find&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-name&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;*.java&apos;&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-mtime&lt;/span&gt; +7 &lt;span class=&quot;token parameter variable&quot;&gt;-print&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;그 중에 어느 파일이 awt 라이브러리를 쓰고있나?&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;find&lt;/span&gt; &lt;span class=&quot;token builtin class-name&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-name&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;*.java&apos;&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-mtime&lt;/span&gt; +7 &lt;span class=&quot;token parameter variable&quot;&gt;-print&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;xargs&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;java.awt&apos;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;(args는 -exec같은 식으로 쓰이는데 더 효과적인듯 보인다. &lt;a href=&quot;https://ko.wikipedia.org/wiki/Xargs&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;xargs란?&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;쉘은 잘 드는 칼 같은거라서 겉보기엔 무서워보이는데 매우 좋다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;h2 id=&quot;tip-21-명령어-쉘의-힘을-사용하라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#tip-21-%EB%AA%85%EB%A0%B9%EC%96%B4-%EC%89%98%EC%9D%98-%ED%9E%98%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EB%9D%BC&quot; aria-label=&quot;tip 21 명령어 쉘의 힘을 사용하라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Tip 21. 명령어 쉘의 힘을 사용하라.&lt;/h2&gt;
&lt;/blockquote&gt;
&lt;p&gt;자바에서 명시적으로 import하는 패키지 이름의 합집합 목록을 만들어서 list란 파일에 저장하기&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;^import &apos;&lt;/span&gt; *.java &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
	&lt;span class=&quot;token function&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;s/.*import *//&apos;&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;s/;.*$//&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
	&lt;span class=&quot;token function&quot;&gt;sort&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; list&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이런식으로 매우 좋다!&lt;/p&gt;
&lt;h2 id=&quot;16-파워-에디팅&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#16-%ED%8C%8C%EC%9B%8C-%EC%97%90%EB%94%94%ED%8C%85&quot; aria-label=&quot;16 파워 에디팅 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;16. 파워 에디팅&lt;/h2&gt;
&lt;p&gt;세상에 에디터는 널렸다. 근데 내가 쓰는거에 대해선 좀 능숙해질 필요가 있다. 정말 남이봐도 잘쓴다 싶을정도로… 하나를 쓴다해도 무슨 기능이 있는지 통달할 필요가 있다!&lt;/p&gt;
&lt;blockquote&gt;
&lt;h2 id=&quot;tip-22-하나의-에디터를-잘-사용하라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#tip-22-%ED%95%98%EB%82%98%EC%9D%98-%EC%97%90%EB%94%94%ED%84%B0%EB%A5%BC-%EC%9E%98-%EC%82%AC%EC%9A%A9%ED%95%98%EB%9D%BC&quot; aria-label=&quot;tip 22 하나의 에디터를 잘 사용하라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Tip 22. 하나의 에디터를 잘 사용하라.&lt;/h2&gt;
&lt;/blockquote&gt;
&lt;p&gt;에디터 하나를 잘 골라서 잘 쓸 수 있도록 만들고 모든 편집작업에 그걸 사용하도록 하라! 무엇을 쓰든간에 정말 효율적으로 바로바로 필요한 기능이 나오도록 하게 하는 것이 베스트다. 또한 그 에디터가 어지간한 플랫폼에서 다 쓸 수 있는지도 파악하면 도움이 된다. (무슨 작업환경에서든 다 쓸 수 있도록 해두라는 말)&lt;/p&gt;
&lt;p&gt;책에서 추천하는 에디터의 기능:
그럴싸한 에디터라면 갖추고있는 몇가지 기능은 다음과 같다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;설정변경 가능&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;폰트, 색깔, 윈도우 크기, 키 입력 바인딩 등을 바꿀 수 있는가?는 다시말해 내가 필요한 기능을 모두 키보드로 조질 수 있는가? 의 의미가 된다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;확장 가능:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;새 프로그래밍 언어를 즉각 대응할 수 있는가? 새 컴파일러에 대응할 수 있는가? 또한 고려요소중의 하나다. 혹은 이런것들을 ‘가르칠’ 수 있어야 한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;프로그램 가능:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;복잡하고 다단계의 작업을 수행할 수 있도록 에디터를 ‘프로그래밍’ 할 수 있어야 한다. 매크로나 내장 스트립트가 있는가?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;많은 에디터들은 다음과 같은 특정 고유기능들이 있다:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;• 구문 강조(syntax highlighting)
• 자동 완성
• 자동 들여쓰기
• 코드나 문서 상용어구 지원
• 관련 도움말 시스템
• IDE 기능(컴파일, 디버그 등)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;메모장으로 잘라붙이기 할 수도 있다. 그런데 예를들어 소스코드를 내가 원하는 내용으로 정렬할 필요가 있을 때는 어떻게 하면 좋을까?&lt;/p&gt;
&lt;p&gt;vi기준 &lt;code class=&quot;language-text&quot;&gt;:.,+3!sort&lt;/code&gt; 하면 알파벳 순으로 라인 정렬이 된다.&lt;/p&gt;
&lt;p&gt;또는 프로그래밍할 때 처음 내가 입력할 필요가 없는 것들을 파일 생성과 동시에 대신 입력해주기도 한다. 예를 들어 이런것들…&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;• 클래스와 모듈 이름(파일 이름에서 도출된것)을 자동입력
• 소스코드 작성자 이름, 저작권 선언
• 특정 언어의 스켈레톤 코드(생성자, 소멸자 같은것들 자동작성)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;책에서는 내가 쓰는 에디터가 무엇인지, 어느정도 쓸 수 있는지에 따라 다음 행동을 제시한다.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;나의 실력&lt;/th&gt;
&lt;th&gt;앞으로 어떻게 하면 좋을까요?&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;나는 여러 에디터 중 기본 기능만 쓴다&lt;/td&gt;
&lt;td&gt;강력한 에디터 하나를 골라잡아서 제대로 익혀보세요&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;선호하는 에디터가 있긴 한데, 기능을 다 쓰지는 않는다&lt;/td&gt;
&lt;td&gt;그걸 제대로 배워서 입력하는 키 갯수를 최대한으로 줄여보세요&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;선호하는 에디터가 있고 가능하면 그걸 쓴다&lt;/td&gt;
&lt;td&gt;지금 하는 작업 이외에 다 많은 작업에 쓰도록 확장해보세요&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&quot;17-소스코드-관리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#17-%EC%86%8C%EC%8A%A4%EC%BD%94%EB%93%9C-%EA%B4%80%EB%A6%AC&quot; aria-label=&quot;17 소스코드 관리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;17. 소스코드 관리&lt;/h2&gt;
&lt;p&gt;Git 씁시다! 형상관리를 SE시간에 배웠고 그 예시로 Git이 당당히 나왔다. 필요하다면 SVN도 알아둬야할 것 같다.&lt;/p&gt;
&lt;p&gt;소스코드 관리 시스템(SCCS: Source Code Control System) 은 누가 소스를 바꿨고 주간 소스코드 버전차이, 어느 릴리즈에 몇줄 바뀌었는지? 어느 파일이 자주 바뀌었는지? 등을 다 파악할 수 있다. 이는 추후에 버그트래킹, 퍼포먼스/품질 관리 등에 쓰이기 좋은 정보들이다.&lt;/p&gt;
&lt;p&gt;브랜치를 나누어서 특점 시점에서 개발 로그를 다르게 남길 수도 있다.&lt;/p&gt;
&lt;p&gt;여러사람이 동시에 작업할 수도 있다.&lt;/p&gt;
&lt;p&gt;이는 작은 프로젝트든 큰 프로젝트든 어디든 다 쓰일 수 있다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;h2 id=&quot;tip-23-언제나-소스코드-관리-시스템을-사용하라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#tip-23-%EC%96%B8%EC%A0%9C%EB%82%98-%EC%86%8C%EC%8A%A4%EC%BD%94%EB%93%9C-%EA%B4%80%EB%A6%AC-%EC%8B%9C%EC%8A%A4%ED%85%9C%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EB%9D%BC&quot; aria-label=&quot;tip 23 언제나 소스코드 관리 시스템을 사용하라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Tip 23. 언제나 소스코드 관리 시스템을 사용하라!&lt;/h2&gt;
&lt;/blockquote&gt;
&lt;p&gt;전체 프로젝트를 제품 빌드를 자동화하고 반복작업을 가능하게 한다.&lt;/p&gt;
&lt;p&gt;갓-깃 씁시다.&lt;/p&gt;
&lt;h2 id=&quot;18-디버깅&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#18-%EB%94%94%EB%B2%84%EA%B9%85&quot; aria-label=&quot;18 디버깅 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;18. 디버깅&lt;/h2&gt;
&lt;p&gt;프로그램은 &lt;em&gt;완벽하게&lt;/em&gt; 짤 수 없다. 그렇다면 디버깅에 관련한 문제를 알아보고 찾기 힘든 버그를 찾아내는 일반적인 전략 몇가지를 알아보자. 피할 수 없으면 효율적으로 격파해야지!&lt;/p&gt;
&lt;p&gt;안되는 코드는 풀어내면 된다. 그 방법중에 하나가 디버깅이다. 못짠 코드는 누구나 만들어낼 수 있다. 절대로 다른 팀원을 비난하면 안 된다!&lt;/p&gt;
&lt;blockquote&gt;
&lt;h2 id=&quot;tip-24-비난-대신-문제를-해결하라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#tip-24-%EB%B9%84%EB%82%9C-%EB%8C%80%EC%8B%A0-%EB%AC%B8%EC%A0%9C%EB%A5%BC-%ED%95%B4%EA%B2%B0%ED%95%98%EB%9D%BC&quot; aria-label=&quot;tip 24 비난 대신 문제를 해결하라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Tip 24. 비난 대신 문제를 해결하라.&lt;/h2&gt;
&lt;/blockquote&gt;
&lt;p&gt;디버깅하면 &lt;strong&gt;내 코드가 틀릴 수 있다&lt;/strong&gt;는 걸 염두에 두고 해야한다. 디버깅 때는 프로젝트의 압박이 있다하더라도 다음 철칙을 항상 염두에 두자!&lt;/p&gt;
&lt;blockquote&gt;
&lt;h2 id=&quot;tip-25-디버깅을-할-때-당황하지-마라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#tip-25-%EB%94%94%EB%B2%84%EA%B9%85%EC%9D%84-%ED%95%A0-%EB%95%8C-%EB%8B%B9%ED%99%A9%ED%95%98%EC%A7%80-%EB%A7%88%EB%9D%BC&quot; aria-label=&quot;tip 25 디버깅을 할 때 당황하지 마라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Tip 25. 디버깅을 할 때 당황하지 마라.&lt;/h2&gt;
&lt;/blockquote&gt;
&lt;p&gt;뭐 때문에 버그가 생겼는지, 인과관계가 어떻게 되어있는지 생각해보는게 정말 중요하다. 버그가 터져도 ‘와 말도 안돼’, ‘버그 터질리가 없는데’ 같은 소리는 의미가 없다. 왜냐고? 진짜 터졌으니까.&lt;/p&gt;
&lt;p&gt;디버깅할 때는 ‘근시’를 조심해야 한다. 바로 눈에 터지는 것만 없애려 하지말고 문제의 &lt;code class=&quot;language-text&quot;&gt;근본적인 원인&lt;/code&gt;을 분석해서 어떻게 터지는지 분석해야 한다. 특정 증상만 고치지 마라!&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;어디에서부터 디버깅해야되나?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;사실 버그 리포트는 정확한 과학이 못 된다… 우연히 어떻게 터졌는지 모르는 것들이기 때문이다. 자세한 사항을 보기 위해 실제 버그가 어떤 상황에 정확히 어떻게하면 터지는지를 알아야한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;가능하다면 처음 받은 자료 이상을 얻기 위해서 버그 리포트한 사용자를 인터뷰할 필요가 있다.&lt;/li&gt;
&lt;li&gt;경계 조건, 실제 최종 사용자 패턴 모두를 철저히 테스트해야한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;디버깅 전략&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;데이터를 가시화하라!&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;프로그램이 다루는 데이터가 어떤거인지 살펴보자. GUI라면 대화상자 필드, 변수이름 = 자료값 이정도일 것.&lt;/li&gt;
&lt;li&gt;데이터와 데이터가 어떻게 데이터를 주고받는지 시각적으로 보여주는 디버거를 쓰면 보다 쉽게 오류를 찾아낼 수 있다!&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;트레이싱(tracing)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;트레이싱 구문은 디버거를 쓸 때 ‘여기까지 도달’, ‘x값 = 2’등 파일에 뿌려주는 진단용 메시지를 말한다. call tree를 타고 내려갈 때도 쓴다. 이런 구문은 규칙적이고 일관적이어야 분석하기 편하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;고무오리&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;문제를 그냥 쭉 설명해보다보면 ‘아차’하고 실수한 부분을 체크할 수 있다. 그런 통찰을 가끔씩 할 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;제거 과정: 내 코드가 문제냐, OS가 문제냐?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;OS의 코드가 고장날 확률이 높을까, 내 코드가 고장날 확률이 높을까? 아래의 팁은 이런 문제와 관련해서 관련 일화를 하나 소개한다.&lt;/li&gt;
&lt;li&gt;해당 일화를 요약하자면 코드의 어디가 망가졌는지 문서를 정독해서 원인을 찾았다는 말. 문제는 바로 본인의 &lt;code class=&quot;language-text&quot;&gt;select&lt;/code&gt; 관련 코드였던 것이다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;h2 id=&quot;tip-26-select는-망가지지-않았다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#tip-26-select%EB%8A%94-%EB%A7%9D%EA%B0%80%EC%A7%80%EC%A7%80-%EC%95%8A%EC%95%98%EB%8B%A4&quot; aria-label=&quot;tip 26 select는 망가지지 않았다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Tip 26. ‘select’는 망가지지 않았다.&lt;/h2&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;놀람의 요소
&lt;ul&gt;
&lt;li&gt;버그가 터지면 내가 제대로 짰다 하는걸 처음부터 다시 생각하라. 버그가 안터지겠다 싶은 곳에서부터 경계조건을 테스트하고 몇번 돌려써도 안터질 코드인가 다시 생각해야한다. 납득하기 싫지만 내 가정이 잘못되었을 수 있다. 뭘 어떻게 가정하고 돌렸을지를 파악하고 데이터로 경계조건으로 코드가 옳음을 ‘증명’하라!&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;h2 id=&quot;tip-27-가정하지-마라-증명하라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#tip-27-%EA%B0%80%EC%A0%95%ED%95%98%EC%A7%80-%EB%A7%88%EB%9D%BC-%EC%A6%9D%EB%AA%85%ED%95%98%EB%9D%BC&quot; aria-label=&quot;tip 27 가정하지 마라 증명하라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Tip 27. 가정하지 마라. 증명하라.&lt;/h2&gt;
&lt;/blockquote&gt;
&lt;p&gt;버그를 고쳤다면, 이 버그가 왜 일찍 보이지 않았을까? 생각할 필요가 있다. 이 버그를 일찍 잡을 수 있도록 단위 테스트나 다른 테스트를 수정할 필요가 있는지도 고려하는 것이 좋다. 이거 비슷한 오류가 터질 코드가 있을 것 같으면 지금 같이 수정하면 된다.&lt;/p&gt;
&lt;p&gt;위 글을 통해 디버깅 체크리스트를 책에서는 제시한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;보고된 문제가 내재하는 버그의 직접적인 결과인가, 아니면 단순히 증상인가?&lt;/li&gt;
&lt;li&gt;버그가 정말로 컴파일러, OS코드에 있나? 아니면 내 코드에 있나?&lt;/li&gt;
&lt;li&gt;이 버그를 팀원에게 설명한다 하면 어떻게 말할 것인가?&lt;/li&gt;
&lt;li&gt;의심되는 코드가 단위 테스트를 통과한다면, 테스트는 충분히 완전한 것인가? 이 데이터로 단위 테스트를 돌린다면 무슨일이 일어나는가?&lt;/li&gt;
&lt;li&gt;이 버그를 일으킨 조건이 다른 곳에도 존재하는가?&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;19-텍스트-처리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#19-%ED%85%8D%EC%8A%A4%ED%8A%B8-%EC%B2%98%EB%A6%AC&quot; aria-label=&quot;19 텍스트 처리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;19. 텍스트 처리&lt;/h2&gt;
&lt;p&gt;텍스트 처리를 위해 awk, sed같은툴이나 쉘 뿐 아니라 파이썬이나 펄도 배울 필요가 있다!&lt;/p&gt;
&lt;p&gt;어떤걸 처리하는데는 다른 특정 언어가 더 나을 수도 있다. 다른언어들로 구현해봤을 때 얼마나 짧고 빠르게 구현할 수 있는가를 논했을 때 C가 150줄일 때 펄은 17줄이면 끝일 정도니까(책피셜)&lt;/p&gt;
&lt;blockquote&gt;
&lt;h2 id=&quot;tip-28-텍스트-처리-언어를-하나-익혀라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#tip-28-%ED%85%8D%EC%8A%A4%ED%8A%B8-%EC%B2%98%EB%A6%AC-%EC%96%B8%EC%96%B4%EB%A5%BC-%ED%95%98%EB%82%98-%EC%9D%B5%ED%98%80%EB%9D%BC&quot; aria-label=&quot;tip 28 텍스트 처리 언어를 하나 익혀라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Tip 28. 텍스트 처리 언어를 하나 익혀라.&lt;/h2&gt;
&lt;/blockquote&gt;
&lt;p&gt;텍스트 처리 언어의 적용범위는 상당히 넓다:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;DB스키마 관리: 스크립트로 스키마 정의 파일을 읽고 다음의 요소들을 생성해낼 수 있다.&lt;/li&gt;
&lt;li&gt;자바 속성 액세스: 파일 내 각 &lt;code class=&quot;language-text&quot;&gt;property&lt;/code&gt;를 파악하고 &lt;code class=&quot;language-text&quot;&gt;getter/setter&lt;/code&gt;를 만들어낼 수 있다.&lt;/li&gt;
&lt;li&gt;테스트 데이터 생성: 파일에 다른 포맷으로 분리된 데이터를 재조립해서 DB에 넣기 편하게 개조가능하다.&lt;/li&gt;
&lt;li&gt;C에서 Object Pascal 인터페이스로: C헤더파일을 해석해서 모든 함수와 그것들이 사용하는 데이터 구조의 정의를 추출시켜주는 툴 제작 가능. 이게 빌드의 일부분이 되면 바뀔 때마다 자동적용…&lt;/li&gt;
&lt;li&gt;웹문서 생성: 각종 DB스키마, 소스파일, makefile, 등 기타 프로젝트 소스들을 읽어서 자동으로 HTML문서화 가능. &lt;a href=&quot;http://woowabros.github.io/experience/2018/12/28/spring-rest-docs.html&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;이런 것을&lt;/a&gt; 말하는 것 같음.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;20-코드-생성기&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#20-%EC%BD%94%EB%93%9C-%EC%83%9D%EC%84%B1%EA%B8%B0&quot; aria-label=&quot;20 코드 생성기 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;20. 코드 생성기&lt;/h2&gt;
&lt;p&gt;똑같은걸 만들 때는 템플릿을 써먹으면 된다. 잘만든 템플릿은 두고두고 써먹는다. 반복되는 작업을 통한 실수를 대폭 줄여주고 실제로 해야할 구현에만 집중할 수 있게 해준다.&lt;/p&gt;
&lt;p&gt;코드 생성기는 그래서 중요하다. 잘 만든 코드 생성기는 프로젝트 전 기간에 그냥 거저로 써먹을 수 있다!&lt;/p&gt;
&lt;blockquote&gt;
&lt;h2 id=&quot;tip-29-코드를-작성하는-코드를-작성하라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#tip-29-%EC%BD%94%EB%93%9C%EB%A5%BC-%EC%9E%91%EC%84%B1%ED%95%98%EB%8A%94-%EC%BD%94%EB%93%9C%EB%A5%BC-%EC%9E%91%EC%84%B1%ED%95%98%EB%9D%BC&quot; aria-label=&quot;tip 29 코드를 작성하는 코드를 작성하라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Tip 29. 코드를 작성하는 코드를 작성하라.&lt;/h2&gt;
&lt;/blockquote&gt;
&lt;p&gt;코드 생성기는 다음 두가지로 분류된다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;수동적 코드 생성기&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;결과수행을 위해 한번만 실행됨; 그 다음부터의 결과물은 독립적인 것&lt;/li&gt;
&lt;li&gt;타이핑을 줄여줌
&lt;ul&gt;
&lt;li&gt;새 소스파일 생성(스켈레톤 코드)&lt;/li&gt;
&lt;li&gt;프로그래밍 언어간 일회용 변환 수행&lt;/li&gt;
&lt;li&gt;런타임이 계산하기엔 비용이 많이 드는 참조 테이블과 여타 자원 생성&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;능동적 코드 생성기:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;코드 생성이 필요할 때마다 작동됨&lt;/li&gt;
&lt;li&gt;DRY 원칙을 따르는 요소.
&lt;ul&gt;
&lt;li&gt;어떤 형태의 스크립트나 컨트롤 파일을 읽어서 자동으로 변경을 감지하는 것을 의미&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[실용주의 프로그래머 pt. 3]]></title><description><![CDATA[실용주의 프로그래머 2nd edition을 읽은 후... pt. 3]]></description><link>https://blog.s3ich4n.me/books/pragmatic-programmer-1st/2018-02-23-pt03</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/pragmatic-programmer-1st/2018-02-23-pt03</guid><pubDate>Fri, 23 Feb 2018 09:00:00 GMT</pubDate><content:encoded>&lt;h3 id=&quot;읽기에-앞서&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%BD%EA%B8%B0%EC%97%90-%EC%95%9E%EC%84%9C&quot; aria-label=&quot;읽기에 앞서 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;읽기에 앞서…&lt;/h3&gt;
&lt;p&gt;실용주의 프로그래머를 읽고 느낀점을 써보려고 합니다. 제가 느낀바로는 이러한 내용이다 하는 방향으로 기술할 것 같습니다.&lt;/p&gt;
&lt;h1 id=&quot;제-2장-실용주의-접근법&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A0%9C-2%EC%9E%A5-%EC%8B%A4%EC%9A%A9%EC%A3%BC%EC%9D%98-%EC%A0%91%EA%B7%BC%EB%B2%95&quot; aria-label=&quot;제 2장 실용주의 접근법 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;제 2장. 실용주의 접근법&lt;/h1&gt;
&lt;p&gt;이 장에서는 소프트웨어 개발에 있어 반드시 적용되는 아이디어나 보편화된 프로세스에 대해 소개한다.&lt;/p&gt;
&lt;p&gt;중복의 해악과 직교성(Orthogonality):&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;전자? 시스템을 통틀어 어떤 지식을 중복하지 마라.&lt;/li&gt;
&lt;li&gt;후자? 하나의 지식을 여러 개의 컴포넌트에 걸쳐 쪼개어놓지 마라.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;가역성(Reversibility):&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;변화하는 환경에서 프로젝트를 분리하는 방법&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;예광탄(Tracer bullets):&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;요구사항을 모음, 설계를 테스트, 코드를 구현함… 이런류의 개발 스타일을 소개함.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;프로토타입과 포스트잇:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;아키텍처, 알고리즘, 인터페이스, 아이디어를 구현하기 위해 프로토타입을 어떻게 쓰는가에 대한 이야기를 함.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;도메인 언어(Domain Language):&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;???&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;추정(Estimating):&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;이정도 개발이면 이정도 쯤 걸리겠는데? 하고 감잡는 방법을 소개&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;7-중복의-해악&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#7-%EC%A4%91%EB%B3%B5%EC%9D%98-%ED%95%B4%EC%95%85&quot; aria-label=&quot;7 중복의 해악 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;7. 중복의 해악&lt;/h2&gt;
&lt;p&gt;지식은 변화한다. 요구사항이 바뀔 수도 있고 알고리즘이 안돌아가서 변경될 수 있고 그에 맞게 기능도 바뀐다. 한마디로 하자면 유지보수는 개발과 이어지는 부분이다 라고할 수 있다.
유지보수를 하려면 사물의 표현방식을 바꿔야함. 객체화한 것들, 캡슐화한 부분들 등… 그렇지만 개발할 때 명세와 프로세스에 지식을 중복해서 넣기 쉽다는 점이다. 이것을 방지하기 위한 원칙은 DRY 원칙이다. 정의는 다음과 같다.&lt;/p&gt;
&lt;p&gt;모든 지식은 시스템 내에서 단일하고, 애매하지 않고, 믿을만한 표현양식을 가져야 한다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;h2 id=&quot;tip-11-dry---dont-repeat-yourself&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#tip-11-dry---dont-repeat-yourself&quot; aria-label=&quot;tip 11 dry   dont repeat yourself permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Tip 11. DRY - Don’t Repeat Yourself&lt;/h2&gt;
&lt;/blockquote&gt;
&lt;p&gt;DRY를 따르지 않는다: 똑같은 것이 여러곳에 반복된다는 것이다. -&gt; 지옥의 유지보수&lt;/p&gt;
&lt;p&gt;중복이 어떻게 생기는가?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;강요된(impose) 중복: 환경이 중복을 요구한다&lt;/li&gt;
&lt;li&gt;부주의한 중복: 개발자들이 중복하고 있다는 것을 인지하지 못함&lt;/li&gt;
&lt;li&gt;참을성 없는 중복: 중복이 쉬워보이기 때문에 개발자들이 게을러져서&lt;/li&gt;
&lt;li&gt;개발자 간의 중복: 한팀에 있는(다른팀에 있는) 여러 사람이 동일한 정보를 중복&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;강요된 중복:
필요한 지식을 한곳에 두도록 하는 기법들&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;정보의 다양한 표현방식: 코딩할 때 동일한 정보가 다른 형태로 표현될 때가 있다.
&lt;ul&gt;
&lt;li&gt;공통된 구조를 다른 요소에서 서로 표현해야할 때&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;코드 생성기를 통해 두 요소의 표현을 자동화한다.
&lt;ul&gt;
&lt;li&gt;코드 내의 문서화&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[실용주의 프로그래머 pt. 2]]></title><description><![CDATA[실용주의 프로그래머 2nd edition을 읽은 후... pt. 2]]></description><link>https://blog.s3ich4n.me/books/pragmatic-programmer-1st/2018-02-21-pt02</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/pragmatic-programmer-1st/2018-02-21-pt02</guid><pubDate>Wed, 21 Feb 2018 09:00:00 GMT</pubDate><content:encoded>&lt;h3 id=&quot;읽기에-앞서&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%BD%EA%B8%B0%EC%97%90-%EC%95%9E%EC%84%9C&quot; aria-label=&quot;읽기에 앞서 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;읽기에 앞서…&lt;/h3&gt;
&lt;p&gt;실용주의 프로그래머를 읽고 느낀점을 써보려고 합니다. 제가 느낀바로는 이러한 내용이다 하는 방향으로 기술할 것 같습니다.&lt;/p&gt;
&lt;h1 id=&quot;제-1장-실용주의-철학&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%A0%9C-1%EC%9E%A5-%EC%8B%A4%EC%9A%A9%EC%A3%BC%EC%9D%98-%EC%B2%A0%ED%95%99&quot; aria-label=&quot;제 1장 실용주의 철학 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;제 1장. 실용주의 철학&lt;/h1&gt;
&lt;p&gt;이 장에서는 문제에 어떻게 접근해야 하는지에 대한 철학을 알려준다.&lt;/p&gt;
&lt;h2 id=&quot;1-고양이가-내-소스코드를-삼켰어요&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1-%EA%B3%A0%EC%96%91%EC%9D%B4%EA%B0%80-%EB%82%B4-%EC%86%8C%EC%8A%A4%EC%BD%94%EB%93%9C%EB%A5%BC-%EC%82%BC%EC%BC%B0%EC%96%B4%EC%9A%94&quot; aria-label=&quot;1 고양이가 내 소스코드를 삼켰어요 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1. 고양이가 내 소스코드를 삼켰어요:&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;내가 한 일에 대해선 책임을 져라. 안돌아가면 변명하지 말고 대안을 찾아야 한다.&lt;/li&gt;
&lt;li&gt;본인의 실력에 대해 자부심을 가질 필요가 있다. 그런만큼 실수를 인정할 필요도 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;h2 id=&quot;tip-3-어설픈-변명은-하지-말고-대안을-제시해라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#tip-3-%EC%96%B4%EC%84%A4%ED%94%88-%EB%B3%80%EB%AA%85%EC%9D%80-%ED%95%98%EC%A7%80-%EB%A7%90%EA%B3%A0-%EB%8C%80%EC%95%88%EC%9D%84-%EC%A0%9C%EC%8B%9C%ED%95%B4%EB%9D%BC&quot; aria-label=&quot;tip 3 어설픈 변명은 하지 말고 대안을 제시해라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Tip 3. 어설픈 변명은 하지 말고 대안을 제시해라.&lt;/h2&gt;
&lt;/blockquote&gt;
&lt;p&gt;코드를 버려야하나? 리팩토링 가능
뭘 구현해야하지? 프로토타입 구현으로 먼저 보여줌
테스팅, 자동화도 도입해야할 요소&lt;/p&gt;
&lt;p&gt;SE시간에 빤히 배웠던 것들을 다시금 강조한다.&lt;/p&gt;
&lt;p&gt;부탁하고 묻고 하는 것에 두려움이 없어야 한다. 혼자 끙끙 앓으면 나만 아프다.&lt;/p&gt;
&lt;h2 id=&quot;2-소프트웨어-엔트로피&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2-%EC%86%8C%ED%94%84%ED%8A%B8%EC%9B%A8%EC%96%B4-%EC%97%94%ED%8A%B8%EB%A1%9C%ED%94%BC&quot; aria-label=&quot;2 소프트웨어 엔트로피 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2. 소프트웨어 엔트로피&lt;/h2&gt;
&lt;p&gt;프로그램을 짜면 필연적으로 누더기 코드가 생긴다.
‘깨진창문 이론’을 생각하자! 작살났거나 쪼대로 짠 코드는 다른 코드도 대충짜게 만든다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;h2 id=&quot;tip-4-깨진창문을-내버려두지-마라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#tip-4-%EA%B9%A8%EC%A7%84%EC%B0%BD%EB%AC%B8%EC%9D%84-%EB%82%B4%EB%B2%84%EB%A0%A4%EB%91%90%EC%A7%80-%EB%A7%88%EB%9D%BC&quot; aria-label=&quot;tip 4 깨진창문을 내버려두지 마라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Tip 4. 깨진창문을 내버려두지 마라.&lt;/h2&gt;
&lt;/blockquote&gt;
&lt;p&gt;영 좋지않은 코드는 주석처리를 하든, 더미 데이터를 넣어놓든 해야한다.&lt;/p&gt;
&lt;p&gt;시간이 촉박하거나 데모를 보여줘야할 땐 물론 급하게 돌아가게는 만들어야한다. 하지만 이는 반드시 수정되어야한다. 이러한 행동을 하지도 않는게 좋겠지.&lt;/p&gt;
&lt;p&gt;멍청한 코드는 프로젝트를 망가뜨리는 지름길이기 때문이다.&lt;/p&gt;
&lt;h2 id=&quot;3-돌멩이-수프와-삶은-개구리&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#3-%EB%8F%8C%EB%A9%A9%EC%9D%B4-%EC%88%98%ED%94%84%EC%99%80-%EC%82%B6%EC%9D%80-%EA%B0%9C%EA%B5%AC%EB%A6%AC&quot; aria-label=&quot;3 돌멩이 수프와 삶은 개구리 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3. 돌멩이 수프와 삶은 개구리&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Stone_Soup&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;돌죽&lt;/a&gt; 일화를 말한다.&lt;/p&gt;
&lt;p&gt;킥스타팅은 별게 아니라 걍 &lt;code class=&quot;language-text&quot;&gt;쉬운걸 구현&lt;/code&gt;하는데서 시작한다는 말이다.&lt;/p&gt;
&lt;p&gt;작년에 프로젝트를 해보면서 틀만 짜놓고 퍼졌던 적이 있다. 그래 뭐 이정도는 했지 ㅋㅋㅋ 하고 자만하고 끝이었는데, 다시보니 그때부터 시작이었던 것이다. 나부터 &lt;code class=&quot;language-text&quot;&gt;변화의 촉매&lt;/code&gt;가 되어야 한다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;h2 id=&quot;tip-5-변화의-촉매가-되어라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#tip-5-%EB%B3%80%ED%99%94%EC%9D%98-%EC%B4%89%EB%A7%A4%EA%B0%80-%EB%90%98%EC%96%B4%EB%9D%BC&quot; aria-label=&quot;tip 5 변화의 촉매가 되어라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Tip 5. 변화의 촉매가 되어라!&lt;/h2&gt;
&lt;/blockquote&gt;
&lt;p&gt;그렇지만, 기능을 잡아넣기만 하면 프로젝트가 뒤틀린다. 세세한거에 집중하다보니 원했던 구현이 되지 않는다. 책의 내용을 그대로 인용하자면 다음과 같다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;(중략) 프로젝트 폭주는 대부분 어느날 갑자기 일어난다. 코드에 패치가 하나 둘 적용되다가 원본이 하나도 남지 않을 때 까지, 시스템은 명세에서부터 기능 하나하나씩 정처 없이 떠다닌다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;그러니까 항상 ‘큰 그림을 기억해야’ 한다. 프로젝트가 어떻게 만들어질지 생각했으면 그거대로 만들어야한다 이말이다. 요구사항과 설계가 이래서 중요하나 싶다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;h2 id=&quot;tip-6-큰-그림을-기억하라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#tip-6-%ED%81%B0-%EA%B7%B8%EB%A6%BC%EC%9D%84-%EA%B8%B0%EC%96%B5%ED%95%98%EB%9D%BC&quot; aria-label=&quot;tip 6 큰 그림을 기억하라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Tip 6. 큰 그림을 기억하라!&lt;/h2&gt;
&lt;/blockquote&gt;
&lt;p&gt;개구리는 서서히 끓는 냄비속에서 ‘어 따뜻해지네?’ 하다가 죽는다. 변화를 감지하지 못한 채로 있다가 방황할지도 모른다.&lt;/p&gt;
&lt;p&gt;이 주제는 정말 중요한 질문을 던지며 마무리한다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;stone soup story에서의 변화와 개구리를 점진적으로 속이는 변화의 차이는 뭘까?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;내가 일으킨 변화는 팀에있어 스톤수프 변화일까, 개구리수프 변화일까?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;이 판단은 주관적일까, 객관적일까?&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;4-적당히-괜찮은-소프트웨어&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#4-%EC%A0%81%EB%8B%B9%ED%9E%88-%EA%B4%9C%EC%B0%AE%EC%9D%80-%EC%86%8C%ED%94%84%ED%8A%B8%EC%9B%A8%EC%96%B4&quot; aria-label=&quot;4 적당히 괜찮은 소프트웨어 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4. 적당히 괜찮은 소프트웨어&lt;/h2&gt;
&lt;p&gt;‘적당히 괜찮은’ 이란 말은 영 좋지않은 코드를 말하는게 아니다. 이건 책을 그대로 인용해서 이해하는 것이 좋겠다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;(중략) 시스템이 성공하려면 사용자의 요구사항을 충족해야 한다. 단지 우리는 여러분이 생산해낸 것이 어느 정도면 적당히 괜찮은지를 결정하는 과정에 사용자가 참가할 기회를 가져야 한다는 걸 말하고 있는 것이다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;피드백&lt;/code&gt;을 얻을 필요가 있다 이말. ‘얼마나 좋아야’되는가? 에 대한 질문은 유저들이 대답해줄 것이다. 프로토타입을 내어주고 그에 대한 피드백으로 개발할 수도 있는 부분이다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;h2 id=&quot;tip-7-품질을-요구사항으로-만들어라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#tip-7-%ED%92%88%EC%A7%88%EC%9D%84-%EC%9A%94%EA%B5%AC%EC%82%AC%ED%95%AD%EC%9C%BC%EB%A1%9C-%EB%A7%8C%EB%93%A4%EC%96%B4%EB%9D%BC&quot; aria-label=&quot;tip 7 품질을 요구사항으로 만들어라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Tip 7. 품질을 요구사항으로 만들어라.&lt;/h2&gt;
&lt;/blockquote&gt;
&lt;p&gt;프로그래밍은 애초부터 완벽하게 할 수가 없다. 불-완벽한(완벽에 최대한 수렴하는) 프로그램을 짤 생각을 해야한다.&lt;/p&gt;
&lt;p&gt;내가 사용자라면?
버그가 단 하나도 없는 프로그램을 기다릴거냐?
복잡한 SW를 쓰면서 어느정도까지 버그는 감내할 수 있냐?
아니면, 결함이 더 적은 간단한 SW를 쓸거냐?&lt;/p&gt;
&lt;h2 id=&quot;5-지식-포트폴리오&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#5-%EC%A7%80%EC%8B%9D-%ED%8F%AC%ED%8A%B8%ED%8F%B4%EB%A6%AC%EC%98%A4&quot; aria-label=&quot;5 지식 포트폴리오 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;5. 지식 포트폴리오&lt;/h2&gt;
&lt;p&gt;내가 가지고 있는 지식은 결국 ‘소진하는 자산(expiring assets)’ 이다. 내 지식은 옛날의 것이 되고, 그 변하는 속도는 말 그래도 &lt;code class=&quot;language-text&quot;&gt;미쳤다&lt;/code&gt; 웹은 더 미친듯이 바뀐다. 오늘 다르고 내일 다르다.&lt;/p&gt;
&lt;p&gt;그래서 책은 내가 알고있는 사실, 경험을 ‘지식 포트폴리오’로 생각하기를 권장한다. 실제 투자하고 밀접한 연관이 있는데 이는 다음과 같다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;진지한 투자자들은 주기적으로 투자하는 습관을 가지고 있다.&lt;/li&gt;
&lt;li&gt;장투로 성공하기 위한 답은 다각화다.&lt;/li&gt;
&lt;li&gt;똑똑한 투자자들은 자신의 포트폴리오를 보수적인 투자, 위험성이 큰 투자, 보상이 높은 투자 사이에서 균형을 잘 맞춘다.&lt;/li&gt;
&lt;li&gt;최대 수익을 위해 싸게 사서 비싸게 판다.&lt;/li&gt;
&lt;li&gt;포트폴리오는 주기적으로 재검토, 재조정 해야한다.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;프로그래머는 위의 수칙을 이렇게 응용할 수도 있다&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;주기적인 투자: 꾸준히 신기술을 배워야함.&lt;/li&gt;
&lt;li&gt;다각화: 어느 분야의 특정 기술이 언제 생기고 언제 사라지는지 파악해야함. 많은 기술에 익숙하면 변화에 잘 적응할 수 있을 것이다.&lt;/li&gt;
&lt;li&gt;리스크 관리: 어느 기술이 어떻게 흥하고 망할지는 아무도 모른다. 그러니까 한기술에 몰빵하지 마라.&lt;/li&gt;
&lt;li&gt;싸게 사서 비싸게 팔기: 신기술이 생기면 적극적으로 들이대보라. 분명 리스크가 있는데, 빵 뜬 언어같으면 내가 그 언어를 ‘잘 안다’ 할 수 있다. 그건 분명 좋은 점이다.&lt;/li&gt;
&lt;li&gt;검토 및 재조정: 작년까지 잘쓰던 기술이 올해는 쌉퇴물이 될 수도 있다. 한동안 안쓰던 기술을 이제와서보니 다시 쓰더라 하기 쉽다. 그래서 많이 다뤄봐야 한다는 말.&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;h2 id=&quot;tip-8-지식-포트폴리오에-주기적으로-투자하라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#tip-8-%EC%A7%80%EC%8B%9D-%ED%8F%AC%ED%8A%B8%ED%8F%B4%EB%A6%AC%EC%98%A4%EC%97%90-%EC%A3%BC%EA%B8%B0%EC%A0%81%EC%9C%BC%EB%A1%9C-%ED%88%AC%EC%9E%90%ED%95%98%EB%9D%BC&quot; aria-label=&quot;tip 8 지식 포트폴리오에 주기적으로 투자하라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Tip 8. 지식 포트폴리오에 주기적으로 투자하라.&lt;/h2&gt;
&lt;/blockquote&gt;
&lt;p&gt;본 책에서는 다음과 같은 방법을 제안함.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;매년 새 언어를 하나씩 배워라.&lt;/li&gt;
&lt;li&gt;기술 서적을 분기마다 하나씩 읽어라.&lt;/li&gt;
&lt;li&gt;비기술 서적을 읽어라. 심리학, 문화인류학, 건축학, 경영학 이런 것들 조차도..&lt;/li&gt;
&lt;li&gt;수업을 들어라. 각종 세미나, 컨퍼런스에 가보라는 말.&lt;/li&gt;
&lt;li&gt;지역 사용자 모임에 참여하라. 고립되면 안된다. 개발자 모임에 가서 새로운 피를 계속 수혈받아야한다.&lt;/li&gt;
&lt;li&gt;다른 환경에서 실험해보라. 윈도우도 써보고 맥도 써보고 유닉스도 써보고 하여튼 다 써봐야함. ./configure, makefile, make도 해봐야되고 IDE도 써봐야되고 하여튼 다 써봐야한다.&lt;/li&gt;
&lt;li&gt;트렌드를 계속 파악하고 있어야한다. subscribe! 이메일 노트도 계속 봐야한다. 맨날 쓰레기통에 주떤지지 말고&lt;/li&gt;
&lt;li&gt;인터넷을 이용하라. 구글께서는 답을 알고계신다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&quot;http://wiki.kldp.org/wiki.php/DocbookSgml/Beginner_QA-KLDP&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener noreferrer&quot;&gt;질문하는 방법&lt;/a&gt;은 kldp에도 있다. 그런 구루들에게 많이 물어서 답을 내꺼로 하자!&lt;/p&gt;
&lt;p&gt;비판적인 사고는 중요하다. ‘내 말이 옳다!’ 하는 미치광이를 멀리해야한다. 어떤 문제에 대해 무조건 풀 수 있는 답 같은건 없다. 주어진 문제를 풀 수 있는 방법은 다양하기 때문이다. 하지만 때로는 아름다운 단 하나의 답만이 존재할 수도 있다.&lt;/p&gt;
&lt;p&gt;kldp의 어느 사람의 말을 기억하자.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;프로그래밍 언어는 목적이 아니라 수단일 뿐입니다.
Buzz와 Fanboyism에 휘둘리기 보다는
하고 있는 일이 잘되게 하는 Getting Things Done에 집중하시길 추천드립니다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;h2 id=&quot;tip-9-읽고-듣는-것을-비판적으로-분석하라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#tip-9-%EC%9D%BD%EA%B3%A0-%EB%93%A3%EB%8A%94-%EA%B2%83%EC%9D%84-%EB%B9%84%ED%8C%90%EC%A0%81%EC%9C%BC%EB%A1%9C-%EB%B6%84%EC%84%9D%ED%95%98%EB%9D%BC&quot; aria-label=&quot;tip 9 읽고 듣는 것을 비판적으로 분석하라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Tip 9. 읽고 듣는 것을 비판적으로 분석하라.&lt;/h2&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;6-소통하라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#6-%EC%86%8C%ED%86%B5%ED%95%98%EB%9D%BC&quot; aria-label=&quot;6 소통하라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;6. 소통하라!&lt;/h2&gt;
&lt;p&gt;앞서 말한걸 다 할 수 있어도 다른사람과 함께 일할 수 없다면 아무 쓸모가 없다. 혼자 일하는 프로그래머는 거의 없고 있어도 다른 누군가하고 분명 소통하고 있을 것이다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;내가 말하고 싶은게 뭔지 파악하자.
문서에 서론, 본론, 결론 나눠서 생각하는 만큼 말할때도 다듬어서 하면 서로 좋다. 나는 할말 바로하고, 상대방은 바로 알아먹으니까.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;청중을 파악하자.
쓸데없이 말 할 필요가 없다. WISDOM principle을 파악하고 써먹으면 그럴 필요가 없어진다.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;WISDOM: 청중 이해하기(내 말을 듣는 사람이 어떤가?)&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;키워드&lt;/th&gt;
&lt;th&gt;내용&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;What&lt;/td&gt;
&lt;td&gt;듣는 사람이 무엇을 배우길 원하는가?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Interest&lt;/td&gt;
&lt;td&gt;듣는 사람이 관심있어 하는 것은 무엇인가?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Sophisticated&lt;/td&gt;
&lt;td&gt;듣는 이들이 얼마나 소양이있나?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Detail&lt;/td&gt;
&lt;td&gt;듣는 이들이 어느정도의 구체적인 내용을 원하나?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Owe&lt;/td&gt;
&lt;td&gt;누가 정보를 소유하길 원하나?&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Motive&lt;/td&gt;
&lt;td&gt;듣는 이가 경청하도록 동기를 주려면 어떻게 해야할까?&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;듣는사람을 &lt;code class=&quot;language-text&quot;&gt;여섯가지&lt;/code&gt;로 먼저 파악하고 말하면 이해도가 빠르다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;언제 내가 말하면 상대방이 잘 들을까?
상대방이 듣고싶어하는 때를 잘 캐치해서 말하는 것이 좋다. 듣는이의 우선순위를 고려하는 것이 좋은 방법이 될 것이다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;말하는 스타일을 골라라.
말하는 스타일이 듣는 사람이 듣고싶어하는 대로 해줘야 좋아하게 된다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;멋져보이게 하라.
아래아 한글을 써도 간지나게 쓰는 사람이 있는가하면 파워포인트를 써도 그놈의 보노보노를 쓰는 사람이 있다. 뭐가 나를 돋보이게 할까? 적어도 내가 쓰는 툴의 다양한 기능을 찾아서 간지나게 해야 보는 사람도 좋고 만든 사람도 뿌듯하지 않을까?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;청중을 참여시켜라
문서의 초고를 독자가 보고 맘에든다/이건 싫다 하는걸로 피드백을 받을 수 있으면 도움이 된다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;청자(listener)가 되어라
내가 상대 말을 먼저 잘 들어야(경청해야) 남도 내 말을 들어준다.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;응답하라
대답은 해줘야 핑퐁대화가 될 것 아니냐.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;cf) 이메일 의사소통:
구글 검색해라&lt;/p&gt;
&lt;blockquote&gt;
&lt;h2 id=&quot;tip-10-무엇을-말하는가와-어떻게-말하는가-모두-중요하다&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#tip-10-%EB%AC%B4%EC%97%87%EC%9D%84-%EB%A7%90%ED%95%98%EB%8A%94%EA%B0%80%EC%99%80-%EC%96%B4%EB%96%BB%EA%B2%8C-%EB%A7%90%ED%95%98%EB%8A%94%EA%B0%80-%EB%AA%A8%EB%91%90-%EC%A4%91%EC%9A%94%ED%95%98%EB%8B%A4&quot; aria-label=&quot;tip 10 무엇을 말하는가와 어떻게 말하는가 모두 중요하다 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Tip 10. &lt;code class=&quot;language-text&quot;&gt;무엇을&lt;/code&gt; 말하는가와 &lt;code class=&quot;language-text&quot;&gt;어떻게&lt;/code&gt; 말하는가 모두 중요하다&lt;/h2&gt;
&lt;/blockquote&gt;</content:encoded></item><item><title><![CDATA[실용주의 프로그래머 pt. 1]]></title><description><![CDATA[실용주의 프로그래머 2nd edition을 읽은 후... pt. 1]]></description><link>https://blog.s3ich4n.me/books/pragmatic-programmer-1st/2018-02-21-pt01</link><guid isPermaLink="false">https://blog.s3ich4n.me/books/pragmatic-programmer-1st/2018-02-21-pt01</guid><pubDate>Wed, 21 Feb 2018 00:00:00 GMT</pubDate><content:encoded>&lt;h3 id=&quot;읽기에-앞서&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%EC%9D%BD%EA%B8%B0%EC%97%90-%EC%95%9E%EC%84%9C&quot; aria-label=&quot;읽기에 앞서 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;읽기에 앞서…&lt;/h3&gt;
&lt;p&gt;실용주의 프로그래머를 읽고 느낀점을 써보려고 합니다. 제가 느낀바로는 이러한 내용이다 하는 방향으로 기술할 것 같습니다.&lt;/p&gt;
&lt;h1 id=&quot;preface&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#preface&quot; aria-label=&quot;preface permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Preface&lt;/h1&gt;
&lt;p&gt;이 책은 서장부터 바로 주요한 내용이 나오기 때문에 특별히 실었다.&lt;/p&gt;
&lt;p&gt;좋은 프로그래머가 되고싶으면 실용주의 프로그래머가 되도록 노력하면 된다.&lt;/p&gt;
&lt;p&gt;실용주의 프로그래머가 되려면?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;얼리어답터.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;신기술을 받아들이는데 적극적이어야 하는 성향을 지니면 좋다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;캐묻기 좋아한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;‘왜?‘의 중요함. 모르면 검색할 줄 아는 적극성.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;비판적인 사고의 소유자&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;인과관계를 확실히 짚을 줄 아는 사람이 되면 좋다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;현실적이다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;내가 마주하는 문제가 어렵나/쉽나, 그로 인해 시간이 얼마나 걸리나를 바로 파악할 수 있는 사람을 말한다.설령 오래 걸린다 해도 얼마만큼 붙잡고 해결할 것인지까지 견적을 내보고 집요하게 달라든다고 할 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;다방면의 기술에 익숙하다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;신기술을 계속 접할 필요가 있다! 후에 다시 나올 이야기이다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;h2 id=&quot;tip-1-자신의-기술craft에-관심과-애정을-가져라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#tip-1-%EC%9E%90%EC%8B%A0%EC%9D%98-%EA%B8%B0%EC%88%A0craft%EC%97%90-%EA%B4%80%EC%8B%AC%EA%B3%BC-%EC%95%A0%EC%A0%95%EC%9D%84-%EA%B0%80%EC%A0%B8%EB%9D%BC&quot; aria-label=&quot;tip 1 자신의 기술craft에 관심과 애정을 가져라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Tip 1. 자신의 기술(craft)에 관심과 애정을 가져라!&lt;/h2&gt;
&lt;/blockquote&gt;
&lt;p&gt;내가 하는 일에 관심과 애정이 없으면 그건 차라리 고문이다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;h2 id=&quot;tip-2-자신의-일에-생각하면서-일하라&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#tip-2-%EC%9E%90%EC%8B%A0%EC%9D%98-%EC%9D%BC%EC%97%90-%EC%83%9D%EA%B0%81%ED%95%98%EB%A9%B4%EC%84%9C-%EC%9D%BC%ED%95%98%EB%9D%BC&quot; aria-label=&quot;tip 2 자신의 일에 생각하면서 일하라 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Tip 2. 자신의 일에 생각하면서 일하라!&lt;/h2&gt;
&lt;p&gt;내가 하는 모든일에 있어 항상 지속적으로 비판적으로 쳐다볼 필요가 있다. 기계적으로 일하지 마라!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;이건 분명 귀찮고 힘들다. 이런 일을 계속 하면 효율적이고 유지보수 쉬운 코드를 짜게되고, 비로소 ‘실용적인 프로그래머’가 될 수 있다.&lt;/p&gt;
&lt;p&gt;장인정신은 이렇기 때문에 중요하다.&lt;/p&gt;</content:encoded></item></channel></rss>